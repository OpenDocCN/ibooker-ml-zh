- en: Chapter 4\. Use AutoML to Predict Advertising Media Channel Sales
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第4 章。使用AutoML预测广告媒体渠道销售
- en: In this chapter, you build an AutoML model to predict advertising media channel
    sales. First, you explore your data using Pandas. Then you learn how to use AutoML
    to build, train, and deploy an ML model to predict sales. You gain an overall
    understanding of the performance of your model using performance metrics and answer
    common business questions. Along the way, you’ll learn about regression analysis,
    a common technique used for prediction use cases.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将建立一个AutoML模型来预测广告媒体渠道的销售情况。首先，您将使用Pandas探索您的数据。然后，您将学习如何使用AutoML构建、训练和部署一个ML模型来预测销售。您将通过性能指标全面了解您模型的表现，并回答常见的业务问题。在此过程中，您将学习到用于预测用例的常见技术——回归分析。
- en: 'The Business Use Case: Media Channel Sales Prediction'
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 业务用例：媒体渠道销售预测
- en: Businesses use advertising media channels to promote their products, services,
    or brand. Marketers and media planners create marketing campaigns that may run
    on digital, TV, radio, or in the newspaper. In this scenario, you work as a media
    planner in the marketing department for a midsize solar energy company. Your firm
    has a modest media budget and needs to evaluate which channels offer the greatest
    number of benefits for the least cost. This is a spend optimization problem.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 企业使用广告媒体渠道来推广其产品、服务或品牌。营销人员和媒体策划人员创建可能在数字、电视、广播或报纸上运行的营销活动。在这种情况下，您作为一个中型太阳能公司市场部门的媒体策划人员工作。您的公司有一个适度的媒体预算，需要评估哪些渠道提供了最大的利益，成本最低。这是一个支出优化问题。
- en: You have been asked to develop a marketing plan that will increase next year’s
    product sales. To accomplish this goal, you need to understand the impact of the
    media channel product advertising budgets on overall sales. The advertising dataset
    captures the sales revenue generated with respect to advertisement costs across
    digital, TV, radio, and newspaper media channels.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 您被要求制定一个营销计划，以增加明年的产品销售量。为了实现这一目标，您需要了解媒体渠道产品广告预算对整体销售额的影响。广告数据集捕捉了在数字、电视、广播和报纸媒体渠道上的广告费用与销售收入之间的关系。
- en: Typically, this type of ask from the team lead would go to a data scientist
    or data analyst. But, although you do not have any coding experience, the marketing
    team lead has asked you to build a sales predictive model using AutoML, something
    they want to try for the first time on the team. The goal is to build an ML model
    to predict how much sales volume will be generated based on the money spent in
    each of the media channels.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，这种要求会交给数据科学家或数据分析师。但是，尽管您没有任何编程经验，市场团队负责人却要求您使用AutoML构建销售预测模型，这是团队首次尝试的事情。目标是建立一个机器学习模型，根据在每个媒体渠道上的花费来预测销售量。
- en: 'Business questions include:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 业务问题包括：
- en: Can the model predict how much sales volume will be generated based on the money
    spent in each media channel?
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型能否根据每个媒体渠道的投入预测未来的销售量？
- en: Is there a relationship between advertising budget and sales?
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 广告预算和销售之间是否存在关系？
- en: Which media channel contributes the most to sales?
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 哪个媒体渠道对销售贡献最大？
- en: Can the model be used to forecast future sales based on the media channel’s
    proposed budget?
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该模型能否用于预测基于媒体渠道拟议预算的未来销售？
- en: How accurately can the model predict future sales?
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型能够准确预测未来销售吗？
- en: The use case is a simple regression problem with just five variables that you
    can use to answer the preceding five questions.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 该用例是一个简单的回归问题，仅包含五个变量，您可以用来回答前面的五个问题。
- en: Project Workflow
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 项目工作流程
- en: '[Figure 4-1](#automl_workflow_for_the_business_case) shows the high-level overview
    of the typical AutoML no-code workflow from [Chapter 3](ch03.html#machine_learning_libraries_and_framewor).
    This workflow is appropriate for your use case.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-1](#automl_workflow_for_the_business_case)显示了典型AutoML无代码工作流程的高级概述，来自[第 3
    章](ch03.html#machine_learning_libraries_and_framewor)。该工作流程适用于您的用例。'
- en: '![AutoML workflow for the business case](assets/lcai_0401.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![业务案例的AutoML工作流程](assets/lcai_0401.png)'
- en: Figure 4-1\. AutoML workflow for the business case.
  id: totrans-16
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-1\. 业务案例的AutoML工作流程。
- en: Now that you understand the business use case and objective, you can proceed
    to data extraction and analysis. Note that this workflow does not include a data
    preprocessing step. You will get lots of hands-on experience with data preprocessing
    in later chapters. After data extraction and analysis, you will upload the dataset
    into the AutoML platform. The advertising budgets of digital, TV, newspaper, and
    radio data are then fed into the model. You’ll then evaluate the AutoML results
    and then deploy the model to make predictions. After this chapter’s hands-on exercise,
    you will be able to create a strategic marketing plan for your team.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您了解了业务用例和目标，可以继续进行数据提取和分析。请注意，此工作流程不包括数据预处理步骤。在后续章节中，您将获得大量数据预处理的实践经验。数据提取和分析后，您将上传数据集到AutoML平台。数字、电视、报纸和广播数据的广告预算将输入模型。然后，您将评估AutoML的结果，并部署模型进行预测。完成本章的实践后，您将能够为您的团队创建战略营销计划。
- en: Project Dataset
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 项目数据集
- en: The dataset is composed of historical marketing channel data that can be leveraged
    to gain insights for spend allocation and to predict sales. The dataset being
    used for this chapter, [the advertising_2023 dataset](https://oreil.ly/JI6eL),
    is based on data taken from [*An Introduction to Statistical Learning with Applications
    in R*](https://www.statlearning.com) by Daniela Witten, Gareth M. James, Trevor
    Hastie, and Robert Tibshirani (Springer, 2021). The advertising dataset captures
    the sales revenue generated from advertising (in thousands of units) for particular
    product advertising budgets (in thousands of dollars) for TV, radio, and newspaper
    media.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集由历史营销渠道数据组成，可用于洞察支出分配并预测销售。本章使用的数据集，[广告_2023数据集](https://oreil.ly/JI6eL)，基于[*An
    Introduction to Statistical Learning with Applications in R*](https://www.statlearning.com)一书（Springer,
    2021）中的数据，作者为Daniela Witten、Gareth M. James、Trevor Hastie和Robert Tibshirani。该广告数据集记录了特定产品广告预算（以千美元计）在电视、广播和报纸媒体上产生的销售收入（以千单位计）。
- en: For this book, the dataset has been updated to include a digital variable and
    modified to show the impact of digital budgets on sales. The number of markets
    has been increased from 200 to 1,200\. Thus, the data consists of the advertising
    budgets for four media channels (digital, TV, radio, and newspapers) and the overall
    sales in 1,200 different markets. You should feel encouraged to look at other
    examples of how to work with this dataset to grow your knowledge after completing
    the exercises in this chapter.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本书，数据集已更新以包括数字变量，并修改以显示数字预算对销售的影响。市场数量已从200增加到1,200个。因此，数据包括1,200个不同市场的广告预算（数字、电视、广播和报纸）以及总销售额。完成本章练习后，鼓励您查看如何处理此数据集的其他示例以增进您的知识。
- en: The data is initially supplied in a CSV file, so you will need to spend some
    time loading the data into Pandas before you can explore it. The dataset contains
    only numeric variables.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 数据最初以CSV文件的形式提供，因此您需要花些时间将数据加载到Pandas中才能进行探索。数据集仅包含数值变量。
- en: There are five columns in the dataset. [Table 4-1](#schema_and_field_value_information_f)
    gives the column names, data types, and some information about the possible values
    for these columns.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集有五列。[表 4-1](#schema_and_field_value_information_f) 提供了这些列的列名、数据类型以及关于这些列可能值的一些信息。
- en: Table 4-1\. Schema and field value information for the advertising dataset
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 表4-1\. 广告数据集的模式和字段值信息
- en: '| Column name | Column type | Notes about field values |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| 列名 | 列类型 | 字段值的注释 |'
- en: '| --- | --- | --- |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Digital | Numeric | Amount spent on advertisements in digital |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| 数字 | 数字 | 在数字广告上的支出金额 |'
- en: '| Newspaper | Numeric | Amount spent on advertisements in newspapers |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| 报纸 | 数字 | 在报纸广告上的支出金额 |'
- en: '| Radio | Numeric | Amount spent on advertisements in radio |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| 广播 | 数字 | 在广播广告上的支出金额 |'
- en: '| TV | Numeric | Amount spent on advertisements in TV |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| 电视 | 数字 | 在电视广告上的支出金额 |'
- en: '| Sales | Numeric | Total media channel sales |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| 销售额 | 数字 | 总媒体渠道销售额 |'
- en: Exploring the Dataset Using Pandas, Matplotlib, and Seaborn
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Pandas、Matplotlib和Seaborn探索数据集
- en: Before you begin using AutoML, you follow the workflow discussed in earlier
    chapters around understanding and preparing data for ML. This section shows you
    how to load data into a Google Colab notebook using Pandas, an open source Python
    package that is widely used for data science and data analysis. Once the data
    is loaded into a DataFrame, you will explore the data. Fortunately, the data has
    already been cleaned—there are no missing values or strange characters in the
    dataset. Your exploratory data analysis is to assist you in validating that the
    data is clean and to explore relationships between the variables to assist you
    in answering questions posed from the team. As noted in previous chapters, much
    of the ML work goes into understanding and preparing the training data—not training
    the model—because you are relying on AutoML to build the model.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始使用AutoML之前，您需要遵循前几章讨论的工作流程，以了解和准备ML所需的数据。本节向您展示如何使用Pandas将数据加载到Google Colab笔记本中，Pandas是一种广泛用于数据科学和数据分析的开源Python包。一旦数据加载到DataFrame中，您将探索数据。幸运的是，数据已经过清理—数据集中没有缺失值或奇怪的字符。您的探索性数据分析是为了验证数据的清洁性，并探索变量之间的关系，以帮助您回答团队提出的问题。正如前几章所述，大部分ML工作是用于理解和准备训练数据—而不是训练模型—因为您依赖于AutoML来构建模型。
- en: All of the code in this section, including some additional examples, is included
    in a Jupyter notebook titled Chapter4_Media_Channel_Sales_Notebook in the [low-code-ai
    repository on GitHub](https://oreil.ly/supp-lcai).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中的所有代码，包括一些额外的示例，都包含在名为[low-code-ai repository on GitHub](https://oreil.ly/supp-lcai)的Jupyter笔记本Chapter4_Media_Channel_Sales_Notebook中。
- en: Load Data into a Pandas DataFrame in a Google Colab Notebook
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Google Colab Notebook中将数据加载到Pandas DataFrame中
- en: First, go to [*https://colab.research.google.com*](https://colab.research.google.com)
    and open a new notebook, following the process discussed in [Chapter 2](ch02.html#data_is_the_first_step).
    You may rename this notebook to a more meaningful name by clicking on the name
    as shown in [Figure 4-2](#renaming_the_google_colab_notebook_to) and replacing
    the current name with a new name, say *Advertising_Model.ipynb*.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，转到[*https://colab.research.google.com*](https://colab.research.google.com)，打开一个新笔记本，按照[第2章](ch02.html#data_is_the_first_step)中讨论的过程操作。您可以通过单击[图 4-2](#renaming_the_google_colab_notebook_to)中显示的名称并用新名称替换当前名称，例如*Advertising_Model.ipynb*，对笔记本进行重命名。
- en: '![Renaming the Google Colab notebook to a more meaningful name](assets/lcai_0402.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![将Google Colab笔记本重命名为更有意义的名称](assets/lcai_0402.png)'
- en: Figure 4-2\. Renaming the Google Colab notebook to a more meaningful name.
  id: totrans-37
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-2\. 将Google Colab笔记本重命名为更有意义的名称。
- en: 'Now type the following code into the first code block to import the packages
    needed to analyze and visualize the advertising dataset:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在将以下代码输入到第一个代码块中，以导入分析和可视化广告数据集所需的包：
- en: '[PRE0]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: You saw some of these packages before in [Chapter 2](ch02.html#data_is_the_first_step)
    when first exploring the use of Colab notebooks.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 当您首次探索Colab笔记本的使用时，在[第2章](ch02.html#data_is_the_first_step)中就看到了这些包的一些示例。
- en: Now execute the cell containing the import statements to import the packages.
    To do this, you click the Run Cell button on the left side of the cell. You can
    also press Shift + Enter to run the cell.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 现在执行包含导入语句的单元格以导入这些包。要执行此操作，请单击单元格左侧的“运行单元格”按钮。您也可以按Shift + Enter运行单元格。
- en: 'Now you are ready to import your data. Using Pandas, you can directly import
    a CSV file into a DataFrame from a location on the internet without having to
    download the file first. To do this, copy the code from the solution notebook
    or type in the following code into a new cell and execute the cell:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您可以导入您的数据了。使用Pandas，您可以直接从互联网上的位置将CSV文件导入DataFrame，而无需先下载文件。要做到这一点，请从解决方案笔记本中复制代码或在新单元格中输入以下代码并执行该单元格：
- en: '[PRE1]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: In general, it is a good idea to look at the first few rows of the DataFrame.
    Use `advertising_df.head()` to explore the first few rows of the DataFrame. The
    head Pandas method lets us see the first five rows of our data. By doing this,
    you can quickly see the features, some of their possible values, and whether they
    are numerical or not.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，查看DataFrame的前几行是个好主意。使用`advertising_df.head()`来探索DataFrame的前几行。head Pandas方法让我们看到我们数据的前五行。通过这样做，您可以快速查看特征、一些可能的值以及它们是否是数值。
- en: An example of a few of the columns is shown in [Figure 4-3](#a_few_columns_of_the_first_five_rows_o).
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 一个示例是在[图 4-3](#a_few_columns_of_the_first_five_rows_o)中显示的几列。
- en: '![A few columns of the first five rows of the DataFrame advertising_df printed
    using the head() method](assets/lcai_0403.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![使用`head()`方法打印出来的 DataFrame `advertising_df` 的前五行的几列](assets/lcai_0403.png)'
- en: Figure 4-3\. A few columns of the first five rows of the DataFrame `advertising_df`
    printed using the `head()` method.
  id: totrans-47
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-3\. 使用`head()`方法打印出来的 DataFrame `advertising_df` 的前五行的几列。
- en: Explore the Advertising Dataset
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索广告数据集
- en: Now  that the data has been loaded into the DataFrame `advertising_df`, you
    can begin to explore and understand it. The immediate goal is to get an idea of
    where there could be issues with the data so that you may resolve those issues
    before moving forward.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在数据已经加载到 DataFrame `advertising_df` 中，你可以开始探索和理解它。当前的目标是了解数据中可能存在的问题，以便在继续之前解决这些问题。
- en: 'Descriptive analysis: Check the data'
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 描述性分析：检查数据
- en: First check the data using standard Python methods. To check the data types
    for your DataFrame, type **`advertising_df.info()`** into a new cell and execute
    the cell. The information contains the number of columns, column labels, column
    data types, memory usage, range index, and the number of cells in each column
    (non-null values).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 首先使用标准的 Python 方法检查数据。要检查 DataFrame 的数据类型，请在一个新的单元格中键入 **`advertising_df.info()`**
    并执行该单元格。信息包括列数、列标签、列数据类型、内存使用情况、索引范围以及每列的单元格数（非空值）。
- en: '[Figure 4-4](#information_on_the_dataset_using_the_in) shows an example of
    the `info()` method output.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-4](#information_on_the_dataset_using_the_in)展示了`info()`方法的输出示例。'
- en: '![Information on the dataset using the info() method](assets/lcai_0404.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![使用`info()`方法获取数据集信息](assets/lcai_0404.png)'
- en: Figure 4-4\. Information on the dataset using the `info()` method.
  id: totrans-54
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-4\. 使用`info()`方法获取数据集信息。
- en: Note that with information on the data type, you can check to make sure that
    the types inferred by Pandas match up with what was expected from [Table 4-1](#schema_and_field_value_information_f).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，有了数据类型的信息，你可以检查确保 Pandas 推断的类型与预期的[表 4-1](#schema_and_field_value_information_f)相匹配。
- en: Shown in [Figure 4-5](#summary_statistics_for_all_columns_in_t) is the `describe()`
    method, which computes and displays summary statistics for the dataset. The `describe`
    function shows information about the numerical variables of our dataset. You can
    see the mean, maximum, and minimum values of each of these variables, along with
    their standard deviation. Type **`advertising_df.describe()`** into a new cell
    and execute the cell.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-5](#summary_statistics_for_all_columns_in_t)显示了`describe()`方法的输出，该方法计算并显示数据集的汇总统计信息。`describe`函数显示了数据集的数值变量的信息。你可以看到每个变量的均值、最大值、最小值以及它们的标准差。在一个新的单元格中键入
    **`advertising_df.describe()`** 并执行该单元格。'
- en: '![Summary statistics for all columns in the advertising dataset](assets/lcai_0405.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![广告数据集所有列的汇总统计信息](assets/lcai_0405.png)'
- en: Figure 4-5\. Summary statistics for all columns in the advertising dataset.
  id: totrans-58
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-5\. 广告数据集所有列的汇总统计信息。
- en: Shown in [Figure 4-6](#determining_null_values_using_the_isnul) is the output
    of the `.isnull()` method. Type **`advertising_df.isnull().sum()`** into a new
    cell and execute the cell. The output shows all of the columns in the DataFrame
    with associated zeros. If there were null values, the number of null values for
    the column would be shown.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-6](#determining_null_values_using_the_isnul)展示了`.isnull()`方法的输出。在一个新的单元格中键入
    **`advertising_df.isnull().sum()`** 并执行该单元格。输出显示了 DataFrame 中所有列的关联零值。如果存在空值，则会显示每列的空值数量。'
- en: '![Determining null values using the isnull() method](assets/lcai_0406.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![使用`isnull()`方法确定空值](assets/lcai_0406.png)'
- en: Figure 4-6\. Determining null values using the `isnull()` method.
  id: totrans-61
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-6\. 使用`isnull()`方法确定空值。
- en: Explore the data
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 探索数据
- en: Exploratory data analysis (EDA) is the first step of any ML project. You need
    to explore your data before building any ML model. The goal is to take a look
    at the raw data, explore it, and gather relevant insights from the information
    derived from the data. Doing this also helps make models better, as you’ll be
    able to spot any “dirty data” issues—such as missing values, strange characters
    in a column, etc.—that may impact performance.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 探索性数据分析（EDA）是任何 ML 项目的第一步。在构建任何 ML 模型之前，你需要先探索数据。目标是查看原始数据、探索数据并从中获取相关的见解。通过这样做，你还可以改进模型，因为你将能够发现任何可能影响性能的“脏数据”问题，如缺失值、列中的奇怪字符等。
- en: Heat maps (correlations)
  id: totrans-64
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 热力图（相关性）
- en: 'A *heat map* is a way of representing the data visually. The data values are
    represented as colors in the graph. The goal of the heat map is to provide a colored
    visual summary of information. Heat maps show your relationships (correlations)
    between variables (features). *Correlation* is a statistical measure that shows
    the extent to which two or more variables move together. Shown in [Figure 4-7](#correlation_matrix_for_advertising_medi)
    is the output of a correlation method that plots correlation values on the grid.
    Type the following code into a new cell and execute the cell:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '*热图*是一种以视觉方式表示数据的方法。数据值在图中表示为颜色。热图的目标是提供信息的彩色视觉摘要。热图显示了变量（特征）之间的关系（相关性）。*相关性*是一个统计量，显示两个或多个变量如何一起移动的程度。在图 4-7](#correlation_matrix_for_advertising_medi)中显示了一个相关性方法的输出，该方法在网格上绘制相关性值。在新单元格中键入以下代码并执行该单元格：'
- en: '[PRE2]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![Correlation matrix for advertising media channels](assets/lcai_0407.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![广告媒体渠道的相关矩阵](assets/lcai_0407.png)'
- en: Figure 4-7\. Correlation matrix for advertising media channels.
  id: totrans-68
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-7\. 广告媒体渠道的相关矩阵。
- en: 'The results from a correlation matrix can be used in a variety of ways, including:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 相关矩阵的结果可以在多种方式中使用，包括：
- en: Identifying relationships between variables
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 识别变量之间的关系
- en: The correlation coefficient between two variables can tell you how strongly
    they are related. A correlation coefficient of 0 means there is no relationship,
    whereas a correlation coefficient of 1 means there is a perfect positive relationship.
    A correlation coefficient of –1 means there is a perfect negative relationship.
    *Note that the stronger relationships are between sales and television (0.78),
    followed by sales and radio (0.58)*. This information can be used to develop targeted
    marketing campaigns that are more likely to improve sales.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 两个变量之间的相关系数可以告诉您它们之间的关系强度。相关系数为0意味着没有关系，而相关系数为1意味着存在完美的正关系。相关系数为–1意味着存在完美的负关系。*请注意，销售和电视之间的关系最为显著（0.78），其次是销售和广播（0.58）*。这些信息可用于制定有针对性的营销活动，以提高销售。
- en: Selecting variables for inclusion in a model
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 选择模型中包含的变量
- en: When you are building a predictive model, you need to select the variables that
    are most likely to be predictive of the outcome. For example, should you include
    newspapers (with a 0.23 correlation to sales) as a feature for inclusion in the
    model to predict sales?
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建预测模型时，您需要选择最有可能预测结果的变量。例如，是否应将报纸（与销售的相关性为0.23）作为模型中的特征包含以预测销售？
- en: Detecting multicollinearity
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 检测多重共线性
- en: Multicollinearity occurs when two or more predictor variables in a regression
    model are highly correlated. For example, if both TV and radio were highly correlated
    (meaning that both had a value >0.7 instead of 0.056 as shown in [Figure 4-7](#correlation_matrix_for_advertising_medi)),
    it would indicate multicollinearity. Since it is harder to numerically distinguish
    predictors with a strong collinear relationship from one another, it is more difficult
    for a regression algorithm to determine the degree of influence or weight one
    of them should have on sales.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 当回归模型中两个或更多预测变量高度相关时，就会发生多重共线性。例如，如果电视和广播的相关性很高（意味着两者的值>0.7，而不是0.056，如图 4-7](#correlation_matrix_for_advertising_medi)所示），则表明存在多重共线性。由于很难从数值上区分具有强共线关系的预测变量，因此回归算法更难确定其中一个对销售的影响程度或权重。
- en: Warning
  id: totrans-76
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: As a warning, the results of a correlation matrix may change due to sample size
    or outliers in the dataset.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 作为警告，由于样本大小或数据集中的异常值，相关矩阵的结果可能会发生变化。
- en: Scatterplots
  id: totrans-78
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 散点图
- en: 'Scatterplots are used to determine relationships between two numerical variables.
    They can help you see if there is a direct relationship (positive linear relationship
    or negative linear relationship, for example) between two variables. Also, they
    can help you detect if your data has outliers or not. [Figure 4-8](#scatterplot_of_digital_and_sales)
    shows a scatter of the digital feature and the sales target. Type the following
    code into a new cell and execute the cell:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 散点图用于确定两个数值变量之间的关系。它们可以帮助您看出两个变量之间是否存在直接关系（例如正线性关系或负线性关系）。此外，它们还可以帮助您检测数据是否存在异常值。[图 4-8](#scatterplot_of_digital_and_sales)显示了数字特征和销售目标的散点图。在新单元格中键入以下代码并执行该单元格：
- en: '[PRE3]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![Scatterplot of digital and sales](assets/lcai_0408.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![数字特征和销售的散点图](assets/lcai_0408.png)'
- en: Figure 4-8\. Scatterplot of digital and sales.
  id: totrans-82
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-8\. 数字和销售的散点图。
- en: 'You want to explore the scatterplots for each variable with the predicted variable
    `sales`. You can plot each feature as a scatterplot separately (as you did earlier),
    or you can plot them so all of the relationships are shown in one plot. Type all
    of the following code into a new cell and execute the cell ([Figure 4-9](#scatterplots_of_all_features_and_sales)
    shows the output):'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 你想探索每个变量与预测变量 `sales` 的散点图。你可以单独绘制每个特征的散点图（如之前所做的那样），或者将它们绘制在同一张图中以展示所有关系。将以下所有代码键入新的单元格并执行单元格（[图 4-9](#scatterplots_of_all_features_and_sales)
    显示输出）：
- en: '[PRE4]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![Scatterplots of all features and sales targets](assets/lcai_0409.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![所有特征和销售目标的散点图](assets/lcai_0409.png)'
- en: Figure 4-9\. Scatterplots of all features and sales targets.
  id: totrans-86
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-9\. 所有特征和销售目标的散点图。
- en: Note that TV and sales have a strong linear relationship—as it appears to show
    that for an increase in TV budget, there is a positive impact on sales volume.
    There does not appear to be a strong relationship between newspaper and sales.
    Recall the correlation values of 0.23 for this relationship. This is very different
    from the relationship between TV and sales (0.78).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，电视和销售之间存在强烈的线性关系——似乎显示出电视预算增加时，对销售量有正面影响。报纸和销售之间似乎没有强烈的关系。回顾该关系的相关系数为0.23。这与电视和销售之间的关系（0.78）非常不同。
- en: Histogram distribution plot
  id: totrans-88
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 直方图分布图
- en: A common approach to visualizing a distribution is the histogram. A *histogram*
    is a bar plot where the axis representing the target variable is divided into
    a set of discrete bins, and the count of observations falling within each bin
    is shown using the height of the corresponding bar.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 可视化分布的常见方法是直方图。*直方图*是一种柱形图，其中代表目标变量的轴被划分为一组离散的箱子，每个箱子内观察到的数量用相应柱的高度表示。
- en: 'Type this code into a new cell and run the cell:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 将此代码键入新的单元格并运行单元格：
- en: '[PRE5]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[Figure 4-10](#sales_histogram_that_is_slightly_skewed) shows the data values
    from the sales column. The plot looks somewhat like a bell curve that is slightly
    skewed to the left. The most common sales amount is $11,000 dollars.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-10](#sales_histogram_that_is_slightly_skewed) 显示了销售列的数据值。该图看起来略呈左偏态钟形曲线。最常见的销售额为$11,000
    美元。'
- en: '![Sales histogram that is slightly skewed to the left](assets/lcai_0410.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![稍微向左偏斜的销售直方图](assets/lcai_0410.png)'
- en: Figure 4-10\. Sales histogram that is slightly skewed to the left.
  id: totrans-94
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-10\. 稍微向左偏斜的销售直方图。
- en: 'What about the other features—are they skewed left or right or do they have
    a “normal distribution,” like a bell curve? You can type the preceding code for
    each individual feature or use the following code to see all of the features together.
    Type the following code into a new cell and execute the cell ([Figure 4-11](#distribution_plots_for_digitalcomma_tvc)
    shows the output):'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 其他特征呢？它们是向左偏斜还是向右偏斜，还是像钟形曲线一样“正态分布”？你可以为每个单独的特征键入前面的代码，或者使用以下代码查看所有特征的汇总。将以下代码键入新的单元格并执行单元格（[图 4-11](#distribution_plots_for_digitalcomma_tvc)
    显示输出）：
- en: '[PRE6]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: As you saw in [Figure 4-10](#sales_histogram_that_is_slightly_skewed), sales
    have somewhat of a normal distribution. However, in [Figure 4-11](#distribution_plots_for_digitalcomma_tvc),
    digital appears to be skewed left, and TV, radio, and newspaper are not normally
    distributed. Standardizing these features so they are normally distributed before
    feeding them into your ML model would generate better results.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你在[图 4-10](#sales_histogram_that_is_slightly_skewed) 中看到的那样，销售基本上呈正态分布。然而，在[图 4-11](#distribution_plots_for_digitalcomma_tvc)
    中，数字似乎向左偏斜，而电视、广播和报纸则不是正态分布的。在将这些特征标准化为正态分布之前，将它们输入到你的 ML 模型中会产生更好的结果。
- en: Note
  id: totrans-98
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: '*However, your role is not that of a data scientist*. Do not worry about understanding
    these concepts. Discussing each transformation required for the features is beyond
    the scope of this chapter. [Chapter 7](ch07.html#training_custom_ml_models_in_python)
    is where you perform transformations on a dataset.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '*然而，你的角色并不是数据科学家*。不必担心理解这些概念。讨论每个特征所需的每个转换超出了本章节的范围。请参阅[第 7 章](ch07.html#training_custom_ml_models_in_python)，在数据集上执行转换操作。'
- en: '![Distribution plots for digital, TV, radio, and newspaper](assets/lcai_0411.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![数字、电视、广播和报纸的分布图](assets/lcai_0411.png)'
- en: Figure 4-11\. Distribution plots for digital, TV, radio, and newspaper.
  id: totrans-101
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-11\. 数字、电视、广播和报纸的分布图。
- en: Export the advertising dataset
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 导出广告数据集
- en: 'After you have checked and explored the dataset, it is time to export the file
    so that it can be uploaded into your AutoML framework. Type the following code
    into a new cell and execute the cell. The first line imports the operating system
    that will allow you to make a directory called *data* (lines two and three):'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在检查和探索数据集之后，现在是时候导出文件，以便将其上传到您的 AutoML 框架中。将以下代码输入到一个新的单元格中并执行该单元格。第一行导入操作系统，使您可以创建一个名为
    *data* 的目录（第二和第三行）：
- en: '[PRE7]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'After the directory has been created, type the following code into a new cell
    and execute the cell. The first line of code creates a CSV file format of the
    advertising DataFrame and places it in the *content/data* directory you made in
    the previous step:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建完目录后，将以下代码输入到一个新的单元格中并执行该单元格。第一行代码创建了广告数据框架的 CSV 文件格式，并将其放置在您在上一步中创建的 *content/data*
    目录中：
- en: '[PRE8]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[Figure 4-12](#newly_created_data_directory_with_adver) shows the newly created
    directory called *data* with the file *advertising.csv*.'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-12](#newly_created_data_directory_with_adver) 显示了名为 *data* 的新创建目录及其文件
    *advertising.csv*。'
- en: '![Newly created data directory with advertising.csv file](assets/lcai_0412.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![新创建的 data 目录中的 advertising.csv 文件](assets/lcai_0412.png)'
- en: Figure 4-12\. Newly created data directory with advertising.csv file.
  id: totrans-109
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-12\. 新创建的 data 目录中的 advertising.csv 文件。
- en: As a best practice, validate that you can see the contents of the newly exported
    file in the newly created directory. Type **`!head /content/data/advertising.csv`**
    into a new cell and execute the cell. Check that the output shown in [Figure 4-13](#output_of_the_advertisingdotcsv_file)
    is the same as yours.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 作为最佳实践，请验证您能够看到新导出文件的内容位于新创建的目录中。在一个新的单元格中键入 **`!head /content/data/advertising.csv`**
    并执行该单元格。检查输出是否与 [图 4-13](#output_of_the_advertisingdotcsv_file) 中显示的内容相同。
- en: '![Output of the advertising.csv file](assets/lcai_0413.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![广告.csv 文件的输出](assets/lcai_0413.png)'
- en: Figure 4-13\. Output of the advertising.csv file.
  id: totrans-112
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-13\. 广告.csv 文件的输出。
- en: Now that you have verified that the file has been properly exported, you can
    download it to your computer.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经验证文件已正确导出，可以将其下载到您的计算机上。
- en: Right-click the *advertising.csv* file in the newly created *data* directory
    and select Download as shown in [Figure 4-14](#validate_advertisingdotcsv_in_data_dire).
    The file will download to your desktop. You are now ready to upload the file for
    AutoML use.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在新创建的 *data* 目录中右键单击 *advertising.csv* 文件，并选择如 [图 4-14](#validate_advertisingdotcsv_in_data_dire)
    所示的下载。该文件将下载到您的桌面。您现在可以将该文件上传以供 AutoML 使用。
- en: '![Validate advertising.csv in data directory](assets/lcai_0414.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![在数据目录中验证 advertising.csv 文件](assets/lcai_0414.png)'
- en: Figure 4-14\. Validate advertising.csv in data directory.
  id: totrans-116
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-14\. 在数据目录中验证 advertising.csv 文件。
- en: In the next section, you build a code-free model based on the training data
    file you just exported.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分中，您将基于刚刚导出的训练数据文件构建一个无代码模型。
- en: Use AutoML to Train a Linear Regression Model
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 AutoML 训练线性回归模型
- en: The AutoML projects for this book will be implemented using Google’s Vertex
    AI, the GUI-based AutoML and custom training framework the authors are most familiar
    with. Note that the top three major cloud vendors (Google, Microsoft, and AWS)
    all offer AutoML tutorials. Each of these three major cloud vendor’s guides can
    be found in their documentation. Many cloud vendors offer a trial period to explore
    their products without cost.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的 AutoML 项目将使用 Google 的 Vertex AI 实施，这是作者们最熟悉的基于 GUI 的 AutoML 和自定义训练框架。请注意，三大主要云供应商（Google、Microsoft
    和 AWS）都提供 AutoML 教程。可以在它们的文档中找到这三家主要云供应商的指南。许多云供应商提供试用期，免费探索其产品。
- en: Given that Google offers a step-by-step tutorial on AutoML, some introductory
    steps are excluded.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于 Google 提供了有关 AutoML 的逐步教程，某些入门步骤被排除在外。
- en: '[Figure 4-15](#automl_no_code_workflow_for_your_use_ca) shows a high-level
    overview of the AutoML no-code workflow for your business use case.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-15](#automl_no_code_workflow_for_your_use_ca) 展示了用于您业务用例的 AutoML 无代码工作流的高级概述。'
- en: '![AutoML no-code workflow for your use case](assets/lcai_0415.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![自动化机器学习（AutoML）无代码工作流适用于您的用例](assets/lcai_0415.png)'
- en: Figure 4-15\. AutoML no-code workflow for your use case.
  id: totrans-123
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-15\. 自动化机器学习（AutoML）无代码工作流适用于您的用例。
- en: No-Code Using Vertex AI
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 无代码使用 Vertex AI
- en: '[Figure 4-16](#vertex_ai_dashboard_showing_the_enable) shows the Vertex AI
    Dashboard. To create an AutoML model, turn on the Vertex AI API by clicking the
    Enable All Recommended APIs button. From the left-hand navigation menu, scroll
    down from Dashboard and select Datasets.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-16](#vertex_ai_dashboard_showing_the_enable) 显示了 Vertex AI 仪表板。要创建 AutoML
    模型，请点击“启用所有推荐的 API”按钮开启 Vertex AI API。从左侧导航菜单中，从“仪表板”中滚动到“数据集”并选择。'
- en: '![Vertex AI Dashboard showing the Enable All Recommended APIs button](assets/lcai_0416.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![Vertex AI 仪表板显示“启用所有推荐的 API”按钮](assets/lcai_0416.png)'
- en: Figure 4-16\. Vertex AI Dashboard showing the Enable All Recommended APIs button.
  id: totrans-127
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-16\. Vertex AI 仪表板显示“启用所有推荐的 API”按钮。
- en: Create a Managed Dataset in Vertex AI
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Vertex AI 中创建托管数据集
- en: Vertex AI offers different AutoML models depending on data type and the objective
    you want to achieve with your model. When you create a dataset you pick an initial
    objective, but after a dataset is created you can use it to train models with
    different objectives. Keep the default region (us-central1), as shown in [Figure 4-17](#vertex_ai_dataset_navigation_that_allow).
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Vertex AI 根据数据类型和您希望通过模型实现的目标提供不同的 AutoML 模型。创建数据集时，您选择一个初始目标，但创建数据集后，您可以使用它来训练具有不同目标的模型。保持默认区域（us-central1），如
    [图 4-17](#vertex_ai_dataset_navigation_that_allow) 所示。
- en: Select the Create button at the top of the page and then enter a name for the
    dataset. For example, you can name the dataset *advertising_automl*.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在页面顶部选择“创建”按钮，然后为数据集输入名称。例如，您可以将数据集命名为 *advertising_automl*。
- en: '![Vertex AI Dataset navigation that allows you to create a dataset](assets/lcai_0417.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![Vertex AI 允许您创建数据集的数据集导航](assets/lcai_0417.png)'
- en: Figure 4-17\. Vertex AI Dataset navigation that allows you to create a dataset.
  id: totrans-132
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-17\. Vertex AI 允许您创建数据集的数据集导航。
- en: Select the Model Objective
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 选择模型目标
- en: '[Figure 4-18](#regressionsolidusclassification_selec) shows Regression/classification
    selected as the model objective under the Tabular tab. Given that you want to
    predict a target column’s value (sales), this is the appropriate selection.'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-18](#regressionsolidusclassification_selec) 显示选中了回归/分类作为表格选项卡下的模型目标。如果您想要预测目标列（销售）的值，这是合适的选择。'
- en: '![Regression/classification selection for model objective](assets/lcai_0418.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![模型目标的回归/分类选择](assets/lcai_0418.png)'
- en: Figure 4-18\. Regression/classification selection for model objective.
  id: totrans-136
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-18\. 用于模型目标的回归/分类选择。
- en: You selected Regression/classification as your objective. Let’s cover some basic
    concepts to help you with future use cases. *Regression* is a supervised ML process.
    It is similar to classification, but rather than predicting a label for a classification,
    such as classifying spam from your email inbox, you try to predict a continuous
    value. *Linear* regression defines the relationship between a target variable
    (*y*) and a set of predictive features (*x*). If you need to predict a number,
    then use regression. In your use case, linear regression predicts a real value
    (sales) using some independent variables given in the dataset (digital, TV, radio,
    and newspaper).
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 您选择了回归/分类作为您的目标。让我们介绍一些基本概念，以帮助您处理未来的使用案例。*回归* 是一种监督式机器学习过程。它与分类相似，但与预测分类标签（例如从您的电子邮件收件箱分类垃圾邮件）不同，您尝试预测一个连续值。*线性*
    回归定义了目标变量（*y*）与一组预测特征（*x*）之间的关系。如果您需要预测一个数值，那么请使用回归。在您的使用案例中，线性回归使用数据集中提供的一些独立变量（数字、电视、广播和报纸）来预测一个实际值（销售）。
- en: Essentially, linear regression assumes a linear relationship with each feature.
    The predicted values are the data points on the line, and the true values are
    in the scatterplot. The goal is to find the best fitting line so that when new
    data is input the model can predict where the new data point will be in relation
    to the line. The “evaluation” of how good that fit is includes an evaluation criteria—which
    is covered in [“Evaluate Model Performance”](#evaluate_model_performance).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 本质上，线性回归假设与每个特征的线性关系。预测值是线上的数据点，真实值则在散点图中。目标是找到最佳拟合线，以便在输入新数据时，模型可以预测新数据点相对于线的位置。“评估”拟合效果如何好，包括评估标准——这在
    [“评估模型性能”](#evaluate_model_performance) 中有所涵盖。
- en: '[Figure 4-19](#true_and_predicted_values_with_a_best_f) shows a “best-fit”
    line based on your dataset, where the model tries to fit the line to your data
    points, which are the dark scatters.'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-19](#true_and_predicted_values_with_a_best_f) 显示了基于您的数据集的“最佳拟合”线，其中模型尝试将线拟合到您的数据点（即深色散点）。'
- en: '![True and predicted values with a best-fitted line](assets/lcai_0419.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![真实值和预测值及最佳拟合线](assets/lcai_0419.png)'
- en: Figure 4-19\. True and predicted values with a best-fitted line.
  id: totrans-141
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-19\. 真实值和预测值及最佳拟合线。
- en: After making the Regression/classification selection, scroll down and click
    the Create button. You are now ready to add data to your dataset. Vertex AI–managed
    datasets are available for a variety of data types, including tabular, image,
    text, and video data.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行回归/分类选择后，向下滚动并点击“创建”按钮。现在您可以向数据集添加数据了。Vertex AI 管理的数据集适用于各种数据类型，包括表格、图像、文本和视频数据。
- en: '[Figure 4-20](#data_source_upload_options_for_your_dat) shows the data source
    upload options—upload CSV from your computer, select CSV files from Cloud Storage,
    or select a table or view from BigQuery (Google’s data warehouse).'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-20](#data_source_upload_options_for_your_dat) 展示了数据源上传选项——从计算机上传 CSV，从云存储选择
    CSV 文件，或从 BigQuery（Google 的数据仓库）选择表或视图。'
- en: '![Data source upload options for your dataset file](assets/lcai_0420.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![数据集文件的数据源上传选项](assets/lcai_0420.png)'
- en: Figure 4-20\. Data source upload options for your dataset file.
  id: totrans-145
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-20\. 数据集文件的数据源上传选项。
- en: To upload your advertising dataset, select “Upload CSV files from your computer.”
    Find the file on your local computer and load it.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 要上传您的广告数据集，请选择“从计算机上传 CSV 文件”。找到本地计算机上的文件并加载它。
- en: 'Scroll down the page and review the Select a Cloud Storage Path section, which
    requires that you store the file in a cloud storage bucket. Why do you need to
    store the file in a cloud storage bucket? Two reasons: (1) when training a large-scale
    ML model, you may need to store terabytes or even petabytes of data; and (2) cloud
    storage buckets are scalable, reliable, and secure.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 向下滚动页面并查看“选择云存储路径”部分，要求您将文件存储在云存储桶中。为什么需要将文件存储在云存储桶中？有两个原因：（1）当训练大规模 ML 模型时，您可能需要存储数千兆字节甚至数百个千兆字节的数据；（2）云存储桶可扩展、可靠且安全。
- en: '[Figure 4-21](#data_source_options_to_load_a_csv_file) shows that the file
    *Advertising_automl.csv* has been uploaded and a cloud storage bucket has been
    created to store the uploaded file. To see the step-by-step process of creating
    the storage bucket and the entire exercise, see the PDF entitled *Chapter 4 AutoML
    Sales Prediction* in the [repository](https://oreil.ly/supp-lcai).'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-21](#data_source_options_to_load_a_csv_file) 显示 *Advertising_automl.csv*
    文件已上传，并创建了一个云存储桶以存储上传的文件。要查看创建存储桶及整个操作的逐步过程，请参阅名为 *Chapter 4 AutoML Sales Prediction*
    的 PDF 文件，位于 [repository](https://oreil.ly/supp-lcai) 中。'
- en: '![Data source options to load a CSV file and store it in a cloud storage bucket](assets/lcai_0421.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![数据源选项，用于加载 CSV 文件并将其存储在云存储桶中](assets/lcai_0421.png)'
- en: Figure 4-21\. Data source options to load a CSV file and store it in a cloud
    storage bucket.
  id: totrans-150
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-21\. 数据源选项，用于加载 CSV 文件并将其存储在云存储桶中。
- en: Some frameworks will generate statistics after the data loads. Other frameworks
    help minimize the need to manually clean data by automatically detecting and cleaning
    missing values, anomalous values, and duplicate rows and columns. Note that there
    are a few additional steps that you can employ, such as to review the data after
    it has loaded to check for missing values and view data statistics.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 一些框架在数据加载后会生成统计信息。其他框架则通过自动检测和清理缺失值、异常值和重复行列来帮助减少手动数据清理的需求。请注意，您可以采用一些额外步骤，例如在加载后检查缺失值和查看数据统计。
- en: '[Figure 4-22](#the_output_of_the_generate_statistics_w) shows the output of
    the Generate Statistics window. Note there are no missing values and the number
    of distinct values for each column is shown.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-22](#the_output_of_the_generate_statistics_w) 展示了生成统计窗口的输出。请注意，这里没有缺失值，并显示了每列的不同值数量。'
- en: '![The output of the Generate Statistics window](assets/lcai_0422.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![生成统计窗口的输出](assets/lcai_0422.png)'
- en: Figure 4-22\. The output of the Generate Statistics window.
  id: totrans-154
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-22\. 生成统计窗口的输出。
- en: AutoML presents a data profile of each feature. To analyze a feature, click
    the name of the feature. A page shows the feature distribution histograms for
    that feature.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: AutoML 会为每个特征展示数据概要。要分析特征，请点击特征的名称。页面将显示该特征的特征分布直方图。
- en: '[Figure 4-23](#feature_profile_for_sales) shows the data profile for sales.
    Note that the mean is 14.014, which is very close to the numeric value you received
    when you typed in the `advertis⁠ing_​df.describe()` code earlier in the chapter
    as you were exploring the dataset.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-23](#销售特征概况)显示了销售的数据概况。请注意，均值为14.014，这与您在探索数据集时键入`advertis⁠ing_​df.describe()`代码获得的数字值非常接近。'
- en: '![Feature profile for sales](assets/lcai_0423.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![销售特征概况](assets/lcai_0423.png)'
- en: Figure 4-23\. Feature profile for sales.
  id: totrans-158
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 4-23\. 销售特征概况。
- en: Build the Training Model
  id: totrans-159
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建训练模型
- en: '[Figure 4-24](#model_now_ready_for_training) shows that the model is now ready
    to train. Select Train New Model under the “Training jobs and models” section.
    Select Other and not AutoML on Pipelines. AutoML on Pipelines is a feature that
    allows you to specify the type of ML model you want to build and other parameters.
    It is beyond the scope of the book.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-24](#现在模型已准备好训练)显示模型现已准备好训练。在“培训作业和模型”部分选择“训练新模型”。选择其他而非管道上的AutoML。AutoML
    on Pipelines是一种功能，允许您指定要构建的ML模型类型和其他参数。这超出了本书的范围。'
- en: '![Model now ready for training](assets/lcai_0424.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![现在模型已准备好训练](assets/lcai_0424.png)'
- en: Figure 4-24\. Model now ready for training.
  id: totrans-162
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 4-24\. 现在模型已准备好训练。
- en: 'The “Train new model” window appears. There are four steps:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: “训练新模型”窗口显示。有四个步骤：
- en: Select the training method
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择培训方法
- en: Configure model details
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置模型详细信息
- en: Determine training options
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定训练选项
- en: Select compute and pricing
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择计算和定价
- en: In Step 1, under the Objective, select the drop-down and choose Regression.
    Under “Model training method,” select AutoML (as shown in [Figure 4-25](#configure_the_training_method_in_step_o)).
    Click Continue.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一步中，在目标下拉菜单中选择回归。在“模型培训方法”下选择AutoML（如[图 4-25](#在第一步中配置培训方法)所示）。点击继续。
- en: '![Configure the training method in Step 1](assets/lcai_0425.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![在第一步中配置培训方法](assets/lcai_0425.png)'
- en: Figure 4-25\. Configure the training method in Step 1.
  id: totrans-170
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 4-25\. 在第一步中配置培训方法。
- en: In Step 2, under “Model details,” name your model and give it a description.
    Under “Target column,” select sales from the drop-down (as shown in [Figure 4-26](#add_model_details_in_step_two)).
    Click Continue.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二步中，在“模型详细信息”下，为您的模型命名并给出描述。在“目标列”下拉菜单中选择销售（如[图 4-26](#在第二步中添加模型详细信息)所示）。点击继续。
- en: '![Add model details in Step 2](assets/lcai_0426.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![在第二步中添加模型详细信息](assets/lcai_0426.png)'
- en: Figure 4-26\. Add model details in Step 2.
  id: totrans-173
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 4-26\. 在第二步中添加模型详细信息。
- en: In Step 3, review the training options. Note that any data transformations (or
    data processing) such as standardization are handled automatically (as shown in
    [Figure 4-27](#add_training_options_in_step_three)). Click Continue.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在第三步中，审查培训选项。请注意，任何数据转换（或数据处理）如标准化都将自动处理（如[图 4-27](#在第三步中添加培训选项)所示）。点击继续。
- en: '![Add training options in Step 3](assets/lcai_0427.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![在第三步中添加培训选项](assets/lcai_0427.png)'
- en: Figure 4-27\. Add training options in Step 3.
  id: totrans-176
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 4-27\. 在第三步中添加培训选项。
- en: In Step 4, you see [“Compute and pricing”](https://oreil.ly/x8C3f) (as shown
    in [Figure 4-28](#train_new_model_in_step_four)). The time required to train your
    model depends on the size and complexity of your training data. A *node hour*
    is one hour’s usage of one node (think virtual machine) in the cloud, spread across
    all nodes. Enter the value **`3`** in the Budget field for maximum number of node
    hours—this is just an estimate. You pay only for compute hours used; if training
    fails for any reason other than a user-initiated cancellation, you are not billed
    for the time. You are charged for training time if you cancel the operation.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在第四步中，您将看到[“计算和定价”](https://oreil.ly/x8C3f)（如[图 4-28](#在第四步中训练新模型)所示）。训练模型所需的时间取决于训练数据的大小和复杂性。一个*节点小时*是云中一个节点（如虚拟机）的使用时间，分布在所有节点上。在预算字段中输入**`3`**，以获取最大节点小时数—这仅是一个估计值。您只需支付使用的计算小时数；如果训练由于用户未启动的取消以外的任何原因而失败，则不会计费。如果取消操作，您将支付培训时间费用。
- en: '![Train new model in Step 4](assets/lcai_0428.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![在第四步中训练新模型](assets/lcai_0428.png)'
- en: Figure 4-28\. Select compute and pricing in Step 4.
  id: totrans-179
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 4-28\. 在第四步中选择计算和定价。
- en: Also under “Compute and pricing” is early stopping. When you enable this option,
    this means that training will end when AutoML determines that no more model improvements
    can be made. If you disable early stopping, AutoML will train the model until
    the budget hours are exhausted.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在“计算和定价”下还有“提前停止”。启用此选项表示，当AutoML确定无法再改进模型时，训练将结束。如果禁用提前停止，则AutoML将训练模型直到耗尽预算小时数。
- en: Once all the parameters are entered, you start the training job. Click Start
    Training.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 输入所有参数后，您可以启动训练作业。单击开始训练。
- en: After model training, the model is registered in the model registry (as shown
    in [Figure 4-29](#advertising_automl_model_showing_in_mod)).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在模型训练完成后，模型将注册到模型注册表中（如[图4-29](#advertising_automl_model_showing_in_mod)所示）。
- en: '![Advertising_automl model showing in model registry](assets/lcai_0429.png)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![Advertising_automl模型显示在模型注册中](assets/lcai_0429.png)'
- en: Figure 4-29\. Advertising_automl model showing in model registry.
  id: totrans-184
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-29\. Advertising_automl模型显示在模型注册中。
- en: Note
  id: totrans-185
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: As previously mentioned, training can take up to several hours, depending on
    the size of your data and type of model objective you choose. Image and video
    data types may take much longer to process than a structured data type such as
    a CSV file. The number of training samples also impacts training time.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，培训可能需要数小时，具体取决于您的数据大小和选择的模型目标类型。图像和视频数据类型的处理时间可能比CSV文件等结构化数据类型长得多。培训样本的数量也会影响培训时间。
- en: Also, AutoML is time intensive. AutoML algorithms need to train a variety of
    models, and this training process can be computationally expensive. This is because
    AutoML algorithms typically try a large number of different models and hyperparameters,
    and each model needs to be trained on the entire dataset. AutoML algorithms then
    need to select the best model from the set of trained models, and this selection
    process can also be time-consuming. This is because AutoML algorithms typically
    need to evaluate the performance of each model on a holdout dataset, and this
    evaluation process can be computationally expensive.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，AutoML非常耗时。AutoML算法需要训练各种模型，而这一训练过程可能计算量很大。这是因为AutoML算法通常尝试大量不同的模型和超参数，并且每个模型都需要在整个数据集上进行训练。然后，AutoML算法需要从训练好的模型集中选择最佳模型，而这一选择过程也可能非常耗时。这是因为AutoML算法通常需要评估每个模型在保留数据集上的性能，而这一评估过程可能计算量很大。
- en: Evaluate Model Performance
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 评估模型性能
- en: '[Figure 4-30](#model_training_results_with_five_evalua) shows the model training
    results.'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '[图4-30](#model_training_results_with_five_evalua)显示了模型训练结果。'
- en: '![Model training results with five evaluation metrics](assets/lcai_0430.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![使用五个评估指标的模型训练结果](assets/lcai_0430.png)'
- en: Figure 4-30\. Model training results with five evaluation metrics.
  id: totrans-191
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-30\. 使用五个评估指标的模型训练结果。
- en: 'There are a few factors that a practitioner should consider when weighing the
    importance of different linear regression evaluation metrics:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 当从业者权衡不同线性回归评估指标的重要性时，有几个因素需要考虑：
- en: The purpose of the model
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的目的
- en: The purpose of the model will determine which evaluation metrics are most important.
    For example, if the model is being used to make predictions, then the practitioner
    may want to focus on metrics such as mean squared error (MSE) or root mean squared
    error (RMSE). However, if the model is being used to understand the relationship
    between variables, then the practitioner may want to focus on metrics such as
    R-squared or adjusted R-squared.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的目的将决定哪些评估指标最重要。例如，如果模型用于进行预测，那么从业者可能希望关注诸如均方误差（MSE）或根均方误差（RMSE）等指标。然而，如果模型用于理解变量之间的关系，那么从业者可能希望关注R平方或调整后的R平方等指标。
- en: The characteristics of the data
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 数据的特征
- en: The characteristics of the data will also affect the importance of different
    evaluation metrics. For example, if the data is noisy (e.g., contains unwanted
    information or errors), then the practitioner may want to focus on metrics that
    are robust to noise, such as mean absolute error (MAE). However, if the data is
    not noisy, then the practitioner may be able to focus on metrics that are more
    sensitive to changes in the model, such as MSE.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 数据的特征也会影响不同评估指标的重要性。例如，如果数据存在噪声（例如包含不需要的信息或错误），那么从业者可能希望关注对噪声鲁棒的指标，如平均绝对误差（MAE）。然而，如果数据没有噪声，那么从业者可能能够关注更加敏感于模型变化的指标，如MSE。
- en: The practitioner’s preferences
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 从业者的偏好
- en: Ultimately, the practitioner’s preferences will also play a role in determining
    the importance of different evaluation metrics. Some practitioners may prefer
    metrics that are easy to understand, while others may prefer metrics that are
    more accurate. There is no right or wrong answer, and the practitioner should
    choose the metrics that are most important to them.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，实践者的偏好也会影响确定不同评估指标的重要性。一些实践者可能更喜欢易于理解的指标，而其他人可能更喜欢更准确的指标。没有对与错的答案，实践者应选择对他们最重要的指标。
- en: 'Here are common linear regression evaluation metrics:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是常见的线性回归评估指标：
- en: R-squared
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: R 平方
- en: R-squared is a measure of how well the model fits the data. It is the square
    of the Pearson correlation coefficient between the observed and predicted values.
    It is calculated by dividing the sum of squared residuals (the difference between
    the predicted and the actual values) by the total sum of squares. A higher R-squared
    value indicates a better fit. R-squared ranges from 0 to 1, where a higher value
    indicates a higher-quality model. Your R² should be around 0.997.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: R 平方是衡量模型与数据拟合程度的指标。它是观察值和预测值之间的皮尔逊相关系数的平方。它通过将平方残差（预测值与实际值之间的差异）除以总平方和来计算。较高的
    R 平方值表示拟合效果更好。R 平方范围从 0 到 1，较高的值表示模型质量更高。你的 R² 应该在约 0.997 左右。
- en: Adjusted R-squared
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 调整后的 R 平方
- en: Adjusted R-squared is a modified version of R-squared that takes into account
    the number of independent variables in the model. It is calculated by dividing
    the sum of squared residuals by the total sum of squares minus the degrees of
    freedom. A higher adjusted R-squared value indicates a better fit, but it is less
    sensitive to the number of independent variables than R-squared.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 调整后的 R 平方是 R 平方的修改版本，考虑了模型中独立变量的数量。它通过将平方残差之和除以总平方和减去自由度来计算。较高的调整后 R 平方值表示拟合效果更好，但对独立变量的数量不太敏感，与
    R 平方相比。
- en: Mean squared error (MSE)
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 均方误差 (MSE)
- en: MSE is a measure of the average squared error between the predicted values and
    the actual values. A lower MSE value indicates a better fit. [Figure 4-31](#loss_formula_for_rmse_of_true_and_predi)
    shows the loss visualized in a table and graph.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: MSE 是预测值与实际值之间平均平方误差的度量。较低的 MSE 值表示拟合效果更好。[图 4-31](#loss_formula_for_rmse_of_true_and_predi)
    显示了表格和图表中可视化的损失。
- en: '![Loss formula for RMSE of true and predicted values](assets/lcai_0431.png)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![RMSE 真实值和预测值的损失公式](assets/lcai_0431.png)'
- en: Figure 4-31\. Loss formula for RMSE of true and predicted values.
  id: totrans-207
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-31\. RMSE 真实值和预测值的损失公式。
- en: Root mean squared error (RMSE)
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 均方根误差 (RMSE)
- en: RMSE is the square root of MSE. It is a more interpretable version of MSE. A
    lower RMSE value indicates a better fit and a higher-quality model, where 0 means
    the model made no errors. Interpreting RMSE depends on the range of values in
    the series. Your RMSE should be around 0.345.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: RMSE 是 MSE 的平方根。它是 MSE 的更易解释版本。较低的 RMSE 值表示拟合效果更好和模型质量更高，其中 0 表示模型没有误差。解释 RMSE
    取决于系列值的范围。你的 RMSE 应该在约 0.345 左右。
- en: Root mean squared log error (RMSLE)
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 均方根对数误差 (RMSLE)
- en: Interpreting RMSLE depends on the range of values in the series. RMSLE is less
    responsive to outliers than RMSE, and it tends to penalize underestimations slightly
    more than overestimations. Your RMSLE should be around 0.026.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 解释 RMSLE 取决于系列值的范围。RMSLE 对异常值的响应较小，比 RMSE 更加严厉地惩罚低估。你的 RMSLE 应该在约 0.026 左右。
- en: Mean absolute error (MAE)
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 平均绝对误差 (MAE)
- en: MAE is a measure of the average absolute error between the predicted values
    and the actual values. A lower MAE value indicates a better fit. Your MAE should
    be around 0.304.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: MAE 是预测值与实际值之间平均绝对误差的度量。较低的 MAE 值表示拟合效果更好。你的 MAE 应该在约 0.304 左右。
- en: Mean absolute percentage error (MAPE)
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 平均绝对百分比误差 (MAPE)
- en: MAPE ranges from 0% to 100%, where a lower value indicates a higher-quality
    model. MAPE is the average of absolute percentage errors. Your MAPE should be
    around 2.28.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: MAPE 范围从 0% 到 100%，较低的值表示模型质量更高。MAPE 是绝对百分比误差的平均值。你的 MAPE 应该在约 2.28 左右。
- en: Model Feature Importance (Attribution)
  id: totrans-216
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型特征重要性（归因）
- en: Model  feature importance tells you how much each feature impacted model training.
    [Figure 4-32](#advertising_dataset_feature_importance) shows attribution values
    expressed as a percentage; the higher the percentage, the more strongly the correlation—that
    is, the more strongly that feature impacted model training. Feature attribution
    allows you to see which features contributed most strongly to the resulting model
    training shown in [Figure 4-32](#advertising_dataset_feature_importance).
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 模型特征重要性告诉您每个特征对模型训练的影响程度。[图 4-32](#advertising_dataset_feature_importance)显示的归因值以百分比表示；百分比越高，相关性越强—即该特征对模型训练的影响越大。特征归因允许您看到哪些特征对于[图 4-32](#advertising_dataset_feature_importance)中显示的模型训练结果贡献最大。
- en: '![Advertising dataset feature importance results](assets/lcai_0432.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![广告数据集特征重要性结果](assets/lcai_0432.png)'
- en: Figure 4-32\. Advertising dataset feature importance results.
  id: totrans-219
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-32\. 广告数据集特征重要性结果。
- en: If you were to hover over the newspaper feature shown in [Figure 4-32](#advertising_dataset_feature_importance),
    you would see that its contribution to model training is 0.2%. This supports what
    you discovered during the EDA phase you completed earlier—the relationship between
    sales and newspaper advertising spend is the weakest. These results mean that
    advertising on *radio*, *digital*, and *TV* contribute the most in *sales*, and
    *newspaper* advertisements have little effect on *sales*.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您将鼠标悬停在[图 4-32](#advertising_dataset_feature_importance)中显示的报纸特征上，您会发现其对模型训练的贡献率为
    0.2%。这支持您在之前完成的探索数据分析阶段中发现的结论—即销售额与报纸广告支出之间的关系最弱。这些结果意味着广播、数字和电视广告对销售额的贡献最大，而报纸广告对销售额影响较小。
- en: Get Predictions from Your Model
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从您的模型获取预测。
- en: To deploy your model, you will need to test it. You can deploy to your environment
    to test your model without building an application you would need to deploy to
    the cloud. After you train an ML model, you need to deploy the model so that others
    can use it to do inferencing. Inferencing in machine learning is the process of
    using a trained ML model to make predictions on new data.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 部署模型时，您需要对其进行测试。您可以部署到您的环境中测试您的模型，而无需构建一个需要部署到云中的应用程序。训练完机器学习模型后，您需要部署该模型，以便其他人可以用它进行推理。在机器学习中，推理是使用训练好的模型对新数据进行预测的过程。
- en: 'There are four steps, but for this chapter you’ll only need the first two.
    For this exercise, it is not necessary to configure model monitoring or model
    objectives. Model monitoring adds an additional charge for logging, while model
    objectives require you to choose from a variety of model objectives, depending
    on the type of model you are training and the application you are using it for.
    Here are the four steps:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 有四个步骤，但对于本章节，您只需要前两步。在这个练习中，不需要配置模型监控或模型目标。模型监控会额外收费以记录日志，而模型目标要求您根据训练的模型类型和使用的应用程序选择各种模型目标。以下是四个步骤：
- en: Define your endpoint.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您的端点。
- en: Configure model settings.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置模型设置。
- en: Configure model monitoring.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置模型监控。
- en: Configure model objectives.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置模型目标。
- en: Note
  id: totrans-228
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: What are endpoints and deployments? In ML, an *endpoint* is a service that exposes
    a model for online prediction. A *deployment* is the process of making a model
    available as an endpoint. An endpoint is an HTTPS path that provides an interface
    for clients to send requests (input data) and receive the inferencing (scoring)
    output of a trained model. Endpoints are typically used to make predictions in
    real time. For example, you could use an endpoint to predict the likelihood of
    a customer clicking on an ad or the risk of a loan defaulting.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是端点和部署？在机器学习中，*端点* 是为在线预测公开模型的服务。*部署* 是使模型作为端点可用的过程。端点是提供接口供客户端发送请求（输入数据）并接收训练后模型的推理（评分）输出的
    HTTPS 路径。端点通常用于实时预测。例如，您可以使用端点预测客户点击广告的可能性或贷款违约风险。
- en: Deployments are typically used to make a model available to a larger audience.
    For example, you could deploy a model to a production environment so that it can
    be used by your customers or employees.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 部署通常用于将模型提供给更广泛的受众。例如，您可以将模型部署到生产环境中，以便客户或员工使用。
- en: '[Figure 4-33](#deploy_your_model_to_an_endpoint_page) shows the deploy and
    test page. To deploy your model, go to Model Registry, select Deploy and Test,
    and select your model.'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-33](#deploy_your_model_to_an_endpoint_page)显示了部署和测试页面。要部署您的模型，请转到模型注册表，选择部署和测试，然后选择您的模型。'
- en: '![Deploy your model to an endpoint page](assets/lcai_0433.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![将您的模型部署到端点页面](assets/lcai_0433.png)'
- en: Figure 4-33\. Deploy your model to an endpoint page.
  id: totrans-233
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-33. 将您的模型部署到端点页面。
- en: In Step 1, you define your endpoint. You select a region and determine how your
    endpoint will be accessed.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 在第1步中，您定义您的端点。您选择一个区域，并确定如何访问您的端点。
- en: 'In Step 2, you add the model and add traffic split. A *traffic split* in Vertex
    AI is a way to distribute traffic between multiple models that are deployed to
    the same endpoint. This can be useful for a variety of purposes, such as:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在第2步中，您添加模型并添加交通分流。在Vertex AI中，*traffic split*是一种将流量分配给部署到同一端点的多个模型的方法。这可以用于各种目的，例如：
- en: A/B testing
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: A/B 测试
- en: Traffic splitting can be used to A/B test different models to see which one
    performs better.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 交通分流可用于A/B测试不同的模型，以查看哪个性能更好。
- en: Canary deployments
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 金丝雀部署
- en: Traffic splitting can be used to deploy a new model to a small percentage of
    users before deploying it to a larger audience. This can help to catch any problems
    with the new model before they affect too many users.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 交通分流可用于先向少数用户部署新模型，然后再向更大的受众部署。这可以帮助在新模型影响太多用户之前捕获任何问题。
- en: Rollouts
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 推出
- en: Traffic splitting can be used to roll out a new model to users gradually. This
    can help to mitigate the impact of any problems with the new model.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 交通分流可用于逐步向用户推出新模型。这可以帮助减轻新模型可能带来的任何问题的影响。
- en: In Step 3, you choose how compute resources will serve the predictions to your
    model (shown in [Figure 4-34](#select_compute_resources_to_train_the_m)). For
    this exercise, use the minimum number of compute nodes (virtual machine servers).
    Under “Machine type,” select Standard.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 在第3步中，您选择如何将计算资源提供给您的模型的预测（如[图4-34](#select_compute_resources_to_train_the_m)所示）。对于此练习，使用最少数量的计算节点（虚拟机服务器）。在“机器类型”下，选择标准。
- en: '![Select compute resources to train the model](assets/lcai_0434.png)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![选择计算资源来训练模型](assets/lcai_0434.png)'
- en: Figure 4-34\. Select compute resources to train the model.
  id: totrans-244
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-34. 选择计算资源来训练模型。
- en: 'Note: “Machine types” differ in a few ways: (1) number of virtual central processing
    units (vCPUs) per node, (2) amount of memory per node, and (3) [pricing](https://oreil.ly/x8C3f).'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：“机器类型”在几个方面有所不同：（1）每个节点的虚拟中央处理单元（vCPU）数量，（2）每个节点的内存量，以及（3）[定价](https://oreil.ly/x8C3f)。
- en: 'There are a few factors to consider when choosing compute resources for a prediction
    model:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择预测模型的计算资源时需要考虑几个因素：
- en: Size and complexity of the model
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的大小和复杂性
- en: The larger and more complex the model, the more compute resources it will need.
    (This is more applicable to custom coding neural networks.)
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 模型越大越复杂，就需要更多的计算资源。（这更适用于定制编码的神经网络。）
- en: Number of predictions that will be made
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 将要进行的预测数量
- en: If you expect to make a large number of predictions, you will need to choose
    a compute resource that can handle the load.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您预计要进行大量预测，您需要选择一个能够处理负载的计算资源。
- en: Latency requirements
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 延迟要求
- en: 'If you need to make predictions in real time or with very low latency, you
    will need to choose a compute resource that can provide the necessary performance.
    Note: low latency in machine learning refers to the time it takes for an ML model
    to make a prediction once it receives a new data point.'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要实时或非常低延迟地进行预测，您需要选择一个可以提供必要性能的计算资源。注意：机器学习中的低延迟指的是ML模型在接收到新数据点后进行预测所需的时间。
- en: Cost
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 成本
- en: Compute resources can vary in price, so you will need to choose one that fits
    your budget.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 计算资源的价格可能有所不同，因此您需要选择一个符合预算的资源。
- en: 'Once you have considered these factors, you can start to narrow down your choices.
    Here are a few examples of compute resources that can be used to serve prediction
    models:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您考虑了这些因素，您可以开始缩小选择范围。以下是可以用来提供预测模型的几个计算资源示例：
- en: CPUs
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: CPU
- en: Central processing units (CPUs) are the most common type of compute resource
    and are a good choice for models that are not too large or complex.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 中央处理单元（CPU）是最常见的计算资源类型，适合那些不太大或复杂的模型。
- en: GPUs
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: GPU
- en: Graphics processing units (GPUs) are more powerful than CPUs and can be used
    to speed up the training and inference of large and complex models.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 图形处理单元（GPU）比CPU更强大，可用于加速大型复杂模型的训练和推理。
- en: TPUs
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: TPU
- en: Tensor processing units (TPUs) are specialized hardware accelerators that are
    designed for ML workloads. They are the most powerful option and can be used to
    train and serve the most demanding models.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 张量处理单元（TPUs）是专门为机器学习工作负载设计的硬件加速器。它们是最强大的选项，可以用于训练和服务最苛刻的模型。
- en: As part of Step 2 under “Model settings,” there is a Logging setting. If you
    enable endpoint logging, charges will apply. Thus, for this exercise, please do
    not enable it.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 作为“模型设置”下的第二步，有一个日志设置。如果启用端点日志记录，将会产生费用。因此，请在此练习中不要启用它。
- en: The next setting is Explainability options, which do not carry a charge. Check
    “Enable feature attributions for this model.”
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是可解释性选项，不会产生费用。选中“为此模型启用特征归因”。
- en: Step 3 is “Model monitoring.” Do not enable it for this project (as shown in
    [Figure 4-35](#quotation_markmodel_monitoringquotation)).
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤 3 是“模型监控”。请不要为这个项目启用它（如图 [图 4-35](#quotation_markmodel_monitoringquotation)
    所示）。
- en: '![“Model monitoring” configuration window](assets/lcai_0435.png)'
  id: totrans-265
  prefs: []
  type: TYPE_IMG
  zh: '![“模型监控”配置窗口](assets/lcai_0435.png)'
- en: Figure 4-35\. “Model monitoring” configuration window.
  id: totrans-266
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-35\. “模型监控”配置窗口。
- en: Now that all configurations are made, the Deploy button should be highlighted.
    Click Deploy to deploy your model to the endpoint (as shown in [Figure 4-36](#deploy_to_the_endpoint)).
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 现在所有配置都已完成，部署按钮应该已突出显示。点击部署将您的模型部署到端点（如图 [图 4-36](#deploy_to_the_endpoint) 所示）。
- en: '![Deploy to the endpoint](assets/lcai_0436.png)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![部署到端点](assets/lcai_0436.png)'
- en: Figure 4-36\. Deploy to the endpoint.
  id: totrans-269
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-36\. 部署到端点。
- en: 'After the endpoint is created and the model deployed to the endpoint, you should
    receive an email regarding the endpoint deployment status. If deployment was successful,
    you can start making predictions. There are four steps:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 在端点创建并将模型部署到端点后，您应该会收到有关端点部署状态的电子邮件。如果部署成功，您就可以开始进行预测。有四个步骤：
- en: Go to Model Registry.
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到模型注册表。
- en: Select your model.
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您的模型。
- en: Select the model’s version.
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择模型的版本。
- en: Scroll down until you see the “Test your model” page.
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动直到看到“测试您的模型”页面。
- en: '[Figure 4-37](#testing_page_for_online_predictions) shows the “Test your model”
    page. Note, this page could be an app or web page that looks like this—where you
    and your team input media channel values and predict sales volume.'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-37](#testing_page_for_online_predictions) 显示了“测试您的模型”页面。请注意，此页面可能是一个应用程序或网页，看起来像这样——您和您的团队输入媒体渠道值并预测销售量。'
- en: Click the Predict button.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 点击预测按钮。
- en: '![Testing page for online predictions](assets/lcai_0437.png)'
  id: totrans-277
  prefs: []
  type: TYPE_IMG
  zh: '![在线预测的测试页面](assets/lcai_0437.png)'
- en: Figure 4-37\. Testing page for online predictions.
  id: totrans-278
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-37\. 在线预测的测试页面。
- en: After clicking the Predict button, you will get a prediction for your label
    (sales), as shown in [Figure 4-38](#prediction_of_sales_volume_based_on_ini).
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 点击预测按钮后，您将得到一个关于您的标签（销售）的预测，如 [图 4-38](#prediction_of_sales_volume_based_on_ini)
    所示。
- en: '![Prediction of sales volume based on initial values](assets/lcai_0438.png)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
  zh: '![基于初始值的销售量预测](assets/lcai_0438.png)'
- en: Figure 4-38\. Prediction of sales volume based on initial values.
  id: totrans-281
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-38\. 基于初始值的销售量预测。
- en: Regression models return a prediction value. [Figure 4-38](#prediction_of_sales_volume_based_on_ini)
    shows a sales prediction result value of 14.63—which is very close to the mean
    from the sales histogram (shown in Figures [4-10](#sales_histogram_that_is_slightly_skewed)
    and [4-23](#feature_profile_for_sales)). The prediction interval provides a range
    of values that the model has 95% confidence to contain the actual result. So,
    since the sales prediction result is 14.63, and the prediction interval is a range
    between 13.58 and 15.53, you can be 95% certain that any prediction result will
    fall within this range.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 回归模型返回一个预测值。[图 4-38](#prediction_of_sales_volume_based_on_ini) 显示了一个销售预测结果值为
    14.63，这非常接近销售直方图中的均值（在图 [4-10](#sales_histogram_that_is_slightly_skewed) 和 [4-23](#feature_profile_for_sales)
    中显示）。预测区间提供了一个值范围，模型有 95% 的置信度包含实际结果。因此，由于销售预测结果为 14.63，而预测区间是从 13.58 到 15.53
    的范围，您可以有 95% 的把握认为任何预测结果都会落在这个范围内。
- en: Now, let’s answer those business questions.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们回答这些业务问题。
- en: The goal was to build an ML model to predict how much sales volume will be generated
    based on the money spent in each of the media channels.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是构建一个机器学习模型，根据在各种媒体渠道上的支出来预测销售量。
- en: Can the model predict how much sales volume will be generated based on the money
    spent in each media channel?
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 模型能预测基于每个媒体渠道的支出会产生多少销售量吗？
- en: Yes. Since Vertex AI allows you to input values for each media channel, you
    can now make decisions about future budget allocation. For example, your company’s
    strategic media plan may now include increasing the digital channel budget based
    upon the results obtained from a prediction.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 是的。由于Vertex AI允许您为每个媒体渠道输入值，因此您现在可以根据预测结果做出未来预算分配的决策。例如，您公司的战略媒体计划现在可以根据预测结果增加数字渠道的预算。
- en: Is there a relationship between advertising spend and sales?
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 广告支出与销售之间是否存在关系？
- en: Yes. There is a positive linear relationship between advertising spend and sales
    for digital, TV, and radio. Newspaper spend has a weak relationship to sales.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 是的。数字、电视和广播的广告支出与销售之间存在正线性关系。报纸支出与销售之间关系较弱。
- en: Which media channel contributes the most to sales?
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 媒体渠道对销售贡献最大的是哪个？
- en: TV contributes more to sales than the other media channels. How? The scatterplot
    you built during the EDA section, and your review of the Vertex AI feature’s attribution
    bar chart after the model was trained, show the contribution of TV to sales.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 电视对销售的贡献大于其他媒体渠道。如何？您在EDA部分构建的散点图以及模型训练后查看的Vertex AI特征归因条形图显示了电视对销售的贡献。
- en: How accurately can the model predict future sales?
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 模型能够准确预测未来销售吗？
- en: The regression model returns a prediction value when media channel values are
    input into the Predict window to predict sales volume. The prediction results
    showed a sales prediction value and prediction interval. Prediction intervals
    can be used to make decisions about future observations, so you can be 95% certain
    that any future sales prediction result will fall within that range.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 当将媒体渠道值输入“预测”窗口以预测销售量时，回归模型将返回一个预测值。预测结果显示了销售预测值和预测区间。预测区间可以用来对未来观察做出决策，因此您可以确信，未来任何销售预测结果都将在该范围内。
- en: Warning
  id: totrans-293
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: Do not forget to *undeploy* your model once you are finished with this chapter.
    Deployed models incur cost even when they are not being used so that they are
    always available to return quick predictions. To undeploy the model, go to Vertex
    AI Endpoints, click the endpoint name, then click the “More actions” three-dot
    menu, and finally click “Undeploy model from endpoint.”
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本章后，请不要忘记*取消部署*模型。即使未使用，部署的模型也会产生成本，以便随时提供快速预测。要取消部署模型，请转到 Vertex AI Endpoints，点击端点名称，然后点击“更多操作”三个点的菜单，最后点击“从端点取消部署模型”。
- en: Summary
  id: totrans-295
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, you built an AutoML model to predict advertising media channel
    sales. You explored your data using Pandas, creating heat maps, scatterplots,
    and histograms. After you exported the data file, you uploaded it into Google’s
    Vertex AI framework. Then you learned how to use Google Cloud’s AutoML to build,
    train, and deploy an ML model to predict sales. You gained an overall understanding
    of the performance of your model using performance metrics and answered common
    business questions. You used the model to make online predictions and do a bit
    of budget forecasting. You are now ready to present to your team!
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您构建了一个AutoML模型来预测广告媒体渠道的销售情况。您使用Pandas探索了数据，创建了热力图、散点图和直方图。在导出数据文件后，您将其上传到Google的Vertex
    AI框架中。然后，您学习了如何使用Google Cloud的AutoML构建、训练和部署ML模型来预测销售。您通过性能指标全面了解了模型的性能，并回答了常见的业务问题。您使用模型进行了在线预测和一些预算预测。现在您已经准备好向您的团队展示了！
