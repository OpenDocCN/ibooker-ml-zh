- en: Chapter 2\. User-Item Ratings and Framing the Problem
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2章 用户-物品评分及问题的构建
- en: If you were asked to curate the selection for a cheese plate at a local café,
    you might start with your favorites. You might also spend a bit of time asking
    for your friends’ favorites. Before you order a large stock in these cheeses for
    the café, you would probably want to run a small experiment—maybe asking a group
    of friends to taste your selections and tell you their preferences.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你被要求为当地咖啡馆的奶酪拼盘进行策划，你可能会从你的最爱开始。你也可能会花一点时间询问你朋友的最爱。在为咖啡馆订购大量这些奶酪之前，你可能会想进行一次小实验
    —— 也许请一群朋友品尝你的选择，并告诉你他们的偏好。
- en: In addition to receiving your friends’ feedback, you’d also learn about your
    friends and the cheeses. You’d learn which kinds of cheeses your friends like
    and which friends have similar tastes. You can also learn which cheeses are the
    most popular and which cheeses are liked by the same people.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 除了收到朋友们的反馈意见外，你还将了解到有关朋友和奶酪的信息。你将会了解到朋友们喜欢哪种类型的奶酪，哪些朋友口味相似。你还可以了解到哪些奶酪最受欢迎，以及哪些奶酪被同一些人喜欢。
- en: 'This data would start to give you hints about your first cheese recommender.
    In this chapter, we’ll talk about how to turn this idea into the right stuff for
    a recommendation system. By way of this example, we’ll discuss one of the underlying
    notions of a recommender: how to predict a user’s affinity for things they’ve
    never seen.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据将开始为你的第一个奶酪推荐系统提供线索。在本章中，我们将讨论如何将这个想法转化为推荐系统的正确组成部分。通过这个例子，我们将讨论推荐系统的一个基本概念：如何预测用户对他们从未见过的东西的喜好。
- en: The User-Item Matrix
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用户-物品矩阵
- en: It’s extremely common to hear those who work on recommendation systems talk
    about matrices, and in particular the user-item matrix. While linear algebra is
    deep, both mathematically and as it applies to RecSys, we will begin with simple
    relationships.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 非常常见的是听到从事推荐系统工作的人谈论矩阵，特别是用户-物品矩阵。虽然线性代数在数学上很深奥，但它在推荐系统中的应用很简单直观。
- en: 'Before we get to the matrix forms, let’s write down some binary relationships
    between a set of users and a set of items. For the sake of this example, think
    of a group of five friends (mysteriously named *A*, *B*, *C*, *D*, *E*) and a
    blind cheese tasting where of four cheeses (*gouda*, *chèvre*, *emmentaler*, *brie*).
    The friends are asked to rate the cheeses, 1–4:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们讨论矩阵形式之前，让我们先列出一些用户集合和物品集合之间的二元关系。为了举例，想象一组五个朋友（神秘地被命名为*A*, *B*, *C*, *D*,
    *E*）和一个盲目品尝奶酪的场景，包括四种奶酪（*gouda*, *chèvre*, *emmentaler*, *brie*）。朋友们被要求对这些奶酪评分，从1到4：
- en: '*A* starts, “OK, I really enjoy *gouda*, so give that a 5; *chèvre* and *emmentaler*
    are yummy too, 4; and *brie* is awful, 1.”'
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*A*开始说：“好吧，我真的很喜欢*gouda*，所以给它5分；*chèvre*和*emmentaler*也很好吃，给4分；而*brie*太难吃了，只给1分。”'
- en: '*B* replies, “What?! *brie* is my favorite! 4.5! *chèvre* and *emmentaler*
    are fine, 3; and *gouda* is just OK, 2.”'
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*B*回答说：“什么？！*brie*是我的最爱！4.5！*chèvre*和*emmentaler*很好，3；而*gouda*只是还行，2。”'
- en: '*C* gives ratings of 3, 2, 3, and 4, respectively.'
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*C*分别给出3、2、3和4的评分。'
- en: '*D* gives 4, 4, 5, but we run out of *brie* before *D* can try it.'
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*D*给出4、4、5的评分，但我们在*D*试之前已经没*brie*了。'
- en: '*E* starts to not feel well, and tries only *gouda*, giving it a 3.'
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*E*开始感觉不舒服，并只尝试了*gouda*，给了它3分。'
- en: 'The first thing you may notice is that such expository writing is a bit tedious
    to read and parse. Let’s summarize these results in a convenient table ([Table 2-1](#table_2_1)):'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能首先注意到这种解说性写作有点乏味并且难以解析。让我们在一个方便的表格中总结这些结果（[表2-1](#table_2_1)）：
- en: Table 2-1\. Cheeses and ratings
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 表2-1\. 奶酪及评分
- en: '| Cheese taster | Gouda | Chèvre | Emmentaler | Brie |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| 奶酪品鉴师 | Gouda | Chèvre | Emmentaler | Brie |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| A | 5 | 4 | 4 | 1 |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| A | 5 | 4 | 4 | 1 |'
- en: '| B | 2 | 3 | 3 | 4.5 |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| B | 2 | 3 | 3 | 4.5 |'
- en: '| C | 3 | 2 | 3 | 4 |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| C | 3 | 2 | 3 | 4 |'
- en: '| D | 4 | 4 | 5 | - |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| D | 4 | 4 | 5 | - |'
- en: '| E | 3 | - | - | - |'
  id: totrans-20
  prefs: []
  type: TYPE_TB
  zh: '| E | 3 | - | - | - |'
- en: 'Your first instinct may be to write this in a form more appropriate for computers.
    You might create a collection of lists:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 你的第一个直觉可能是将这些内容写成更适合计算机的形式。你可以创建一系列的列表：
- en: <math alttext="StartLayout 1st Row 1st Column upper A 2nd Column colon 3rd Column
    left-bracket 5 comma 4 comma 4 comma 1 right-bracket 2nd Row 1st Column upper
    B 2nd Column colon 3rd Column left-bracket 2 comma 3 comma 3 comma 4.5 right-bracket
    3rd Row 1st Column upper C 2nd Column colon 3rd Column left-bracket 3 comma 2
    comma 3 comma 4 right-bracket 4th Row 1st Column upper D 2nd Column colon 3rd
    Column left-bracket 4 comma 4 comma 5 comma minus right-bracket 5th Row 1st Column
    upper E 2nd Column colon 3rd Column left-bracket 3 comma minus comma minus comma
    minus right-bracket EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd
    columnalign="right"><mi>A</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>5</mn> <mo>,</mo> <mn>4</mn> <mo>,</mo> <mn>4</mn> <mo>,</mo> <mn>1</mn> <mo>]</mo></mrow></mtd></mtr>
    <mtr><mtd columnalign="right"><mi>B</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>2</mn> <mo>,</mo> <mn>3</mn> <mo>,</mo> <mn>3</mn> <mo>,</mo> <mn>4</mn> <mo>.</mo>
    <mn>5</mn> <mo>]</mo></mrow></mtd></mtr> <mtr><mtd columnalign="right"><mi>C</mi></mtd>
    <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo> <mn>3</mn> <mo>,</mo>
    <mn>2</mn> <mo>,</mo> <mn>3</mn> <mo>,</mo> <mn>4</mn> <mo>]</mo></mrow></mtd></mtr>
    <mtr><mtd columnalign="right"><mi>D</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>4</mn> <mo>,</mo> <mn>4</mn> <mo>,</mo> <mn>5</mn> <mo>,</mo> <mo>-</mo> <mo>]</mo></mrow></mtd></mtr>
    <mtr><mtd columnalign="right"><mi>E</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>3</mn> <mo>,</mo> <mo>-</mo> <mo>,</mo> <mo>-</mo> <mo>,</mo> <mo>-</mo> <mo>]</mo></mrow></mtd></mtr></mtable></math>
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="StartLayout 1st Row 1st Column upper A 2nd Column colon 3rd Column
    left-bracket 5 comma 4 comma 4 comma 1 right-bracket 2nd Row 1st Column upper
    B 2nd Column colon 3rd Column left-bracket 2 comma 3 comma 3 comma 4.5 right-bracket
    3rd Row 1st Column upper C 2nd Column colon 3rd Column left-bracket 3 comma 2
    comma 3 comma 4 right-bracket 4th Row 1st Column upper D 2nd Column colon 3rd
    Column left-bracket 4 comma 4 comma 5 comma minus right-bracket 5th Row 1st Column
    upper E 2nd Column colon 3rd Column left-bracket 3 comma minus comma minus comma
    minus right-bracket EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd
    columnalign="right"><mi>A</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>5</mn> <mo>,</mo> <mn>4</mn> <mo>,</mo> <mn>4</mn> <mo>,</mo> <mn>1</mn> <mo>]</mo></mrow></mtd></mtr>
    <mtr><mtd columnalign="right"><mi>B</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>2</mn> <mo>,</mo> <mn>3</mn> <mo>,</mo> <mn>3</mn> <mo>,</mo> <mn>4</mn> <mo>.</mo>
    <mn>5</mn> <mo>]</mo></mrow></mtd></mtr> <mtr><mtd columnalign="right"><mi>C</mi></mtd>
    <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo> <mn>3</mn> <mo>,</mo>
    <mn>2</mn> <mo>,</mo> <mn>3</mn> <mo>,</mo> <mn>4</mn> <mo>]</mo></mrow></mtd></mtr>
    <mtr><mtd columnalign="right"><mi>D</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>4</mn> <mo>,</mo> <mn>4</mn> <mo>,</mo> <mn>5</mn> <mo>,</mo> <mo>-</mo> <mo>]</mo></mrow></mtd></mtr>
    <mtr><mtd columnalign="right"><mi>E</mi></mtd> <mtd><mo>:</mo></mtd> <mtd columnalign="left"><mrow><mo>[</mo>
    <mn>3</mn> <mo>,</mo> <mo>-</mo> <mo>,</mo> <mo>-</mo> <mo>,</mo> <mo>-</mo> <mo>]</mo></mrow></mtd></mtr></mtable></math>
- en: 'This may work in some scenarios, but you might want to more clearly indicate
    the positional meaning in each list. You could simply visualize this data with
    a heatmap ([Figure 2-1](#fig:cheese-ratings)):'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下这可能有效，但你可能希望更清楚地表明每个列表中的位置意义。你可以简单地使用热图来可视化这些数据（[图2-1](#fig:cheese-ratings)）：
- en: '[PRE0]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![Ratings Heatmap](assets/brpj_0201.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![评分热图](assets/brpj_0201.png)'
- en: Figure 2-1\. Cheese ratings matrix
  id: totrans-26
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图2-1\. 奶酪评分矩阵
- en: 'As we observe datasets with huge numbers of users or items, and with more and
    more sparsity, we will need to employ a data structure more well suited to representing
    only the necessary data. A variety of so-called *dense representations* exists,
    but for now we will use the simplest form: tuples of `user_id`, `item_id`, and
    `rating`. In practice, the structure is often a dictionary with indices provided
    by the IDs.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们观察到拥有大量用户或物品，并且稀疏度越来越高的数据集时，我们需要使用更适合表示必要数据的数据结构。存在各种所谓的*稠密表示*，但现在我们将使用最简单的形式：`user_id`、`item_id`和`rating`的元组。在实践中，这种结构通常是一个由ID提供索引的字典。
- en: Dense and Sparse Representations
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 稠密和稀疏表示
- en: Two types of structures for these kinds of data are dense and sparse representations.
    Loosely, a *sparse representation* is one such that a datum exists for each nontrivial
    observation. A *dense representation* always contains a datum for each possibility
    even when trivial (`null` or zero).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据的两种类型结构是稠密和稀疏表示。宽泛地说，*稀疏表示*是这样一种表示，即每个非平凡观察都存在一个数据。*稠密表示*总是包含每个可能性的数据，即使是在平凡（`null`或零）情况下也是如此。
- en: 'Let’s see what this data looks like as a dictionary:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这些数据作为字典的样子：
- en: '[PRE1]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'A few natural questions emerge:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 出现了几个自然的问题：
- en: What’s the most popular cheese? From the observations so far, it’s looking like
    *emmentaler* is potentially the favorite, but *E* didn’t try *emmentaler*.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从迄今的观察来看，最受欢迎的奶酪是什么？看起来*emmentaler*可能是最喜欢的，但*E*没有尝试过*emmentaler*。
- en: Would *D* like *brie*? It seems to be a contentious cheese.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*D*会喜欢*brie*吗？看起来这是一种有争议的奶酪。'
- en: If you were asked to buy only two cheeses, which should you buy to best satisfy
    everyone?
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你只被要求买两种奶酪，你应该买哪两种来最好地满足所有人的需求？
- en: This example and associated questions are intentionally simple, but the point
    is clear that this matrix representation is at least convenient for capturing
    these ratings.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子及其相关问题故意简单，但其要点是很明确的，即这种矩阵表示至少对捕捉这些评分是方便的。
- en: 'What may not be obvious is that beyond the convenience of this data visualization
    is the mathematical utility of this representation. Question 2 suggests an inherent
    RecSys problem: “predict how much a user will like an item they haven’t seen.”
    This question may also be recognizable as a problem from a linear algebra class:
    “How can we fill in unknown elements of a matrix from the ones we know?” This
    is called *matrix completion.*'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 也许并不明显的是，除了这种数据可视化的便利性之外，这种表示法在数学上的实用性也是存在的。问题2暗示了一个固有的推荐系统问题：“预测用户未看到的物品会喜欢多少。”这个问题也可以被认出是线性代数课程中的问题：“如何从我们知道的元素中填充矩阵的未知元素？”这被称为*矩阵完成*。
- en: The back-and-forth between creating user experiences that capture their needs
    and the mathematical formulations to model this data and needs is at the heart
    of recommendation systems.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在创造捕捉用户需求的用户体验和数学建模数据及需求之间的反复过程中，推荐系统的核心问题浮出水面。
- en: User-User Versus Item-Item Collaborative Filtering
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用户-用户与物品-物品协同过滤
- en: Before we dive into the linear algebra, let’s consider the purely data science
    perspective called *collaborative filtering* (*CF*), a term originally used by
    David Goldberg et al. in their 1992 paper [“Using Collaborative Filtering to Weave
    an Information Tapestry”](https://oreil.ly/Nd3oe).
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入线性代数之前，让我们考虑一下纯数据科学的视角，称为*协同过滤*（*CF*），这个术语最初是由David Goldberg等人在他们1992年的论文[“Using
    Collaborative Filtering to Weave an Information Tapestry”](https://oreil.ly/Nd3oe)中使用的。
- en: The underlying idea of CF is that those with similar tastes help others to know
    what they like without having to try it themselves. The *collaboration* terminology
    was originally intended to mean among similar-taste users, and *filtering* was
    originally intended to mean filtering out choices people will not like.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: CF的基本思想是，具有相似品味的人可以帮助其他人了解他们喜欢的东西，而无需自己去尝试。*协同*术语最初是指类似品味的用户之间的协同，*过滤*最初是指过滤掉人们不喜欢的选择。
- en: 'You can think of this CF strategy in two ways:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以用两种方式来思考这种协同过滤策略：
- en: Two users with similar tastes will continue to have similar tastes.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两个具有相似品味的用户将继续拥有相似的品味。
- en: Two items with similar user fans will continue to be popular with other users
    who are similar to those fans.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两个具有相似用户粉丝的物品将继续受到其他类似粉丝的用户的欢迎。
- en: 'These may sound identical, but they appear differently in the mathematical
    interpretations. At a high level, the difference is in deciding which kind of
    similarity your recommender should prioritize: user similarity or item similarity.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这些听起来可能相同，但在数学解释上它们看起来不同。在高层次上，区别在于你的推荐系统应该优先考虑哪种相似性：用户相似性还是物品相似性。
- en: If you prioritize *user similarity*, then to provide a recommendation for a
    user *A*, you find a similar user *B* and then choose a recommendation from *B*’s
    list of liked content that *A* hasn’t seen yet.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你优先考虑 *用户相似性*，那么为了为用户 *A* 提供推荐，你会找到一个类似的用户 *B*，然后从 *B* 喜欢的内容列表中选择一个 *A* 还没看过的推荐。
- en: If you prioritize *item similarity*, then to provide a recommendation for a
    user *A*, you find an item that *A* liked, *chèvre*, and then you find an item
    similar to *chèvre* that *A* hasn’t seen, *emmentaler*, and recommend it for *A*.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你优先考虑 *物品相似性*，那么为了为用户 *A* 提供推荐，你会找到一个 *A* 喜欢的物品 *奶酪*，然后找到一个与 *奶酪* 相似的 *A*
    还没看过的物品 *埃门塔勒*，并向 *A* 推荐它。
- en: Later we will dive deeper into similarity, but let’s quickly link these ideas
    to our preceding discussion. *Similar users* are rows of the user-item matrix
    that are similar as vectors; *similar items* are columns of the user-item matrix
    that are similar as vectors.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 稍后我们将深入探讨相似性，但让我们快速将这些想法与前面的讨论联系起来。*相似的用户* 是用户-物品矩阵中作为向量相似的行；*相似的物品* 是作为向量相似的用户-物品矩阵中的列。
- en: Vector Similarity
  id: totrans-49
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 向量相似性
- en: '*Dot product similarity* is more precisely defined in [Chapter 10](ch10.html#ch10).
    For now, consider similarity to be computed by normalizing the vectors and then
    taking their cosine similarity. Given entities of any kind that you’ve associated
    to vectors (lists of numbers), *vector similarity* compares which entities are
    most alike with respect to the characteristics captured by those lists of numbers
    (called the *latent space*).'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '*点积相似性* 在 [第 10 章](ch10.html#ch10) 中有更精确的定义。暂时来说，相似性是通过将向量归一化然后计算它们的余弦相似度来计算的。给定任何类型的实体，你已经将它们关联到向量（数字列表）中，*向量相似性*
    比较的是哪些实体在特征上最相似，这些特征由这些数字列表（称为 *潜在空间*）捕获。'
- en: The Netflix Challenge
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Netflix 挑战
- en: In 2006, Netflix kicked off an online competition called the Netflix Prize.
    This competition challenged teams to improve on the performance of Netflix CF
    algorithms on a dataset released as open source by the company. While such a competition
    is common today via websites like Kaggle or conference, at that time, it was very
    exciting and novel for those interested in RecSys.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 2006 年，Netflix 启动了一个名为 Netflix 奖 的在线竞赛。这个竞赛挑战团队在由公司发布的开放数据集上改进 Netflix 的 CF
    算法的性能。虽然像 Kaggle 或者会议网站上的这类竞赛如今已经很普遍，但在当时对于对推荐系统感兴趣的人来说，这是非常令人兴奋和新颖的。
- en: The competition consisted of several intermediate rounds awarding a Progress
    Prize and the final Netflix Prize awarded in 2009\. The data provided was a collection
    of 2,817,131 triples consisting of (`user, movie, date_rated`). And half of these
    additionally included the rating itself. Notice that as in our preceding example,
    the user-item information is nearly enough to specify the problem. In this particular
    dataset, the date was provided. Later, we will dig into how time might be a factor,
    and in particular, for sequential recommendation systems.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这个竞赛包括多个中间回合，颁发进步奖以及 2009 年颁发的最终 Netflix 奖。提供的数据集包括 2,817,131 个三元组，包括 (`用户，电影，评分日期`)。其中一半还包括评分本身。请注意，就像我们前面的例子一样，用户-物品信息几乎足以指定问题。在这个特定的数据集中，日期是已提供的信息。稍后，我们将探讨时间可能是如何成为因素的，特别是对于顺序推荐系统。
- en: The stakes were quite high in this competition. Requirements for beating the
    internal performance were a 10% increase in root mean square error (RMSE); we
    will discuss this loss function later. And the spoils added up to over $1.1 million.
    The final winners were BellKor’s Pragmatic Chaos (which incidentally won the two
    previous Progress Prizes) with a test RMSE of 0.8567\. In the end, only a 20-minute
    earlier submission time kept BellKor ahead of the competitors The Ensemble.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这个竞赛的赌注非常高。击败内部性能的要求是将均方根误差（RMSE）提高 10%；稍后我们将讨论这个损失函数。奖金总额超过了 110 万美元。最终的获胜者是
    BellKor's Pragmatic Chaos（其实也赢得了之前两个进步奖）的测试 RMSE 为 0.8567。最终，仅仅是 20 分钟的提前提交时间使
    BellKor 领先于竞争对手 The Ensemble。
- en: 'To read in detail about the winning submissions, check out [“The BigChaos Solution
    to the Netflix Grand Prize”](https://oreil.ly/joaqu) by Andreas Töscher and Michael
    Jahrer and [“The BigChaos Solution to the Netflix Prize 2008”](https://oreil.ly/D51iM)
    by the same authors. Meanwhile, let’s review a few important lessons from this
    competition:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 要详细了解获胜作品，请查看[“Netflix大奖的BigChaos解决方案”](https://oreil.ly/joaqu)由Andreas Töscher和Michael
    Jahrer以及相同作者的[“Netflix Prize 2008的BigChaos解决方案”](https://oreil.ly/D51iM)。与此同时，让我们回顾一下这场比赛中的几个重要教训：
- en: First, we see that the user-item matrix we’ve discussed appears in these solutions
    as the critical mathematical data structure. The model selection and training
    is important, but parameter tuning provided a huge improvement in several algorithms.
    We will return to parameter tuning in later chapters. The authors state that several
    model innovations came from reflecting on the business use case and human behavior
    and trying to capture those patterns in the model architectures. Next, linear-algebraic
    approaches resulted in the first reasonably performant solutions, and building
    on top of them led to the winning model. Finally, eking out the performance that
    Netflix originally demanded to win the competition took so long that business
    circumstances changed and the [solution was no longer useful](https://oreil.ly/fz6rz).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们看到我们讨论过的用户-项目矩阵在这些解决方案中出现为关键的数学数据结构。模型选择和训练很重要，但参数调整在几种算法中提供了巨大的改进。我们将在后续章节中回到参数调整。作者指出，几种模型创新来自于反思业务用例和人类行为，并尝试在模型架构中捕捉这些模式。接下来，线性代数方法导致了第一个相对性能良好的解决方案，并在此基础上构建了获胜模型。最后，为了获得Netflix最初要求赢得比赛的性能，花费了很长时间，而业务环境却发生了变化，[解决方案不再有用](https://oreil.ly/fz6rz)。
- en: That last point might be the *most* important thing an ML developer needs to
    learn about recommendation systems; see the following tip.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一点可能是机器学习开发者需要了解的*最*重要的关于推荐系统的事情；请看以下提示。
- en: Start with Simplicity
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从简单开始
- en: Build a working usable model quickly and iterate while the model is still relevant
    to the needs of the business.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 快速构建一个可用的工作模型，并在模型仍然符合业务需求时进行迭代。
- en: Soft Ratings
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 软评分
- en: 'In our cheese-tasting example, each cheese either received a numerical rating
    or was not tried by a guest. These are *hard ratings*: regardless of whether the
    cheese is a brie or a chèvre, the ratings are explicit, and their absence indicates
    a lack of interaction between the user and item. In some contexts, we’ll want
    to accommodate data indicating a user does interact with an item and yet provides
    no rating.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们品尝奶酪的例子中，每种奶酪都会收到一个数字评分或者客人未尝试过。这些是*硬评分*：无论奶酪是布里还是露琪，评分都是明确的，其缺失表明用户与项目之间缺乏互动。在某些情况下，我们需要处理表明用户确实与项目进行了互动但未提供评分的数据。
- en: 'A common example is a movies app; a user may have watched a movie with the
    app but not provided a star rating. This indicates that the item (in this case,
    a movie) has been observed, but we don’t have the rating for our algorithms to
    learn from. However, we can still use this implicit data to do the following:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 一个常见的例子是电影应用程序；用户可能使用应用程序观看了电影，但未提供星级评分。这表明项目（在这种情况下是电影）已被观察到，但我们的算法没有学习的评分。然而，我们仍然可以使用这些隐含数据来执行以下操作：
- en: Exclude this item from future recommendations
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从未来的推荐中排除这个项目
- en: Use this data as a separate term in our learner
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将这些数据作为我们学习者中的一个单独项使用
- en: Assign a default rating value to indicate “interesting enough to watch, not
    significant enough to rate”
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分配一个默认的评分值，以指示“有趣但不足以评级”
- en: It turns out that implicit ratings are critical for training effective recommendation
    systems, not only because users often don’t give hard ratings, but also because
    implicit ratings provide a different level of signal. Later, when we wish to train
    multilevel models to predict both click likelihood and buy likelihood, these two
    levels will prove extremely important.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，隐含评分对训练有效的推荐系统至关重要，不仅因为用户经常不提供硬评分，而且因为隐含评分提供了不同水平的信号。稍后，当我们希望训练多级模型以预测点击和购买可能性时，这两个级别将非常重要。
- en: 'To sum up:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 总结一下：
- en: A hard rating occurs when the user directly responds to a prompt for feedback
    on an item.
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当用户直接对项目的反馈提出请求时，会产生硬评分。
- en: A soft rating occurs when the user’s behavior implicitly communicates feedback
    on an item without responding to a direct prompt.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当用户的行为在未直接回应提示的情况下隐含地传达对项目的反馈时，会产生软评分。
- en: Data Collection and User Logging
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据收集和用户记录
- en: We’ve established that we learn from both explicit ratings and implicit ratings,
    so how and where do we get this data? To dive into this, we’ll need to start worrying
    about application code. In many businesses, the data scientists and ML engineers
    are separate from the software engineers, but working with recommendation systems
    requires alignment between the two functions.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经确定，我们既从显式评级学习，也从隐式评级学习，那么我们如何以及从哪里获取这些数据？为了深入探讨这一点，我们需要开始关注应用程序代码。在许多企业中，数据科学家和机器学习工程师与软件工程师是分开的，但是处理推荐系统需要两个功能之间的协调。
- en: What to Log
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 记录什么内容
- en: The simplest and most obvious data collection is user ratings. If users are
    given the option to provide ratings, or even a thumbs-up or thumbs-down, that
    component will need to be built and that data will need to be stored. These ratings
    must be stored not only for the opportunity to build recommendations, but also
    to prevent the bad user experience of rating something and then shortly thereafter
    not having the rating appear when revisiting the page.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单和最明显的数据收集是用户评级。如果用户可以选择提供评级，甚至是赞成或反对的选项，那么就需要构建该组件并存储这些数据。这些评级不仅需要存储，以便建立推荐，还要防止用户评级某物品后不久再次访问页面时评级消失，从而导致不好的用户体验。
- en: 'Similarly, it’s useful to understand a few other key interactions that can
    improve and expand your recommendation system: page loads, page views, clicks,
    and add-to-bag.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 同样地，了解几个其他关键互动也可以改进和扩展您的推荐系统：页面加载、页面浏览、点击和加入购物袋。
- en: 'For these types of data, let’s use a slightly more complicated example: the
    ecommerce website [Bookshop.org](https://www.bookshop.org). This one site has
    multiple applications of recommendation systems, almost all of which we will return
    to in time. For now, let’s focus on some interactions ([Figure 2-2](#fig:bookshop-landing)).'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这些类型的数据，让我们使用一个稍微复杂的例子：电子商务网站 [Bookshop.org](https://www.bookshop.org)。这个站点有多个推荐系统的应用，我们将逐步回到几乎所有这些应用。现在，让我们专注于一些互动（[图
    2-2](#fig:bookshop-landing)）。
- en: '![Bookshop Landing Page](assets/brpj_0202.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![图书店首页](assets/brpj_0202.png)'
- en: Figure 2-2\. Bookshop.org landing page
  id: totrans-77
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-2\. Bookshop.org 首页
- en: Page loads
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 页面加载
- en: When you first load up Bookshop.org, it starts with items on the page. The Best
    Sellers of the Week are all clickable images to those book listings. Despite the
    user having no choice in loading this initial page, it’s actually quite important
    to log the contents of this initial page load.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 当您首次加载 Bookshop.org 时，页面上会显示项目。本周畅销书都是可点击的书籍列表的图片。尽管用户在加载此初始页面时没有选择，但记录这个初始页面加载的内容实际上非常重要。
- en: These options represent the population of books that the user has seen. If a
    user has seen an option, they have the opportunity to click it, which will ultimately
    be an important implicit signal.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这些选项代表用户看过的所有书籍的总体。如果用户看过某个选项，他们就有点击它的机会，这将最终成为一个重要的隐式信号。
- en: Propensity Scores
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 倾向评分
- en: The consideration of the population of all items a user has seen is deeply tied
    to propensity score matching. In mathematics, *propensity scores* are the probability
    that an observational unit will be assigned to the treatment group versus the
    control group.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑用户看过的所有项目的总体与倾向评分匹配密切相关。在数学上，*倾向评分*是观察单元被分配到处理组与对照组的概率。
- en: 'Compare this setup to the simple 50-50 A/B test: every unit has a 50% chance
    of being exposed to your treatment. In a feature-stratified A/B test, you purposely
    change the probability of exposure dependent on a certain feature or collection
    of features (often called *covariates* in this context). Those probabilities of
    exposure are the propensity scores.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 将这种设置与简单的 50-50 A/B 测试进行比较：每个单元有 50% 的机会暴露于您的处理。在特征分层的 A/B 测试中，您有意根据某些特征或特征集（在这种情况下通常称为*协变量*）更改暴露的概率。这些暴露概率就是倾向评分。
- en: 'Why bring up A/B testing here? Later, we’ll be interested in mining our soft
    ratings for signal on user preference, but we must consider the possibility that
    the lack of a soft rating is not an implicit bad rating. Thinking back to the
    cheeses: taster *D* never had a chance to rate *brie*, so there’s no reason to
    think *D* has a preference for aversion on *brie*. This is because *D* was not
    *exposed to* *brie*.'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么在这里提到 A/B 测试？稍后，我们将对用户偏好的软评级进行挖掘，但我们必须考虑到缺乏软评级可能并不意味着隐含的不良评级。回想起奶酪：品鉴员 *D*
    没有机会评价 *brie*，因此没有理由认为 *D* 对 *brie* 有偏好或厌恶。这是因为 *D* 没有*接触到* *brie*。
- en: 'Now thinking back to Bookshop.org: the landing page does not show *The Hitchhiker’s
    Guide to the Galaxy*, so the user has no way to click it and implicitly communicate
    interest in that book. The user could use the search option, but that’s a different
    kind of signal—which we’ll talk about later and is, in fact, a much stronger signal.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在回想起 Bookshop.org：首页没有显示《银河系漫游指南》，所以用户无法点击它并隐式表达对该书的兴趣。用户可以使用搜索选项，但这是一种不同类型的信号——我们稍后会讨论，实际上是一种更强的信号。
- en: When understanding implicit ratings like “did the user look at something,” we
    need to properly account for the entire population of choices they were exposed
    to, and use the inverse of that population size to weigh the importance of clicking.
    For this reason, understanding *all* page loads is important.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在理解像“用户是否看过某物”这样的隐式评级时，我们需要正确考虑他们暴露给的所有选择，并使用该人群规模的倒数来衡量点击的重要性。因此，理解所有页面加载都很重要。
- en: Page views and hover
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 页面浏览和悬停
- en: Websites have gotten much more complicated, and now users must contend with
    a variety of interactions. [Figure 2-3](#fig:bookshop-top-sellers) demonstrates
    what happens if the user clicks the right arrow in the Best Sellers of the Week
    carousel and then moves their mouse over the Cooking at Home option.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 网站已经变得更加复杂，现在用户必须应对各种交互。[图 2-3](#fig:bookshop-top-sellers) 展示了如果用户在本周畅销书籍的轮播中点击右箭头，然后将鼠标移动到《家庭烹饪》选项上会发生什么。
- en: '![Bookshop Top Sellers](assets/brpj_0203.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![Bookshop 畅销书籍](assets/brpj_0203.png)'
- en: Figure 2-3\. Bookshop.org top sellers
  id: totrans-90
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-3\. Bookshop.org 畅销书籍
- en: The user has unveiled a new option, and by mousing over it, has made it larger
    and given it a visual effect. These are ways to communicate more information to
    the user, and remind the user that these options are clickable. To the recommender,
    these clicks can be used as more implicit feedback.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 用户揭示了一个新选项，并通过将鼠标悬停在其上，使其变大并产生视觉效果。这些都是向用户传达更多信息的方法，并提醒用户这些选项是可点击的。对于推荐系统来说，这些点击可以被用作更多的隐式反馈。
- en: First, the user clicked the carousel scroll—so some of what they saw in the
    carousel was interesting enough to dig further. Second, they moused over *Cooking
    at Home*, which they might click or might just want to see if additional information
    becomes available when hovering. Many websites use a hover interaction to provide
    a pop-up detail. While Bookshop.org doesn’t implement something like this, internet
    users have been trained to expect this behavior by all the websites that do, and
    so the signal is still meaningful. Third, the user has now uncovered a new potential
    item in their carousel scroll—which we should add to our page loads but with a
    higher rating because it required interaction to uncover.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，用户点击了轮播滚动条——因此他们在轮播中看到的部分内容足够有趣，以便进一步挖掘。其次，他们将鼠标悬停在《家庭烹饪》上，这可能会导致点击，也可能只是想看看在悬停时是否提供了额外信息。许多网站使用悬停交互来提供弹出式详细信息。尽管
    Bookshop.org 没有实现类似的功能，但互联网用户已经习惯了所有实现此行为的网站，因此这个信号仍然具有意义。第三，用户现在在轮播滚动中发现了一个新的潜在项目——我们应该将其添加到我们的页面加载中，但评分较高，因为它需要交互才能揭示。
- en: All this and more can be encoded into the website’s logging. Rich and verbose
    logging is one of the most important ways to improve a recommendation system.
    Having more logging data than you need is almost always better than having the
    opposite.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些信息和更多信息都可以编码到网站的日志中。丰富和详细的日志记录是改善推荐系统的最重要方法之一。比你实际需要的更多的日志数据几乎总是比相反情况更好。
- en: Clicks
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 点击
- en: If you thought hovering meant interest, wait until you consider clicking! Not
    in all cases, but in the large majority, clicking is a strong indicator of product
    interest. For ecommerce, clicking often is computed as part of the recommendation
    team’s core key performance indicators (KPIs).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您认为悬停意味着兴趣，那么等您考虑到点击时会怎样！在大多数情况下，点击是产品兴趣的强有力指标。对于电子商务来说，点击经常作为推荐团队核心关键绩效指标（KPI）的一部分计算。
- en: 'This is for two reasons:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这是出于两个原因：
- en: Clicking is almost always required to purchase, so it’s an upstream filter for
    most business transactions.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 点击几乎总是购买所必需的，因此对于大多数业务交易来说，它是一个上游过滤器。
- en: Clicking requires explicit user action, so it’s a good measure of intent.
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 点击需要明确的用户操作，因此它是意图的良好衡量指标。
- en: Noise will always exist of course, but clicks are the go-to indicator of a client’s
    interest. Many production recommendation systems are trained on click data—not
    ratings data—because of the much higher data volume and the strong correlation
    between click behavior and purchase behavior.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，噪音总是存在的，但点击是客户兴趣的主要指标。许多生产推荐系统是基于点击数据训练的，而不是评级数据，因为点击行为和购买行为之间存在强烈的相关性，且数据量更大。
- en: Click-Stream Data
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 点击流数据
- en: Sometimes in recommendation systems you hear people talk about *click-stream*
    data. This important view into click data also considers the order of a user’s
    clicks in a single *session*. Modern recommendation systems put a lot of effort
    into utilizing the order of items a user clicks, calling this *sequential recommendations*,
    and have shown dramatic improvements via this additional dimension. We will discuss
    sequence-based recommendations in [Chapter 7](ch07.html#serving-and-architecture).
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 有时在推荐系统中，您会听到人们谈论*点击流*数据。这一重要的点击数据视图还考虑了用户在单个*会话*中点击的顺序。现代推荐系统致力于利用用户点击顺序，称之为*顺序推荐*，并通过这一额外的维度显示了显著的改进。我们将在[第7章](ch07.html#serving-and-architecture)中讨论基于序列的推荐。
- en: Add-to-bag
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加到购物袋
- en: We’ve finally arrived; the user has added an item to their bag or cart or queue.
    This is an extremely strong indicator of interest and is often quite correlated
    with purchasing. There are even reasons to argue that add-to-bag is a better signal
    than purchase/order/watch. Add-to-bag is essentially the end of the line for soft
    ratings, and usually beyond this you’d want to start collecting ratings and reviews.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我们终于到了；用户已将物品添加到他们的购物袋、购物车或队列中。这是极其强烈的兴趣指示器，通常与购买行为高度相关。甚至有理由认为添加到购物袋比购买/订单/观看更好作为信号。添加到购物袋基本上是软评级的终点，通常在此之后您希望开始收集评级和评价。
- en: Impressions
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 印象
- en: We might also wish to log *impressions* of an item that wasn’t clicked. This
    supplies the recommendation system with negative feedback on items that the user
    isn’t interested in. For example, if the cheeses *gouda*, *chèvre* and *emmentaler*
    are offered to the user but the user tastes only *chèvre*, perhaps the user doesn’t
    like *gouda*. They might not have gotten around to tasting *emmentaler*, on the
    other hand, so these impressions may carry only noisy signal.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能还希望记录那些未被点击的项目的*印象*。这为推荐系统提供了用户对不感兴趣项目的负反馈。例如，如果用户被提供了*gouda*、*chèvre*和*emmentaler*这些奶酪，但用户只尝试了*chèvre*，也许用户不喜欢*gouda*。另一方面，他们可能还没来得及尝试*emmentaler*，所以这些印象可能只带来噪声信号。
- en: Collection and Instrumentation
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 收集和仪器化
- en: Web applications frequently instrument all the interactions we’ve discussed
    via events. If you don’t yet know what events are, maybe ask a buddy in your engineering
    org—but we’ll also give you the skinny. Like logging, *events* are specially formatted
    messages that the application sends out when a certain block of code is executed.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: Web应用程序通常通过事件来仪表化我们讨论过的所有交互。如果您还不知道什么是事件，可以向您工程组织的同事询问，但我们也会为您提供简略信息。与日志记录类似，*事件*是应用程序在执行某段代码时发送的特殊格式消息。
- en: 'As in the example of a click, the application needs to make a call to get the
    next content to show the user, it’s common to also “fire an event” at this moment,
    indicating information about the user, what they clicked, the session-ID for later
    reference, the time, and various other useful details. This event can be handled
    downstream in any number of ways, but there’s an increasingly prevalent pattern
    of path bifurcation to the following:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 正如点击的例子中，应用程序需要调用以获取下一个要向用户显示的内容，此时通常也会“触发事件”，指示有关用户的信息，他们点击了什么，会话ID以供以后参考，时间以及其他各种有用的细节。此事件可以在下游以任何方式处理，但有一种越来越普遍的路径分歧模式如下：
- en: A log database, like a mySQL application database tied to the service
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个日志数据库，如与服务绑定的mySQL应用程序数据库
- en: An event stream for real-time handling
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个实时处理事件流
- en: 'The latter will be interesting: event streams are often connected to listeners
    via technologies like Apache Kafka. This kind of infrastructure can get complicated
    fast (consult your local data engineer or MLOps person), but a simple model for
    what happens is that all of a particular kind of log are sent to several destinations
    that you think can make use of these events.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 后者将很有趣：事件流通常通过诸如Apache Kafka之类的技术与侦听器连接。这种基础设施可能会迅速变得复杂（请咨询您的本地数据工程师或MLOps人员），但发生的简单模型是所有特定类型的日志都发送到您认为可以利用这些事件的几个目的地。
- en: In the recommender case, an event stream can be connected up to a sequence of
    transformations to process the data for downstream learning tasks. This will be
    enormously useful if you want to build a recommendation system that uses those
    logs. Other important uses are real-time metrics logging for what is going on
    at any given time on the website.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在推荐系统的情况下，事件流可以连接到一系列转换以处理下游的学习任务数据。如果您希望构建一个使用这些日志的推荐系统，这将非常有用。其他重要用途包括实时度量日志，用于了解网站上的实时情况。
- en: Funnels
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 漏斗
- en: We’ve just worked through our first example of a funnel, which no good data
    scientist can avoid thinking about. Like them or hate them, funnel analyses are
    crucial for critical evaluation of your website, and by extension your recommendation
    system.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚通过了我们的第一个漏斗示例，任何一个好的数据科学家都无法避免考虑它们。无论喜欢与否，漏斗分析对于评估你的网站以及扩展你的推荐系统至关重要。
- en: Click-Streams
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 点击流
- en: A *funnel* is a collection of steps a user must take to get from one state to
    another; it’s called a funnel because at each of the discrete steps, a user may
    stop proceeding through, or *drop off*, thus reducing the population size at each
    step.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '*漏斗*是用户从一个状态到另一个状态必须执行的步骤集合；之所以称为漏斗，是因为在每个离散步骤，用户可能会停止继续进行，或者*掉队*，从而在每个步骤中减少人口数量。'
- en: In our discussion of events and user logging, each step is relevant for a subset
    of the previous. This means that the process is a funnel, as shown in [Figure 2-4](#fig:funnel).
    Understanding the drop-off rate at each step reveals important characteristics
    of your website and your recommendations.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们对事件和用户日志的讨论中，每个步骤都与前面的某个子集相关。这意味着该过程是一个漏斗，如[图 2-4](#fig:funnel)所示。了解每个步骤的流失率揭示了你的网站和推荐的重要特征。
- en: '![An onboarding funnel](assets/brpj_0204.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![一个入门漏斗](assets/brpj_0204.png)'
- en: Figure 2-4\. An onboarding funnel
  id: totrans-119
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-4\. 一个入门漏斗
- en: 'Three important funnel analyses can be considered in [Figure 2-4](#fig:funnel):'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在[图 2-4](#fig:funnel)中考虑三种重要的漏斗分析：
- en: Page view to add-to-bag user flow
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 页面浏览到加入购物袋用户流
- en: Page view to add-to-bag per recommendation
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 页面浏览到每个推荐的加入购物袋
- en: Add-to-bag to complete purchase
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从加入购物袋到完成购买
- en: The first funnel is merely identifying, at a high level, the percentage of users
    who take each step in the flow. This is a high-level measure of your website optimization,
    the general interestingness of your product offering, and the quality of your
    user leads.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个漏斗只是在高层次上识别用户在流程中每个步骤中的占比。这是你的网站优化的高级衡量标准，产品提供的一般吸引力，以及用户引导的质量。
- en: The second funnel, which is more fine-grained, takes into consideration the
    recommendations themselves. As mentioned previously in terms of propensity scoring,
    users can proceed through the funnel for a particular item only if they’re shown
    the item. This concept intersects with the use of funnels because you want to
    understand at a high level how certain recommendations correlate with funnel drop-off,
    but also, when using a recommendation system, the confidence in your recommendations
    should correlate well with the funnel metrics. We will return to this in more
    detail in [Part III](part03.html#ranking), but for now you should remember to
    think about different categories of recommendation-user pairs and how their funnels
    may look compared to the average.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个更为精细的漏斗考虑了推荐系统本身。正如在倾向性评分方面之前提到的那样，用户只有在看到某个物品时才能进入特定物品的推荐漏斗。这个概念与漏斗的使用相交汇，因为你希望从高层次理解某些推荐与漏斗流失的关系，但是同时，在使用推荐系统时，你对推荐的信心应该与漏斗指标很好地相关。我们将在[第三部分](part03.html#ranking)详细讨论这个问题，但现在你应该记住考虑不同类别的推荐用户对和他们的漏斗可能与平均水平有何不同。
- en: Finally, we can consider add-to-bag to completion. This actually isn’t part
    of the RecSys problem but should be on your mind as a data scientist or ML engineer
    trying to improve the product. *No matter how good your recommendations are, this
    funnel may destroy any of your hard work.* Before working on a recommender problem,
    you should almost always investigate the funnel performance in getting a user
    from add-to-bag to check-out-completed. If there’s something cumbersome or difficult
    about this flow, it will almost certainly provide a bigger bang for your buck
    to fix this than to improve recommendations. Investigate the drop-offs, do user
    studies to understand what might be confusing, and work with product and engineering
    teams to ensure that everyone is aligned on this flow before you start building
    a recommender for ecommerce.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以考虑从加入购物车到完成购买。这实际上不是推荐系统问题的一部分，但作为试图改进产品的数据科学家或机器学习工程师，你应该时刻关注这一点。*无论你的推荐有多好，这一漏斗可能会摧毁你的所有努力。*在解决推荐问题之前，你几乎总是应该调查漏斗在从加入购物车到完成购买过程中的表现。如果流程中有任何复杂或困难之处，修复这些问题几乎肯定比改进推荐系统更有价值。调查流失情况，进行用户研究以理解可能的混淆因素，并与产品和工程团队合作，确保每个人在开始构建电子商务推荐系统之前都对这一流程有共识。
- en: Business Insight and What People Like
  id: totrans-127
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 业务见解和用户喜好
- en: In the previous example from Bookshop.org, Top Sellers of the Week is the primary
    carousel on the page. Recall our earlier work on `get_most_popular_recs`; what
    powers the carousel is simply that recommender but applied to a specific collector—one
    that looks only in the last week.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前来自Bookshop.org的例子中，本周热销排行榜是页面上的主要轮播内容。回顾我们之前的`get_most_popular_recs`工作；轮播的动力仅仅是推荐系统应用于特定收藏者的结果——一个只看最近一周的收藏者。
- en: This carousel is an example of a recommender providing business insight in addition
    to driving recommendations. A common mission of a growth team is to understand
    weekly trends and KPIs, often metrics like weekly active users and new sign-ups.
    For many digital-first companies, growth teams are additionally interested in
    understanding the primary drivers of engagement.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 这个轮播示例展示了推荐系统在提供业务见解的同时，也推动了推荐功能。增长团队的常见任务是理解每周的趋势和关键绩效指标，通常是每周活跃用户和新注册用户这样的指标。对于许多数字化公司来说，增长团队还对理解用户参与的主要驱动因素感兴趣。
- en: 'Let’s take an example: as of this writing, the Netflix show *Squid Game* became
    the company’s most popular series of all time, breaking a huge number of records
    in the process. *Squid Game* reached 111 million viewers in the first month. Most
    obviously, *Squid Game* needs to be featured in the Top Shows of the Week or Hottest
    Titles carousels, but where else should a breakout hit like this matter?'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们举个例子：截至目前，Netflix的节目《鱿鱼游戏》成为了该公司有史以来最受欢迎的系列，刷新了大量记录。《鱿鱼游戏》在第一个月就吸引了1.11亿观众。显而易见，《鱿鱼游戏》需要在本周热门节目或最热门标题的轮播中亮相，但是像这样的爆款还应该在哪些地方受到重视呢？
- en: 'The first important insight companies almost always ask for is *attribution*:
    if the numbers go up in a week, what led to that? Is there something important
    or special about launches that drove additional growth? How can we learn from
    those signals to do better in the future? In the case of *Squid Game*—a foreign-language
    show that saw massive interest from an English-speaking audience—executives might
    take away the inclination to invest more in shows from South Korea or in subtitled
    shows with high drama. The flip side of this coin is also important: when growth
    metrics lag, executives nearly always ask why. Being able to point to what was
    the most popular, and how it may have deviated from expectation, helps a lot.'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 公司几乎总是会首先寻求的第一个重要洞见是*归因*：如果数字在一周内上升，是什么导致了这一点？推动额外增长的重要或特别因素是什么？我们如何从这些信号中学习以在未来做得更好？在*Squid
    Game*这样的外语节目引起英语观众的巨大兴趣的情况下，高管可能会倾向于增加对来自韩国的节目或具有高戏剧性的字幕节目的投资。另一面同样重要：当增长指标滞后时，高管几乎总是会问为什么。能够指出什么是最受欢迎的，以及它可能如何偏离预期，会有很大帮助。
- en: The other important insight can feed back into recommendations; during exciting
    debuts like *Squid Game*, it’s easy to get caught up in the excitement as you
    see all your metrics go up and to the right, but might this negatively affect
    metrics also? If you have a show debuting the same week or two as *Squid Game*,
    you’ll be less enthusiastic about all this success. Overall, successes like this
    usually drive *incremental* growth, which is great for business, and in total,
    metrics will all probably look up. Other items, however, may have less successful
    launches due to a zero-sum game among the core user base. This can have a negative
    effect on longer-term metrics and can even make later recommendations less effective.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个重要的洞见可以反馈到推荐中；在像*Squid Game*这样令人兴奋的首播期间，当你看到所有指标都在上升时很容易被兴奋所影响，但这是否会对指标产生负面影响呢？如果你的节目和*Squid
    Game*在同一周或两周内首播，你可能对这一成功不那么热衷。总体而言，这种成功通常会带动*增量*增长，这对业务非常有利，整体而言，指标可能会全部看起来向好的方向发展。然而，其他项目可能由于核心用户群体之间的零和游戏而推出不成功。这可能会对长期指标产生负面影响，甚至可能使后续的推荐效果不佳。
- en: 'Later, you will learn about diversity of recommendations; there are many reasons
    to care about diversifying your recommendations, but here we observe one: diversifying
    can increase the overall ability to match your users with items. As you keep a
    broad base of users highly engaged, you increase your future opportunity for growth.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 后来，你将会了解到推荐的多样性；关于为何关心推荐多样化有很多理由，但我们在这里观察其中一个：多样化可以增加匹配用户与物品的整体能力。当你保持广泛的用户基础高度参与时，你增加了未来增长的机会。
- en: Finally, beyond surfacing the trending hits, another benefit of knowing what’s
    really hot on your platform or service is advertising. When a phenomenon starts,
    a huge advantage can result from priming the pump—making noise and driving publicity
    of the success. This sometimes leads to a network effect, and in these days of
    viral content and easy distribution, this can have multiplicative impacts on your
    platform’s growth.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在突显热门命中之外，了解平台或服务上真正热门的另一个好处是广告。当一个现象开始时，通过引导和推广成功可以带来巨大优势。有时这会导致网络效应，在这些天病毒式内容和简易传播，这可以对平台的增长产生多重影响。
- en: Summary
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: This constitutes the most basic aspects of formulating your recommendation problems
    and preparing yourself to solve them.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 这构成了制定推荐问题和为解决问题做好准备的最基本方面。
- en: The user-item matrix gave us a tool to summarize the relationship between users
    and items in the simplest case of numerical ratings and will generalize to more
    complicated models later. We saw our first notion of vector similarity, which
    will be expanded to a deep geometric notion of relevance. Next, we learned about
    the kinds of signals that users can provide via explicit and implicit actions.
    Finally, we learned how to capture these actions for training models.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 用户-物品矩阵为我们提供了一个工具，以数字评分的最简单情况总结用户和物品之间的关系，并且将在后续更复杂的模型中进行泛化。我们看到了第一个向量相似性的概念，它将扩展到深层次的相关性概念。接下来，我们了解了用户通过显式和隐式行动提供的信号类型。最后，我们学会了如何捕捉这些行动来训练模型。
- en: Now that we’ve finished our problem framing, we’ve got a bit of a math review
    for you. Don’t worry, you can keep your ruler and compass packed away, and you
    won’t be required to prove anything or compute any integrals. You will, however,
    see some important mathematical notions that will help you think clearly about
    expectations for your recommendation systems and ensure you’re asking the right
    questions.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们完成了问题框架，接下来为您进行一些数学复习。别担心，您可以将尺子和圆规收起来，无需证明任何事情或计算任何积分。然而，您会看到一些重要的数学概念，这些概念将帮助您清晰地思考推荐系统的期望，并确保您提出正确的问题。
