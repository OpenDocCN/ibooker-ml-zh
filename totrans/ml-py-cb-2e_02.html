<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 2. Loading Data" data-type="chapter" epub:type="chapter"><div class="chapter" id="loading-data">
<h1><span class="label">Chapter 2. </span>Loading Data</h1>
<section data-pdf-bookmark="2.0 Introduction" data-type="sect1"><div class="sect1" id="id32">
<h1>2.0 Introduction</h1>
<p>The first step in any machine learning endeavor is to get the raw data into our system. The raw data might be a logfile, dataset file, database, or cloud blob store such as Amazon S3. Furthermore, often we will want to retrieve data from multiple sources.</p>
<p>The recipes in this chapter look at methods of <a data-primary="loading data" data-type="indexterm" id="ix_load_data_ch2"/>loading data from a variety of sources, including CSV files and SQL databases. We also cover methods of generating simulated data with desirable properties for experimentation. Finally, while there are many ways to load data in the Python ecosystem, we will focus on using the pandas library’s extensive set of methods for loading external data, and using scikit-learn—​an open source machine learning library in Python—​for generating simulated data.</p>
</div></section>
<section data-pdf-bookmark="2.1 Loading a Sample Dataset" data-type="sect1"><div class="sect1" id="loading-a-sample-dataset">
<h1>2.1 Loading a Sample Dataset</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id466">
<h2>Problem</h2>
<p>You want to <a data-primary="scikit-learn library" data-secondary="sample dataset from" data-type="indexterm" id="ix_scikit_sample_data"/><a data-primary="loading data" data-secondary="sample dataset from scikit-learn library" data-type="indexterm" id="ix_load_data_sample"/>load a preexisting sample dataset from the scikit-learn library.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id985">
<h2>Solution</h2>
<p>scikit-learn comes with a number of popular datasets for you to use:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load scikit-learn's datasets</code>
<code class="kn">from</code> <code class="nn">sklearn</code> <code class="kn">import</code> <code class="n">datasets</code>

<code class="c1"># Load digits dataset</code>
<code class="n">digits</code> <code class="o">=</code> <code class="n">datasets</code><code class="o">.</code><code class="n">load_digits</code><code class="p">()</code>

<code class="c1"># Create features matrix</code>
<code class="n">features</code> <code class="o">=</code> <code class="n">digits</code><code class="o">.</code><code class="n">data</code>

<code class="c1"># Create target vector</code>
<code class="n">target</code> <code class="o">=</code> <code class="n">digits</code><code class="o">.</code><code class="n">target</code>

<code class="c1"># View first observation</code>
<code class="n">features</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code></pre>
<pre data-type="programlisting">array([  0.,   0.,   5.,  13.,   9.,   1.,   0.,   0.,   0.,   0.,  13.,
        15.,  10.,  15.,   5.,   0.,   0.,   3.,  15.,   2.,   0.,  11.,
         8.,   0.,   0.,   4.,  12.,   0.,   0.,   8.,   8.,   0.,   0.,
         5.,   8.,   0.,   0.,   9.,   8.,   0.,   0.,   4.,  11.,   0.,
         1.,  12.,   7.,   0.,   0.,   2.,  14.,   5.,  10.,  12.,   0.,
         0.,   0.,   0.,   6.,  13.,  10.,   0.,   0.,   0.])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id33">
<h2>Discussion</h2>
<p>Often we do not want to go through the work of loading, transforming,
and cleaning a real-world dataset before we can explore some machine
learning algorithm or method. Luckily, scikit-learn comes with some
common datasets we can quickly load. These datasets are often called
“toy” datasets because they are far smaller and cleaner than a dataset we would see in the real world. Some popular sample datasets in scikit-learn are:</p>
<dl>
<dt><code>load_iris</code></dt>
<dd>
<p>  Contains 150 <a data-primary="load_iris dataset" data-type="indexterm" id="id986"/>observations on the measurements of iris
flowers. It is a good dataset for exploring classification algorithms.</p>
</dd>
<dt><code>load_digits</code></dt>
<dd>
<p>  Contains 1,797 <a data-primary="load_digits dataset" data-type="indexterm" id="id987"/>observations from images of handwritten
digits. It is a good dataset for teaching image classification.</p>
</dd>
</dl>
<p>To see more <a data-primary="DESCR attribute" data-type="indexterm" id="id988"/>details on any of these datasets, you can print the <code>DESCR</code> attribute:<a data-primary="" data-startref="ix_load_data_sample" data-type="indexterm" id="id989"/><a data-primary="" data-startref="ix_scikit_sample_data" data-type="indexterm" id="id990"/></p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load scikit-learn's datasets</code>
<code class="kn">from</code> <code class="nn">sklearn</code> <code class="kn">import</code> <code class="n">datasets</code>

<code class="c1"># Load digits dataset</code>
<code class="n">digits</code> <code class="o">=</code> <code class="n">datasets</code><code class="o">.</code><code class="n">load_digits</code><code class="p">()</code>

<code class="c1"># Print the attribute</code>
<code class="nb">print</code><code class="p">(</code><code class="n">digits</code><code class="o">.</code><code class="n">DESCR</code><code class="p">)</code></pre>
<pre data-type="programlisting">.. _digits_dataset:

Optical recognition of handwritten digits dataset
--------------------------------------------------

**Data Set Characteristics:**

    :Number of Instances: 1797
    :Number of Attributes: 64
    :Attribute Information: 8x8 image of integer pixels in the range 0..16.
    :Missing Attribute Values: None
    :Creator: E. Alpaydin (alpaydin '@' boun.edu.tr)
    :Date: July; 1998
...</pre>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id991">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/WS1gc">scikit-learn toy datasets</a></p>
</li>
<li>
<p><a href="https://oreil.ly/0hukv">The Digit Dataset</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.2 Creating a Simulated Dataset" data-type="sect1"><div class="sect1" id="creating-a-simulated-dataset">
<h1>2.2 Creating a Simulated Dataset</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id34">
<h2>Problem</h2>
<p>You need to <a data-primary="loading data" data-secondary="generating simulated dataset" data-type="indexterm" id="ix_load_data_sim"/><a data-primary="simulated dataset, generating" data-type="indexterm" id="ix_sim_dataset_gen"/>generate a dataset of simulated data.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id35">
<h2>Solution</h2>
<p>scikit-learn offers many methods for creating simulated data. Of those,
three methods are particularly useful: <code>make_regression</code>, <code>make_classification</code>, and <code>make_blobs</code>.</p>
<p>When we want a dataset designed to be used with <a data-primary="make_regression method" data-type="indexterm" id="id992"/>linear regression,
<code>make_regression</code> is a good choice:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">make_regression</code>

<code class="c1"># Generate features matrix, target vector, and the true coefficients</code>
<code class="n">features</code><code class="p">,</code> <code class="n">target</code><code class="p">,</code> <code class="n">coefficients</code> <code class="o">=</code> <code class="n">make_regression</code><code class="p">(</code><code class="n">n_samples</code> <code class="o">=</code> <code class="mi">100</code><code class="p">,</code>
                                                 <code class="n">n_features</code> <code class="o">=</code> <code class="mi">3</code><code class="p">,</code>
                                                 <code class="n">n_informative</code> <code class="o">=</code> <code class="mi">3</code><code class="p">,</code>
                                                 <code class="n">n_targets</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
                                                 <code class="n">noise</code> <code class="o">=</code> <code class="mf">0.0</code><code class="p">,</code>
                                                 <code class="n">coef</code> <code class="o">=</code> <code class="kc">True</code><code class="p">,</code>
                                                 <code class="n">random_state</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>

<code class="c1"># View feature matrix and target vector</code>
<code class="nb">print</code><code class="p">(</code><code class="s1">'Feature Matrix</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code> <code class="n">features</code><code class="p">[:</code><code class="mi">3</code><code class="p">])</code>
<code class="nb">print</code><code class="p">(</code><code class="s1">'Target Vector</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code> <code class="n">target</code><code class="p">[:</code><code class="mi">3</code><code class="p">])</code></pre>
<pre data-type="programlisting">Feature Matrix
 [[ 1.29322588 -0.61736206 -0.11044703]
 [-2.793085    0.36633201  1.93752881]
 [ 0.80186103 -0.18656977  0.0465673 ]]
Target Vector
 [-10.37865986  25.5124503   19.67705609]</pre>
<p>If we are interested in creating a simulated dataset for <a data-primary="make_classification method" data-type="indexterm" id="id993"/>classification,
we can use <code>make_classification</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">make_classification</code>

<code class="c1"># Generate features matrix and target vector</code>
<code class="n">features</code><code class="p">,</code> <code class="n">target</code> <code class="o">=</code> <code class="n">make_classification</code><code class="p">(</code><code class="n">n_samples</code> <code class="o">=</code> <code class="mi">100</code><code class="p">,</code>
                                       <code class="n">n_features</code> <code class="o">=</code> <code class="mi">3</code><code class="p">,</code>
                                       <code class="n">n_informative</code> <code class="o">=</code> <code class="mi">3</code><code class="p">,</code>
                                       <code class="n">n_redundant</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code>
                                       <code class="n">n_classes</code> <code class="o">=</code> <code class="mi">2</code><code class="p">,</code>
                                       <code class="n">weights</code> <code class="o">=</code> <code class="p">[</code><code class="mf">.25</code><code class="p">,</code> <code class="mf">.75</code><code class="p">],</code>
                                       <code class="n">random_state</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>

<code class="c1"># View feature matrix and target vector</code>
<code class="nb">print</code><code class="p">(</code><code class="s1">'Feature Matrix</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code> <code class="n">features</code><code class="p">[:</code><code class="mi">3</code><code class="p">])</code>
<code class="nb">print</code><code class="p">(</code><code class="s1">'Target Vector</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code> <code class="n">target</code><code class="p">[:</code><code class="mi">3</code><code class="p">])</code></pre>
<pre data-type="programlisting">Feature Matrix
 [[ 1.06354768 -1.42632219  1.02163151]
 [ 0.23156977  1.49535261  0.33251578]
 [ 0.15972951  0.83533515 -0.40869554]]
Target Vector
 [1 0 0]</pre>
<p>Finally, if we want a dataset designed to work well with clustering
techniques, scikit-learn <a data-primary="make_blobs method" data-type="indexterm" id="id994"/>offers <code>make_blobs</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">make_blobs</code>

<code class="c1"># Generate features matrix and target vector</code>
<code class="n">features</code><code class="p">,</code> <code class="n">target</code> <code class="o">=</code> <code class="n">make_blobs</code><code class="p">(</code><code class="n">n_samples</code> <code class="o">=</code> <code class="mi">100</code><code class="p">,</code>
                              <code class="n">n_features</code> <code class="o">=</code> <code class="mi">2</code><code class="p">,</code>
                              <code class="n">centers</code> <code class="o">=</code> <code class="mi">3</code><code class="p">,</code>
                              <code class="n">cluster_std</code> <code class="o">=</code> <code class="mf">0.5</code><code class="p">,</code>
                              <code class="n">shuffle</code> <code class="o">=</code> <code class="kc">True</code><code class="p">,</code>
                              <code class="n">random_state</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>

<code class="c1"># View feature matrix and target vector</code>
<code class="nb">print</code><code class="p">(</code><code class="s1">'Feature Matrix</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code> <code class="n">features</code><code class="p">[:</code><code class="mi">3</code><code class="p">])</code>
<code class="nb">print</code><code class="p">(</code><code class="s1">'Target Vector</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code> <code class="n">target</code><code class="p">[:</code><code class="mi">3</code><code class="p">])</code></pre>
<pre data-type="programlisting">Feature Matrix
 [[ -1.22685609   3.25572052]
 [ -9.57463218  -4.38310652]
 [-10.71976941  -4.20558148]]
Target Vector
 [0 1 1]</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id36">
<h2>Discussion</h2>
<p>As might be apparent from the solutions, <code>make_regression</code> returns a feature matrix of float values and a target vector of float values,
while <code>make_classification</code> and <code>make_blobs</code> return a feature matrix of
float values and a target vector of integers representing membership in
a class.</p>
<p>scikit-learn’s simulated datasets offer extensive options to control
the type of data generated. scikit-learn’s documentation contains a full
description of all the parameters, but a few are worth noting.</p>
<p>In <code>make_regression</code> and <code>make_classification</code>, <code>n_informative</code>
determines the <a data-primary="make_regression method" data-type="indexterm" id="id995"/>number of features that are used to generate the target
vector. If <code>n_informative</code> is less than the total number of features
(<code>n_features</code>), the resulting dataset will have redundant features
that can be identified through feature selection techniques.</p>
<p>In <a data-primary="make_classification method" data-type="indexterm" id="id996"/>addition, <code>make_classification</code> contains a <code>weights</code> parameter that allows us to simulate datasets with imbalanced classes. For example,
<code>weights = [.25, .75]</code> would return a dataset with 25% of observations belonging to one class and 75% of observations belonging to a second
class.<a data-primary="" data-startref="ix_load_data_sim" data-type="indexterm" id="id997"/><a data-primary="" data-startref="ix_sim_dataset_gen" data-type="indexterm" id="id998"/></p>
<p>For <code>make_blobs</code>, the <code>centers</code> parameter <a data-primary="make_blobs method" data-type="indexterm" id="id999"/>determines the number of
clusters generated. Using the <code>matplotlib</code> visualization library, we can
visualize the clusters generated by <code>make_blobs</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>

<code class="c1"># View scatterplot</code>
<code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">features</code><code class="p">[:,</code><code class="mi">0</code><code class="p">],</code> <code class="n">features</code><code class="p">[:,</code><code class="mi">1</code><code class="p">],</code> <code class="n">c</code><code class="o">=</code><code class="n">target</code><code class="p">)</code>
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>
<figure class="width-60"><div class="figure">
<img alt="mpc2 02in01" height="391" src="assets/mpc2_02in01.png" width="536"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1000">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/VrtN3"><code>make_regression</code> documentation</a></p>
</li>
<li>
<p><a href="https://oreil.ly/rehc-"><code>make_classification</code> documentation</a></p>
</li>
<li>
<p><a href="https://oreil.ly/1LZAI"><code>make_blobs</code> documentation</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.3 Loading a CSV File" data-type="sect1"><div class="sect1" id="loading-a-csv-file">
<h1>2.3 Loading a CSV File</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id37">
<h2>Problem</h2>
<p>You need to import a <a data-primary="CSV (comma-separated value) file, loading data from" data-type="indexterm" id="ix_csv_comma_sep_file"/><a data-primary="loading data" data-secondary="from CSV file" data-secondary-sortas="CSV file" data-type="indexterm" id="ix_load_data_csv"/><a data-primary="comma-separated value (CSV) file, loading data from" data-type="indexterm" id="ix_comma_sep_file"/>comma-separated value (CSV) file.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id1001">
<h2>Solution</h2>
<p>Use the pandas library’s <code>read_csv</code> to load a local or hosted CSV file into a pandas DataFrame:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="c1"># Create URL</code>
<code class="n">url</code> <code class="o">=</code> <code class="s1">'https://raw.githubusercontent.com/chrisalbon/sim_data/master/data.csv'</code>

<code class="c1"># Load dataset</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="n">url</code><code class="p">)</code>

<code class="c1"># View first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>integer</th>
<th>datetime</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5</td>
<td>2015-01-01 00:00:00</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>5</td>
<td>2015-01-01 00:00:01</td>
<td>0</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id38">
<h2>Discussion</h2>
<p>There are two things to note about loading CSV files. First, it is often
useful to take a quick look at the contents of the file before loading.
It can be very helpful to see how a dataset is structured beforehand and
what parameters we need to set to load in the file. Second, <code>read_csv</code>
has over 30 parameters and therefore the documentation can be daunting.
Fortunately, those parameters are mostly there to allow it to handle a
wide variety of CSV formats.</p>
<p>CSV files get their names from the fact that the values are literally separated by commas (e.g., one row might be <code>2,"2015-01-01 00:00:00",0</code>); however, it is common for CSV files to use other separators, such as tabs <a data-primary="tab-separated value (TSV) files" data-type="indexterm" id="id1002"/><a data-primary="TSV (tab-separated value) files" data-type="indexterm" id="id1003"/>(which are referred to as TSV files). The pandas <code>sep</code> parameter allows us to define the delimiter used in the file. Although it is not always the case, a common formatting issue with CSV files is that the first line of the file is used to define column headers (e.g., <code>integer, datetime, category</code> in our solution). The <code>header</code> parameter allows us to specify if or where a header row exists. If a header row does not exist, we set <code>header=None</code>.</p>
<p>The <code>read_csv</code> function <a data-primary="read_csv function" data-type="indexterm" id="id1004"/>returns a pandas DataFrame: a common and useful object for working with tabular data that we’ll cover in more depth throughout this book.<a data-primary="" data-startref="ix_comma_sep_file" data-type="indexterm" id="id1005"/><a data-primary="" data-startref="ix_csv_comma_sep_file" data-type="indexterm" id="id1006"/><a data-primary="" data-startref="ix_load_data_csv" data-type="indexterm" id="id1007"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="2.4 Loading an Excel File" data-type="sect1"><div class="sect1" id="loading-an-excel-file">
<h1>2.4 Loading an Excel File</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id39">
<h2>Problem</h2>
<p>You need to import an <a data-primary="Excel file, loading data from" data-type="indexterm" id="id1008"/><a data-primary="loading data" data-secondary="from Excel file" data-secondary-sortas="Excel file" data-type="indexterm" id="id1009"/>Excel spreadsheet.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id40">
<h2>Solution</h2>
<p>Use the <a data-primary="read_excel function" data-type="indexterm" id="id1010"/>pandas library’s <code>read_excel</code> to load an Excel spreadsheet:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="c1"># Create URL</code>
<code class="n">url</code> <code class="o">=</code> <code class="s1">'https://raw.githubusercontent.com/chrisalbon/sim_data/master/data.xlsx'</code>

<code class="c1"># Load data</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="n">url</code><code class="p">,</code> <code class="n">sheet_name</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">header</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code>

<code class="c1"># View the first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>integer</th>
<th>datetime</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr>
<td/>
<td>5</td>
<td>2015-01-01 00:00:00</td>
<td>0</td>
</tr>
<tr>
<th>0</th>
<td>5</td>
<td>2015-01-01 00:00:01</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>9</td>
<td>2015-01-01 00:00:02</td>
<td>0</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id1011">
<h2>Discussion</h2>
<p>This solution is similar to our solution for reading CSV files. The main
difference is the additional parameter, <code>sheet_name</code>, that specifies which sheet in the Excel file we wish to load. <code>sheet_name</code> can accept both strings, containing the name of the sheet, and integers, pointing to sheet positions (zero-indexed). If we need to load multiple sheets, we include them as a list. For example, <code>sheet_name=[0,1,2, "Monthly Sales"]</code> will return a dictionary of pandas DataFrames containing the first, second, and third sheets, and the sheet named <code>Monthly Sales</code>.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="2.5 Loading a JSON File" data-type="sect1"><div class="sect1" id="loading-a-json-file">
<h1>2.5 Loading a JSON File</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id41">
<h2>Problem</h2>
<p>You need to load a <a data-primary="JSON file, loading data from" data-type="indexterm" id="id1012"/><a data-primary="loading data" data-secondary="from JSON file" data-secondary-sortas="JSON file" data-type="indexterm" id="id1013"/>JSON file for data preprocessing.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id42">
<h2>Solution</h2>
<p>The pandas <a data-primary="read_json function" data-type="indexterm" id="id1014"/>library provides <code>read_json</code> to convert a JSON file into a
pandas object:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="c1"># Create URL</code>
<code class="n">url</code> <code class="o">=</code> <code class="s1">'https://raw.githubusercontent.com/chrisalbon/sim_data/master/data.json'</code>

<code class="c1"># Load data</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="n">url</code><code class="p">,</code> <code class="n">orient</code><code class="o">=</code><code class="s1">'columns'</code><code class="p">)</code>

<code class="c1"># View the first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>category</th>
<th>datetime</th>
<th>integer</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>2015-01-01 00:00:00</td>
<td>5</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>2015-01-01 00:00:01</td>
<td>5</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id1015">
<h2>Discussion</h2>
<p>Importing JSON files into pandas is similar to the last few recipes we
have seen. The key difference is the <code>orient</code> parameter, which indicates
to pandas how the JSON file is structured. However, it might take some
experimenting to figure out which argument (<code>split</code>, <code>records</code>, <code>index</code>,
<code>columns</code>, or <code>values</code>) is the right one. Another helpful tool pandas
offers is <code>json_normalize</code>, which can help convert semistructured JSON data into a pandas DataFrame.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1016">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/nuvIB"><code>json_normalize</code> documentation</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.6 Loading a Parquet File" data-type="sect1"><div class="sect1" id="loading-a-parquet-file">
<h1>2.6 Loading a Parquet File</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id43">
<h2>Problem</h2>
<p>You need to load a <a data-primary="Apache Parquet" data-type="indexterm" id="id1017"/><a data-primary="Parquet file, loading data from" data-type="indexterm" id="id1018"/><a data-primary="loading data" data-secondary="from Parquet file" data-secondary-sortas="Parquet file" data-type="indexterm" id="id1019"/>Parquet file.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id44">
<h2>Solution</h2>
<p>The <a data-primary="read_parquet function" data-type="indexterm" id="id1020"/>pandas <code>read_parquet</code> function allows us to read in Parquet files:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="c1"># Create URL</code>
<code class="n">url</code> <code class="o">=</code> <code class="s1">'https://machine-learning-python-cookbook.s3.amazonaws.com/data.parquet'</code>

<code class="c1"># Load data</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_parquet</code><code class="p">(</code><code class="n">url</code><code class="p">)</code>

<code class="c1"># View the first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>category</th>
<th>datetime</th>
<th>integer</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>2015-01-01 00:00:00</td>
<td>5</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>2015-01-01 00:00:01</td>
<td>5</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id45">
<h2>Discussion</h2>
<p>Parquet is a popular data storage format in the large data space. It is often used with big data tools such as Hadoop and Spark. While <a data-primary="PySpark" data-type="indexterm" id="id1021"/>PySpark is outside the focus of this book, it’s highly likely companies operating on a large scale will use an efficient data storage format such as Parquet, and it’s valuable to know how to read it into a dataframe and manipulate it.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1022">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/M5bRq">Apache Parquet documentation</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.7 Loading an Avro File" data-type="sect1"><div class="sect1" id="loading-a-avro-file">
<h1>2.7 Loading an Avro File</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id46">
<h2>Problem</h2>
<p>You need to load an <a data-primary="Apache Avro" data-type="indexterm" id="id1023"/><a data-primary="Avro file, loading data from" data-type="indexterm" id="id1024"/><a data-primary="loading data" data-secondary="from Avro file" data-secondary-sortas="Avro file" data-type="indexterm" id="id1025"/>Avro file into a pandas DataFrame.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id47">
<h2>Solution</h2>
<p>The use <a data-primary="pandavro library" data-type="indexterm" id="id1026"/><a data-primary="read_avro method" data-type="indexterm" id="id1027"/>the <code>pandavro</code> library’s <code>read_avro</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">requests</code>
<code class="kn">import</code> <code class="nn">pandavro</code> <code class="k">as</code> <code class="nn">pdx</code>

<code class="c1"># Create URL</code>
<code class="n">url</code> <code class="o">=</code> <code class="s1">'https://machine-learning-python-cookbook.s3.amazonaws.com/data.avro'</code>

<code class="c1"># Download file</code>
<code class="n">r</code> <code class="o">=</code> <code class="n">requests</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="n">url</code><code class="p">)</code>
<code class="nb">open</code><code class="p">(</code><code class="s1">'data.avro'</code><code class="p">,</code> <code class="s1">'wb'</code><code class="p">)</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">r</code><code class="o">.</code><code class="n">content</code><code class="p">)</code>

<code class="c1"># Load data</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pdx</code><code class="o">.</code><code class="n">read_avro</code><code class="p">(</code><code class="s1">'data.avro'</code><code class="p">)</code>

<code class="c1"># View the first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>category</th>
<th>datetime</th>
<th>integer</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>2015-01-01 00:00:00</td>
<td>5</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>2015-01-01 00:00:01</td>
<td>5</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id1028">
<h2>Discussion</h2>
<p>Apache Avro is an open source, binary data format that relies on schemas for the data structure. At the time of writing, it is not as common as Parquet. However, large binary data formats such as Avro, thrift, and Protocol Buffers are growing in popularity due to their efficient nature. If you work with large data systems, you’re likely to run into one of these formats in the near future.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1029">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/Y1TJA">Apache Avro documentation</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.8 Querying a SQLite Database" data-type="sect1"><div class="sect1" id="querying-a-sql-database">
<h1>2.8 Querying a SQLite Database</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id48">
<h2>Problem</h2>
<p>You need to load data from a <a data-primary="loading data" data-secondary="SQLite database query" data-type="indexterm" id="ix_load_data_sql_query"/><a data-primary="SQLite database query" data-type="indexterm" id="ix_sqlite_query"/>database using structured query
language (SQL).</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id49">
<h2>Solution</h2>
<p>pandas’ <code>read_sql_query</code> allows us to make an <a data-primary="read_sql_query function" data-type="indexterm" id="id1030"/>SQL query to a database and
load it:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load libraries</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>
<code class="kn">from</code> <code class="nn">sqlalchemy</code> <code class="kn">import</code> <code class="n">create_engine</code>

<code class="c1"># Create a connection to the database</code>
<code class="n">database_connection</code> <code class="o">=</code> <code class="n">create_engine</code><code class="p">(</code><code class="s1">'sqlite:///sample.db'</code><code class="p">)</code>

<code class="c1"># Load data</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_sql_query</code><code class="p">(</code><code class="s1">'SELECT * FROM data'</code><code class="p">,</code> <code class="n">database_connection</code><code class="p">)</code>

<code class="c1"># View first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>first_name</th>
<th>last_name</th>
<th>age</th>
<th>preTestScore</th>
<th>postTestScore</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jason</td>
<td>Miller</td>
<td>42</td>
<td>4</td>
<td>25</td>
</tr>
<tr>
<th>1</th>
<td>Molly</td>
<td>Jacobson</td>
<td>52</td>
<td>24</td>
<td>94</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id50">
<h2>Discussion</h2>
<p>SQL is the lingua franca for pulling data from databases. In this recipe we first use
<code>create_engine</code> to define a connection to an SQL database engine called SQLite. Next we use pandas’ <code>read_sql_query</code> to query that database
using SQL and put the results in a DataFrame.</p>
<p>SQL is a language in its own right and, while beyond the scope of this
book, it is certainly worth knowing for anyone wanting to learn about machine
learning. Our SQL query, <code>SELECT * FROM data</code>, asks the database to give
us all columns (<code>*</code>) from the table called <code>data</code>.</p>
<p>Note that this is one of a few recipes in this book that will not run without extra code. Specifically, <code>create_engine('sqlite:///sample.db')</code> assumes that an SQLite database already exists.<a data-primary="" data-startref="ix_load_data_sql_query" data-type="indexterm" id="id1031"/><a data-primary="" data-startref="ix_sqlite_query" data-type="indexterm" id="id1032"/></p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1033">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/8Y91T">SQLite</a></p>
</li>
<li>
<p><a href="https://oreil.ly/A7H1m">W3Schools SQL Tutorial</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.9 Querying a Remote SQL Database" data-type="sect1"><div class="sect1" id="id681">
<h1>2.9 Querying a Remote SQL Database</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id51">
<h2>Problem</h2>
<p>You need to connect to, and read from, a <a data-primary="remote SQL database query" data-type="indexterm" id="ix_rem_sql_query"/><a data-primary="SQL, remote database query" data-type="indexterm" id="ix_sql_rem_query"/><a data-primary="loading data" data-secondary="remote SQL database query" data-type="indexterm" id="ix_load_data_rem_sql_query"/>remote SQL database.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id52">
<h2>Solution</h2>
<p>Create a <a data-primary="pymysql library" data-type="indexterm" id="id1034"/>connection with <code>pymysql</code> and read it into a dataframe with pandas:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Import libraries</code>
<code class="kn">import</code> <code class="nn">pymysql</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="c1"># Create a DB connection</code>
<code class="c1"># Use the following example to start a DB instance</code>
<code class="c1"># https://github.com/kylegallatin/mysql-db-example</code>
<code class="n">conn</code> <code class="o">=</code> <code class="n">pymysql</code><code class="o">.</code><code class="n">connect</code><code class="p">(</code>
    <code class="n">host</code><code class="o">=</code><code class="s1">'localhost'</code><code class="p">,</code>
    <code class="n">user</code><code class="o">=</code><code class="s1">'root'</code><code class="p">,</code>
    <code class="n">password</code> <code class="o">=</code> <code class="s2">""</code><code class="p">,</code>
    <code class="n">db</code><code class="o">=</code><code class="s1">'db'</code><code class="p">,</code>
<code class="p">)</code>

<code class="c1"># Read the SQL query into a dataframe</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_sql</code><code class="p">(</code><code class="s2">"select * from data"</code><code class="p">,</code> <code class="n">conn</code><code class="p">)</code>

<code class="c1"># View the first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>integer</th>
<th>datetime</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5</td>
<td>2015-01-01 00:00:00</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>5</td>
<td>2015-01-01 00:00:01</td>
<td>0</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id53">
<h2>Discussion</h2>
<p>Of all of the recipes presented in this chapter, this is probably the one we will use most in the real world. While connecting and reading from an example <code>sqlite</code> database is useful, it’s likely not representative of tables you’ll need to connect to in an enterprise environment. Most SQL instances that you’ll connect to will require you to connect to the host and port of a remote machine, specifying a username and password for authentication. This example requires you <a href="https://oreil.ly/Sxjqz">to start a running SQL instance locally</a> that mimics a remote server on localhost so that you can get a sense of the workflow.<a data-primary="" data-startref="ix_load_data_rem_sql_query" data-type="indexterm" id="id1035"/><a data-primary="" data-startref="ix_rem_sql_query" data-type="indexterm" id="id1036"/><a data-primary="" data-startref="SQL, remote database query" data-type="indexterm" id="id1037"/></p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1038">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/8zSnj">PyMySQL documentation</a></p>
</li>
<li>
<p><a href="https://oreil.ly/Yb7sH">pandas Read SQL documentation</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.10 Loading Data from a Google Sheet" data-type="sect1"><div class="sect1" id="id682">
<h1>2.10 Loading Data from a Google Sheet</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id54">
<h2>Problem</h2>
<p>You need to read in data directly from a <a data-primary="Google Sheet, loading data from" data-type="indexterm" id="id1039"/><a data-primary="loading data" data-secondary="from Google Sheet" data-secondary-sortas="Google Sheet" data-type="indexterm" id="id1040"/>Google Sheet.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id55">
<h2>Solution</h2>
<p>Use <a data-primary="read_csv function" data-type="indexterm" id="id1041"/>pandas <code>read_CSV</code> and pass a URL that exports the Google Sheet as a CSV:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Import libraries</code>
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="c1"># Google Sheet URL that downloads the sheet as a CSV</code>
<code class="n">url</code> <code class="o">=</code> <code class="s2">"https://docs.google.com/spreadsheets/d/"</code>\
      <code class="s2">"1ehC-9otcAuitqnmWksqt1mOrTRCL38dv0K9UjhwzTOA/export?format=csv"</code>

<code class="c1"># Read the CSV into a dataframe</code>
<code class="n">dataframe</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="n">url</code><code class="p">)</code>

<code class="c1"># View the first two rows</code>
<code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code></pre>
<table>
<thead>
<tr>
<th/>
<th>integer</th>
<th>datetime</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5</td>
<td>2015-01-01 00:00:00</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>5</td>
<td>2015-01-01 00:00:01</td>
<td>0</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id1042">
<h2>Discussion</h2>
<p>While Google Sheets can easily be downloaded, it’s sometimes helpful to be able to read them directly into Python without any intermediate steps. The 
<span class="keep-together"><code>/export?format=csv</code></span> query parameter at the end of the URL above creates an endpoint from which we can either download the file or read it into pandas.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1043">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/GRLzg">Google Sheets API</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.11 Loading Data from an S3 Bucket" data-type="sect1"><div class="sect1" id="id683">
<h1>2.11 Loading Data from an S3 Bucket</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id56">
<h2>Problem</h2>
<p>You need to read a CSV file from an <a data-primary="loading data" data-secondary="from S3 bucket" data-secondary-sortas="S3 bucket" data-type="indexterm" id="id1044"/><a data-primary="S3 bucket, loading data from" data-type="indexterm" id="id1045"/>S3 bucket you have access to.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id1046">
<h2>Solution</h2>
<p>Add storage options to pandas giving it access to the S3 object:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="c1"># Import libraries</code><code>
</code><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="k">as</code><code> </code><code class="nn">pd</code><code>
</code><code>
</code><code class="c1"># S3 path to CSV</code><code>
</code><code class="n">s3_uri</code><code> </code><code class="o">=</code><code> </code><code class="s2">"</code><code class="s2">s3://machine-learning-python-cookbook/data.csv</code><code class="s2">"</code><code>
</code><code>
</code><code class="c1"># Set AWS credentials (replace with your own)</code><code>
</code><code class="n">ACCESS_KEY_ID</code><code> </code><code class="o">=</code><code> </code><code class="s2">"</code><em><code class="s2">xxxxxxxxxxxxx</code></em><code class="s2">"</code><code>
</code><code class="n">SECRET_ACCESS_KEY</code><code> </code><code class="o">=</code><code> </code><code class="s2">"</code><em><code class="s2">xxxxxxxxxxxxxxxx</code></em><code class="s2">"</code><code>
</code><code>
</code><code class="c1"># Read the CSV into a dataframe</code><code>
</code><code class="n">dataframe</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="n">s3_uri</code><code class="p">,</code><code class="n">storage_options</code><code class="o">=</code><code class="p">{</code><code>
</code><code>        </code><code class="s2">"</code><code class="s2">key</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">ACCESS_KEY_ID</code><code class="p">,</code><code>
</code><code>        </code><code class="s2">"</code><code class="s2">secret</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">SECRET_ACCESS_KEY</code><code class="p">,</code><code>
</code><code>  </code><code class="p">}</code><code>
</code><code class="p">)</code><code>
</code><code>
</code><code class="c1"># View first two rows</code><code>
</code><code class="n">dataframe</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code>
</code></pre>
<table>
<thead>
<tr>
<th/>
<th>integer</th>
<th>datetime</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5</td>
<td>2015-01-01 00:00:00</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>5</td>
<td>2015-01-01 00:00:01</td>
<td>0</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id1047">
<h2>Discussion</h2>
<p>Many enterprises now keep data in cloud provider blob stores such as Amazon S3 or Google Cloud Storage (GCS). It’s common for machine learning practitioners to connect to these sources to retrieve data. Although the S3 URI (<code>s3://machine-learning-python-cookbook/data.csv</code>) is public, it still requires you to provide your own AWS access credentials to access it. It’s worth noting that public objects also have HTTP URLs from which they can download files, <a href="https://oreil.ly/byelc">such as this one for the CSV file</a>.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1048">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/E-CZX">Amazon S3</a></p>
</li>
<li>
<p><a href="https://oreil.ly/aHBBb">AWS Security Credentials</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="2.12 Loading Unstructured Data" data-type="sect1"><div class="sect1" id="id684">
<h1>2.12 Loading Unstructured Data</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id467">
<h2>Problem</h2>
<p>You need to load <a data-primary="unstructured data" data-secondary="loading" data-type="indexterm" id="id1049"/><a data-primary="loading data" data-secondary="unstructured data" data-type="indexterm" id="id1050"/>unstructured data like text or images.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id57">
<h2>Solution</h2>
<p>Use the base <a data-primary="open function" data-type="indexterm" id="id1051"/>Python <code>open</code> function to load the information:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Import libraries</code>
<code class="kn">import</code> <code class="nn">requests</code>

<code class="c1"># URL to download the txt file from</code>
<code class="n">txt_url</code> <code class="o">=</code> <code class="s2">"https://machine-learning-python-cookbook.s3.amazonaws.com/text.txt"</code>

<code class="c1"># Get the txt file</code>
<code class="n">r</code> <code class="o">=</code> <code class="n">requests</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="n">txt_url</code><code class="p">)</code>

<code class="c1"># Write it to text.txt locally</code>
<code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'text.txt'</code><code class="p">,</code> <code class="s1">'wb'</code><code class="p">)</code> <code class="k">as</code> <code class="n">f</code><code class="p">:</code>
    <code class="n">f</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">r</code><code class="o">.</code><code class="n">content</code><code class="p">)</code>

<code class="c1"># Read in the file</code>
<code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'text.txt'</code><code class="p">,</code> <code class="s1">'r'</code><code class="p">)</code> <code class="k">as</code> <code class="n">f</code><code class="p">:</code>
    <code class="n">text</code> <code class="o">=</code> <code class="n">f</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>

<code class="c1"># Print the content</code>
<code class="nb">print</code><code class="p">(</code><code class="n">text</code><code class="p">)</code></pre>
<pre data-type="programlisting">Hello there!</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id58">
<h2>Discussion</h2>
<p>While structured data can easily be read in from CSV, JSON, or various databases, unstructured data can be more challenging and may require custom processing down the line. Sometimes it’s helpful to open and read in files using Python’s basic <code>open</code> function. This allows us to open files and then read the content of that file.<a data-primary="" data-startref="ix_load_data_ch2" data-type="indexterm" id="id1052"/></p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id1053">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/Xuuom">Python’s open function</a></p>
</li>
<li>
<p><a href="https://oreil.ly/UyZnL">Context managers in Python</a></p>
</li>
</ul>
</div></section>
</div></section>
</div></section></div></body></html>