<html><head></head><body><section data-pdf-bookmark="Chapter 6. Exploring" data-type="chapter" epub:type="chapter"><div class="chapter" id="idm46066901910264">&#13;
<h1><span class="label">Chapter 6. </span>Exploring</h1>&#13;
&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-type="indexterm" id="ix_ch06-asciidoc0"/>It has been said that it is easier to take a <a data-primary="subject matter expert (SME)" data-secondary="and nuance in data" data-type="indexterm" id="idm46066901739928"/>SME and train them in data science than the reverse. I’m not sure I agree with that 100%, but there is truth that data has nuance and an SME can help tease that apart. By understanding the business and the data, they are able to create better models and have a better impact on their business.</p>&#13;
&#13;
<p>Before I create a model, I will do some exploratory data analysis. This gives me a feel for the data, but also is a great excuse to meet and discuss issues with business units that control that data.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Data Size" data-type="sect1"><div class="sect1" id="idm46066901747096">&#13;
<h1>Data Size</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="data size" data-type="indexterm" id="idm46066901745896"/>Again, we are using the Titanic dataset here. <a data-primary="pandas" data-secondary="determining data size" data-type="indexterm" id="idm46066901744824"/>The pandas <code>.shape</code> property will return a tuple of the number of rows and <span class="keep-together">columns:</span></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">shape</code>&#13;
<code class="go">(1309, 13)</code></pre>&#13;
&#13;
<p>We can see that this dataset has 1,309 rows and 13 columns.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Summary Stats" data-type="sect1"><div class="sect1" id="idm46066901758424">&#13;
<h1>Summary Stats</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="summary statistics" data-type="indexterm" id="idm46066901757272"/><a data-primary="pandas" data-secondary="summary stats" data-type="indexterm" id="idm46066901756328"/><a data-primary="summary statistics" data-type="indexterm" id="idm46066901711752"/>We can use pandas to get summary statistics for our data. The&#13;
<code>.describe</code> method will also give us the count of non-NaN values. Let’s&#13;
look at the results for the first and last columns:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">describe</code><code class="p">()</code><code class="o">.</code><code class="n">iloc</code><code class="p">[:,</code> <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="o">-</code><code class="mi">1</code><code class="p">]]</code>&#13;
<code class="go">            pclass   embarked_S</code>&#13;
<code class="go">count  1309.000000  1309.000000</code>&#13;
<code class="go">mean     -0.012831     0.698243</code>&#13;
<code class="go">std       0.995822     0.459196</code>&#13;
<code class="go">min      -1.551881     0.000000</code>&#13;
<code class="go">25%      -0.363317     0.000000</code>&#13;
<code class="go">50%       0.825248     1.000000</code>&#13;
<code class="go">75%       0.825248     1.000000</code>&#13;
<code class="go">max       0.825248     1.000000</code></pre>&#13;
&#13;
<p>The count row tells us that both of these columns are filled in. There are no missing values. We also have the mean, standard deviation, minimum, maximum, and quartile values.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="pandas" data-secondary="iloc attribute" data-type="indexterm" id="idm46066901676760"/>A pandas DataFrame has an <code>iloc</code> attribute that we can do&#13;
index operations on. It will let us pick out rows and columns&#13;
by index location. We pass in the row positions as a scalar, list, or&#13;
slice, and then we can add a comma and pass in the column&#13;
positions as a scalar, list, or slice.</p>&#13;
&#13;
<p>Here we pull out the second and fifth row, and the last three columns:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">iloc</code><code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="o">-</code><code class="mi">3</code><code class="p">:]</code>&#13;
<code class="go">     sex_male  embarked_Q  embarked_S</code>&#13;
<code class="go">677       1.0           0           1</code>&#13;
<code class="go">864       0.0           0           1</code></pre>&#13;
&#13;
<p>There is also a <code>.loc</code> attribute, and we can put out rows and&#13;
columns based on name (rather than position). Here is the&#13;
same portion of the DataFrame:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">loc</code><code class="p">[[</code><code class="mi">677</code><code class="p">,</code> <code class="mi">864</code><code class="p">],</code> <code class="s">"sex_male"</code><code class="p">:]</code>&#13;
<code class="go">     sex_male  embarked_Q  embarked_S</code>&#13;
<code class="go">677       1.0           0           1</code>&#13;
<code class="go">864       0.0           0           1</code></pre>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Histogram" data-type="sect1"><div class="sect1" id="idm46066901758120">&#13;
<h1>Histogram</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="histograms for" data-type="indexterm" id="idm46066901586840"/><a data-primary="histograms" data-type="indexterm" id="idm46066901585896"/>A histogram is a great tool to visualize numeric data. You can see how&#13;
many modes there are as well as look at the distribution (see <a data-type="xref" href="#id7">Figure 6-1</a>). <a data-primary="pandas" data-secondary="histograms with" data-type="indexterm" id="idm46066901584152"/>The pandas&#13;
library has a <code>.plot</code> method to show histograms:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">fare</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">kind</code><code class="o">=</code><code class="s">"hist"</code><code class="p">,</code> <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0601.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id7">&#13;
<img alt="Pandas histogram." src="assets/mlpr_0601.png"/>&#13;
<h6><span class="label">Figure 6-1. </span>Pandas histogram.</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="seaborn" data-secondary="histograms with" data-type="indexterm" id="idm46066901479256"/>Using the seaborn library, we can plot a histogram of continuous&#13;
values against the target (see <a data-type="xref" href="#iddist2">Figure 6-2</a>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="go">fig, ax = plt.subplots(figsize=(12, 8))</code>&#13;
<code class="go">mask = y_train == 1</code>&#13;
<code class="go">ax = sns.distplot(X_train[mask].fare, label='survived')</code>&#13;
<code class="go">ax = sns.distplot(X_train[~mask].fare, label='died')</code>&#13;
<code class="go">ax.set_xlim(-1.5, 1.5)</code>&#13;
<code class="go">ax.legend()</code>&#13;
<code class="go">fig.savefig('images/mlpr_0602.png', dpi=300, bbox_inches='tight')</code></pre>&#13;
&#13;
<figure><div class="figure" id="iddist2">&#13;
<img alt="Seaborn histogram." src="assets/mlpr_0602.png"/>&#13;
<h6><span class="label">Figure 6-2. </span>Seaborn histogram.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Scatter Plot" data-type="sect1"><div class="sect1" id="idm46066901469320">&#13;
<h1>Scatter Plot</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="scatter plot for" data-type="indexterm" id="idm46066901467848"/><a data-primary="scatter plot" data-secondary="exploratory data analysis with" data-type="indexterm" id="idm46066901466904"/>A scatter plot shows the relationship between two numeric columns (see <a data-type="xref" href="#id8">Figure 6-3</a>).&#13;
<a data-primary="pandas" data-secondary="scatter plot generation" data-type="indexterm" id="idm46066901465064"/>Again, this is easy with pandas. Adjust the <code>alpha</code> parameter if you&#13;
have overlapping data:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">plot</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">x</code><code class="o">=</code><code class="s">"age"</code><code class="p">,</code> <code class="n">y</code><code class="o">=</code><code class="s">"fare"</code><code class="p">,</code> <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.3</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0603.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id8">&#13;
<img alt="Pandas scatter plot." src="assets/mlpr_0603.png"/>&#13;
<h6><span class="label">Figure 6-3. </span>Pandas scatter plot.</h6>&#13;
</div></figure>&#13;
&#13;
<p>There doesn’t appear to be much correlation between these two features. <a data-primary="Pearson correlation" data-type="indexterm" id="idm46066901365592"/>We can do Pearson correlation between two (pandas) columns with the&#13;
<code>.corr</code> method to quantify the correlation:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">age</code><code class="o">.</code><code class="n">corr</code><code class="p">(</code><code class="n">X</code><code class="o">.</code><code class="n">fare</code><code class="p">)</code>&#13;
<code class="go">0.17818151568062093</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Joint Plot" data-type="sect1"><div class="sect1" id="idm46066901468952">&#13;
<h1>Joint Plot</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="joint plot for" data-type="indexterm" id="idm46066901357800"/><a data-primary="joint plot, exploratory data analysis with" data-type="indexterm" id="idm46066901356856"/><a data-primary="Yellowbrick" data-secondary="scatter plot" data-type="indexterm" id="idm46066901356216"/>Yellowbrick has a fancier scatter plot that includes histograms on the&#13;
edge as well as a regression line called a <em>joint plot</em> (see <a data-type="xref" href="#id9">Figure 6-4</a>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">yellowbrick.features</code> <code class="kn">import</code> <code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">JointPlotVisualizer</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">jpv</code> <code class="o">=</code> <code class="n">JointPlotVisualizer</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">feature</code><code class="o">=</code><code class="s">"age"</code><code class="p">,</code> <code class="n">target</code><code class="o">=</code><code class="s">"fare"</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">jpv</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">X</code><code class="p">[</code><code class="s">"age"</code><code class="p">],</code> <code class="n">X</code><code class="p">[</code><code class="s">"fare"</code><code class="p">])</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">jpv</code><code class="o">.</code><code class="n">poof</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0604.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id9">&#13;
<img alt="Yellowbrick joint plot." src="assets/mlpr_0604.png"/>&#13;
<h6><span class="label">Figure 6-4. </span>Yellowbrick joint plot.</h6>&#13;
</div></figure>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>In this <code>.fit</code> method, <code>X</code> and <code>y</code> refer to a column each. <span class="keep-together">Usually,</span> the&#13;
<code>X</code> is a DataFrame, not a series.</p>&#13;
</div>&#13;
&#13;
<p class="pagebreak-before"><a data-primary="seaborn" data-secondary="joint plot creation" data-type="indexterm" id="idm46066901220648"/>You can also use the <a href="https://seaborn.pydata.org">seaborn</a> library to create a joint plot (see <a data-type="xref" href="#id10">Figure 6-5</a>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">seaborn</code> <code class="kn">import</code> <code class="n">jointplot</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code> <code class="o">=</code> <code class="n">X</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code><code class="p">[</code><code class="s">"target"</code><code class="p">]</code> <code class="o">=</code> <code class="n">y</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">p</code> <code class="o">=</code> <code class="n">jointplot</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="s">"age"</code><code class="p">,</code> <code class="s">"fare"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">new_df</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s">"reg"</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">p</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0605.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id10">&#13;
<img alt="Seaborn joint plot." src="assets/mlpr_0605.png"/>&#13;
<h6><span class="label">Figure 6-5. </span>Seaborn joint plot.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Pair Grid" data-type="sect1"><div class="sect1" id="idm46066901103080">&#13;
<h1>Pair Grid</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="pair grid for" data-type="indexterm" id="idm46066901101848"/><a data-primary="pair grid" data-type="indexterm" id="idm46066901100904"/><a data-primary="seaborn" data-secondary="pair grid creation" data-type="indexterm" id="idm46066901100232"/>The seaborn library can create a pair grid (see <a data-type="xref" href="#id11">Figure 6-6</a>). This plot is&#13;
a matrix of columns and kernel density estimations. To&#13;
color by a column from a DataFrame, use the <code>hue</code> parameter. By coloring with the target,&#13;
we can see if features have different effects on the target:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">seaborn</code> <code class="kn">import</code> <code class="n">pairplot</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code> <code class="o">=</code> <code class="n">X</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code><code class="p">[</code><code class="s">"target"</code><code class="p">]</code> <code class="o">=</code> <code class="n">y</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">vars</code> <code class="o">=</code> <code class="p">[</code><code class="s">"pclass"</code><code class="p">,</code> <code class="s">"age"</code><code class="p">,</code> <code class="s">"fare"</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">p</code> <code class="o">=</code> <code class="n">pairplot</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">new_df</code><code class="p">,</code> <code class="nb">vars</code><code class="o">=</code><code class="nb">vars</code><code class="p">,</code> <code class="n">hue</code><code class="o">=</code><code class="s">"target"</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s">"reg"</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">p</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0606.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id11">&#13;
<img alt="Seaborn pair grid." src="assets/mlpr_0606.png"/>&#13;
<h6><span class="label">Figure 6-6. </span>Seaborn pair grid.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Box and Violin Plots" data-type="sect1"><div class="sect1" id="idm46066900991288">&#13;
<h1>Box and Violin Plots</h1>&#13;
&#13;
<p><a data-primary="box plots" data-type="indexterm" id="idm46066900989816"/><a data-primary="exploratory data analysis" data-secondary="box and violin plots" data-type="indexterm" id="idm46066900989112"/><a data-primary="seaborn" data-secondary="box and violin plots" data-type="indexterm" id="idm46066900988200"/>Seaborn has various plots to visualize distributions.&#13;
We show examples of a box plot and a violin plot (see <a data-type="xref" href="#id12">Figure 6-7</a> and <a data-type="xref" href="#id13">Figure 6-8</a>).&#13;
These plots can visualize a feature against a target:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">seaborn</code> <code class="kn">import</code> <code class="n">box</code> <code class="n">plot</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code> <code class="o">=</code> <code class="n">X</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code><code class="p">[</code><code class="s">"target"</code><code class="p">]</code> <code class="o">=</code> <code class="n">y</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">boxplot</code><code class="p">(</code><code class="n">x</code><code class="o">=</code><code class="s">"target"</code><code class="p">,</code> <code class="n">y</code><code class="o">=</code><code class="s">"age"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">new_df</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0607.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id12">&#13;
<img alt="Seaborn box plot." src="assets/mlpr_0607.png"/>&#13;
<h6><span class="label">Figure 6-7. </span>Seaborn box plot.</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="violin plots" data-type="indexterm" id="idm46066900963208"/>Violin plots can help with distribution visualization:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">seaborn</code> <code class="kn">import</code> <code class="n">violinplot</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code> <code class="o">=</code> <code class="n">X</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code><code class="p">[</code><code class="s">"target"</code><code class="p">]</code> <code class="o">=</code> <code class="n">y</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">violinplot</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">x</code><code class="o">=</code><code class="s">"target"</code><code class="p">,</code> <code class="n">y</code><code class="o">=</code><code class="s">"sex_male"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">new_df</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0608.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id13">&#13;
<img alt="Seaborn violin plot." src="assets/mlpr_0608.png"/>&#13;
<h6><span class="label">Figure 6-8. </span>Seaborn violin plot.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Comparing Two Ordinal Values" data-type="sect1"><div class="sect1" id="idm46066900845272">&#13;
<h1>Comparing Two Ordinal Values</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="comparing two ordinal values" data-type="indexterm" id="idm46066900843832"/><a data-primary="ordinal values, comparing" data-type="indexterm" id="idm46066900842920"/><a data-primary="pandas" data-secondary="ordinal category comparison" data-type="indexterm" id="idm46066900842280"/>Here is pandas code to compare two ordinal categories. I’m&#13;
simulating that by binning age into ten quantiles, and pclass&#13;
into three bins. The plot is normalized so it fills all of the&#13;
vertical area. This makes it easy to see that in the 40% quantile&#13;
most of the tickets were in 3rd class (see <a data-type="xref" href="#id42">Figure 6-9</a>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">X</code><code class="o">.</code><code class="n">assign</code><code class="p">(</code>&#13;
<code class="gp">... </code>        <code class="n">age_bin</code><code class="o">=</code><code class="n">pd</code><code class="o">.</code><code class="n">qcut</code><code class="p">(</code>&#13;
<code class="gp">... </code>            <code class="n">X</code><code class="o">.</code><code class="n">age</code><code class="p">,</code> <code class="n">q</code><code class="o">=</code><code class="mi">10</code><code class="p">,</code> <code class="n">labels</code><code class="o">=</code><code class="bp">False</code>&#13;
<code class="gp">... </code>        <code class="p">),</code>&#13;
<code class="gp">... </code>        <code class="n">class_bin</code><code class="o">=</code><code class="n">pd</code><code class="o">.</code><code class="n">cut</code><code class="p">(</code>&#13;
<code class="gp">... </code>            <code class="n">X</code><code class="o">.</code><code class="n">pclass</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">labels</code><code class="o">=</code><code class="bp">False</code>&#13;
<code class="gp">... </code>        <code class="p">),</code>&#13;
<code class="gp">... </code>    <code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="o">.</code><code class="n">groupby</code><code class="p">([</code><code class="s">"age_bin"</code><code class="p">,</code> <code class="s">"class_bin"</code><code class="p">])</code>&#13;
<code class="gp">... </code>    <code class="o">.</code><code class="n">size</code><code class="p">()</code>&#13;
<code class="gp">... </code>    <code class="o">.</code><code class="n">unstack</code><code class="p">()</code>&#13;
<code class="gp">... </code>    <code class="o">.</code><code class="n">pipe</code><code class="p">(</code><code class="k">lambda</code> <code class="n">df</code><code class="p">:</code> <code class="n">df</code><code class="o">.</code><code class="n">div</code><code class="p">(</code><code class="n">df</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">),</code> <code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">))</code>&#13;
<code class="gp">... </code>    <code class="o">.</code><code class="n">plot</code><code class="o">.</code><code class="n">bar</code><code class="p">(</code>&#13;
<code class="gp">... </code>        <code class="n">stacked</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code>&#13;
<code class="gp">... </code>        <code class="n">width</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code>&#13;
<code class="gp">... </code>        <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">,</code>&#13;
<code class="gp">... </code>        <code class="n">cmap</code><code class="o">=</code><code class="s">"viridis"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">bbox_to_anchor</code><code class="o">=</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">))</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="s">"image/mlpr_0609.png"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">bbox_inches</code><code class="o">=</code><code class="s">"tight"</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The lines:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="go">.groupby(["age_bin", "class_bin"])</code>&#13;
<code class="go">.size()</code>&#13;
<code class="go">.unstack()</code></pre>&#13;
&#13;
<p>can be replaced by:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="go">.pipe(lambda df: pd.crosstab(</code>&#13;
<code class="go">      df.age_bin, df.class_bin)</code>&#13;
<code class="go">)</code></pre>&#13;
&#13;
<p>In pandas, there is often more than one way to do something, and some helper functions are available that compose other functionality, such as <code>pd.crosstab</code>.</p>&#13;
</div>&#13;
&#13;
<figure><div class="figure" id="id42">&#13;
<img alt="Comparing ordinal values." src="assets/mlpr_0609.png"/>&#13;
<h6><span class="label">Figure 6-9. </span>Comparing ordinal values.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Correlation" data-type="sect1"><div class="sect1" id="idm46066900564888">&#13;
<h1>Correlation</h1>&#13;
&#13;
<p><a data-primary="columns" data-secondary="correlation between" data-type="indexterm" id="ix_ch06-asciidoc1"/><a data-primary="correlation, in exploratory data analysis" data-type="indexterm" id="ix_ch06-asciidoc2"/><a data-primary="exploratory data analysis" data-secondary="correlation" data-type="indexterm" id="ix_ch06-asciidoc3"/><a data-primary="pairwise comparisons" data-type="indexterm" id="ix_ch06-asciidoc4"/><a data-primary="Yellowbrick" data-secondary="pairwise comparisons" data-type="indexterm" id="ix_ch06-asciidoc5"/>Yellowbrick can create pairwise comparisons between the features (see <a data-type="xref" href="#id14">Figure 6-10</a>). <a data-primary="Pearson correlation" data-type="indexterm" id="idm46066900535544"/>This plot shows a Pearson correlation (the <code>algorithm</code> parameter also accepts <code>'spearman'</code> and <span class="keep-together"><code>'covariance'</code></span>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">yellowbrick.features</code> <code class="kn">import</code> <code class="n">Rank2D</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pcv</code> <code class="o">=</code> <code class="n">Rank2D</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">features</code><code class="o">=</code><code class="n">X</code><code class="o">.</code><code class="n">columns</code><code class="p">,</code> <code class="n">algorithm</code><code class="o">=</code><code class="s">"pearson"</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pcv</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pcv</code><code class="o">.</code><code class="n">transform</code><code class="p">(</code><code class="n">X</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pcv</code><code class="o">.</code><code class="n">poof</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="s">"images/mlpr_0610.png"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">bbox_inches</code><code class="o">=</code><code class="s">"tight"</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id14">&#13;
<img alt="Covariance created with Yellowbrick." src="assets/mlpr_0610.png"/>&#13;
<h6><span class="label">Figure 6-10. </span>Covariance correlation created with Yellowbrick.</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="heat map" data-type="indexterm" id="idm46066900576408"/><a data-primary="seaborn" data-secondary="heat maps" data-type="indexterm" id="idm46066900369624"/>A similar plot, a heat map, is available in the seaborn library (see <a data-type="xref" href="#id15">Figure 6-11</a>). We need&#13;
to pass in a correlation DataFrame as the data. Sadly, the colorbar does not&#13;
span between -1 and 1 unless the values in the matrix do, or we add the <code>vmin</code> and&#13;
<code>vmax</code> parameters:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">seaborn</code> <code class="kn">import</code> <code class="n">heatmap</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">ax</code> <code class="o">=</code> <code class="n">heatmap</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">X</code><code class="o">.</code><code class="n">corr</code><code class="p">(),</code>&#13;
<code class="gp">... </code>    <code class="n">fmt</code><code class="o">=</code><code class="s">".2f"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">annot</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">cmap</code><code class="o">=</code><code class="s">"RdBu_r"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">vmin</code><code class="o">=-</code><code class="mi">1</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">vmax</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="s">"images/mlpr_0611.png"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">bbox_inches</code><code class="o">=</code><code class="s">"tight"</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id15">&#13;
<img alt="Seaborn heat map." src="assets/mlpr_0611.png"/>&#13;
<h6><span class="label">Figure 6-11. </span>Seaborn heat map.</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="pandas" data-secondary="DataFrame column correlation" data-type="indexterm" id="ix_ch06-asciidoc6"/>The pandas library can also provide a correlation between DataFrame columns. We only show the first two columns of the result. The default method is <code>'pearson'</code>, but you can also set the <code>method</code> parameter to <code>'kendall'</code>, <code>'spearman'</code>, or a custom callable that returns a float given two columns:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">X</code><code class="o">.</code><code class="n">corr</code><code class="p">()</code><code class="o">.</code><code class="n">iloc</code><code class="p">[:,</code> <code class="p">:</code><code class="mi">2</code><code class="p">]</code>&#13;
<code class="go">              pclass       age</code>&#13;
<code class="go">pclass      1.000000 -0.440769</code>&#13;
<code class="go">age        -0.440769  1.000000</code>&#13;
<code class="go">sibsp       0.060832 -0.292051</code>&#13;
<code class="go">parch       0.018322 -0.174992</code>&#13;
<code class="go">fare       -0.558831  0.177205</code>&#13;
<code class="go">sex_male    0.124617  0.077636</code>&#13;
<code class="go">embarked_Q  0.230491 -0.061146</code>&#13;
<code class="go">embarked_S  0.096335 -0.041315</code></pre>&#13;
&#13;
<p>Highly correlated columns don’t add value and can throw off&#13;
feature importance and interpretation of regression coefficients.&#13;
Below is code to find the correlated columns. In our data none&#13;
of the columns are highly correlated (remember we removed the sex_male column).</p>&#13;
&#13;
<p>If we had correlated columns, we could choose to remove either the columns from level_0 or level_1 from the feature data:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">correlated_columns</code><code class="p">(</code><code class="n">df</code><code class="p">,</code> <code class="n">threshold</code><code class="o">=</code><code class="mf">0.95</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="p">(</code>&#13;
<code class="gp">... </code>        <code class="n">df</code><code class="o">.</code><code class="n">corr</code><code class="p">()</code>&#13;
<code class="gp">... </code>        <code class="o">.</code><code class="n">pipe</code><code class="p">(</code>&#13;
<code class="gp">... </code>            <code class="k">lambda</code> <code class="n">df1</code><code class="p">:</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code>&#13;
<code class="gp">... </code>                <code class="n">np</code><code class="o">.</code><code class="n">tril</code><code class="p">(</code><code class="n">df1</code><code class="p">,</code> <code class="n">k</code><code class="o">=-</code><code class="mi">1</code><code class="p">),</code>&#13;
<code class="gp">... </code>                <code class="n">columns</code><code class="o">=</code><code class="n">df</code><code class="o">.</code><code class="n">columns</code><code class="p">,</code>&#13;
<code class="gp">... </code>                <code class="n">index</code><code class="o">=</code><code class="n">df</code><code class="o">.</code><code class="n">columns</code><code class="p">,</code>&#13;
<code class="gp">... </code>            <code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="o">.</code><code class="n">stack</code><code class="p">()</code>&#13;
<code class="gp">... </code>        <code class="o">.</code><code class="n">rename</code><code class="p">(</code><code class="s">"pearson"</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="o">.</code><code class="n">pipe</code><code class="p">(</code>&#13;
<code class="gp">... </code>            <code class="k">lambda</code> <code class="n">s</code><code class="p">:</code> <code class="n">s</code><code class="p">[</code>&#13;
<code class="gp">... </code>                <code class="n">s</code><code class="o">.</code><code class="n">abs</code><code class="p">()</code> <code class="o">&gt;</code> <code class="n">threshold</code>&#13;
<code class="gp">... </code>            <code class="p">]</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code>&#13;
<code class="gp">... </code>        <code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="o">.</code><code class="n">query</code><code class="p">(</code><code class="s">"level_0 not in level_1"</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="p">)</code>&#13;
&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">correlated_columns</code><code class="p">(</code><code class="n">X</code><code class="p">)</code>&#13;
<code class="go">Empty DataFrame</code>&#13;
<code class="go">Columns: [level_0, level_1, pearson]</code>&#13;
<code class="go">Index: []</code></pre>&#13;
&#13;
<p>Using the dataset with more columns, we can see that many of them are correlated<a data-startref="ix_ch06-asciidoc6" data-type="indexterm" id="idm46066900207912"/>:<a data-startref="ix_ch06-asciidoc5" data-type="indexterm" id="idm46066900207400"/><a data-startref="ix_ch06-asciidoc4" data-type="indexterm" id="idm46066900009448"/><a data-startref="ix_ch06-asciidoc3" data-type="indexterm" id="idm46066900008776"/><a data-startref="ix_ch06-asciidoc2" data-type="indexterm" id="idm46066900008104"/><a data-startref="ix_ch06-asciidoc1" data-type="indexterm" id="idm46066900007432"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">c_df</code> <code class="o">=</code> <code class="n">correlated_columns</code><code class="p">(</code><code class="n">agg_df</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">c_df</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">format</code><code class="p">({</code><code class="s">"pearson"</code><code class="p">:</code> <code class="s">"{:.2f}"</code><code class="p">})</code>&#13;
<code class="go">        level_0     level_1   pearson</code>&#13;
<code class="go">3   pclass_mean      pclass  1.00</code>&#13;
<code class="go">4   pclass_mean  pclass_min  1.00</code>&#13;
<code class="go">5   pclass_mean  pclass_max  1.00</code>&#13;
<code class="go">6    sibsp_mean   sibsp_max  0.97</code>&#13;
<code class="go">7    parch_mean   parch_min  0.95</code>&#13;
<code class="go">8    parch_mean   parch_max  0.96</code>&#13;
<code class="go">9     fare_mean        fare  0.95</code>&#13;
<code class="go">10    fare_mean    fare_max  0.98</code>&#13;
<code class="go">12    body_mean    body_min  1.00</code>&#13;
<code class="go">13    body_mean    body_max  1.00</code>&#13;
<code class="go">14     sex_male  sex_female -1.00</code>&#13;
<code class="go">15   embarked_S  embarked_C -0.95</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="RadViz" data-type="sect1"><div class="sect1" id="idm46066900564264">&#13;
<h1>RadViz</h1>&#13;
&#13;
<p><a data-primary="exploratory data analysis" data-secondary="RadViz plot" data-type="indexterm" id="idm46066899970504"/><a data-primary="RadViz plot" data-type="indexterm" id="idm46066899969512"/><a data-primary="Yellowbrick" data-secondary="RadViz plot" data-type="indexterm" id="idm46066899968840"/>A RadViz plot shows each sample on a circle, with the features on the&#13;
circumference (see <a data-type="xref" href="#id16">Figure 6-12</a>). The values are normalized, and you can imagine that each&#13;
figure has a spring that pulls samples to it based on the value.</p>&#13;
&#13;
<p>This is one technique to visualize separability between the <span class="keep-together">targets.</span></p>&#13;
&#13;
<p>Yellowbrick can do this:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">yellowbrick.features</code> <code class="kn">import</code> <code class="n">RadViz</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">rv</code> <code class="o">=</code> <code class="n">RadViz</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">classes</code><code class="o">=</code><code class="p">[</code><code class="s">"died"</code><code class="p">,</code> <code class="s">"survived"</code><code class="p">],</code>&#13;
<code class="gp">... </code>    <code class="n">features</code><code class="o">=</code><code class="n">X</code><code class="o">.</code><code class="n">columns</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">rv</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">_</code> <code class="o">=</code> <code class="n">rv</code><code class="o">.</code><code class="n">transform</code><code class="p">(</code><code class="n">X</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">rv</code><code class="o">.</code><code class="n">poof</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0612.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id16">&#13;
<img alt="Yellowbrick RadViz plot." src="assets/mlpr_0612.png"/>&#13;
<h6><span class="label">Figure 6-12. </span>Yellowbrick RadViz plot.</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="pandas" data-secondary="RadViz plots" data-type="indexterm" id="idm46066899838808"/>The pandas library can plot RadViz plots as well (see <a data-type="xref" href="#id17">Figure 6-13</a>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">pandas.plotting</code> <code class="kn">import</code> <code class="n">radviz</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code> <code class="o">=</code> <code class="n">X</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code><code class="p">[</code><code class="s">"target"</code><code class="p">]</code> <code class="o">=</code> <code class="n">y</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">radviz</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">new_df</code><code class="p">,</code> <code class="s">"target"</code><code class="p">,</code> <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">,</code> <code class="n">colormap</code><code class="o">=</code><code class="s">"PiYG"</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0613.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id17">&#13;
<img alt="Pandas RadViz plot." src="assets/mlpr_0613.png"/>&#13;
<h6><span class="label">Figure 6-13. </span>Pandas RadViz plot.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Parallel Coordinates" data-type="sect1"><div class="sect1" id="idm46066899714744">&#13;
<h1>Parallel Coordinates</h1>&#13;
&#13;
<p><a data-primary="clustering" data-secondary="parallel coordinates plot" data-type="indexterm" id="idm46066899713272"/><a data-primary="exploratory data analysis" data-secondary="parallel coordinates plot" data-type="indexterm" id="idm46066899712328"/><a data-primary="multivariate data" data-type="indexterm" id="idm46066899711448"/><a data-primary="parallel coordinates plot" data-type="indexterm" id="idm46066899710776"/><a data-primary="Yellowbrick" data-secondary="parallel coordinates plot" data-type="indexterm" id="idm46066899710136"/>For multivariate data, you can use a parallel coordinates plot to see&#13;
clustering visually (see <a data-type="xref" href="#id18">Figure 6-14</a> and <a data-type="xref" href="#id19">Figure 6-15</a>).</p>&#13;
&#13;
<p>Again, here is a Yellowbrick version:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">yellowbrick.features</code> <code class="kn">import</code> <code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">ParallelCoordinates</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pc</code> <code class="o">=</code> <code class="n">ParallelCoordinates</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">classes</code><code class="o">=</code><code class="p">[</code><code class="s">"died"</code><code class="p">,</code> <code class="s">"survived"</code><code class="p">],</code>&#13;
<code class="gp">... </code>    <code class="n">features</code><code class="o">=</code><code class="n">X</code><code class="o">.</code><code class="n">columns</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pc</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pc</code><code class="o">.</code><code class="n">transform</code><code class="p">(</code><code class="n">X</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">ax</code><code class="o">.</code><code class="n">set_xticklabels</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">ax</code><code class="o">.</code><code class="n">get_xticklabels</code><code class="p">(),</code> <code class="n">rotation</code><code class="o">=</code><code class="mi">45</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">pc</code><code class="o">.</code><code class="n">poof</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s">"images/mlpr_0614.png"</code><code class="p">,</code> <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id18">&#13;
<img alt="Yellowbrick parallel coordinates plot." src="assets/mlpr_0614.png"/>&#13;
<h6><span class="label">Figure 6-14. </span>Yellowbrick parallel coordinates plot.</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="pandas" data-secondary="parallel coordinates plot" data-type="indexterm" id="idm46066899614248"/>And a pandas version:<a data-startref="ix_ch06-asciidoc0" data-type="indexterm" id="idm46066899613176"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">pandas.plotting</code> <code class="kn">import</code> <code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">parallel_coordinates</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code> <code class="o">=</code> <code class="n">X</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">new_df</code><code class="p">[</code><code class="s">"target"</code><code class="p">]</code> <code class="o">=</code> <code class="n">y</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">parallel_coordinates</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">new_df</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="s">"target"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">colormap</code><code class="o">=</code><code class="s">"viridis"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">ax</code><code class="o">.</code><code class="n">set_xticklabels</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="n">ax</code><code class="o">.</code><code class="n">get_xticklabels</code><code class="p">(),</code> <code class="n">rotation</code><code class="o">=</code><code class="mi">45</code>&#13;
<code class="gp">... </code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code>&#13;
<code class="gp">... </code>    <code class="s">"images/mlpr_0615.png"</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">dpi</code><code class="o">=</code><code class="mi">300</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">bbox_inches</code><code class="o">=</code><code class="s">"tight"</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">)</code></pre>&#13;
&#13;
<figure><div class="figure" id="id19">&#13;
<img alt="Pandas parallel coordinates plot." src="assets/mlpr_0615.png"/>&#13;
<h6><span class="label">Figure 6-15. </span>Pandas parallel coordinates plot.</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>