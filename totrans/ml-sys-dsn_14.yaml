- en: 12 Measuring and reporting results
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 12 衡量和报告结果
- en: This chapter covers
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Measuring results
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 衡量结果
- en: Benefiting from A/B tests
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从A/B测试中受益
- en: Reporting received results
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告收到的结果
- en: In the preceding chapters, we discussed the building blocks that form the backbone
    of a machine learning (ML) system, starting with data collection and model selection,
    continuing with metrics, losses, and validation split, and ending with a comprehensive
    error analysis. With all these elements firmly established in the pipeline, it’s
    time to circle back to the initial purpose of the system and think about proper
    reporting of the achieved results.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们讨论了构成机器学习（ML）系统骨架的构建块，从数据收集和模型选择开始，继续到指标、损失和验证分割，最后是全面的错误分析。在管道中确立了所有这些元素后，现在是时候回到系统的初始目的，并考虑如何恰当地报告所取得的结果。
- en: 'Reporting consists of evaluating our ML system’s performance based on its final
    goal and sharing the results with teammates and stakeholders. In chapter 5, we
    introduced two types of metrics: online and offline metrics, which generate two
    types of evaluation: offline testing and online testing. While offline testing
    is relatively straightforward, online testing implies running experiments in real-world
    scenarios. Typically, the most effective approach involves a series of A/B tests,
    a crucial procedure in developing an efficient, properly working model, which
    we cover in section 12.2\. This helps capture metrics that either directly match
    or are highly correlated with our business goals.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 报告包括根据我们的机器学习系统的最终目标评估其性能，并将结果与团队成员和利益相关者分享。在第5章中，我们介绍了两种类型的指标：在线指标和离线指标，它们生成两种类型的评估：离线测试和在线测试。虽然离线测试相对直接，但在线测试意味着在现实世界场景中运行实验。通常，最有效的方法涉及一系列A/B测试，这是开发一个高效、正常工作的模型的关键程序，我们将在第12.2节中介绍。这有助于捕捉与我们业务目标直接匹配或高度相关的指标。
- en: Measuring results in offline testing (sometimes called *backtesting*) is an
    attempt to assess what effect we can expect to catch during the online testing
    stage, either directly or through proxy metrics. Online testing, however, is often
    a trickier story. For example, recommender systems rely heavily on feedback loops,
    so the training data depends on what we predicted at the previous timestamps.
    Moreover, we don’t know exactly what would have happened if we had shown item
    X or Y to user A instead of item Z, which appeared in historical data at timestamp
    T.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在离线测试（有时称为*回测*）中衡量结果是一种尝试评估我们可以在在线测试阶段期望捕捉到的效果，无论是直接还是通过代理指标。然而，在线测试通常是一个更复杂的故事。例如，推荐系统严重依赖于反馈循环，因此训练数据取决于我们在上一个时间戳所做的预测。此外，我们不知道如果我们向用户A展示了项目X或Y而不是在时间戳T的历史数据中出现的项目Z，会发生什么。
- en: Finally, when the experiment is done, we are ready to report the effect of the
    model on the business metrics we are interested in. What do we report? How do
    we present the result? What conclusion should we make about the further steps
    of system elaboration? In this chapter, we answer questions that might arise during
    the process.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，当实验完成时，我们准备好报告模型对我们感兴趣的业务指标的影响。我们报告什么？我们如何展示结果？关于系统细化的下一步，我们应该得出什么结论？在本章中，我们回答在过程中可能出现的疑问。
- en: 12.1 Measuring results
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.1 衡量结果
- en: Before implementing an ML system, we should fully understand what goal we aim
    to achieve—that’s why our design document should begin with the goal description.
    Likewise, before running an experiment to check how a change affects our system
    (in this chapter, we mostly narrow our focus to A/B tests), we design it and outline
    a hypothesis that covers our expectations of how the given change is expected
    to affect metrics. This is where offline testing comes into play, as using offline
    evaluation as a proxy for online evaluation is a valid and beneficial approach.
    Its objective is to swiftly determine whether the new (modified) solution is better
    than the existing one and, if so, try to quantify by what margin it is better.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在实施机器学习系统之前，我们应该完全理解我们旨在实现的目标——这就是为什么我们的设计文档应该从目标描述开始。同样，在运行实验以检查变化如何影响我们的系统（在本章中，我们主要关注A/B测试）之前，我们设计它并概述一个假设，该假设涵盖了我们对给定变化预期如何影响指标的看法。这就是离线测试发挥作用的地方，因为使用离线评估作为在线评估的代理是一种有效且有益的方法。其目标是迅速确定新（修改后的）解决方案是否优于现有解决方案，如果是这样，则尝试通过多大差距来量化它。
- en: As we already mentioned, metrics are interconnected within a hierarchical structure.
    There are proxy metrics for other proxy metrics for metrics of our interest (please
    see chapter 5). Consequently, there are plenty of ways to conduct the offline
    evaluation.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们之前提到的，指标在层次结构中相互关联。对于我们的兴趣指标，存在其他代理指标的代理指标（请参阅第5章）。因此，有大量的方式进行离线评估。
- en: 12.1.1 Model performance
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.1 模型性能
- en: The first layer of evaluation usually involves a basic estimation of ML metrics,
    which we introduced in chapter 7\. We assume that alongside offline metrics (common
    metrics like root mean square error, mean absolute percentage error, or normalized
    discounted cumulative gain), we also improve business metrics (average revenue
    per user or click-through rate [CTR]).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 评估的第一层通常涉及对机器学习指标的基本估计，这些指标我们在第7章中介绍过。我们假设，除了离线指标（如均方根误差、平均绝对百分比误差或归一化折现累积增益等常见指标）之外，我们还提高了业务指标（平均每用户收入或点击率[CTR]）。
- en: Prediction evaluation is the fastest way to check the model’s quality and iterate
    through different versions, but it is also usually the farthest from business
    metrics (the relationship between prediction quality and online metrics is often
    far from ideal).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 预测评估是检查模型质量并迭代不同版本的最快方式，但它通常与业务指标（预测质量与在线指标之间的关系往往远非理想）相去甚远。
- en: The offline evaluation procedure is trustworthy and valuable for assessing quality.
    However, there is rarely a direct connection between offline and online metrics,
    and learning how an increase in offline metrics A, B, and C affects online metrics
    X, Y, and Z is a regression problem by itself. To bridge the gap between offline
    and online metrics and make offline testing more robust, we could gather a history
    of online tests and online metrics and related offline metrics to calculate the
    correlation between offline and online results.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 离线评估程序是可信的，对于评估质量非常有价值。然而，离线和在线指标之间很少存在直接联系，了解离线指标A、B和C的增加如何影响在线指标X、Y和Z本身就是一个问题。为了弥合离线和在线指标之间的差距，并使离线测试更加稳健，我们可以收集在线测试和在线指标以及相关的离线指标的历史数据，以计算离线和在线结果之间的相关性。
- en: 12.1.2 Transition to business metrics
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.2 转换到业务指标
- en: 'In some scenarios, we can transition from model predictions to real-world business
    metrics. To illustrate this, let’s consider the example of forecasting airline
    ticket sales. Often, the fundamental model performance metrics we use for forecasting
    are the weighted average percentage error (WAPE) and bias:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，我们可以从模型预测过渡到现实世界的业务指标。为了说明这一点，让我们考虑预测航空公司票务销售的例子。通常，我们用于预测的基本模型性能指标是加权平均百分比误差（WAPE）和偏差：
- en: '![figure](../Images/babushkin-ch12-eqs-0x.png)![figure](../Images/babushkin-ch12-eqs-1x.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/babushkin-ch12-eqs-0x.png)![figure](../Images/babushkin-ch12-eqs-1x.png)'
- en: Suppose we have two models, each with a bias of ±10% for predicting ticket sales
    for a specific flight at a certain hour. In this example, we forecast 110 tickets
    sold for a given period of time, while the actual number of tickets sold was 100\.
    Also, let’s assume we have the actual ticket prices for each day.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有两个模型，每个模型在预测特定航班特定小时的票务销售时都有±10%的偏差。在这个例子中，我们预测在给定时间段内售出110张票，而实际售出的票数是100张。此外，让我们假设我们拥有每天的实际票价。
- en: Our goal is to avoid overbooking (missed revenue due to offering too many discounted
    tickets) and minimize unsold seats (lost revenue). Assume the number of tickets
    sold reflects the passengers’ actual demand and that we adjust prices at the beginning
    of each day based on our forecast. We are okay with this rough estimation for
    the sake of illustration.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是避免过度预订（由于提供过多折扣票而错过的收入）并最小化未售出的座位（损失的收入）。假设售出的票数反映了乘客的实际需求，并且我们在每天开始时根据我们的预测调整价格。为了说明起见，我们对此粗略估计是可以接受的。
- en: The actual number of tickets sold during the 4 days is [120, 90, 110, 80]. The
    predicted ticket sales are
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，在4天内售出的票数是[120, 90, 110, 80]。预测的票务销售情况如下
- en: '*Model A*—[90, 90, 90, 90]'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型A*—[90, 90, 90, 90]'
- en: '*Model B*—[110, 110, 110, 110]'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型B*—[110, 110, 110, 110]'
- en: The model biases are
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的偏差是
- en: '*Model A*—![equation image](../Images/eq-chapter-12-26-1.png)'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型A*—![equation image](../Images/eq-chapter-12-26-1.png)'
- en: '*Model B*—![equation image](../Images/eq-chapter-12-27-1.png)'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型B*—![equation image](../Images/eq-chapter-12-27-1.png)'
- en: The model WAPEs are
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的WAPE值是
- en: '*Model A*—![equation image](../Images/eq-chapter-12-29-1.png)'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型A*—![equation image](../Images/eq-chapter-12-29-1.png)'
- en: '*Model B*—![equation image](../Images/eq-chapter-12-30-1.png)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型B*—![方程式图片](../Images/eq-chapter-12-30-1.png)'
- en: Both models have the same WAPE and bias, but model A has a negative bias of
    10% (and tends to underpredict), while model B has a positive bias of 10% (and
    tends to overpredict).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个模型具有相同的WAPE和偏差，但模型A具有10%的负偏差（并倾向于低估），而模型B具有10%的正偏差（并倾向于高估）。
- en: The ticket prices for each day are [$200, $220, $230, $210].
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 每天的票价为[$200, $220, $230, $210]。
- en: The total revenue (we choose the minimum of sold and forecasted tickets for
    each day) is
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 总收入（我们选择每天已售和预测票数的最低值）为
- en: '*Model A*—90 * $200 + 90 * $220 + 90 * $230 + 80 * $210 = $75,300'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型A*—90 * $200 + 90 * $220 + 90 * $230 + 80 * $210 = $75,300'
- en: '*Model B*—110 * $200 + 90 * $220 + 110 * $230 + 80 * $210 = $83,900'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型B*—110 * $200 + 90 * $220 + 110 * $230 + 80 * $210 = $83,900'
- en: As you can see, model B generates $8,600 more revenue for a single flight within
    just 4 days (while the total flight’s cost remains unchanged). When multiplied
    by hundreds of flights and days, this difference will result in a substantial
    revenue gain.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，模型B在短短4天内（而总飞行成本保持不变）就为单次航班带来了$8,600的收入。当乘以数百次航班和天数时，这种差异将导致显著的收入增长。
- en: Certainly, we’ve oversimplified the real-world context where the model makes
    forecasts and affects decision-making (e.g., how many tickets to release for sale,
    how to adjust prices dynamically). Here, the whole transition is done by multiplying
    by price and, optionally, subtracting flight costs.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们在现实世界的背景下过于简化了模型进行预测和影响决策的情况（例如，销售多少张票，如何动态调整价格）。在这里，整个过渡过程是通过乘以价格和可选地减去飞行成本来完成的。
- en: Nonetheless, this example illustrates how we can transition from model performance
    metrics, which may not fully capture the practical effect of predictions, to business
    indicators like revenue. These business metrics can be reported to the team before
    running A/B tests.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，这个例子说明了我们如何从可能不完全捕捉预测实际效果的模型性能指标，过渡到如收入这样的业务指标。这些业务指标可以在运行A/B测试之前报告给团队。
- en: 12.1.3 Simulated environment
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.3 模拟环境
- en: When the stakes are high, it is reasonable to invest in a more sophisticated,
    computationally expensive, but more robust offline testing procedure. Building
    a simulator of the online environment for the problem at hand and running an algorithm
    against this simulator can become such an investment.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 当风险很高时，投资于更复杂、计算成本更高但更稳健的离线测试程序是合理的。为手头的问题构建在线环境的模拟器并对该模拟器运行算法可以成为这样的投资。
- en: A good example of this kind of environment would be time-series forecasting,
    which is relatively simple to simulate thanks to the availability of labels, auxiliary
    information (e.g., historical costs or turnover of goods in stock), and disambiguation
    in the outcome. That is usually not the case for online recommendation systems,
    such as news, ads, or product recommendations, where we deal with partly labeled
    data; we know only impressions of content items (views, clicks, and conversions)
    that we showed to a particular user, while those that we did not show remain without
    user feedback as there is always a chance that had we produced an alternative
    order of impressions, everything might have been very different.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 这种环境的良好例子是时间序列预测，由于标签、辅助信息（例如，历史成本或库存商品的周转）和结果中的消歧的可用性，这种模拟相对简单。这通常不适用于在线推荐系统，如新闻、广告或产品推荐，在这些系统中我们处理部分标记的数据；我们只知道我们向特定用户展示的内容项的印象（查看、点击和转化），而那些我们没有展示的内容则没有用户反馈，因为总有可能，如果我们产生了不同的印象顺序，一切可能都会非常不同。
- en: Let’s review how such an environment could be created in the case of a recommender
    system.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下在推荐系统的情况下，如何创建这样的环境。
- en: 'Sometimes online recommendation systems are solved via the multi-armed bandits
    and contextual bandits approaches (usually, this subset of recommender systems
    is called *real-time bidding*, but in a nutshell, its goal remains the same—to
    provide the best pick from a variety of options to maximize a specific reward).
    There is an agent, which is our algorithm, that “interacts” with an environment.
    For example, it consumes information about user context (their recent history)
    and chooses which ad banner to show to maximize CTR, conversion rate (CVR), or
    effective cost per mile (eCPM). This is a typical reinforcement learning problem
    with a great feedback loop influence: previously shown ads change the future user
    behavior and give us information about their preferences.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，在线推荐系统是通过多臂老虎机和上下文多臂老虎机方法解决的（通常，这个推荐系统子集被称为*实时竞价*，但简而言之，其目标保持不变——从多种选择中提供最佳选择以最大化特定奖励）。有一个代理，即我们的算法，它与环境“互动”。例如，它消耗有关用户上下文（他们的近期历史）的信息，并选择显示哪个广告横幅以最大化点击率（CTR）、转化率（CVR）或每英里有效成本（eCPM）。这是一个典型的强化学习问题，具有强大的反馈循环影响：之前显示的广告会改变未来的用户行为，并为我们提供有关他们偏好的信息。
- en: 'The so-called “replay” algorithm is a simple (but not the most intuitive) way
    to build a simulation for real-time recommendations, derived from the paper “Unbiased
    Offline Evaluation of Contextual-bandit-based News Article Recommendation Algorithms”
    by Lihong Li et al. ([https://arxiv.org/abs/1003.5956](https://arxiv.org/abs/1003.5956)).
    Here we summarize the paper due to its practicality:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 所说的“重放”算法是一种简单（但不是最直观）的方法来为实时推荐构建模拟，该方法源于李红等人在论文“基于上下文多臂老虎机的新闻文章推荐算法的无偏离线评估”中的描述（[https://arxiv.org/abs/1003.5956](https://arxiv.org/abs/1003.5956)）。在这里，我们总结了这篇论文，因为它具有实用性：
- en: Suppose we take a historical dataset that consists of user context (user features),
    recommended ads (let’s say we can suggest one item at a time), and user feedback
    (which can be both binary and continuous). Also, for each row of data, we know
    all available items we could recommend for that user at a given moment (items
    are arms for contextual bandits).
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设我们选取一个历史数据集，该数据集包含用户上下文（用户特征）、推荐广告（比如说我们一次可以推荐一个项目），以及用户反馈（可以是二进制或连续的）。此外，对于数据集中的每一行，我们知道在特定时刻可以为该用户推荐的所有可用项目（项目是上下文多臂老虎机中的臂）。
- en: Also, we have the second dataset, which we’ll call the virtual dataset. It is
    empty at the start of the simulation.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，我们还有一个第二数据集，我们将其称为虚拟数据集。在模拟开始时，它是空的。
- en: We split our historical dataset into batches (e.g., 1-hour intervals per iteration).
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将历史数据集分成批次（例如，每次迭代的1小时间隔）。
- en: For each row in a single batch, we predict what ad our algorithm could recommend
    based on the proposed user context and available items. Our algorithm is trained
    on the virtual dataset, which is initially empty. Hence, we start with random
    “exploration.”
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于单个批次中的每一行，我们根据提出的用户上下文和可用项目预测我们的算法可能会推荐哪个广告。我们的算法在初始为空的虚拟数据集上训练。因此，我们开始于随机的“探索”。
- en: Rows, for which the recommendation produced by the model is equal to historically
    chosen ads, are saved to the virtual dataset (with their feedback).
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于模型生成的推荐与历史选择广告相等的行，将保存到虚拟数据集中（包括他们的反馈）。
- en: We retrain the model based on the updated virtual dataset.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们根据更新的虚拟数据集重新训练模型。
- en: We repeat steps 4–6 until we reach the end of the historical dataset.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们重复步骤4到6，直到达到历史数据集的末尾。
- en: 'There is also an optimized version for steps 4 and 5: instead of one item (as
    in the real environment), we recommend three or five items for each row, and if
    the recommended item matches one of them, we append this row to the virtual dataset.
    This allows the model to learn more effectively while reducing stochasticity.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 对于步骤4和5也有一个优化版本：不是像真实环境中的一个项目，而是为每一行推荐三个或五个项目，如果推荐的项目与其中之一匹配，我们就将这一行追加到虚拟数据集中。这允许模型更有效地学习，同时减少随机性。
- en: A visual example is divided into several pieces in figures 12.1 to 12.5 that
    demonstrate the work of an unbiased estimator, with figure 12.1 displaying the
    real history of events and figures 12.2 to 12.5 showcasing simulated events based
    on historical data.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在图12.1到12.5中，一个视觉示例被分成几个部分，展示了无偏估计器的工作，其中图12.1显示了事件的真实历史，而图12.2到12.5展示了基于历史数据的模拟事件。
- en: '![figure](../Images/CH12_F01_Babushkin.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F01_Babushkin.png)'
- en: 'Figure 12.1 Unbiased estimator (offline validation): stream of real events'
  id: totrans-54
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.1 无偏估计器（离线验证）：真实事件流
- en: For the simulated events here, we go through the real history of events and
    only consider those events in which the output of a new model (chosen landing
    pages) equals the output of the old model. In figure 12.2, the simulated user
    behavior implies five transitions from banners to landing pages with two successful
    purchases and $6 of a predicted profit per click.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这里的模拟事件，我们通过实际事件的历史来筛选，只考虑那些新模型（选择的着陆页）的输出与旧模型输出相等的事件。在图12.2中，模拟的用户行为显示了从横幅到着陆页的五个转换，其中有两个成功的购买和每点击预测利润6美元。
- en: '![figure](../Images/CH12_F02_Babushkin.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F02_Babushkin.png)'
- en: 'Figure 12.2 Unbiased estimator (offline validation): simulation of events,
    example 1'
  id: totrans-57
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.2 无偏估计器（离线验证）：事件模拟，示例1
- en: Featuring only four goods viewed by users, figure 12.3 suggests the lowest possible
    profit ($10) and profit per click ($2.5).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 仅展示用户查看的四种商品，图12.3表明了最低可能的利润（10美元）和每点击利润（2.5美元）。
- en: '![figure](../Images/CH12_F03_Babushkin.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F03_Babushkin.png)'
- en: 'Figure 12.3 Unbiased estimator (offline validation): simulation of events,
    example 2'
  id: totrans-60
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.3 无偏估计器（离线验证）：事件模拟，示例2
- en: Figure 12.4 provides another example of simulated user behavior with a decent
    conversion rate (50%) but one of the lowest profit-per-click values (only 3%)
    due to the low cost of purchases.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.4提供了另一个模拟用户行为的示例，具有相当高的转化率（50%），但由于购买成本低，每点击利润值（仅为3%）却很低。
- en: '![figure](../Images/CH12_F04_Babushkin.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F04_Babushkin.png)'
- en: 'Figure 12.4 Unbiased estimator (offline validation): simulation of events,
    example 3'
  id: totrans-63
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.4 无偏估计器（离线验证）：事件模拟，示例3
- en: Finally, a simulated environment in figure 12.5 suggests the best possible CVR
    (60%) and profit per click ($7), while the overall profit is only $3 less than
    that of the stream of real events (see figure 12.1).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，图12.5中的模拟环境表明了最佳可能的CVR（60%）和每点击利润（7美元），而整体利润仅比真实事件流低3美元（见图12.1）。
- en: '![figure](../Images/CH12_F05_Babushkin.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F05_Babushkin.png)'
- en: 'Figure 12.5 Unbiased estimator (offline validation): simulation of events,
    example 4'
  id: totrans-66
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.5 无偏估计器（离线验证）：事件模拟，示例4
- en: 'We eventually end up with a virtual dataset produced by the interaction of
    our model with a simulated data flow. Based on it, we can calculate all listed
    metrics:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我们最终得到一个虚拟数据集，这是我们的模型与模拟数据流交互产生的。基于它，我们可以计算所有列出的指标：
- en: CTR = number of clicks/number of views (total number of rows)
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CTR = 点击数/查看数（总行数）
- en: CVR = number of conversions/number of clicks
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CVR = 转化数/点击数
- en: eCPM = revenue/number of clicks * 1000
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: eCPM = 收入/点击数 * 1000
- en: While not ideal, running different models through this procedure will make it
    possible to evaluate them from the product metrics point of view and understand
    the relationship between these estimates of online metrics and the accuracy of
    predictions and then provide this information to a wider audience.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然不是理想的解决方案，但通过这个程序运行不同的模型将使从产品指标的角度评估它们成为可能，并理解这些在线指标估计与预测准确性之间的关系，然后向更广泛的受众提供这些信息。
- en: 12.1.4 Human evaluation
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.4 人工评估
- en: Sometimes the final option worth mentioning for measuring results before deploying
    the system to production is validation by the assessors, or human evaluation.
    If the simulation is computationally expensive and slow, this can be even worse
    due to limited bandwidth, longer delay, human-induced ambiguity, and greater costs.
    However, in cases where human-in-the-loop is applicable, it is usually the most
    precise and trustworthy way to test the model, except for direct online testing
    on real data.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在将系统部署到生产之前，有时值得提及的最终选项是评估者的验证，或人工评估。如果模拟计算成本高且慢，由于带宽有限、延迟更长、人为引起的模糊性以及更高的成本，这可能会变得更糟。然而，在适用人工介入的情况下，这通常是测试模型最精确和最可靠的方式，除了直接在真实数据上在线测试之外。
- en: For instance, after building a new version of a search engine pipeline, we can
    either ask a group of experts to estimate the relevance of search results from
    1 to 5 for some benchmark queries or choose which output is more relevant, comparing
    the old and new versions of search results. The second (comparative) formulation
    tends to produce a more robust evaluation as it excludes the subjectiveness of
    score estimates. In the case of generative large language models, human evaluation
    and hybrid approaches (auxiliary “critic” model, trained on human feedback) are
    the most popular options to measure the quality of generations.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在构建搜索引擎管道的新版本后，我们可以要求一组专家对某些基准查询的搜索结果的相关性进行1到5的估计，或者选择哪个输出更相关，比较新旧版本的搜索结果。第二种（比较）方法往往会产生更稳健的评估，因为它排除了评分估计的主观性。在生成大型语言模型的情况下，人工评估和混合方法（基于人类反馈的辅助“评论”模型）是最受欢迎的选项来衡量生成的质量。
- en: While human evaluation has low throughput and high costs that may impede frequent
    use, its capacity to yield highly precise and trustworthy assessments (compared
    to fast but limited automated methods) cannot be downplayed.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然人工评估的吞吐量低，成本高，可能会阻碍频繁使用，但其产生高度精确和可靠的评估（与快速但有限的自动化方法相比）的能力不容小觑。
- en: 12.2 A/B testing
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.2 A/B 测试
- en: 'Heavily used in various fields, including marketing, advertising, product design,
    and many others, A/B testing is a gold standard for causal inference that helps
    make data-driven decisions rather than relying solely on intuition. You might
    have a valid question: we have been discussing how to measure and report results,
    and now we have suddenly jumped on the causal inference boat; how so? In a sense,
    measuring results is a part of causal inference, as we want to be sure those results
    are caused by the factor we have influenced (in our case, an ML system). Of course,
    we can deploy our system in production and measure all metrics of interest as
    is, but we rarely do so, mainly for the following reasons:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在包括市场营销、广告、产品设计在内的多个领域被广泛使用，A/B 测试是因果推断的金标准，它有助于做出基于数据的决策，而不是仅仅依赖直觉。你可能会有一个合理的问题：我们一直在讨论如何衡量和报告结果，现在我们突然跳上了因果推断的船；这是为什么？从某种意义上说，衡量结果是因果推断的一部分，因为我们想确保这些结果是由我们影响的因素（在我们的情况下，是一个机器学习系统）引起的。当然，我们可以将我们的系统部署到生产环境中，并测量所有感兴趣的指标，但我们很少这样做，主要原因如下：
- en: It is dangerous. If something is broken, deploying it to everyone would lead
    to further breakage. For this reason, we should deploy it to a small fraction
    first.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这很危险。如果出了问题，将其部署给所有人会导致进一步的损坏。因此，我们应该先将其部署给一小部分人。
- en: Even if we don’t care about the previous point (probably not, but still), what
    if something changed outside our control zone, affecting the overall performance,
    but we thought it was us who caused it and thus made a false conclusion?
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 即使我们对前面的观点不关心（可能不是，但仍然如此），如果在我们控制范围之外发生了变化，影响了整体性能，但我们认为是我们自己导致了这种情况，从而得出错误的结论，那会怎样呢？
- en: These two points combined lead us to the need for a control group (status quo)
    and a treatment group (our change), which helps us handle both; on the one hand,
    we can vary the size of the treatment group, controlling the affected fraction,
    and on the other hand, we can have the control group to compare the change affecting
    the treatment group with it.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这两个观点结合起来，使我们需要对照组（现状）和实验组（我们的变化），这有助于我们处理两者；一方面，我们可以改变实验组的大小，控制受影响的分数，另一方面，我们可以有对照组来比较对实验组产生影响的改变。
- en: 'During A/B experiments, we split entities (in most cases, users) into two groups:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在 A/B 实验期间，我们将实体（在大多数情况下，是用户）分为两组：
- en: A control group that uses the existing version of our system
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用我们系统现有版本的对照组
- en: A testing group that uses the new version
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用新版本的测试组
- en: This allows us to isolate the effect of a change on key metrics while controlling
    external factors that may affect the results (see figure 12.6).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 这使我们能够在控制可能影响结果的外部因素的同时，隔离变化对关键指标的影响（见图12.6）。
- en: '![figure](../Images/CH12_F06_Babushkin.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F06_Babushkin.png)'
- en: Figure 12.6 A/B testing split stage
  id: totrans-86
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.6 A/B 测试分割阶段
- en: 12.2.1 Experiment design
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.1 实验设计
- en: 'Every experiment starts with a hypothesis:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 每个实验都从一个假设开始：
- en: '*If we do [action A], it will help us achieve/solve [goal/problem P], which
    will be reflected in the form of an [X%] expected uplift in the [metrics M] based
    on [research/estimation R].*'
  id: totrans-89
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*如果我们执行[行动A]，它将帮助我们实现/解决[目标/问题P]，这将反映在基于[研究/估计R]的[指标M]的[X%]预期提升上。*'
- en: 'Let’s break down the variables mentioned in the hypothesis:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分解一下假设中提到的变量：
- en: '*Action* is deploying a new solution to compare it with the existing one. For
    instance, the goal could be to decrease the number of out-of-stock situations
    and reduce the gap between predicted and actual sales for Supermegaretail.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*行动* 是部署一个新的解决方案来与现有的一个进行比较。例如，目标可能是减少Supermegaretail的缺货情况数量，并缩小预测销售和实际销售之间的差距。'
- en: '*Metrics* are providing us with a means of quantifying the progress toward
    our objectives. For example, a “weight loss” metric in a fitness app can demonstrate
    a user’s progress toward their set target weight. See chapter 5 for further insights.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指标* 为我们提供了一种量化我们目标进展的手段。例如，健身应用中的“减重”指标可以展示用户向其设定的目标体重进度的进展。参见第5章以获取更多见解。'
- en: '*Expected uplift* can be derived from our previous experience, available benchmarks,
    a rule of thumb, or even wishful thinking (this happens very often!). Additional
    data provided by offline testing is usually used to make it more precise.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*预期提升* 可以从我们以往的经验、可用的基准、经验法则，甚至美好的愿望（这种情况很常见！）中得出。通常，离线测试提供的数据用于使其更加精确。'
- en: 'Before running an A/B test, there are at least three hyperparameters we must
    define:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在运行A/B测试之前，至少有三个超参数我们必须定义：
- en: '*Minimum detectable effect* (MDE), also known as minimum detectable change
    (MDC), is the smallest disparity between two groups that can be reliably detected
    given the study’s design and sample size. The MDE must be equal to or less than
    the expected uplift to avoid overlooking it.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*最小可检测效应*（MDE），也称为最小可检测变化（MDC），是在给定研究设计和样本量的情况下，两组之间可以可靠检测到的最小差异。MDE必须等于或小于预期提升，以避免忽略它。'
- en: '*Type I error* (false positives) is the probability of wrongly concluding that
    an effect exists when it does not. A typical threshold for this error is 5% (signified
    by *α* = 0.05).'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*I型错误*（假阳性）是在效应不存在时错误地得出效应存在的结论的概率。这种错误的典型阈值是5%（用 *α* = 0.05 表示）。'
- en: '*Type II error* (false negatives) is the probability of failing to recognize
    an effect when it is present. A typically used threshold is 20% (represented by
    *β* = 0.2).'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*II型错误*（假阴性）是在效应存在时未能识别出效应的概率。通常使用的阈值是20%（用 *β* = 0.2 表示）。'
- en: 'Along with the variation in the data, this affects the number of samples (and
    therefore the time required to run the test, taking some seasonality into account
    as well) needed to run the test; all these factors combined result in the following
    equation:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 随着数据的变动，这会影响测试所需的样本数量（因此，考虑到一些季节性因素，所需的测试时间），所有这些因素加在一起导致以下方程：
- en: '![figure](../Images/babushkin-ch12-eqs-5x.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/babushkin-ch12-eqs-5x.png)'
- en: Where *n* is the required sample size per group, *Z**[α]*is the Z-score corresponding
    to the desired significance level (for type I error rate), *Z**[β]* is the Z-score
    corresponding to the desired power (for type II error rate), *s**²* is the estimated
    variance of the metric, and *MDC* is the minimum detectable change. As we mentioned
    before, the very frequent sample unit is *user*, but it could be *session*, *transaction*,
    *shop level*, and so on.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *n* 是每组所需的样本量，*Z**[α]* 是对应于所需显著性水平的Z分数（对于I型错误率），*Z**[β]* 是对应于所需功效的Z分数（对于II型错误率），*s**²*
    是指标估计的方差，*MDC* 是最小可检测变化。正如我们之前提到的，非常常见的样本单位是 *用户*，但它也可能是 *会话*、*交易*、*店铺级别* 等等。
- en: After formulating the hypothesis and our expectations, we choose a *splitting
    strategy* determined mainly by the nature of the system we deploy and how it will
    affect the existing processes.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在制定假设和我们的期望之后，我们选择一个 *分割策略*，这主要取决于我们部署的系统性质以及它将如何影响现有流程。
- en: 'Next, we decide on the *statistical criteria* and conduct simulation tests,
    both A/A (where we compare the same system against itself to check type I error
    rates) and A/B (where we simulate a desired effect through the addition of the
    noise of a desired magnitude), as a sanity check on historical data. This helps
    us confirm whether we meet the predefined type I and type II error levels. A comprehensive
    description of that is beyond the scope of this book, but if you are interested
    in more details, a great starting point would be *Trustworthy Online Controlled
    Experiments: A Practical Guide to A/B Testing* ([https://mng.bz/86Qz](https://mng.bz/86Qz))
    by Ron Kohavi et al.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们决定**统计标准**并执行模拟测试，包括A/A（我们比较相同的系统以检查I型错误率）和A/B（我们通过添加期望大小的噪声来模拟期望的效果），作为对历史数据的合理性检查。这有助于我们确认我们是否达到了预定义的I型和II型错误水平。关于这一点的全面描述超出了本书的范围，但如果你对更多细节感兴趣，一个很好的起点是Ron
    Kohavi等人所著的《可信在线受控实验：A/B测试实用指南》([https://mng.bz/86Qz](https://mng.bz/86Qz))。
- en: Finally, we have everything we need to launch our A/B test. Remember that the
    design of the experiment is fixed beforehand and cannot be changed on the go.
    Next we briefly outline the basic stages of A/B testing.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们拥有了启动我们的A/B测试所需的一切。记住，实验的设计是在事先固定的，不能在过程中改变。接下来，我们简要概述A/B测试的基本阶段。
- en: 12.2.2 Splitting strategy
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.2 分裂策略
- en: The question is, how do we split the data? The usual answer is “by user.” For
    instance, we have a control group of users to interact with the existing search
    engine and an experimental group to use the new version. However, things get more
    complex when we can’t split by users (e.g., there isn’t a consistent user ID),
    or splitting by users is entirely irrelevant to our service.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 问题在于，我们如何分割数据？通常的答案是“按用户”。例如，我们有一个控制组用户与现有的搜索引擎互动，一个实验组使用新版本。然而，当我们不能按用户分割（例如，没有一致的用户ID）或者按用户分割对我们服务完全无关时，事情就变得更加复杂。
- en: 'To zoom in, let’s examine hypothetical pricing systems applied in different
    domains:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更深入地了解，让我们考察在不同领域应用的不同假设定价系统：
- en: In *offline retail*, it is physically not feasible to show different price tags
    to customers within the same store. So a more suitable unit for splitting is the
    store rather than individual customers.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在**线下零售**中，在同一个商店内向客户展示不同的价格标签在物理上是不切实际的。因此，一个更适合分割的单位是商店而不是单个客户。
- en: In *online retail*, while it is technically possible to show different prices
    to different users, it also can lead to legal problems, as many countries have
    laws preventing user discrimination in eCommerce.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在**在线零售**中，虽然技术上可以向不同的用户显示不同的价格，但这也可能导致法律问题，因为许多国家都有法律禁止在电子商务中对用户进行歧视。
- en: In *ridesharing*, users can be separated as the orders are made using the app,
    but we must consider potential negative user experiences. If we split by user
    and two users decide to ride scooters together, one user might see a price of
    $5 per hour in their app, while it will be $6 per hour for the other. This discrepancy
    could lead to a confusing and negative user experience and feedback.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在**共享出行**中，用户可以通过应用程序下订单来分离，但我们必须考虑潜在的负面用户体验。如果我们按用户分割，并且两个用户决定一起骑滑板车，一个用户可能在他们的应用程序中看到每小时5美元的价格，而另一个用户则是每小时6美元。这种差异可能导致令人困惑和负面的用户体验和反馈。
- en: When it comes to dynamic pricing applied to *loans and credit rates*, the offered
    rate is expected to be highly personalized, like a mortgage. Therefore, different
    “prices” won’t raise eyebrows, even if two users are in the same room. In this
    situation, it’s relatively safe to split by user.
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当涉及到应用于**贷款和信贷利率**的动态定价时，提供的利率预计将非常个性化，就像抵押贷款一样。因此，即使两个用户在同一房间里，不同的“价格”也不会引起注意。在这种情况下，按用户分割相对安全。
- en: An ideal case for user testing is presented by *advertising networks*, as they
    offer an abundance of diverse, relatively low-cost data points, and a user-specific
    cost per click is both common and expected. This type of setup often allows for
    more traditional user-based splits.
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 广告网络提供了一个理想的用户测试案例，因为它们提供了大量多样化的、相对低成本的独立数据点，并且每个用户的点击成本既常见也预期。这种设置通常允许更传统的基于用户的分割。
- en: If splitting data by individual users isn’t feasible, we can use higher-level
    entities as atomic units. For offline retail, we could use entire stores; for
    scooters, trips could be divided based on parking slots, neighborhoods, cities,
    or even regions. However, this strategy might shift data distribution and create
    unequal sample sizes or lack of representation, which should be considered when
    selecting an appropriate statistical test.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 如果按单个用户分割数据不可行，我们可以使用更高级别的实体作为原子单位。对于线下零售，我们可以使用整个商店；对于电动滑板车，可以根据停车区、社区、城市甚至地区来划分行程。然而，这种策略可能会改变数据分布，造成样本大小不均或缺乏代表性，这在选择合适的统计测试时应该予以考虑。
- en: When splitting by a nontypical key, aiming for group (bucket) similarity is
    essential. For instance, if you’re compelled to divide geographically, the chosen
    areas should be similar and possess comparable economic indicators (they should
    match each other).
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 当按非典型键分割时，追求组（桶）相似性至关重要。例如，如果你被迫按地理划分，所选区域应该是相似的，并具有可比的经济指标（它们应该相互匹配）。
- en: Finally, there is a more advanced splitting strategy called *switchback testing*.
    This technique divides data into region-time buckets and randomly and continuously
    switches between different models (see figure 12.7). It ensures that each region
    will be in both the control group and the testing group for an approximately equal
    amount of time. For further details, see “Design and Analysis of Switchback Experiments”
    by Iavor Bojinov et al. ([https://arxiv.org/abs/2009.00148](https://arxiv.org/abs/2009.00148)).
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，还有一种更高级的分割策略，称为*回溯测试*。这种技术将数据分为区域-时间桶，并在不同模型之间随机且持续地切换（见图12.7）。它确保每个区域将在控制组和测试组中大约相等的时间内。有关更多详细信息，请参阅Iavor
    Bojinov等人撰写的“回溯实验的设计与分析”（[https://arxiv.org/abs/2009.00148](https://arxiv.org/abs/2009.00148)）。
- en: '![figure](../Images/CH12_F07_Babushkin.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F07_Babushkin.png)'
- en: Figure 12.7 Switchback split pattern, representing time-region cell allocation
  id: totrans-116
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.7 回溯分割模式，表示时间-区域单元格分配
- en: 12.2.3 Selecting metrics
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.3 选择指标
- en: When designing an A/B test, selecting metrics is a crucial step that can be
    a deciding factor in the test’s success or failure. We prefer trustworthy, sensitive,
    interpretable metrics with a low feedback delay for online testing.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在设计A/B测试时，选择指标是一个关键步骤，它可能是测试成功或失败的决定性因素。我们更喜欢在线测试中可信赖、敏感、可解释的指标，并且反馈延迟低。
- en: 'Every experiment usually has three kinds of metrics:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 每个实验通常都有三种类型的指标：
- en: '*Key metrics* are the primary metrics the experiment aims to improve. These
    metrics directly affect the success of our business objectives and are used to
    determine the final outcome of the experiment. For example, the key metric for
    an eCommerce website could be the CVR, average order value (AOV), or gross merchandise
    value / revenue.'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*关键指标*是实验旨在改进的主要指标。这些指标直接影响我们商业目标的成功，并用于确定实验的最终结果。例如，电子商务网站的关键指标可能是转化率（CVR）、平均订单价值（AOV）或总商品价值/收入。'
- en: '*Control metrics* are expected to remain unchanged during the experiment, serving
    as a check on its validity. For example, if the control metric for the number
    of visitors to the website (or page loading time) shows a significant decrease
    (or increase), this could indicate a problem with the experiment design or a change
    in external factors that could affect the results.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*控制指标*在实验期间预期保持不变，作为对其有效性的检验。例如，如果网站访问量（或页面加载时间）的控制指标显示出显著的下降（或上升），这可能表明实验设计存在问题或外部因素的变化，这些因素可能会影响结果。'
- en: '*Auxiliary metrics* provide additional information about the experiment but
    are not used to determine the final outcome. These metrics help provide a deeper
    understanding of the experiment’s results and can be used to identify potential
    problems or opportunities for improvement. For example, an auxiliary metric for
    an eCommerce website could be the number of product views or the time spent on
    the website.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*辅助指标*提供了关于实验的额外信息，但不用于确定最终结果。这些指标有助于更深入地了解实验结果，并可用于识别潜在问题或改进的机会。例如，电子商务网站的辅助指标可能是产品查看次数或网站上的时间花费。'
- en: All three groups play an important role in the design and execution of an A/B
    testing experiment. Key metrics determine the success of the experiment, control
    metrics ensure the validity of the experiment, and auxiliary metrics provide additional
    information to support the results and inform future experiments.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 所有三个组在A/B测试实验的设计和执行中都发挥着重要作用。关键指标决定了实验的成功，控制指标确保实验的有效性，辅助指标提供额外信息以支持结果并指导未来的实验。
- en: 12.2.4 Statistical criteria
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.4 统计标准
- en: The third essential ingredient in any A/B experiment is a statistical test that
    makes the final decision of whether a significant effect is captured.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 任何A/B实验的第三个基本要素是统计测试，它做出最终决定，即是否捕捉到显著效果。
- en: In short, statistical criteria are used to quantify the probability of receiving
    specific results under specific assumptions. For example, the probability of receiving
    t-statistics equal to or greater than 3 generally will be less than 0.01 (if there’s
    no difference between the groups and assumptions for which the t-test is met).
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，统计标准用于量化在特定假设下获得特定结果的概率。例如，获得等于或大于3的t统计值的概率通常将小于0.01（如果两组之间没有差异，并且满足t测试的假设）。
- en: 'The most common statistical test used in A/B testing is the t-test we just
    mentioned. It has many modifications. For example, Welch’s t-test is relatively
    easy to interpret and is similar to Student’s t-test, but it can be used even
    when the variances of two groups are not equal. The statistic for the Welch t-test
    is calculated as follows:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在A/B测试中最常用的统计测试是我们刚才提到的t测试。它有许多修改。例如，Welch的t测试相对容易解释，类似于Student的t测试，但它可以在两组的方差不相等的情况下使用。Welch
    t测试的统计量计算如下：
- en: '![figure](../Images/babushkin-ch12-eqs-6x.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/babushkin-ch12-eqs-6x.png)'
- en: The *null hypothesis* (a default assumption under the test’s result) for the
    Welch t-test implies that there is no difference between the means of the two
    groups; here, the captured difference between the two groups appeared by accident
    and was caused by noise. The alternative hypothesis is that the captured difference
    is not caused by noise, and the difference is statistically significant.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Welch t测试的*零假设*（测试结果的默认假设）意味着两组之间的均值没有差异；在这里，两组之间的捕获差异是偶然出现的，是由噪声引起的。备择假设是捕获的差异不是由噪声引起的，差异是统计显著的。
- en: By statistical significance, we mean that the probability of capturing a specific
    value of a statistic or even a more extreme one under the assumption that the
    null hypothesis is true (we call it *p-value*) is less than *significance level*
    *α* (effectively, the same as type I error; typically, *α* = 0.05). P-value, along
    with the significance level, is a way to standardize the results of any statistical
    test and map them to a single reference point rather than to define critical values
    for each test in particular.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 通过统计显著性，我们指的是在假设零假设为真的情况下（我们称之为*p值*），捕捉到特定统计值或更极端值的概率小于*显著性水平* *α*（实际上，等同于第一类错误；通常，*α*
    = 0.05）。p值，连同显著性水平，是标准化任何统计测试结果并将其映射到单一参考点的方法，而不是为每个特定的测试定义临界值。
- en: 'While there are many different statistical tests available, the choice of a
    particular test depends on the context of the experiment and the nature of the
    data. That said, providing a detailed guide on choosing the most appropriate test
    is beyond the scope of this book. For a more detailed discussion on selecting
    the right statistical test for A/B testing, we once again recommend *Trustworthy
    Online Controlled Experiments: A Practical Guide to A/B Testing* ([https://mng.bz/EOKd](https://mng.bz/EOKd))
    by Ron Kohavi et al.'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '尽管有许多不同的统计测试可用，但特定测试的选择取决于实验的背景和数据性质。尽管如此，提供选择最合适的测试的详细指南超出了本书的范围。关于选择合适的统计测试进行A/B测试的更详细讨论，我们再次推荐Ron
    Kohavi等人所著的《可信在线受控实验：A/B测试实用指南》(*Trustworthy Online Controlled Experiments: A
    Practical Guide to A/B Testing*) ([https://mng.bz/EOKd](https://mng.bz/EOKd))。'
- en: The t-test is widely used because it is a robust test that can handle a variety
    of situations, it is easy to implement, and it provides results that are easy
    to interpret. However, the choice of a specific test should always be made considering
    the type of data you are dealing with, the nature of your experiment, and the
    assumptions each test requires.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: t检验被广泛使用，因为它是一种稳健的测试，可以处理各种情况，易于实现，并且提供易于解释的结果。然而，选择特定的测试应该始终考虑到你处理的数据类型、实验的性质以及每个测试所需的假设。
- en: 12.2.5 Simulated experiments
  id: totrans-133
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.5 模拟实验
- en: We can run a simulation to check whether we have succeeded in designing an experiment.
    We replicate the whole pipeline multiple times on a different set of samples and
    periods.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过模拟来检查我们是否成功设计了一个实验。我们在不同的样本和时间段上多次复制整个流程。
- en: A *simulated A/A test* involves randomly sampling two groups with no incurred
    difference and applying a chosen test statistic. We repeat these actions many
    times (say 1,000 or 10,000 times) and expect the p-value to follow a uniform distribution
    (if everything is correct). For instance, in 5% of simulations, the test will
    reject the null hypothesis for *α* = 0.05\. The exact percentage of cases when
    the test does catch a difference for two groups is a *simulated type I error rate.*
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 一个*模拟的A/A测试*涉及随机抽取两组没有产生差异的样本，并应用选择的测试统计量。我们重复这些动作很多次（比如说1,000或10,000次），并期望p值遵循均匀分布（如果一切正常）。例如，在5%的模拟中，测试将以*α*
    = 0.05拒绝零假设。测试确实捕捉到两组差异的确切百分比是一个*模拟的第一类错误率*。
- en: A *simulated A/B test* does a similar thing, but now we add an uplift of a specific
    size (usually MDE of interest) to the second group B (we assume that groups A
    and B are the same size as they will be during the real A/B test). Again, we apply
    our test statistic and run it 1,000 to 10,000 times. After that, we reexamine
    the distribution of resulting p-values and count how many times we rejected the
    null hypothesis (“the p-value passed the threshold”). The percentage of cases
    when the chosen test rejects the null hypothesis is an estimation of sensitivity
    (1 – *β*), which is the probability that the test catches the difference if there
    is one. If we subtract sensitivity from 1, we get a *type II error rate* (the
    probability of ignoring the difference between A and B when there is one). If
    calculated type I and II error rates fit predefined levels, then the statistical
    test is picked properly, and the sample size is estimated correctly (see figure
    12.8).
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 一个*模拟的A/B测试*做的是类似的事情，但现在我们给第二组B（我们假设A组和B组的大小与真实A/B测试时相同）增加一个特定大小的提升（通常是感兴趣的MDE）。再次，我们应用我们的测试统计量，并运行它1,000到10,000次。之后，我们重新检查结果的p值分布，并计算我们拒绝了零假设（“p值通过了阈值”）的次数。选择测试拒绝零假设的案例百分比是敏感度的估计（1
    – *β*），即测试在存在差异时捕捉到差异的概率。如果我们从敏感度中减去1，我们得到*第二类错误率*（当存在A和B之间的差异时忽略差异的概率）。如果计算出的I型和II型错误率符合预定义的水平，那么统计测试就被正确选择，样本大小也被正确估计（见图12.8）。
- en: '![figure](../Images/CH12_F08_Babushkin.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F08_Babushkin.png)'
- en: Figure 12.8 Simulation provides a final validation that everything is correct
    and set up to run an A/B test.
  id: totrans-138
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.8 模拟提供了一个最终的验证，确保一切正确设置，可以运行A/B测试。
- en: 12.2.6 When A/B testing is not possible
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.6 当A/B测试不可行时
- en: There are situations where running classic A/B tests is not feasible or desirable—either
    due to legal restrictions (certain industries, such as healthcare and finance,
    have strict regulations that prohibit conducting experiments on customers), logistical
    limitations (it may be difficult to randomly divide the customer base into two
    groups for testing), or other reasons.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些情况下，运行经典的A/B测试是不可行或不理想的——可能是因为法律限制（某些行业，如医疗保健和金融，有严格的法规，禁止对客户进行实验），物流限制（可能很难将客户基础随机分成两组进行测试），或其他原因。
- en: 'There are different ways to tackle this problem, but since this is a narrow
    topic that is out of the scope of this book, we will not cover it in detail. For
    your convenience, however, we list them here so you can use them as keywords for
    a more in-depth look:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 有不同的方法来解决这个问题，但由于这是一个超出本书范围的主题，我们不会详细讨论。为了您的方便，我们在这里列出它们，以便您可以将它们用作更深入研究的关键词：
- en: Casual effect
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因果效应
- en: Difference-in-difference
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 差分法
- en: Synthetic control
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 合成控制
- en: Interrupted time-series analysis
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中断时间序列分析
- en: Regression discontinuity design
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 回归不连续设计
- en: Causal inference
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因果推断
- en: 12.3 Reporting results
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.3 报告结果
- en: Monitoring an ongoing experiment is important for ensuring it runs smoothly
    and produces reliable results. If something goes wrong during the experiment,
    it is critical to promptly identify and address the problem to avoid a growing
    negative effect. Sometimes it is possible to exclude specific users, items, or
    segments from an experiment and move on. However, this option is not recommended
    if it was not considered in the initial design. In other cases, we prefer to terminate
    an experiment entirely and start investigating factors that have caused the failure.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 监控正在进行中的实验对于确保其顺利运行并产生可靠的结果至关重要。如果在实验过程中出现问题，及时识别和解决问题以避免负面影响的扩大至关重要。有时可能排除特定用户、项目或段落的实验，并继续进行。然而，如果这不是在初始设计中考虑的，则不建议这样做。在其他情况下，我们更喜欢完全终止实验并调查导致失败的因素。
- en: Campfire story from Arseny
  id: totrans-150
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 来自阿列克谢的营火故事
- en: 'Those working in an extra-flexible startup environment may think that all the
    reporting only applies to big corps, but that is not correct; even in small companies,
    enough effort should be dedicated to ensure proper reporting and experiment management.
    I learned this lesson the hard way: once I worked in a relatively small company
    with only three ML engineers, where I was to improve the core performance of a
    model. After months of research and experiments, I managed to achieve good results,
    which were highly appreciated by my manager and the company’s CTO. I was into
    production implementation of the new model when a message from the CTO popped
    up: “Hey, we have a board meeting tomorrow, and I want to highlight your achievement
    on the slides. Please give me detailed information on X with the granularity of
    Y.”'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个额外灵活的初创环境工作的那些人可能会认为所有的报告都只适用于大公司，但这并不正确；即使在小型公司，也应投入足够的努力以确保适当的报告和实验管理。我通过艰难的方式学到了这个教训：我曾经在一个相对较小的公司工作，那里只有三名机器学习工程师，我的任务是提高一个模型的核心性能。经过数月的研发和实验，我设法取得了良好的成果，得到了我的经理和公司CTO的高度赞赏。当我准备将新模型投入生产实施时，CTO的一条消息弹了出来：“嘿，我们明天要开董事会会议，我想在幻灯片上突出你的成就。请给我提供关于X的详细信息和Y的粒度。”
- en: I tried to make a report per the request, but suddenly, after careful analysis,
    the numbers showed that the new model’s performance was actually worse than the
    old one’s! It looked awful, but I definitely wasn’t going to try to trick the
    CTO by reporting nonexistent better results. Given that it was my first big project
    at this company, it looked very suspicious. The group of three—the CTO, my manager,
    and myself—started digging into the problem.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我按照要求尝试制作了一份报告，但突然，经过仔细分析，数字显示新模型的性能实际上比旧模型差！看起来很糟糕，但我绝对不打算通过报告不存在的更好结果来欺骗CTO。鉴于这是我在这家公司的第一个大项目，这看起来非常可疑。我们三个人——CTO、我的经理和我——开始深入调查这个问题。
- en: 'It was only close to midnight that I found the root cause: while running additional
    experiments, I accidentally overwrote the results of the best model with some
    unsuccessful experiments and used this data for the board meeting report. Because
    I was the only person working on the problem, I didn’t pay enough attention to
    that, and the lack of proper reporting and experiment management (just semirandom
    chunks of data stored on a dev machine instead) led to this incident.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 直到快到午夜，我才找到了根本原因：在运行额外实验时，我意外地用一些不成功的实验覆盖了最佳模型的结果，并使用这些数据为董事会会议报告。因为我是在处理这个问题的唯一一个人，我没有足够注意这一点，而且缺乏适当的报告和实验管理（只是在开发机上存储的半随机数据块）导致了这一事件。
- en: 12.3.1 Control and auxiliary metrics
  id: totrans-154
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.1 控制和辅助指标
- en: In section 12.2.1, we mentioned control and auxiliary metrics that we should
    monitor during the test. They can hint if something goes wrong before the key
    metrics experience a significant drop. For instance, it is important to track
    user feedback—if you notice a significant drop in user engagement or a spike in
    user churn, it is a clear indicator of malfunction. In this case, it may indicate
    that the experimental group is not responding well to the pushed changes. This
    information can easily lead to an early termination.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在12.2.1节中，我们提到了在测试期间应监控的控制和辅助指标。它们可以在关键指标出现显著下降之前提示出问题。例如，跟踪用户反馈很重要——如果你注意到用户参与度显著下降或用户流失率激增，这是一个明显的故障指标。在这种情况下，这可能表明实验组对推入的变化反应不佳。这些信息可以轻易导致实验提前终止。
- en: 'Also, when conducting an A/B test, we should consider fairness and biases among
    different segments of users, which can affect target and auxiliary metrics. This
    analysis is similar to what we covered in depth in chapter 9\. For further reading,
    we recommend “Fairness through Experimentation: Inequality in A/B Testing as an
    Approach to Responsible Design” by Guillaume Saint-Jacques et al. ([https://arxiv.org/pdf/2002.05819.pdf](https://arxiv.org/pdf/2002.05819.pdf)).'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '此外，在进行A/B测试时，我们应该考虑不同用户群体之间的公平性和偏见，这可能会影响目标和辅助指标。这种分析与我们第9章中深入探讨的内容相似。关于进一步阅读，我们推荐Guillaume
    Saint-Jacques等人所著的《Fairness through Experimentation: Inequality in A/B Testing
    as an Approach to Responsible Design》（[https://arxiv.org/pdf/2002.05819.pdf](https://arxiv.org/pdf/2002.05819.pdf))。'
- en: 12.3.2 Uplift monitoring
  id: totrans-157
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.2 提升量监控
- en: The most valuable measurement to track during an A/B experiment is the uplift
    or the relative difference in the key metric between group A and group B. The
    longer the experiment runs, the greater the sensitivity of the test and the smaller
    the effect (either positive or negative) we can detect.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在A/B实验期间，最有价值的测量指标是提升量，即A组和B组关键指标之间的相对差异。实验运行时间越长，测试的敏感性就越高，我们能够检测到的效果（无论是正面还是负面）就越小。
- en: Figure 12.9 shows a funnel representing the range of effects that we cannot
    detect with statistical significance. If the uplift moves outside this funnel,
    the effect is significant. Please note that without a specific design, you cannot
    peek into the test as many times as you wish until you see the desired results.
    For further reading on the subject, we recommend “Peeking Problem—The Fatal Mistake
    in A/B Testing and Experimentation” by Oleg Ya ([https://gopractice.io/data/peeking-problem/](https://gopractice.io/data/peeking-problem/))
    and “Sequential A/B Testing, Further Reading Choosing Sequential Testing Framework—Comparisons
    and Discussions” by Mårten Schultzberg et al. ([https://mng.bz/NBon](https://mng.bz/NBon)).
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.9显示了表示我们无法以统计显著性检测到的效果范围的漏斗。如果提升量移动到这个漏斗之外，那么效果是显著的。请注意，如果没有具体的设计，你不能像你希望的那样频繁地查看测试，直到看到期望的结果。关于这个主题的进一步阅读，我们推荐Oleg
    Ya的《Peeking Problem—The Fatal Mistake in A/B Testing and Experimentation》（[https://gopractice.io/data/peeking-problem/](https://gopractice.io/data/peeking-problem/))
    和 Mårten Schultzberg等人所著的《Sequential A/B Testing, Further Reading Choosing Sequential
    Testing Framework—Comparisons and Discussions》（[https://mng.bz/NBon](https://mng.bz/NBon))。
- en: '![figure](../Images/CH12_F09_Babushkin.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_F09_Babushkin.png)'
- en: Figure 12.9 An example of cumulative lift dynamics over time with specific confidence
    intervals
  id: totrans-161
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.9 时间累积提升动态示例，以及具体的置信区间
- en: 'This funnel can be calculated based on the MDC. Here, we need to solve the
    same equation we saw earlier—however, this time for different time periods—but
    we cannot make a decision until a period of time that we calculated in advance
    has passed. You could ask: what’s the point of using it then? The answer is to
    have an emergency stop criterion to abort the experiment if results are outside
    the funnel and negative—the least expected, desirable, and probable outcome. For
    any sequential testing framework mentioned by the link earlier (e.g., mSPRT),
    we can make a decision as soon as results are outside the funnel or the experiment
    time has ended.'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 这个漏斗可以根据MDC计算得出。在这里，我们需要解决之前看到的相同方程——然而，这次是针对不同的时间段——但我们不能在没有提前计算出的时间段过去之前做出决定。你可能会问：那么使用它的意义在哪里呢？答案是，为了有一个紧急停止标准，如果结果超出了漏斗并且是负面的——这是最不期望、最不希望和最不可能的结果，我们可以终止实验。对于之前提到的任何顺序测试框架（例如，mSPRT），我们可以在结果超出漏斗或实验时间结束时立即做出决定。
- en: 12.3.3 When to finish the experiment
  id: totrans-163
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.3 何时结束实验
- en: It might be tempting to prematurely stop or extend an A/B test based on interim
    results. However, this can lead to erroneous conclusions due to changes in statistical
    power and the risk of false positives or negatives if we have not incorporated
    sequential testing. So when should we stop an experiment if we are not doing sequential
    testing?
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 基于中间结果提前停止或延长A/B测试可能会很有诱惑力。然而，如果没有采用顺序测试，这可能导致由于统计功效的变化以及假阳性或假阴性的风险而得出错误的结论。所以，如果我们没有进行顺序测试，我们应该在什么时候停止实验？
- en: In general, an experiment should run according to the predetermined design unless
    there’s a catastrophic drawdown in key metrics (a significant negative effect)
    that would result in a meaningful financial loss had the experiment continued.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，实验应该按照预定的设计进行，除非关键指标出现灾难性的下降（显著的负面效果），如果实验继续进行，这将导致有意义的财务损失。
- en: On the other hand, if you see positive effects in key metrics, the best practice
    is to stick with the initial plan and let the experiment run its full course.
    It allows you to confirm that these positive effects are sustained over time and
    are not a result of short-term fluctuations.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，如果你在关键指标中看到积极的效果，最佳实践是坚持初始计划，让实验完整运行。这让你可以确认这些积极效果随着时间的推移而持续，并且不是短期波动的结果。
- en: What about those borderline cases where some metrics are positive, some are
    negative, and others hover around the MDE? It’s crucial during the experimental
    design phase to decide how you will interpret these mixed outcomes and set priorities
    among the different key metrics.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 对于那些边界案例，一些指标是正的，一些是负的，还有一些在MDE周围徘徊的情况怎么办？在实验设计阶段，决定你将如何解释这些混合结果，并在不同的关键指标之间设定优先级是至关重要的。
- en: If you can’t wait to see the final results, consider using methods like sequential
    testing, which allows for repeated significance testing at different stages of
    the experiment. These methods come with their own assumptions and considerations,
    so make sure you understand them fully before proceeding.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你迫不及待地想看到最终结果，考虑使用如顺序测试等方法，这允许在实验的不同阶段进行重复的显著性测试。这些方法有其自己的假设和考虑因素，所以在进行之前确保你完全理解它们。
- en: Deciding whether to stop or continue an experiment is a complex task that requires
    careful consideration of the metrics, potential outcomes, and their effects. Document
    these decisions in your experimental protocol, including criteria for possible
    early termination.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 决定是否停止或继续实验是一个复杂的任务，需要仔细考虑指标、潜在结果及其影响。在你的实验方案中记录这些决定，包括可能的早期终止标准。
- en: 12.3.4 What to report
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.4 应报告的内容
- en: After finishing the experiment, it is time to start our analysis. Here we need
    to calculate the required metrics, double-check monitoring, and provide confidence
    intervals for every measurement.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 实验完成后，是时候开始我们的分析了。在这里，我们需要计算所需的指标，双重检查监控，并为每个测量提供置信区间。
- en: 'Not every experiment is successful. According to our experience, it is quite
    good to have 20% of A/B tests show a statistically significant difference (recall
    that usually if the false positive rate is 5%, the margin is 15%). And remember:
    if the test was statistically significant, it doesn’t mean that the results are
    positive or massive.'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 并非每个实验都是成功的。根据我们的经验，有20%的A/B测试显示出统计学上的显著差异是相当不错的（记住，通常如果假阳性率为5%，则差异为15%）。并且记住：如果测试在统计学上是显著的，并不意味着结果是积极的或巨大的。
- en: 'Suppose we decide that the A/B test is successful and the effect is significant.
    In that case, we have two options:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们决定A/B测试是成功的，效果是显著的。在这种情况下，我们有两种选择：
- en: '*Report a pointwise effect—*“Effect is significant and equal to X,” where X
    is the calculated difference between metric values on both experimental and control
    groups.'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*报告点估计效果—*“效果是显著的，等于X，”其中X是实验组和对照组指标值计算出的差异。'
- en: '*Estimate the confidence interval for effect—*If the pessimistic estimate of
    the effect is equal to the lower confidence bound of the difference, the conservative
    estimate is equal to the pointwise difference, and the optimistic estimate is
    equal to the upper confidence bound.'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*估计效果置信区间—*如果效果的最悲观估计等于差异的下置信界限，保守估计等于点估计差异，乐观估计等于差异的上置信界限。'
- en: We have provided the core information of the report (of course, the reported
    metrics should be understandable to the audience, preferably expressed in earned
    or saved money, longer user sessions, etc.). In addition, it is good to dive deeper
    into the change in metrics, analyze how it affected different user or item segments,
    and outline the further steps (how overall metrics might change if we roll up
    on 100%). Table 12.1 shows examples of what fields can be included in the reporting
    table.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经提供了报告的核心信息（当然，报告的指标应该对观众来说是可理解的，最好用赚取或节省的钱、更长的用户会话等来表示）。此外，深入分析指标的变化，分析它如何影响不同的用户或项目细分，并概述进一步步骤（如果我们汇总到100%，整体指标可能会如何变化）是很好的。表12.1显示了报告表中可以包含的字段示例。
- en: Table 12.1 An example of what fields can be included in the reporting table
  id: totrans-177
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表12.1 报告表中可以包含的字段示例
- en: '| Metric | Group A | Group B | MDE | Lift | p-value | Conclusion |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 指标 | 组A | 组B | MDE | 提升率 | p值 | 结论 |'
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- |'
- en: '| CVR  | 75.2%  | 79.8%  | 5%  | 6.12%  | 0.0472  | +4.2–6.9% (significant)  |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| CVR  | 75.2%  | 79.8%  | 5%  | 6.12%  | 0.0472  | +4.2–6.9% (显著)  |'
- en: '| AOV  | $232.2  | $242.8  | 11%  | 4.57%  | 0.3704  | No significant effect  |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| AOV  | $232.2  | $242.8  | 11%  | 4.57%  | 0.3704  | 无显著影响  |'
- en: '| …  | …  | …  | …  | …  | …  | …  |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| …  | …  | …  | …  | …  | …  | …  |'
- en: Once uplift is reported, the possible positive scenario may include one more
    experiment on a larger proportion of data or a complete switch to a new system—or
    a full-scale rollout, pause, and reversed A/B test. A series of successful A/B
    experiments will provide you with a solid data-driven argument that will serve
    as adequate support in making decisions on whether to give the green light to
    further steps.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦提升被报告，可能的积极场景可能包括在更大比例的数据上进行一个额外的实验，或者完全切换到新系统——或者全面推出、暂停和反向的A/B测试。一系列成功的A/B实验将为您提供坚实的基于数据的论据，这将作为在决定是否批准进一步步骤时的充分支持。
- en: 12.3.5 Debrief document
  id: totrans-184
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.5 简报文档
- en: Writing a debrief document is valuable for transparent communication of A/B
    experiment results, as well as for improving the quality of future experiments.
    It should be created during or immediately after the experiment to summarize key
    findings, including captured insights, detected problems, and recommendations.
    Sharing this document with the team ensures everyone is on the same page and enables
    continuous learning and improvement of the system.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 编写简报文档对于透明地沟通A/B实验结果以及提高未来实验的质量都是很有价值的。它应该在实验期间或实验结束后立即创建，以总结关键发现，包括捕获的见解、检测到的问题和建议。与团队分享此文档确保每个人都处于同一页面上，并能够持续学习和改进系统。
- en: If the experiment is successful, a debrief document will include suggestions
    for similar experiments in other products. In case of failure, it is important
    to discuss what should be done differently in future tests and what mistakes should
    be avoided, as well as to develop new control metrics to prevent similar failures
    in the future earlier during an experiment.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 如果实验成功，简报文档将包括对其他产品中类似实验的建议。如果实验失败，讨论在未来的测试中应该做些什么不同，应该避免哪些错误，以及开发新的控制指标以防止在实验早期发生类似的失败，这些都是非常重要的。
- en: '12.4 Design document: Measuring and reporting'
  id: totrans-187
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.4 设计文档：测量和报告
- en: Because reporting cannot be designed at the preproduction stages when the design
    document is set to be prepared, it should be skipped by default. However, we’ve
    included it for demonstration purposes.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 由于在准备设计文档的预生产阶段无法设计报告，因此默认情况下应跳过。然而，我们已将其包括在内以供演示目的。
- en: 12.4.1 Measuring and reporting for Supermegaretail
  id: totrans-189
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.4.1 Supermegaretail的测量和报告
- en: Measuring and reporting for Supermegaretail as part of the design document have
    their own peculiarities, and one of the crucial ones is that since we are predicting
    the future, we can only assess the quality of the system when the future comes;
    at the end of the day, we want to understand how much profit we will be able to
    generate, but we can only know this post facto, while the only way to evaluate
    this is by using certain metrics that are not directly related.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 作为设计文档的一部分，对Supermegaretail的测量和报告有其独特的特点，其中之一是，由于我们正在预测未来，我们只能在未来到来时评估系统的质量；最终，我们希望了解我们将能够产生多少利润，但我们只能事后知道这一点，而评估这一点的唯一方法是通过某些与直接相关的指标无关的指标。
- en: 'Design document: Supermegaretail'
  id: totrans-191
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 设计文档：Supermegaretail
- en: IX. Measuring and reporting
  id: totrans-192
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: IX. 测量和报告
- en: i. Measuring results
  id: totrans-193
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: i. 测量结果
- en: As a first step to improving the prediction quality of the already deployed
    sales forecasting model, we plan to experiment with combining existing models
    (one per category) into one. The reasoning behind this is that we will encode
    information about the group of items without loss in specificity but will gain
    more data and, thus, better generalization. Even with no improvement in quality,
    it is still much easier to maintain one model than many.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 作为提高已部署的销售预测模型预测质量的第一步，我们计划尝试将现有的模型（每个类别一个）合并成一个。背后的理由是，我们将编码关于物品组的信息，而不会损失具体性，但将获得更多数据，从而实现更好的泛化。即使没有质量上的改进，维护一个模型也比维护多个模型容易得多。
- en: 'As offline metrics, we looked into different quantiles, percentage errors,
    and biases. But instead of evaluating only the overall score, we checked on metrics
    and the error analysis of specific categories. These offline tests yielded the
    following intermediate results:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 作为离线指标，我们考虑了不同的分位数、百分比误差和偏差。但我们不仅评估整体得分，还检查了特定类别的指标和错误分析。这些离线测试产生了以下中间结果：
- en: The general prediction quality steadily increases across all metrics, and the
    majority of validation folds when switching to a split model.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在所有指标上，一般预测质量稳步提高，并且在切换到分割模型时，大多数验证折都得到了提高。
- en: The categories with a small number of products showed an increase in the offline
    metrics compared to a baseline (multi) model. The amount of data they had was
    insufficient to learn meaningful patterns. The large categories didn’t change
    many wins when switching to a unified model. The result is reproducible through
    different seasons and key geo regions.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与基线（多）模型相比，产品数量较少的类别在离线指标上有所增加。他们拥有的数据量不足以学习到有意义的模式。大型类别在切换到统一模型时，改变了很多胜利。结果在不同季节和关键地理区域都是可重复的。
- en: Previously, A/B tests provided some estimation of what uplift to expect in each
    major category based on offline metrics. If we reduce metric M for product P by
    X%, it leads to a decrease in missed profit (out-of-stock) by Y% and cuts losses
    due to the overstock situation by Z%. According to our estimates, the total increase
    in revenue for the pilot group is expected to be 0.3% to 0.7%.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 以前，A/B测试基于离线指标提供了一些对每个主要类别预期提升的估计。如果我们将产品P的指标M减少X%，将导致缺货（缺货）的利润减少Y%，并减少由于过剩库存情况造成的损失Z%。根据我们的估计，试点组的总收入预期将增加0.3%至0.7%。
- en: ii. A/B tests
  id: totrans-199
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: ii. A/B测试
- en: '*Hypothesis*—The experiment hypothesis is that according to the offline metrics
    improvement, we expect revenue to increase by at least 0.3\.'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*假设*—实验假设是根据离线指标的改进，我们预计收入至少会增加0.3%。'
- en: '*Key metrics*—The best proxy metric for revenue we can use in the A/B experiment
    is the average check. It perfectly correlates with the revenue (assuming the number
    of checks has not changed). The atomic observation for the statistical test will
    be a single check.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*关键指标*—在A/B实验中，我们可以使用的最佳代理指标是平均检查金额。它与收入（假设检查次数没有变化）完美相关。统计测试的原子观察将是单个检查。'
- en: '*Splitting strategy*—We split by distribution center and, through them, acquire
    two sets of stores, as each center serves a cluster of stores. From those sets,
    we pick subsets that are representative of each other and use them as groups A
    and B.'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*分割策略*—我们按配送中心进行分割，并通过它们获取两组商店，因为每个中心服务于一组商店。从这些集合中，我们选择彼此代表性的子集，并将它们用作组A和B。'
- en: '*Additional metrics*—Control metrics for the experiment are'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*附加指标*—实验的控制指标是'
- en: '*Number of checks per day*—Whether the sales volume has no significant drop.'
  id: totrans-204
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每天检查次数*—检查销售量是否有显著下降。'
- en: '*Model’s update frequency*—Does the model accumulate newly gathered data regularly?'
  id: totrans-205
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型的更新频率*—模型是否定期积累新收集的数据？'
- en: '*Model’s offline metrics*—Quantile metric, bias, WAPE.'
  id: totrans-206
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型的离线指标*—分位数指标、偏差、WAPE。'
- en: '*Auxiliary metrics*—'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*辅助指标*—'
- en: '*Daily revenue*'
  id: totrans-208
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每日收入*'
- en: '*Daily profit*'
  id: totrans-209
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每日利润*'
- en: '*Statistical criteria*—We’ll use Welch’s t-test to capture the difference between
    samples.'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*统计标准*—我们将使用Welch的t检验来捕捉样本之间的差异。'
- en: '*Error rates*—We set the significant level to 5% and the type II error to 10%.'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*错误率*—我们将显著性水平设定为5%，II型错误为10%。'
- en: '*Experiment duration*—According to our calculations, 2 weeks will be enough
    to check the results. However, given the distribution center’s replenishment cadence
    of 1 week, we will extend this period to one full month.'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*实验持续时间*—根据我们的计算，两周时间足够检查结果。然而，考虑到配送中心的补充节奏为一周，我们将此期限延长至整整一个月。'
- en: iii. Reporting results
  id: totrans-213
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: iii. 报告结果
- en: 'A report containing the following chapters is to be provided:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 应提供包含以下章节的报告：
- en: '*Results*—Shown as 95% confidence intervals for primary and auxiliary metrics'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*结果*—以主要和辅助指标的95%置信区间表示'
- en: '*Graphical representation*—The value of a specific metric at a specific date
    for all metrics from both control and treatment groups for ease of consumption'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*图形表示*—特定日期特定指标的值，以及来自控制组和处理组的所有指标的值，以便于消费'
- en: '*Absolute numbers**—*For example, the number of shops in each group, the total
    number of checks, and total revenue'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*绝对数字**—*例如，每组商店的数量、总检查次数和总收入'
- en: '*Methodology**—*For example, how groups were picked to be representative of
    each other, simulations run to check for type I and type II errors, etc. (see
    the appendix for more details)'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*方法**—*例如，如何选择代表彼此的组，运行模拟以检查I型和II型错误等。（见附录以获取更多详细信息）'
- en: '*Recommendation/further steps**—W*hat to do next based on the received results'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*推荐/进一步步骤**—基于收到的结果下一步该做什么'
- en: 12.4.2 Measuring and reporting for PhotoStock Inc.
  id: totrans-220
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.4.2 为PhotoStock Inc.测量和报告
- en: We’ve included this phase as a template for the PhotoStock Inc. case.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将这一阶段作为PhotoStock Inc.案例的模板。
- en: 'Design document: PhotoStock Inc.'
  id: totrans-222
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 设计文档：PhotoStock Inc.
- en: IX. Measuring and reporting
  id: totrans-223
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: IX. 测量和报告
- en: i. Measuring results
  id: totrans-224
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: i. 测量结果
- en: 'The following is our baseline list of offline metrics:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我们基线列表中的离线指标：
- en: '*NDCG@10 (human)**—*We use human-labeled relevance scores for each photo in
    the search engine results page (SERP).'
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*NDCG@10（人工）*—*我们使用人工标记的相关性分数作为搜索结果页面（SERP）中每张照片的相关性评分。'
- en: '*NDCG@30 (implicit)*—We use implicit feedback as a relevance score:'
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*NDCG@30（隐式）*—我们使用隐式反馈作为相关性评分：'
- en: '*3*—Image bought'
  id: totrans-228
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*3*—购买的图片'
- en: '*2*—Image added to Favorites'
  id: totrans-229
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*2*—添加到收藏夹的图片'
- en: '*1*—Image clicked on'
  id: totrans-230
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*1*—点击的图片'
- en: '*0*—Views with no interactions'
  id: totrans-231
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*0*—无交互的浏览'
- en: '*MRR (human)*—The average position of the first photo labeled as relevant.'
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*MRR（人工）*—被标记为相关性的第一张照片的平均位置。'
- en: '*MRR (click)**—*The average position of the first photo clicked in SERP.'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*MRR（点击）*—*在搜索结果页面（SERP）中首次点击的照片的平均位置。'
- en: '*MRR (purchase)*—The average position of the first photo purchased in SERP.'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*MRR（购买）*—在搜索结果页面（SERP）中首次购买的照片的平均位置。'
- en: We retrospectively apply these metrics to the current non-ML search algorithm
    by collecting SERPs displayed for each query. We then measure our online metrics
    (CTR and CVR) over different time periods. After that, we calculate Spearman’s
    rank correlation coefficient and select an offline metric that correlates most
    strongly with each online metric. The chosen offline metric is then used in a
    simple regression model to provide an initial estimate of the MDE in an A/B experiment.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 我们回顾性地将这些指标应用于当前的非机器学习搜索算法，通过收集每个查询显示的搜索结果页面（SERP）。然后，我们在不同的时间段内测量我们的在线指标（点击率CTR和转化率CVR）。之后，我们计算Spearman等级相关系数，并选择与每个在线指标相关性最强的离线指标。所选的离线指标随后用于一个简单的回归模型，以提供一个A/B实验中MDE的初始估计。
- en: 'Given that this is the first A/B test, we do not yet have comparative data
    for more precise MDE estimation. However, for future testing, we propose a systematic
    approach where we will collect and correlate the differences in offline and online
    metrics between variations A and B from each A/B test. The ultimate goal is to
    establish an approximate correlation: for each X% improvement in offline metric
    C, we see a Y% uplift in online metric D.'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这是第一次A/B测试，我们还没有用于更精确MDE估计的比较数据。然而，对于未来的测试，我们提出了一种系统性的方法，我们将收集和关联每个A/B测试中A和B变体之间的离线和在线指标差异。最终目标是建立一个近似的关联：对于离线指标C的X%改进，我们观察到在线指标D的Y%提升。
- en: Further refinement of our online metrics estimation could involve building a
    user behavior simulation. However, that would be a more complex task, and we believe
    the current approach provides a solid foundation for our testing.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 进一步细化我们的在线指标估计可能涉及构建用户行为模拟。然而，这将是一个更复杂的任务，我们相信当前的方法为我们测试提供了一个坚实的基础。
- en: 'Apart from the aforementioned automated offline testing methods, we can also
    incorporate feedback from assessors. We propose two evaluation tasks:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 除了上述的自动化离线测试方法外，我们还可以结合评估者的反馈。我们提出了两个评估任务：
- en: Given a query Q and the top 20 photos suggested by the new search engine, assessors
    would rank the overall SERP from 1 to 5 based on its relevance.
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 给定查询Q和新搜索引擎建议的前20张照片，评估者将根据其相关性将整体搜索结果页面（SERP）从1到5进行排名。
- en: Presented with a query Q and the top 20 photos from two different search engines
    (one being the current version and the other the new version), assessors would
    determine which SERP is more relevant.
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在展示查询Q和两个不同搜索引擎（一个是当前版本，另一个是新版本）的前20张照片后，评估者将确定哪个搜索结果页面（SERP）更相关。
- en: The second task allows for a comparative assessment, which generally produces
    more robust evaluations by reducing the influence of individual scoring biases.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个任务允许进行比较评估，这通常通过减少个人评分偏差的影响，产生更稳健的评价。
- en: ii. A/B experiment design
  id: totrans-242
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: ii. A/B实验设计
- en: 'Let’s say we have received approximate estimates of the minimum expected effect
    in the offline metrics: +5% for CTR and +20% for CVR. Our *experiment hypothesis*
    is the following:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们已经收到了离线指标中最低预期效果的近似估计：点击率（CTR）+5% 和转化率（CVR）+20%。我们的*实验假设*如下：
- en: If we switch the current search engine to our ML-based solution, it will provide
    more relevant search results, which will be reflected in an increase in CTR by
    at least 5% and an increase in CVR by at least 20%.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果我们将当前的搜索引擎切换到我们的基于机器学习的解决方案，它将提供更相关的搜索结果，这将在点击率（CTR）至少提高 5% 和转化率（CVR）至少提高
    20% 的基础上反映出来。
- en: Consequently, our *key metrics* are CTR and CVR.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们的*关键指标*是点击率（CTR）和转化率（CVR）。
- en: '*Control metrics,* which should not change during the experiment, are'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: '*控制指标*在实验期间不应发生变化'
- en: '*Views per variation*—If not equal, either there is a problem in splitting
    strategy, or we greatly affected user experience in the testing group.'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每个变体的浏览量*—如果不相等，要么是分割策略有问题，要么我们在测试组中极大地影响了用户体验。'
- en: '*Response latency*—This should not increase much, or at least fit SLAs.'
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*响应延迟*—这不应该增加太多，至少要符合服务等级协议（SLAs）。'
- en: '*Queries per second*—If the value is low, the search engine seems to become
    unavailable.'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每秒查询数*—如果这个值低，搜索引擎似乎变得不可用。'
- en: '*A daily number of queries and percentage of sessions started from the search
    bar*—Both inform user engagement; we expect these numbers to not decrease.'
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每日查询数和从搜索栏开始的会话百分比*—两者都反映了用户参与度；我们预计这些数字不会下降。'
- en: '*A number of customer support reports*—If there is a spike, something is probably
    broken.'
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*客户支持报告的数量*—如果出现峰值，可能意味着有问题。'
- en: '*Auxiliary metrics* that give additional information but do not participate
    directly in the decision-making are'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: '*辅助指标*提供额外的信息，但不直接参与决策'
- en: '*Average time spent on SERP*—If increased, it can signal that the search engine
    has become worse and the user needs to spend more time, make more queries, and
    scroll more pages to find what they are looking for.'
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在 SERP 上花费的平均时间*—如果增加，这可能表明搜索引擎变得更差，用户需要花费更多时间，进行更多查询，滚动更多页面来找到他们想要的东西。'
- en: '*The total number of clicks and purchases per variation*—Both will report what
    leads to an increase in conversion rate (the nominator, the denominator, or both
    with different rates).'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*每个变体的点击数和购买数*—两者都将报告导致转化率提高的因素（分子、分母或两者以不同的比率）。'
- en: '*Total profit and average profit per purchase*.'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*总利润和每笔购买的平均利润*。'
- en: '*An average position of the clicked photo in SERP and an average number of
    queries per session*—A tricky metrics that, with a decrease, under some assumptions,
    indicate that it has become easier for the user to navigate and fewer actions
    and less time are needed to find what they needed.'
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*点击照片在搜索结果页面（SERP）中的平均位置和每次会话的平均查询数*—这是一个棘手的指标，在某些假设下，其下降可能表明用户导航变得更容易，找到所需内容所需的动作和时间更少。'
- en: '*Percentage of sessions ended with a purchase*—A less sensitive version of
    CVR.'
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*会话结束时的购买率*—这是转化率（CVR）的一个不太敏感的版本。'
- en: '*Splitting strategy*—No extra dependencies are added to the user experience
    by the new search engine, so nothing prevents us from dividing users in a standard
    way by their unique ID.'
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*分割策略*—新的搜索引擎不会向用户体验添加额外的依赖，所以我们不会因为用户的唯一 ID 而以标准方式分割用户，没有任何东西阻止我们这样做。'
- en: '*Statistical criteria*—Considering that we aim to increase CTR and CVR (both
    are proportion metrics), we choose the proportional Z-test.'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*统计标准*—考虑到我们的目标是提高点击率（CTR）和转化率（CVR）（两者都是比例指标），我们选择比例 Z 测试。'
- en: 'We’ll use conservative error rates for type I and II errors: *α* = 0.01 and
    *β* = 0.05:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用保守的错误率来处理第一类和第二类错误：*α* = 0.01 和 *β* = 0.05：
- en: '*Sample size*—Let’s analyze what we have before the test:'
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*样本大小*—在测试之前，让我们分析一下我们拥有的数据：'
- en: PhotoStock Inc. website has 100,000 visits daily
  id: totrans-262
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: PhotoStock Inc. 网站每日有 100,000 次访问
- en: 'Average search queries: 1.5 per visit'
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平均每次访问的搜索查询数：1.5
- en: 'Average number of photos viewed after each query: 20'
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每次查询后平均查看的照片数量：20
- en: 'Average percentage of viewed photos that were clicked: 10%'
  id: totrans-265
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平均查看照片的点击率：10%
- en: 'Average percentage of clicked photos that was purchased: 1%'
  id: totrans-266
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平均点击照片的购买率：1%
- en: 'Therefore, we have 100,000 × 1.5 × 20 = 3,000,000 views daily:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们每日有 100,000 × 1.5 × 20 = 3,000,000 次浏览：
- en: Baseline CTR is 10% (number of clicks per view)
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基准点击率（每浏览次数点击数）为 10%
- en: Baseline CVR is 10% * 1% = 0.1% (number of purchases per view)
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基准 CVR 是 10% * 1% = 0.1%（每浏览次数的购买数）
- en: Thus, we have 300,000 clicks and 3,000 purchases daily.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们每日有 300,000 次点击和 3,000 笔购买。
- en: Previously, we discussed that to avoid possible risks, we would like to roll
    out gradually. So for the first A/B, we will take only 10% for both groups (5%
    for group A and 5% for group B). That means we have 3,000,000 × 2.5% = 150,000
    views per day for each group.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 之前，我们讨论了为了避免可能的风险，我们希望逐步推出。所以对于第一个A/B，我们将只对两组各取10%（组A为5%，组B为5%）。这意味着我们每天每个组有3,000,000
    × 2.5% = 150,000次观看。
- en: 'How much time should the experiment take? The following is a formula for sample
    size estimation based on required MDE and error rates:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 实验应该持续多长时间？以下是基于所需MDE和错误率的样本大小估计公式：
- en: '![figure](../Images/babushkin-ch12-eqs-7x.png)'
  id: totrans-273
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/babushkin-ch12-eqs-7x.png)'
- en: Here *p**[A]* and *p**[B]* are old and new proportions (in our case, CTRs or
    CVRs), and *Z**[x]* are critical values of Z-statistic for a given level.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 这里*p**[A]*和*p**[B]*是旧和新的比例（在我们的情况下，是CTR或CVR），而*Z**[x]*是给定水平的Z统计量的临界值。
- en: 'We have 10% and 10.5% as old and new CTR values:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有10%和10.5%作为旧和新的CTR值：
- en: '![figure](../Images/babushkin-ch12-eqs-8x.png)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/babushkin-ch12-eqs-8x.png)'
- en: This leads to 131,095 views required, while we have 150,000 views daily for
    each group. This means that we need only 1 day to collect the necessary amount
    of data to detect a significant increase (5% or greater) for CTR.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致需要131,095次观看，而我们每天每个组有150,000次观看。这意味着我们只需要1天就能收集到检测到显著增加（5%或更高）所需的数据量。
- en: What about the conversion rate? We have 0.1% for the old version and 0.12% for
    the new version. Applying the preceding formula once again will lead to 978,693
    views required. So we need 7 days to collect this data.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 关于转化率呢？旧版本为0.1%，新版本为0.12%。再次应用前面的公式将导致需要978,693次观看。因此，我们需要7天来收集这些数据。
- en: Summing up, the experiment will run for a week to satisfy both metrics. A week
    is also good because it will cover the full cycle of week seasonality, if any
    (e.g., for PhotoStock Inc., there may be more professional users during working
    days and amateurs during weekends).
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，实验将持续一周以满足两个指标。一周也是好的，因为它将涵盖整个周的季节性周期，如果有的话（例如，对于PhotoStock Inc.，工作日可能有更多专业用户，周末可能有更多业余用户）。
- en: To check whether we did everything right, we will run simulated A/A and A/B
    tests multiple times, generating samples from the binomial distribution of estimated
    size and with required CTR and CVR values to ensure that calculated error rates
    are less than the desired ones.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查我们是否一切都做得正确，我们将多次运行模拟的A/A和A/B测试，从估计大小为二项分布的样本中生成，并具有所需的CTR和CVR值，以确保计算出的错误率低于期望值。
- en: iii. Reporting template
  id: totrans-281
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: iii. 报告模板
- en: During an experiment, we primarily monitored MDE dynamics. As expected, the
    CTR effect was statistically significant on the second day. In contrast, a statistically
    significant effect in CVR was detected only on the fourth day of the experiment.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 在实验期间，我们主要监控MDE动态。正如预期的那样，CTR效果在第二天就具有统计学意义。相比之下，在实验的第四天才检测到CVR的统计学意义。
- en: '![figure](../Images/CH12_UN01_Babushkin.png)'
  id: totrans-283
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_UN01_Babushkin.png)'
- en: CTR effect
  id: totrans-284
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: CTR效果
- en: '![figure](../Images/CH12_UN02_Babushkin.png)'
  id: totrans-285
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_UN02_Babushkin.png)'
- en: CVR effect
  id: totrans-286
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: CVR效果
- en: 'By the end, we collected the following metrics values:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 到最后，我们收集了以下指标值：
- en: CTR is 9.91% in group A and 10.51% in group B (+6% difference).
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 组A的CTR为9.91%，组B为10.51%（相差6%）。
- en: CVR is 0.10% in group A and 0.13% in group B (+29% difference).
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 组A的CVR为0.10%，组B为0.13%（相差29%）。
- en: 'We make the preliminary conclusion:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得出初步结论：
- en: The new search engine only slightly increased the number of clicks per view
    (+6%); however, the clickable photos turned out to be more relevant (+29% more
    conversions into purchases). Therefore, the A/B experiment was successful.
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新的搜索引擎仅略微增加了每观看一次的点击次数（+6%）；然而，可点击的图片结果证明更加相关（转化为购买的转换率增加了29%）。因此，A/B实验是成功的。
- en: Expended effect reporting
  id: totrans-292
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 消耗效果报告
- en: We applied the bootstrap procedure to switch from point-wise effect estimation
    to distribution. We treat the lower and upper bounds for the 95% confidence interval
    as pessimistic and optimistic effect estimations. We use the original point-wise
    effect as a conservative estimate.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应用了自举程序，从点估计效应转换为分布。我们将95%置信区间的下限和上限视为悲观和乐观的效应估计。我们使用原始的点估计作为保守估计。
- en: '![figure](../Images/CH12_UN03_Babushkin.png)'
  id: totrans-294
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_UN03_Babushkin.png)'
- en: Bootstrapped CTR
  id: totrans-295
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 自举CTR
- en: 'We report the following effect for CTR:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 我们报告以下CTR效果：
- en: The pessimistic estimate is +5.1% (new CTR is 10.4%).
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 悲观估计为+5.1%（新点击率是10.4%）。
- en: The conservative estimate is +6% (new CTR is 10.5%).
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保守估计为+6%（新CTR为10.5%）。
- en: The optimistic estimate is +6.8% (new CTR is 10.6%).
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 乐观估计为+6.8%（新CTR为10.6%）。
- en: '![figure](../Images/CH12_UN04_Babushkin.png)'
  id: totrans-300
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/CH12_UN04_Babushkin.png)'
- en: Bootstrapped CVR
  id: totrans-301
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 自举CVR
- en: 'We report the following effect for the CVR:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 我们报告以下CVR的效果：
- en: The pessimistic estimate is +19.2% (new CVR is 0.12%).
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 悲观估计为+19.2%（新CVR为0.12%）。
- en: The conservative estimate is +29% (new CVR is 0.13%).
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保守估计为+29%（新CVR为0.13%）。
- en: The optimistic estimate is +39.4% (new CVR is 0.14%).
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 乐观估计为+39.4%（新CVR为0.14%）。
- en: Scaling up the effect
  id: totrans-306
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 扩大效果
- en: Let’s evaluate these gains in terms of revenue when we scale the newly tested
    ML-based search engine to all traffic, assuming that the average photo profit
    ($3.0) and amount of daily visits (3 million) are the same.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们将新测试的基于机器学习的搜索引擎扩展到所有流量时，让我们以收入来评估这些收益，假设平均照片利润（$3.0）和每日访问量（300万）保持不变。
- en: 'The baseline CVR was 0.1%. Multiplying by daily traffic and fee, we get $9,000
    daily income or $3.3 million yearly:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 基线CVR为0.1%。乘以每日流量和费用，我们得到每日收入$9,000或每年$3.3百万：
- en: The pessimistic estimate gives us $10,800 daily (+$1,800) or $3.9 million yearly
    (+$600,000).
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 悲观估计给我们带来每日$10,800（+$1,800）或每年$3.9百万（+$600,000）。
- en: The conservative estimate gives us $11,700 daily (+$2,700) or $4.3 million yearly
    (+$1 million).
  id: totrans-310
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保守估计给我们带来每日$11,700（+$2,700）或每年$4.3百万（+$1百万）。
- en: The optimistic estimate gives us $12,600 daily (+$13,600) or $4.6 million yearly
    (+$1.3 million).
  id: totrans-311
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 乐观估计给我们带来每日$12,600（+$13,600）或每年$4.6百万（+$1.3百万）。
- en: These numbers fully justify all our efforts and time.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数字完全证明了我们所有的努力和时间。
- en: Further steps will require running two to three shorter A/B experiments to cover
    a larger percentage of users (for instance, 20% -> 30% -> 50%) to ensure the system
    is safe, the effect is reproducible, and the experiment results are trustworthy.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 进一步的步骤将需要运行两个到三个较短的A/B实验，以覆盖更大比例的用户（例如，20% -> 30% -> 50%），以确保系统安全，效果可重复，实验结果可靠。
- en: 'Consider these side notes:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下旁注：
- en: Control metrics detected no incidents during the experiment.
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制指标在实验期间未检测到任何事件。
- en: The average search time slightly decreased, which is a good sign. This means
    that the user experience has improved and that users can find what they need faster.
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平均搜索时间略有下降，这是一个好兆头。这意味着用户体验得到了改善，用户可以更快地找到他们需要的东西。
- en: The number of sessions that ended with purchase grew. SERPs became more relevant.
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以购买结束的会话数量增加。SERPs变得更加相关。
- en: The average profit per photo remained unchanged (~$3.0).
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每张照片的平均利润保持不变（约$3.0）。
- en: After the experiment, we also retrospectively estimated how many overall clicked
    photos were in the top 1,000 of the new model. It turns out that Recall@1000 for
    these clicks was 97%. This important finding hints at the further improvement
    of the system, specifically switching to the two-stage pipeline by adding a retrieval
    stage (candidate model).
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 实验结束后，我们还回顾性地估计了在新模型中点击的照片中有多少在顶部1,000名之内。结果是，这些点击的Recall@1000为97%。这一重要发现暗示了系统进一步改进的可能性，特别是通过添加检索阶段（候选模型）转向两阶段管道。
- en: Summary
  id: totrans-320
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Use offline evaluation to get an approximation of the expected effect of your
    ML system before deploying and running the online testing phase.
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在部署和运行在线测试阶段之前，使用离线评估来获取您机器学习系统预期效果的近似值。
- en: There are various ways to derive a connection between offline and online metrics,
    including benchmarks and the history of previously run A/B tests and their respective
    offline metrics.
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有各种方法可以推导出离线和在线指标之间的关系，包括基准和之前运行的A/B测试及其相应的离线指标。
- en: To make data-driven decisions about whether a new model is better than the old
    one (or an ML-based solution is better than a non-ML one), the industry standard
    is an A/B test (however, there are other options to derive a causal relationship).
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要关于新模型是否优于旧模型（或基于机器学习的解决方案是否优于非机器学习解决方案）做出数据驱动的决策，行业标准是A/B测试（然而，还有其他选项可以推导出因果关系）。
- en: To run an A/B test smoothly and safely, we need to formulate a plausible hypothesis,
    pick the right key/control/auxiliary metrics, estimate expected lift and experiment
    duration, and sometimes perform simulated A/A and A/B tests before conducting
    real testing.
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了顺利且安全地运行A/B测试，我们需要制定一个合理的假设，选择正确的关键/控制/辅助指标，估计预期的提升和实验持续时间，并在进行实际测试之前，有时进行模拟的A/A和A/B测试。
- en: While reporting the experiment results to stakeholders and teammates, we need
    to communicate the captured effect, what effect to expect if we roll out the service,
    what effect is seen in different segments, what problems were found during the
    experiment, and what the next steps and suggestions for further improvements are.
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在向利益相关者和团队成员报告实验结果时，我们需要传达捕捉到的效果，如果推出服务，预期会产生什么效果，不同细分市场看到的效果是什么，实验过程中发现了什么问题，以及下一步和进一步改进的建议。
