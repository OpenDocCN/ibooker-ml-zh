<html><head></head><body><section class="pagenumrestart" data-pdf-bookmark="Chapter 1. Introduction" data-type="chapter" epub:type="chapter"><div class="chapter" id="idm46066913346056">&#13;
<h1><span class="label">Chapter 1. </span>Introduction</h1>&#13;
&#13;
&#13;
<p>This is not so much an instructional manual, but rather notes, tables,&#13;
and examples for machine learning. It was created by the author as an&#13;
additional resource during training, meant to be distributed as a&#13;
physical notebook. Participants (who favor the physical characteristics&#13;
of dead-tree material) could add their own notes and thoughts and have a&#13;
valuable reference of curated examples.</p>&#13;
&#13;
<p>We will walk through classification with structured data. Other common machine learning applications&#13;
include predicting a continuous value (regression), creating clusters, or trying&#13;
to reduce dimensionality, among others.&#13;
This book does not discuss deep learning techniques. While those&#13;
techniques work well for unstructured data, most recommend&#13;
the techniques in this book for structured data.</p>&#13;
&#13;
<p>We assume knowledge and familiarity with Python. Learning&#13;
how to manipulate data using the <a href="https://pandas.pydata.org">pandas library</a> is useful. We have many examples using&#13;
pandas, and it is an excellent tool for dealing with&#13;
structured data. However, some of the indexing operations&#13;
may be confusing if you are not familiar with numpy. Full&#13;
coverage of pandas could be a book in itself.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Libraries Used" data-type="sect1"><div class="sect1" id="idm46066913081400">&#13;
<h1>Libraries Used</h1>&#13;
&#13;
<p><a data-primary="libraries" data-secondary="list of" data-type="indexterm" id="ix_ch01-asciidoc0"/>This book uses many libraries. This can be a good thing and a bad thing. Some of these libraries may be hard to install or conflict with other library versions. Do not feel like you need to install all of these libraries. Use “JIT installation” and only install the libraries that you want to use as you need them.</p>&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">autosklearn</code><code class="o">,</code> <code class="nn">catboost</code><code class="o">,</code>&#13;
<code class="nn">category_encoders</code><code class="o">,</code> <code class="nn">dtreeviz</code><code class="o">,</code> <code class="nn">eli5</code><code class="o">,</code> <code class="nn">fancyimpute</code><code class="o">,</code>&#13;
<code class="nn">fastai</code><code class="o">,</code> <code class="nn">featuretools</code><code class="o">,</code> <code class="nn">glmnet_py</code><code class="o">,</code> <code class="nn">graphviz</code><code class="o">,</code>&#13;
<code class="nn">hdbscan</code><code class="o">,</code> <code class="nn">imblearn</code><code class="o">,</code> <code class="nn">janitor</code><code class="o">,</code> <code class="nn">lime</code><code class="o">,</code> <code class="nn">matplotlib</code><code class="o">,</code>&#13;
<code class="nn">missingno</code><code class="o">,</code> <code class="nn">mlxtend</code><code class="o">,</code> <code class="nn">numpy</code><code class="o">,</code> <code class="nn">pandas</code><code class="o">,</code> <code class="nn">pdpbox</code><code class="o">,</code> <code class="nn">phate</code><code class="o">,</code>&#13;
<code class="nn">pydotplus</code><code class="o">,</code> <code class="nn">rfpimp</code><code class="o">,</code> <code class="nn">scikitplot</code><code class="o">,</code> <code class="nn">scipy</code><code class="o">,</code> <code class="nn">seaborn</code><code class="o">,</code>&#13;
<code class="nn">shap</code><code class="o">,</code> <code class="nn">sklearn</code><code class="o">,</code> <code class="nn">statsmodels</code><code class="o">,</code> <code class="nn">tpot</code><code class="o">,</code> <code class="nn">treeinterpreter</code><code class="o">,</code>&#13;
<code class="nn">umap</code><code class="o">,</code> <code class="nn">xgbfir</code><code class="o">,</code> <code class="nn">xgboost</code><code class="o">,</code> <code class="nn">yellowbrick</code>&#13;
&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">lib</code> <code class="ow">in</code> <code class="p">[</code>&#13;
<code class="gp">... </code>    <code class="n">autosklearn</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">catboost</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">category_encoders</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">dtreeviz</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">eli5</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">fancyimpute</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">fastai</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">featuretools</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">glmnet_py</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">graphviz</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">hdbscan</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">imblearn</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">lime</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">janitor</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">matplotlib</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">missingno</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">mlxtend</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">numpy</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">pandas</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">pandas_profiling</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">pdpbox</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">phate</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">pydotplus</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">rfpimp</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">scikitplot</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">scipy</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">seaborn</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">shap</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">sklearn</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">statsmodels</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">tpot</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">treeinterpreter</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">umap</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">xgbfir</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">xgboost</code><code class="p">,</code>&#13;
<code class="gp">... </code>    <code class="n">yellowbrick</code><code class="p">,</code>&#13;
<code class="gp">... </code><code class="p">]:</code>&#13;
<code class="gp">... </code>    <code class="k">try</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">lib</code><code class="o">.</code><code class="n">__name__</code><code class="p">,</code> <code class="n">lib</code><code class="o">.</code><code class="n">__version__</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">except</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">"Missing"</code><code class="p">,</code> <code class="n">lib</code><code class="o">.</code><code class="n">__name__</code><code class="p">)</code>&#13;
<code class="go">catboost 0.11.1</code>&#13;
<code class="go">category_encoders 2.0.0</code>&#13;
<code class="go">Missing dtreeviz</code>&#13;
<code class="go">eli5 0.8.2</code>&#13;
<code class="go">fancyimpute 0.4.2</code>&#13;
<code class="go">fastai 1.0.28</code>&#13;
<code class="go">featuretools 0.4.0</code>&#13;
<code class="go">Missing glmnet_py</code>&#13;
<code class="go">graphviz 0.10.1</code>&#13;
<code class="go">hdbscan 0.8.22</code>&#13;
<code class="go">imblearn 0.4.3</code>&#13;
<code class="go">janitor 0.16.6</code>&#13;
<code class="go">Missing lime</code>&#13;
<code class="go">matplotlib 2.2.3</code>&#13;
<code class="go">missingno 0.4.1</code>&#13;
<code class="go">mlxtend 0.14.0</code>&#13;
<code class="go">numpy 1.15.2</code>&#13;
<code class="go">pandas 0.23.4</code>&#13;
<code class="go">Missing pandas_profiling</code>&#13;
<code class="go">pdpbox 0.2.0</code>&#13;
<code class="go">phate 0.4.2</code>&#13;
<code class="go">Missing pydotplus</code>&#13;
<code class="go">rfpimp</code>&#13;
<code class="go">scikitplot 0.3.7</code>&#13;
<code class="go">scipy 1.1.0</code>&#13;
<code class="go">seaborn 0.9.0</code>&#13;
<code class="go">shap 0.25.2</code>&#13;
<code class="go">sklearn 0.21.1</code>&#13;
<code class="go">statsmodels 0.9.0</code>&#13;
<code class="go">tpot 0.9.5</code>&#13;
<code class="go">treeinterpreter 0.1.0</code>&#13;
<code class="go">umap 0.3.8</code>&#13;
<code class="go">xgboost 0.81</code>&#13;
<code class="go">yellowbrick 0.9</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Most of these libraries are easily installed with <code>pip</code> or <code>conda</code>. With&#13;
<code>fastai</code> I need to use <code>pip install</code> <span class="keep-together"><code>--no-deps fastai</code></span>. The <code>umap</code> library&#13;
is installed with <code>pip install umap-learn</code>. The <code>janitor</code> library&#13;
is installed with <code>pip install pyjanitor</code>. The <code>autosklearn</code> library&#13;
is installed with <code>pip install auto-sklearn</code>.</p>&#13;
&#13;
<p>I usually use Jupyter for doing an analysis. You can use other notebook tools as well. Note that some, like Google Colab, have preinstalled many of the libraries (though they may be outdated versions).</p>&#13;
</div>&#13;
&#13;
<p>There are two main options for installing libraries in Python.&#13;
One is to use <code>pip</code> (an acronym for Pip Installs Python), a tool that comes with Python. The other option is to use <a href="https://anaconda.org">Anaconda</a>. We will introduce both.<a data-startref="ix_ch01-asciidoc0" data-type="indexterm" id="idm46066909982968"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Installation with Pip" data-type="sect1"><div class="sect1" id="idm46066909982136">&#13;
<h1>Installation with Pip</h1>&#13;
&#13;
<p><a data-primary="installation of libraries" data-secondary="with pip" data-type="indexterm" id="ix_ch01-asciidoc1"/><a data-primary="libraries" data-secondary="installation with pip" data-type="indexterm" id="ix_ch01-asciidoc2"/><a data-primary="pip" data-secondary="installation of libraries with" data-type="indexterm" id="ix_ch01-asciidoc3"/>Before using <code>pip</code>, we will create a sandbox environment to install our libraries into. <a data-primary="sandbox environment, for library installation" data-type="indexterm" id="idm46066909975736"/><a data-primary="virtual environment, for library installation" data-type="indexterm" id="idm46066909974856"/>This is called a virtual environment named <code>env</code>:</p>&#13;
<pre>$ python -m venv env</pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="Linux, library installation on" data-type="indexterm" id="idm46066909972408"/><a data-primary="Macintosh, library installation on" data-type="indexterm" id="idm46066909971736"/><a data-primary="OSX, library installation on" data-type="indexterm" id="idm46066909971048"/><a data-primary="Windows, library installation on" data-type="indexterm" id="idm46066909970360"/>On Macintosh and Linux, use <code>python</code>; on Windows, use <code>python3</code>. If Windows&#13;
doesn’t recognize that from the command prompt, you may need to&#13;
reinstall or fix your install and make sure you check the&#13;
“Add Python to my PATH” checkbox.</p>&#13;
</div>&#13;
&#13;
<p>Then you activate the environment so that when you install&#13;
libraries, they go in the sandbox environment and not&#13;
in the global Python installation. As many of these libraries&#13;
change and are updated, it is best to lock down versions&#13;
on a per-project basis so you know that your code will run.</p>&#13;
&#13;
<p>Here is how we activate the virtual environment on Linux and&#13;
Macintosh:</p>&#13;
<pre>$ source env/bin/activate</pre>&#13;
&#13;
<p>You will notice that the prompt is updated, indicating that&#13;
we are using the virtual environment:</p>&#13;
<pre data-type="programlisting">&#13;
  (env) $ <strong>which python</strong>&#13;
  env/bin/python&#13;
</pre>&#13;
&#13;
<p>On Windows, you will need to activate the environment&#13;
by running this command:</p>&#13;
<pre>C:&gt; env\Scripts\activate.bat</pre>&#13;
&#13;
<p class="pagebreak-before">Again, you will notice that the prompt is updated, indicating that&#13;
we are using the virtual environment:</p>&#13;
<pre data-type="programlisting">&#13;
  (env) C:&gt; <strong>where python</strong>&#13;
  env\Scripts\python.exe&#13;
</pre>&#13;
&#13;
<p>On all platforms, you can install packages using <code>pip</code>. To&#13;
install pandas, type:</p>&#13;
<pre>(env) $ pip install pandas</pre>&#13;
&#13;
<p>Some of the package names are different than the library names.&#13;
You can search for packages using:</p>&#13;
<pre>(env) $ pip search libraryname</pre>&#13;
&#13;
<p>Once you have your packages installed, you can create a file&#13;
with all of the versions of the packages using <code>pip</code>:</p>&#13;
<pre>(env) $ pip freeze &gt; requirements.txt</pre>&#13;
&#13;
<p>With this <code>requirements.txt</code> file you can easily install&#13;
the packages into a new virtual environment:<a data-startref="ix_ch01-asciidoc3" data-type="indexterm" id="idm46066909957496"/><a data-startref="ix_ch01-asciidoc2" data-type="indexterm" id="idm46066909956792"/><a data-startref="ix_ch01-asciidoc1" data-type="indexterm" id="idm46066909956120"/></p>&#13;
<pre>(other_env) $ pip install -r requirements.txt</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Installation with Conda" data-type="sect1"><div class="sect1" id="idm46066909981224">&#13;
<h1>Installation with Conda</h1>&#13;
&#13;
<p><a data-primary="Anaconda, package installation on" data-type="indexterm" id="idm46066909953768"/><a data-primary="conda" data-secondary="installation of libraries with" data-type="indexterm" id="idm46066909953000"/><a data-primary="installation of libraries" data-secondary="with conda" data-type="indexterm" id="idm46066909952040"/><a data-primary="libraries" data-secondary="installation with conda" data-type="indexterm" id="idm46066909951080"/>The <code>conda</code> tool comes with Anaconda and lets us create&#13;
environments and install packages.</p>&#13;
&#13;
<p>To create an environment named <code>env</code>, run:</p>&#13;
<pre>$ conda create --name env python=3.6</pre>&#13;
&#13;
<p>To activate this environment, run:</p>&#13;
<pre>$ conda activate env</pre>&#13;
&#13;
<p>This will update the prompt on both Unix and Windows systems.&#13;
Now you can search for packages using:</p>&#13;
<pre>(env) $ conda search libraryname</pre>&#13;
&#13;
<p>To install a package, like pandas, run:</p>&#13;
<pre>(env) $ conda install pandas</pre>&#13;
&#13;
<p>To create a file with the package requirements in it, run:</p>&#13;
<pre>(env) $ conda env export &gt; environment.yml</pre>&#13;
&#13;
<p>To install these requirements in a new environment, run:</p>&#13;
<pre>(other_env) $ conda create -f environment.yml</pre>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p><a data-primary="conda" data-secondary="pip in conda environment" data-type="indexterm" id="idm46066909942504"/><a data-primary="pip" data-secondary="in conda environment" data-type="indexterm" id="idm46066909941288"/>Some of the libraries mentioned in this book are not&#13;
available to install from Anaconda’s repository.&#13;
Don’t fret. It turns out you can use <code>pip</code> inside of&#13;
a conda environment (no need to create a new virtual&#13;
environment), and install these using <code>pip</code>.<a data-primary="classification" data-secondary="evaluation" data-see="classification evaluation" data-type="indexterm" id="idm46066909939144"/><a data-primary="classification" data-secondary="imbalanced classes" data-see="imbalanced classes" data-type="indexterm" id="idm46066909937848"/><a data-primary="data" data-secondary="missing" data-see="missing data" data-type="indexterm" id="idm46066909936632"/><a data-primary="evaluation tools" data-see="classification evaluation" data-type="indexterm" id="idm46066909935416"/><a data-primary="feature" data-secondary="dimensionality reduction" data-see="dimensionality reduction" data-type="indexterm" id="idm46066909934456"/><a data-primary="gradient boosting" data-see="LightGBM" data-type="indexterm" id="idm46066909933208"/><a data-primary="manifold learning" data-see="Uniform Manifold Approximation and Projection (UMAP)" data-type="indexterm" id="idm46066909932264"/><a data-primary="PCA" data-see="principal component analysis" data-type="indexterm" id="idm46066909931224"/><a data-primary="sensitivity" data-see="recall" data-type="indexterm" id="idm46066909930264"/><a data-primary="SME" data-see="subject matter expert" data-type="indexterm" id="idm46066909929320"/><a data-primary="unsupervised learning" data-see="clustering" data-type="indexterm" id="idm46066909928376"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>