<html><head></head><body>
<div id="sbo-rt-content"><section class="pagenumrestart" data-pdf-bookmark="Chapter 1. Working with Vectors, Matrices, &#10;and Arrays in NumPy" data-type="chapter" epub:type="chapter"><div class="chapter" id="vectors-matrices-and-arrays">
<h1><span class="label">Chapter 1. </span>Working with Vectors, Matrices, 
<span class="keep-together">and Arrays in NumPy</span></h1>
<section data-pdf-bookmark="1.0 Introduction" data-type="sect1"><div class="sect1" id="id2">
<h1>1.0 Introduction</h1>
<p>NumPy is a <a data-primary="NumPy arrays" data-type="indexterm" id="ix_numpy_array_ch1"/>foundational tool of the Python machine learning stack. NumPy
allows for efficient operations on the data structures often used in
machine learning: vectors, matrices, and tensors. While NumPy isn’t the focus of this book, it will show up frequently in the following chapters. This chapter covers the most common NumPy operations we’re likely to run into while working on machine learning workflows.<a data-primary="pandas library" data-see="dataframes; loading data" data-type="indexterm" id="id871"/><a data-primary="longitudinal data" data-see="dates and times" data-type="indexterm" id="id872"/><a data-primary="time series data" data-see="dates and times" data-type="indexterm" id="id873"/><a data-primary="tuning hyperparameters" data-see="hyperparameters" data-type="indexterm" id="id874"/><a data-primary="regression and regressors" data-secondary="linear" data-see="linear regression" data-type="indexterm" id="id875"/><a data-primary="regression and regressors" data-secondary="logistic" data-see="logistic regression" data-type="indexterm" id="id876"/><a data-primary="arrays" data-see="matrices; NumPy arrays; vectors" data-type="indexterm" id="id877"/><a data-primary="PyTorch" data-secondary="neural networks" data-see="neural networks" data-type="indexterm" id="id878"/><a data-primary="quantitative data" data-see="numerical data" data-type="indexterm" id="id879"/><a data-primary="weights" data-see="parameters" data-type="indexterm" id="id880"/><a data-primary="tensors" data-see="PyTorch" data-type="indexterm" id="id881"/><a data-primary="trees and forests" data-secondary="random forests" data-see="random forests" data-type="indexterm" id="id882"/><a data-primary="tf-idf" data-see="term frequency-inverse document frequency" data-type="indexterm" id="id883"/></p>
</div></section>
<section data-pdf-bookmark="1.1 Creating a Vector" data-type="sect1"><div class="sect1" id="creating-a-vector">
<h1>1.1 Creating a Vector</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id3">
<h2>Problem</h2>
<p>You <a data-primary="vectors" data-type="indexterm" id="ix_vectors_numpy_array"/><a data-primary="NumPy arrays" data-secondary="vectors" data-type="indexterm" id="ix_numpy_array_vec"/>need to create a vector.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id884">
<h2>Solution</h2>
<p>Use NumPy to create a one-dimensional array:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create a vector as a row</code>
<code class="n">vector_row</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code>

<code class="c1"># Create a vector as a column</code>
<code class="n">vector_column</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">],</code>
                          <code class="p">[</code><code class="mi">2</code><code class="p">],</code>
                          <code class="p">[</code><code class="mi">3</code><code class="p">]])</code></pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id4">
<h2>Discussion</h2>
<p>NumPy’s main data structure is the multidimensional array. A vector is just an array with a single dimension. To create a vector, we simply create a one-dimensional array. Just like vectors,
these arrays can be represented horizontally (i.e., rows) or vertically (i.e., columns).<a data-primary="" data-startref="ix_numpy_array_vec" data-type="indexterm" id="id885"/><a data-primary="" data-startref="ix_vectors_numpy_array" data-type="indexterm" id="id886"/></p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id887">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/43I-b">Vectors, Math Is Fun</a></p>
</li>
<li>
<p><a href="https://oreil.ly/er78t">Euclidean vector, Wikipedia</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.2 Creating a Matrix" data-type="sect1"><div class="sect1" id="creating-a-matrix">
<h1>1.2 Creating a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id454">
<h2>Problem</h2>
<p>You need to create a <a data-primary="NumPy arrays" data-secondary="matrices" data-type="indexterm" id="ix_numpy_array_matrix"/><a data-primary="matrices" data-secondary="creating" data-type="indexterm" id="id888"/>matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id5">
<h2>Solution</h2>
<p>Use NumPy to create a <a data-primary="multidimensional array" data-type="indexterm" id="id889"/>two-dimensional array:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create a matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]])</code></pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id890">
<h2>Discussion</h2>
<p>To create a matrix we can use a NumPy two-dimensional array. In our
solution, the matrix contains three rows and two columns (a column of
1s and a column of 2s).</p>
<p>NumPy actually has a dedicated matrix data structure:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">matrix_object</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">mat</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code>
                        <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code>
                        <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]])</code></pre>
<pre data-type="programlisting">matrix([[1, 2],
        [1, 2],
        [1, 2]])</pre>
<p>However, the matrix data structure is not recommended for two
reasons. First, arrays are the de facto standard data structure of
NumPy. Second, the vast majority of NumPy operations return arrays, not
matrix objects.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id891">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/tnRJw">Matrix, Wikipedia</a></p>
</li>
<li>
<p><a href="https://oreil.ly/76jUS">Matrix, Wolfram MathWorld</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.3 Creating a Sparse Matrix" data-type="sect1"><div class="sect1" id="creating-a-sparse-matrix">
<h1>1.3 Creating a Sparse Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id455">
<h2>Problem</h2>
<p>Given <a data-primary="matrices" data-secondary="sparse matrix" data-type="indexterm" id="ix_sparse_matrix"/><a data-primary="sparse matrix" data-secondary="creating" data-type="indexterm" id="ix_sparse_matrix_cr"/>data with very few nonzero values, you want to efficiently
represent it.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id892">
<h2>Solution</h2>
<p>Create a sparse matrix:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load libraries</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>
<code class="kn">from</code> <code class="nn">scipy</code> <code class="kn">import</code> <code class="n">sparse</code>

<code class="c1"># Create a matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">0</code><code class="p">]])</code>

<code class="c1"># Create compressed sparse row (CSR) matrix</code>
<code class="n">matrix_sparse</code> <code class="o">=</code> <code class="n">sparse</code><code class="o">.</code><code class="n">csr_matrix</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id6">
<h2>Discussion</h2>
<p>A frequent situation in machine learning is having a huge amount of
data; however, most of the elements in the data are zeros. For example,
imagine a matrix where the columns are every movie on Netflix, the rows
are every Netflix user, and the values are how many times a user has
watched that particular movie. This matrix would have tens of thousands
of columns and millions of rows! However, since most users do not watch
most movies, the vast majority of elements would be zero.</p>
<p>A <em>sparse matrix</em> is a matrix in which most elements are 0. Sparse matrices store only nonzero elements and assume all other values
will be zero, leading to significant computational savings. In our
solution, we created a NumPy array with two nonzero values, then
converted it into a sparse matrix. If we view the sparse matrix we can
see that only the nonzero values are stored:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># View sparse matrix</code>
<code class="nb">print</code><code class="p">(</code><code class="n">matrix_sparse</code><code class="p">)</code></pre>
<pre data-type="programlisting">  (1, 1)    1
  (2, 0)    3</pre>
<p>There are a number of types of sparse matrices. <a data-primary="compressed sparse row (CSR) matrices" data-type="indexterm" id="id893"/><a data-primary="CSR (compressed sparse row) matrices" data-type="indexterm" id="id894"/>However, in <em>compressed sparse row</em> (CSR) matrices, <code>(1, 1)</code> and <code>(2, 0)</code> represent the (zero-indexed) indices of the nonzero values <code>1</code> and <code>3</code>, respectively. For example, the element <code>1</code> is in the second row and second column. We can see the advantage of sparse matrices if we create a much larger matrix with many more zero elements and then compare this larger matrix with our original sparse matrix:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Create larger matrix</code>
<code class="n">matrix_large</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>
                         <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>
                         <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]])</code>

<code class="c1"># Create compressed sparse row (CSR) matrix</code>
<code class="n">matrix_large_sparse</code> <code class="o">=</code> <code class="n">sparse</code><code class="o">.</code><code class="n">csr_matrix</code><code class="p">(</code><code class="n">matrix_large</code><code class="p">)</code></pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># View original sparse matrix</code>
<code class="nb">print</code><code class="p">(</code><code class="n">matrix_sparse</code><code class="p">)</code></pre>
<pre data-type="programlisting">  (1, 1)    1
  (2, 0)    3</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># View larger sparse matrix</code>
<code class="nb">print</code><code class="p">(</code><code class="n">matrix_large_sparse</code><code class="p">)</code></pre>
<pre data-type="programlisting">  (1, 1)    1
  (2, 0)    3</pre>
<p>As we can see, despite the fact that we added many more zero elements in the larger matrix, its sparse representation is exactly the same as our original sparse matrix. That is, the addition of zero elements did not change the size of the sparse matrix.</p>
<p>As mentioned, there are many different types of sparse matrices, such
as compressed sparse column, list of lists, and dictionary of keys.
While an explanation of the different types and their implications is
outside the scope of this book, it is worth noting that while there is
no “best” sparse matrix type, there are meaningful differences among
them, and we should be conscious about why we are choosing one type
over another.<a data-primary="" data-startref="ix_numpy_array_matrix" data-type="indexterm" id="id895"/><a data-primary="" data-startref="ix_sparse_matrix" data-type="indexterm" id="id896"/><a data-primary="" data-startref="ix_sparse_matrix_cr" data-type="indexterm" id="id897"/></p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id898">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/zBBRB">SciPy documentation: Sparse Matrices</a></p>
</li>
<li>
<p><a href="https://oreil.ly/sBQhN">101 Ways to Store a Sparse Matrix</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.4 Preallocating NumPy Arrays" data-type="sect1"><div class="sect1" id="preallocating-numpy-arrays">
<h1>1.4 Preallocating NumPy Arrays</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id7">
<h2>Problem</h2>
<p>You need to <a data-primary="NumPy arrays" data-secondary="preallocating" data-type="indexterm" id="id899"/><a data-primary="preallocating arrays" data-type="indexterm" id="id900"/>preallocate arrays of a given size with some value.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id901">
<h2>Solution</h2>
<p>NumPy has functions for generating vectors and matrices of any size using 0s, 1s, or values of your choice:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Generate a vector of shape (1,5) containing all zeros</code>
<code class="n">vector</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">zeros</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code>

<code class="c1"># View the matrix</code>
<code class="nb">print</code><code class="p">(</code><code class="n">vector</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([0., 0., 0., 0., 0.])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Generate a matrix of shape (3,3) containing all ones</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">full</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code><code class="mi">3</code><code class="p">),</code> <code class="n">fill_value</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code>

<code class="c1"># View the vector</code>
<code class="nb">print</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[1., 1., 1.],
       [1., 1., 1.],
       [1., 1., 1.]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id902">
<h2>Discussion</h2>
<p>Generating arrays prefilled with data is useful for a number of purposes, such as making code more performant or using synthetic data to test algorithms. In many programming languages, preallocating an array of default values (such as 0s) is considered common practice.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="1.5 Selecting Elements" data-type="sect1"><div class="sect1" id="selecting-elements">
<h1>1.5 Selecting Elements</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id456">
<h2>Problem</h2>
<p>You need to <a data-primary="NumPy arrays" data-secondary="selecting elements" data-type="indexterm" id="ix_numpy_array_sel_elem"/><a data-primary="selecting elements" data-secondary="NumPy arrays" data-type="indexterm" id="ix_sel_elem_numpy"/>select one or more elements in a vector or matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id903">
<h2>Solution</h2>
<p>NumPy arrays make it easy to select elements in vectors or matrices:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create row vector</code>
<code class="n">vector</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Select third element of vector</code>
<code class="n">vector</code><code class="p">[</code><code class="mi">2</code><code class="p">]</code></pre>
<pre data-type="programlisting">3</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select second row, second column</code>
<code class="n">matrix</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code class="mi">1</code><code class="p">]</code></pre>
<pre data-type="programlisting">5</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id8">
<h2>Discussion</h2>
<p>Like most things in Python, NumPy arrays are <a data-primary="zero-indexed arrays" data-type="indexterm" id="id904"/>zero-indexed, meaning that
the index of the first element is 0, not 1. With that caveat, NumPy
offers a wide variety of methods for selecting (i.e., indexing and
slicing) elements or groups of elements in arrays:<a data-primary="" data-startref="ix_numpy_array_sel_elem" data-type="indexterm" id="id905"/><a data-primary="" data-startref="ix_sel_elem_numpy" data-type="indexterm" id="id906"/></p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select all elements of a vector</code>
<code class="n">vector</code><code class="p">[:]</code></pre>
<pre data-type="programlisting">array([1, 2, 3, 4, 5, 6])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select everything up to and including the third element</code>
<code class="n">vector</code><code class="p">[:</code><code class="mi">3</code><code class="p">]</code></pre>
<pre data-type="programlisting">array([1, 2, 3])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select everything after the third element</code>
<code class="n">vector</code><code class="p">[</code><code class="mi">3</code><code class="p">:]</code></pre>
<pre data-type="programlisting">array([4, 5, 6])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select the last element</code>
<code class="n">vector</code><code class="p">[</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code></pre>
<pre data-type="programlisting">6</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Reverse the vector</code>
<code class="n">vector</code><code class="p">[::</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code></pre>
<pre data-type="programlisting">array([6, 5, 4, 3, 2, 1])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select the first two rows and all columns of a matrix</code>
<code class="n">matrix</code><code class="p">[:</code><code class="mi">2</code><code class="p">,:]</code></pre>
<pre data-type="programlisting">array([[1, 2, 3],
       [4, 5, 6]])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Select all rows and the second column</code>
<code class="n">matrix</code><code class="p">[:,</code><code class="mi">1</code><code class="p">:</code><code class="mi">2</code><code class="p">]</code></pre>
<pre data-type="programlisting">array([[2],
       [5],
       [8]])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.6 Describing a Matrix" data-type="sect1"><div class="sect1" id="describing-a-matrix">
<h1>1.6 Describing a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id457">
<h2>Problem</h2>
<p>You want to <a data-primary="NumPy arrays" data-secondary="matrices" data-type="indexterm" id="id907"/><a data-primary="matrices" data-secondary="describing" data-type="indexterm" id="id908"/>describe the shape, size, and dimensions of a matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id9">
<h2>Solution</h2>
<p>Use the <code>shape</code>, <code>size</code>, and <code>ndim</code> <a data-primary="shape attribute" data-type="indexterm" id="id909"/><a data-primary="size attribute" data-type="indexterm" id="id910"/><a data-primary="ndim attribute" data-type="indexterm" id="id911"/>attributes of a NumPy object:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">9</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">11</code><code class="p">,</code> <code class="mi">12</code><code class="p">]])</code>

<code class="c1"># View number of rows and columns</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">shape</code></pre>
<pre data-type="programlisting">(3, 4)</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># View number of elements (rows * columns)</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">size</code></pre>
<pre data-type="programlisting">12</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># View number of dimensions</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">ndim</code></pre>
<pre data-type="programlisting">2</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id912">
<h2>Discussion</h2>
<p>This might seem basic (and it is); however, time and again it will be
valuable to check the shape and size of an array both for further
calculations and simply as a gut check after an operation.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="1.7 Applying Functions over Each Element" data-type="sect1"><div class="sect1" id="applying-functions-over-each-element">
<h1>1.7 Applying Functions over Each Element</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id458">
<h2>Problem</h2>
<p>You want to <a data-primary="NumPy arrays" data-secondary="applying functions over array elements" data-type="indexterm" id="id913"/>apply some function to all elements in an array.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id914">
<h2>Solution</h2>
<p>Use the NumPy <code>vectorize</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Create function that adds 100 to something</code>
<code class="n">add_100</code> <code class="o">=</code> <code class="k">lambda</code> <code class="n">i</code><code class="p">:</code> <code class="n">i</code> <code class="o">+</code> <code class="mi">100</code>

<code class="c1"># Create vectorized function</code>
<code class="n">vectorized_add_100</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">vectorize</code><code class="p">(</code><code class="n">add_100</code><code class="p">)</code>

<code class="c1"># Apply function to all elements in matrix</code>
<code class="n">vectorized_add_100</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[101, 102, 103],
       [104, 105, 106],
       [107, 108, 109]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id10">
<h2>Discussion</h2>
<p>The NumPy <code>vectorize</code> <a data-primary="vectorize method" data-type="indexterm" id="id915"/><a data-primary="broadcasting" data-type="indexterm" id="id916"/>method converts a function into a function that can
apply to all elements in an array or slice of an array. It’s worth noting that <code>vectorize</code> is essentially a <code>for</code> loop over the elements and does not increase performance. Furthermore, NumPy arrays allow us to perform operations between arrays even if their dimensions are not the same (a process called <em>broadcasting</em>). For example, we can create a much simpler version of our solution using broadcasting:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Add 100 to all elements</code>
<code class="n">matrix</code> <code class="o">+</code> <code class="mi">100</code></pre>
<pre data-type="programlisting">array([[101, 102, 103],
       [104, 105, 106],
       [107, 108, 109]])</pre>
<p>Broadcasting does not work for all shapes and situations, but it is a common way of applying simple operations over all elements of a NumPy array.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="1.8 Finding the Maximum and Minimum Values" data-type="sect1"><div class="sect1" id="finding-the-maximum-and-minimum-values">
<h1>1.8 Finding the Maximum and Minimum Values</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id459">
<h2>Problem</h2>
<p>You need to find the <a data-primary="NumPy arrays" data-secondary="maximum and minimum values in" data-type="indexterm" id="id917"/>maximum or minimum value in an array.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id918">
<h2>Solution</h2>
<p>Use NumPy’s <code>max</code> and <code>min</code> methods:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Return maximum element</code>
<code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">9</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Return minimum element</code>
<code class="n">np</code><code class="o">.</code><code class="n">min</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">1</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id460">
<h2>Discussion</h2>
<p>Often we want to know the maximum and minimum value in an array or
subset of an array. This can be <a data-primary="max method" data-secondary="NumPy array" data-type="indexterm" id="id919"/><a data-primary="min method" data-secondary="NumPy array" data-type="indexterm" id="id920"/>accomplished with the <code>max</code> and <code>min</code>
methods. Using the <code>axis</code> parameter, we can also apply the operation along a certain axis:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Find maximum element in each column</code>
<code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">matrix</code><code class="p">,</code> <code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([7, 8, 9])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Find maximum element in each row</code>
<code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">matrix</code><code class="p">,</code> <code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([3, 6, 9])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.9 Calculating the Average, Variance, and Standard Deviation" data-type="sect1"><div class="sect1" id="calculating-the-average-variance-and-standard-deviation">
<h1>1.9 Calculating the Average, Variance, and Standard Deviation</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id11">
<h2>Problem</h2>
<p>You want to calculate some <a data-primary="NumPy arrays" data-secondary="descriptive statistics calculation" data-type="indexterm" id="id921"/><a data-primary="descriptive statistics" data-type="indexterm" id="id922"/>descriptive statistics about an array.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id12">
<h2>Solution</h2>
<p>Use <a data-primary="mean method" data-secondary="NumPy array" data-type="indexterm" id="id923"/><a data-primary="var method" data-type="indexterm" id="id924"/><a data-primary="std method" data-type="indexterm" id="id925"/>NumPy’s <code>mean</code>, <code>var</code>, and <code>std</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Return mean</code>
<code class="n">np</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">5.0</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Return variance</code>
<code class="n">np</code><code class="o">.</code><code class="n">var</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">6.666666666666667</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Return standard deviation</code>
<code class="n">np</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">2.5819888974716112</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id926">
<h2>Discussion</h2>
<p>Just like with <code>max</code> and <code>min</code>, we can easily get descriptive statistics about the whole matrix or do calculations along a single axis:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Find the mean value in each column</code>
<code class="n">np</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">matrix</code><code class="p">,</code> <code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([ 4.,  5.,  6.])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.10 Reshaping Arrays" data-type="sect1"><div class="sect1" id="reshaping-arrays">
<h1>1.10 Reshaping Arrays</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id461">
<h2>Problem</h2>
<p>You want to change the <a data-primary="NumPy arrays" data-secondary="reshaping" data-type="indexterm" id="id927"/><a data-primary="reshape method" data-secondary="NumPy array" data-type="indexterm" id="id928"/>shape (number of rows and columns) of an array
without changing the element values.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id929">
<h2>Solution</h2>
<p>Use NumPy’s <code>reshape</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create 4x3 matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">10</code><code class="p">,</code> <code class="mi">11</code><code class="p">,</code> <code class="mi">12</code><code class="p">]])</code>

<code class="c1"># Reshape matrix into 2x6 matrix</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">6</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[ 1,  2,  3,  4,  5,  6],
       [ 7,  8,  9, 10, 11, 12]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id13">
<h2>Discussion</h2>
<p><code>reshape</code> allows us to restructure an array so that we maintain
the same data but organize it as a different number of rows and
columns. The only requirement is that the shape of the original and new
matrix contain the same number of elements (i.e., are the same size). We can
see the <a data-primary="size method, matrix" data-type="indexterm" id="id930"/>size of a matrix using <code>size</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">matrix</code><code class="o">.</code><code class="n">size</code></pre>
<pre data-type="programlisting">12</pre>
<p>One useful argument in <code>reshape</code> is <code>-1</code>, which effectively means “as many
as needed,” so <code>reshape(1, -1)</code> means one row and as many columns as
needed:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">matrix</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="o">-</code><code class="mi">1</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12]])</pre>
<p class="fix_tracking2">
Finally, if we provide one integer, <code>reshape</code> will return a one-dimensional array of
that length:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">matrix</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="mi">12</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.11 Transposing a Vector or Matrix" data-type="sect1"><div class="sect1" id="transposing-a-vector-or-matrix">
<h1>1.11 Transposing a Vector or Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id14">
<h2>Problem</h2>
<p>You need to <a data-primary="NumPy arrays" data-secondary="matrices" data-type="indexterm" id="ix_numpy_array_matrix2"/><a data-primary="transposing" data-secondary="matrices" data-type="indexterm" id="id931"/><a data-primary="matrices" data-secondary="transposing" data-type="indexterm" id="id932"/><a data-primary="NumPy arrays" data-secondary="vectors" data-type="indexterm" id="id933"/><a data-primary="vectors" data-seealso="support vector machines" data-type="indexterm" id="id934"/>transpose a vector or matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id15">
<h2>Solution</h2>
<p>Use <a data-primary="T method" data-type="indexterm" id="id935"/>the <code>T</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Transpose matrix</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">T</code></pre>
<pre data-type="programlisting">array([[1, 4, 7],
       [2, 5, 8],
       [3, 6, 9]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id936">
<h2>Discussion</h2>
<p class="fix_tracking4">
<em>Transposing</em> is a common operation in linear algebra where the column and
row indices of each element are swapped. A nuanced point typically overlooked outside of a linear algebra class is that, technically, a
vector can’t be transposed because it’s just a collection of values:
</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Transpose vector</code>
<code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code><code class="o">.</code><code class="n">T</code></pre>
<pre data-type="programlisting">array([1, 2, 3, 4, 5, 6])</pre>
<p>However, it is common to refer to transposing a vector as converting a
row vector to a column vector (notice the second pair of brackets) or
vice versa:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Transpose row vector</code>
<code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code><code class="o">.</code><code class="n">T</code></pre>
<pre data-type="programlisting">array([[1],
       [2],
       [3],
       [4],
       [5],
       [6]])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.12 Flattening a Matrix" data-type="sect1"><div class="sect1" id="flattening-a-matrix">
<h1>1.12 Flattening a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id462">
<h2>Problem</h2>
<p>You need to transform a <a data-primary="matrices" data-secondary="flattening" data-type="indexterm" id="id937"/>matrix into a one-dimensional array.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id463">
<h2>Solution</h2>
<p>Use <a data-primary="flatten method" data-secondary="NumPy array" data-type="indexterm" id="id938"/>the <code>flatten</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Flatten matrix</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">flatten</code><code class="p">()</code></pre>
<pre data-type="programlisting">array([1, 2, 3, 4, 5, 6, 7, 8, 9])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id16">
<h2>Discussion</h2>
<p><code>flatten</code> is a simple method to transform a matrix into a
one-dimensional array. Alternatively, we can <a data-primary="ravel method" data-type="indexterm" id="id939"/><a data-primary="reshape method" data-secondary="NumPy array" data-type="indexterm" id="id940"/>use <code>reshape</code> to create a
row vector:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">matrix</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="o">-</code><code class="mi">1</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[1, 2, 3, 4, 5, 6, 7, 8, 9]])</pre>
<p>
Another common way to flatten arrays is the <code>ravel</code> method. Unlike <code>flatten</code>, which returns a copy of the original array, <code>ravel</code> operates on the original object itself and is therefore slightly faster. It also lets us flatten lists of arrays, which we can’t do with the <code>flatten</code> method. This operation is useful for flattening very large arrays and speeding up code:
</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Create one matrix</code>
<code class="n">matrix_a</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">]])</code>

<code class="c1"># Create a second matrix</code>
<code class="n">matrix_b</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">]])</code>

<code class="c1"># Create a list of matrices</code>
<code class="n">matrix_list</code> <code class="o">=</code> <code class="p">[</code><code class="n">matrix_a</code><code class="p">,</code> <code class="n">matrix_b</code><code class="p">]</code>

<code class="c1"># Flatten the entire list of matrices</code>
<code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">matrix_list</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([1, 2, 3, 4, 5, 6, 7, 8])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.13 Finding the Rank of a Matrix" data-type="sect1"><div class="sect1" id="finding-the-rank-of-a-matrix">
<h1>1.13 Finding the Rank of a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id464">
<h2>Problem</h2>
<p>You need to know the <a data-primary="matrices" data-secondary="finding rank of" data-type="indexterm" id="id941"/>rank of a matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id17">
<h2>Solution</h2>
<p>Use NumPy’s linear algebra <a data-primary="matrix_rank method" data-type="indexterm" id="id942"/><a data-primary="rank of a matrix, finding" data-type="indexterm" id="id943"/>method <code>matrix_rank</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">10</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">15</code><code class="p">]])</code>

<code class="c1"># Return matrix rank</code>
<code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">matrix_rank</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">2</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id944">
<h2>Discussion</h2>
<p>The <em>rank</em> of a matrix is the dimensions of the vector space spanned by
its columns or rows. Finding the rank of a matrix is easy in NumPy thanks to <code>matrix_rank</code>.</p>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id945">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/Wg9ZG">The Rank of a Matrix, CliffsNotes</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.14 Getting the Diagonal of a Matrix" data-type="sect1"><div class="sect1" id="getting-the-diagonal-of-a-matrix">
<h1>1.14 Getting the Diagonal of a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id18">
<h2>Problem</h2>
<p>You need to get the <a data-primary="diagonal of a matrix, finding" data-type="indexterm" id="id946"/><a data-primary="matrices" data-secondary="finding diagonal" data-type="indexterm" id="id947"/>diagonal elements of a matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id948">
<h2>Solution</h2>
<p>Use NumPy’s <code>diagonal</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Return diagonal elements</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">diagonal</code><code class="p">()</code></pre>
<pre data-type="programlisting">array([1, 4, 9])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id949">
<h2>Discussion</h2>
<p>NumPy makes getting the diagonal elements of a matrix easy with
<code>diagonal</code>. It is also possible to get a diagonal off the main
diagonal by using the <code>offset</code> parameter:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Return diagonal one above the main diagonal</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">diagonal</code><code class="p">(</code><code class="n">offset</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([2, 6])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Return diagonal one below the main diagonal</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">diagonal</code><code class="p">(</code><code class="n">offset</code><code class="o">=-</code><code class="mi">1</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([2, 8])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.15 Calculating the Trace of a Matrix" data-type="sect1"><div class="sect1" id="calculating-the-trace-of-a-matrix">
<h1>1.15 Calculating the Trace of a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id19">
<h2>Problem</h2>
<p>You need to calculate the <a data-primary="trace of a matrix, calculating" data-type="indexterm" id="id950"/><a data-primary="matrices" data-secondary="calculating trace of" data-type="indexterm" id="id951"/>trace of a matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id952">
<h2>Solution</h2>
<p>Use <code>trace</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code>

<code class="c1"># Return trace</code>
<code class="n">matrix</code><code class="o">.</code><code class="n">trace</code><code class="p">()</code></pre>
<pre data-type="programlisting">14</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id20">
<h2>Discussion</h2>
<p>The <em>trace</em> of a matrix is the sum of the diagonal elements and is often
used under the hood in machine learning methods. Given a NumPy multidimensional array, we can calculate the <a data-primary="trace method" data-type="indexterm" id="id953"/>trace using <code>trace</code>. Alternatively, we can return the diagonal of a matrix and calculate its sum:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Return diagonal and sum elements</code>
<code class="nb">sum</code><code class="p">(</code><code class="n">matrix</code><code class="o">.</code><code class="n">diagonal</code><code class="p">())</code></pre>
<pre data-type="programlisting">14</pre>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id954">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/AhX1b">The Trace of a Square Matrix</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.16 Calculating Dot Products" data-type="sect1"><div class="sect1" id="calculating-dot-products">
<h1>1.16 Calculating Dot Products</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id21">
<h2>Problem</h2>
<p>You need to calculate the <a data-primary="NumPy arrays" data-secondary="dot product calculation" data-type="indexterm" id="id955"/><a data-primary="dot product calculation" data-type="indexterm" id="id956"/>dot product of two vectors.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id22">
<h2>Solution</h2>
<p>Use <a data-primary="dot function (NumPy)" data-type="indexterm" id="id957"/>NumPy’s <code>dot</code> function:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create two vectors</code>
<code class="n">vector_a</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">])</code>
<code class="n">vector_b</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">4</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">])</code>

<code class="c1"># Calculate dot product</code>
<code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">vector_a</code><code class="p">,</code> <code class="n">vector_b</code><code class="p">)</code></pre>
<pre data-type="programlisting">32</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id958">
<h2>Discussion</h2>
<p>The <em>dot product</em> of two vectors, <math display="inline"><mi>a</mi></math> and <math display="inline"><mi>b</mi></math>, is
defined as:</p>
<div data-type="equation">
<math display="block">
<mrow>
<munderover><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </munderover>
<msub><mi>a</mi> <mi>i</mi> </msub>
<msub><mi>b</mi> <mi>i</mi> </msub>
</mrow>
</math>
</div>
<p>where <math display="inline"><msub><mi>a</mi><mi>i</mi></msub></math> is the <math display="inline"><mi>i</mi></math>th element of vector
<math display="inline"><mi>a</mi></math>, and <math display="inline"><msub><mi>b</mi><mi>i</mi></msub></math> is the <math display="inline"><mi>i</mi></math>th element of vector
<math display="inline"><mi>b</mi></math>. We can use NumPy’s <code>dot</code> function to calculate the dot
product. Alternatively, in Python 3.5+ we can use the new <code>@</code> operator:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Calculate dot product</code>
<code class="n">vector_a</code> <code class="o">@</code> <code class="n">vector_b</code></pre>
<pre data-type="programlisting">32</pre>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id959">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/MpBt7">Vector Dot Product and Vector Length, Khan Academy</a></p>
</li>
<li>
<p><a href="https://oreil.ly/EprM1">Dot Product, Paul’s Online Math Notes</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.17 Adding and Subtracting Matrices" data-type="sect1"><div class="sect1" id="adding-and-subtracting-matrices">
<h1>1.17 Adding and Subtracting Matrices</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id465">
<h2>Problem</h2>
<p>You want to <a data-primary="matrices" data-secondary="adding and subtracting" data-type="indexterm" id="id960"/>add or subtract two matrices.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id23">
<h2>Solution</h2>
<p>Use <a data-primary="add method" data-type="indexterm" id="id961"/><a data-primary="subtract method" data-type="indexterm" id="id962"/>NumPy’s <code>add</code> and <code>subtract</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix_a</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]])</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix_b</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">]])</code>

<code class="c1"># Add two matrices</code>
<code class="n">np</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">matrix_a</code><code class="p">,</code> <code class="n">matrix_b</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[ 2,  4,  2],
       [ 2,  4,  2],
       [ 2,  4, 10]])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Subtract two matrices</code>
<code class="n">np</code><code class="o">.</code><code class="n">subtract</code><code class="p">(</code><code class="n">matrix_a</code><code class="p">,</code> <code class="n">matrix_b</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[ 0, -2,  0],
       [ 0, -2,  0],
       [ 0, -2, -6]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id24">
<h2>Discussion</h2>
<p>Alternatively, we can <a data-primary="subtract (-) operation" data-type="indexterm" id="id963"/><a data-primary="- (subtract) operation" data-type="indexterm" id="id964"/><a data-primary="plus (+) operator" data-type="indexterm" id="id965"/><a data-primary="+ (plus) operator" data-type="indexterm" id="id966"/>simply use the <code>+</code> and <code>–</code>
operators:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Add two matrices</code>
<code class="n">matrix_a</code> <code class="o">+</code> <code class="n">matrix_b</code></pre>
<pre data-type="programlisting">array([[ 2,  4,  2],
       [ 2,  4,  2],
       [ 2,  4, 10]])</pre>
</div></section>
</div></section>
<section data-pdf-bookmark="1.18 Multiplying Matrices" data-type="sect1"><div class="sect1" id="multiplying-matrices">
<h1>1.18 Multiplying Matrices</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id25">
<h2>Problem</h2>
<p>You want to <a data-primary="matrices" data-secondary="multiplying" data-type="indexterm" id="id967"/><a data-primary="multiplying matrices" data-type="indexterm" id="id968"/>multiply two matrices.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id969">
<h2>Solution</h2>
<p>Use NumPy’s <code>dot</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix_a</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]])</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix_b</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                     <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]])</code>

<code class="c1"># Multiply two matrices</code>
<code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">matrix_a</code><code class="p">,</code> <code class="n">matrix_b</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[2, 5],
       [3, 7]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id26">
<h2>Discussion</h2>
<p>Alternatively, in <a data-primary="@ operator" data-type="indexterm" id="id970"/>Python 3.5+ we can use the <code>@</code>
operator:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Multiply two matrices</code>
<code class="n">matrix_a</code> <code class="o">@</code> <code class="n">matrix_b</code></pre>
<pre data-type="programlisting">array([[2, 5],
       [3, 7]])</pre>
<p>If we want to do element-wise multiplication, we <a data-primary="× (multiply) operator" data-type="indexterm" id="id971"/><a data-primary="multiply (×) operator" data-type="indexterm" id="id972"/>can use the <code>*</code>
operator:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Multiply two matrices element-wise</code>
<code class="n">matrix_a</code> <code class="o">*</code> <code class="n">matrix_b</code></pre>
<pre data-type="programlisting">array([[1, 3],
       [1, 4]])</pre>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id973">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/_sFx5">Array vs. Matrix Operations, MathWorks</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.19 Inverting a Matrix" data-type="sect1"><div class="sect1" id="inverting-a-matrix">
<h1>1.19 Inverting a Matrix</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id27">
<h2>Problem</h2>
<p>You want to calculate the <a data-primary="inverting a matrix (inv)" data-type="indexterm" id="id974"/><a data-primary="matrices" data-secondary="inverting" data-type="indexterm" id="id975"/>inverse of a square matrix.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id976">
<h2>Solution</h2>
<p>Use NumPy’s linear algebra <code>inv</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Create matrix</code>
<code class="n">matrix</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code>
                   <code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">5</code><code class="p">]])</code>

<code class="c1"># Calculate inverse of matrix</code>
<code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">inv</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[-1.66666667,  1.33333333],
       [ 0.66666667, -0.33333333]])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id28">
<h2>Discussion</h2>
<p>The inverse of a square matrix, <strong>A</strong>, is a second
matrix, <strong>A</strong><sup>–1</sup>, such that:</p>
<div data-type="equation">
<math display="block">
<mrow>
<mi mathvariant="bold">A</mi>
<msup><mi mathvariant="bold">A</mi> <mrow><mo>-</mo><mn>1</mn></mrow> </msup>
<mo>=</mo>
<mi mathvariant="bold">I</mi>
</mrow>
</math>
</div>
<p>where <strong>I</strong> is the <a data-primary="identity matrix" data-type="indexterm" id="id977"/>identity matrix. In NumPy we can use <code>linalg.inv</code> to calculate <strong>A</strong><sup>–1</sup> if it exists. To see this in action, we can multiply a matrix by its inverse, and the result is the identity matrix:<a data-primary="" data-startref="ix_numpy_array_matrix2" data-type="indexterm" id="id978"/></p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Multiply matrix and its inverse</code>
<code class="n">matrix</code> <code class="o">@</code> <code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">inv</code><code class="p">(</code><code class="n">matrix</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([[ 1.,  0.],
       [ 0.,  1.]])</pre>
</div></section>
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id979">
<h2>See Also</h2>
<ul>
<li>
<p><a href="https://oreil.ly/SwRXC">Inverse of a Matrix</a></p>
</li>
</ul>
</div></section>
</div></section>
<section data-pdf-bookmark="1.20 Generating Random Values" data-type="sect1"><div class="sect1" id="generating-random-values">
<h1>1.20 Generating Random Values</h1>
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="problem-20">
<h2>Problem</h2>
<p>You want to <a data-primary="random value generation" data-type="indexterm" id="ix_ran_val_gen"/><a data-primary="NumPy arrays" data-secondary="random value generation" data-type="indexterm" id="ix_numpy_array_ran_val"/><a data-primary="pseudorandom values, generating" data-type="indexterm" id="ix_pseudo_ran_val_gen"/>generate pseudorandom values.</p>
</div></section>
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="solution-20">
<h2>Solution</h2>
<p>Use <a data-primary="random method" data-type="indexterm" id="ix_ran_val_meth"/>NumPy’s <code>random</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Load library</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="c1"># Set seed</code>
<code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>

<code class="c1"># Generate three random floats between 0.0 and 1.0</code>
<code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([ 0.5488135 ,  0.71518937,  0.60276338])</pre>
</div></section>
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="discussion-20">
<h2>Discussion</h2>
<p>NumPy offers a wide variety of means to generate random numbers—many
more than can be covered here. In our solution we generated floats;
however, it is also common to generate integers:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Generate three random integers between 0 and 10</code>
<code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">11</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([3, 7, 9])</pre>
<p>Alternatively, we can generate numbers by drawing them from a
distribution (note this is not technically random):</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Draw three numbers from a normal distribution with mean 0.0</code>
<code class="c1"># and standard deviation of 1.0</code>
<code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="mf">0.0</code><code class="p">,</code> <code class="mf">1.0</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([-1.42232584,  1.52006949, -0.29139398])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Draw three numbers from a logistic distribution with mean 0.0 and scale of 1.0</code>
<code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">logistic</code><code class="p">(</code><code class="mf">0.0</code><code class="p">,</code> <code class="mf">1.0</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([-0.98118713, -0.08939902,  1.46416405])</pre>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Draw three numbers greater than or equal to 1.0 and less than 2.0</code>
<code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">uniform</code><code class="p">(</code><code class="mf">1.0</code><code class="p">,</code> <code class="mf">2.0</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code></pre>
<pre data-type="programlisting">array([ 1.47997717,  1.3927848 ,  1.83607876])</pre>
<p>Finally, sometimes it can be useful to return the same random numbers
multiple times to get predictable, repeatable results.<a data-primary="" data-startref="ix_numpy_array_ran_val" data-type="indexterm" id="id980"/><a data-primary="" data-startref="ix_ran_val_meth" data-type="indexterm" id="id981"/><a data-primary="" data-startref="ix_numpy_array_ch1" data-type="indexterm" id="id982"/><a data-primary="" data-startref="ix_pseudo_ran_val_gen" data-type="indexterm" id="id983"/><a data-primary="" data-startref="ix_ran_val_gen" data-type="indexterm" id="id984"/> We can do this by setting the “seed” (an integer) of the pseudorandom generator. Random processes with the same seed will always produce the same output. We will use seeds throughout this book so that the code you see in the book and the code you run on your computer produces the same results.</p>
</div></section>
</div></section>
</div></section></div></body></html>