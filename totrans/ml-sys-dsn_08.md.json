["```py\nimport numpy as np\nfrom sklearn.model_selection import GroupKFold\n\nimport numpy as np\nfrom sklearn.model_selection import GroupKFold\nfrom sklearn.exceptions import NotFittedError\n\ndef grouped_time_series_kfold(model, X, y, groups, n_folds=5, \nn_repeats=10, seed=0):\n    scores = []\n    np.random.seed(seed)\n    unique_groups = np.unique(groups)\n\n    for i in range(n_repeats):\n        gkf = GroupKFold(n_splits=n_folds)\n        shuffled_groups = np.random.permutation(unique_groups)\n\n        for train_group_idx, test_group_idx in gkf.split(X, y,\n        groups=shuffled_groups):\n            train_groups = shuffled_groups[train_group_idx]\n            test_groups = shuffled_groups[test_group_idx]\n\n            # Find the earliest and latest indices for train and test groups\n            train_indices = np.where(np.isin(groups, train_groups))[0]\n            test_indices = np.where(np.isin(groups, test_groups))[0]\n            train_end = np.min(test_indices)\n\n            # Ensure temporal order\n            train_mask = np.isin(groups, train_groups) &\n            (np.arange(len(groups)) < train_end)\n            test_mask = np.isin(groups, test_groups)\n\n            model.fit(X[train_mask], y[train_mask])\n            score = model.score(X[test_mask], y[test_mask])\n            scores.append(score)\n\n    return np.array(scores)\n```", "```py\ndef assign_bucket(user_id):\n    _hash = sha1(user_id.encode()).hexdigest()\n    return int(_hash, 16) % n_buckets\n\ndef assign_split(user_id):\n    bucket = assign_bucket(user_id)\n    if bucket < n_buckets * train_ratio:\n        return 'train'\n    elif bucket < n_buckets * (train_ratio + val_ratio):\n        return 'val'\n    else:\n        return 'test'\n```"]