# ç¬¬åç« ï¼šä½ç§©æ–¹æ³•

åœ¨å‰ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹å¤„ç†è¿™ä¹ˆå¤šç‰¹å¾çš„æŒ‘æˆ˜æ„Ÿåˆ°æƒ‹æƒœã€‚é€šè¿‡è®©æ¯ä¸ªé¡¹ç›®æˆä¸ºå…¶è‡ªå·±çš„ç‰¹å¾ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè¡¨è¾¾å¤§é‡å…³äºç”¨æˆ·åå¥½å’Œé¡¹ç›®ç›¸å…³æ€§çš„ä¿¡æ¯ï¼Œä½†åœ¨ç»´åº¦ç¾éš¾æ–¹é¢æˆ‘ä»¬é™·å…¥äº†éº»çƒ¦ã€‚ç»“åˆéå¸¸ç¨€ç–ç‰¹å¾çš„ç°å®ï¼Œæ‚¨é¢ä¸´å±é™©ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è½¬å‘æ›´å°çš„ç‰¹å¾ç©ºé—´ã€‚é€šè¿‡å°†ç”¨æˆ·å’Œé¡¹ç›®è¡¨ç¤ºä¸ºä½ç»´å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æœ‰æ•ˆåœ°æ•æ‰å®ƒä»¬ä¹‹é—´çš„å¤æ‚å…³ç³»ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸ºç”¨æˆ·ç”Ÿæˆæ›´ä¸ªæ€§åŒ–å’Œç›¸å…³çš„æ¨èï¼ŒåŒæ—¶å‡å°‘æ¨èè¿‡ç¨‹çš„è®¡ç®—å¤æ‚æ€§ã€‚

æˆ‘ä»¬å°†æ¢è®¨ä½¿ç”¨ä½ç»´åµŒå…¥çš„æ–¹æ³•ï¼Œå¹¶è®¨è®ºæ­¤æ–¹æ³•çš„ä¼˜åŠ¿ä»¥åŠéƒ¨åˆ†å®ç°ç»†èŠ‚ã€‚æˆ‘ä»¬è¿˜å°†æŸ¥çœ‹åœ¨ JAX ä¸­ä½¿ç”¨ç°ä»£åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æ¥å‡å°‘é¡¹ç›®æˆ–ç”¨æˆ·è¡¨ç¤ºç»´åº¦çš„ä»£ç ã€‚

# æ½œåœ¨ç©ºé—´

æ‚¨å·²ç»ç†Ÿæ‚‰ç‰¹å¾ç©ºé—´ï¼Œé€šå¸¸æ˜¯æ•°æ®çš„åˆ†ç±»æˆ–çŸ¢é‡å€¼ç›´æ¥è¡¨ç¤ºã€‚è¿™å¯ä»¥æ˜¯å›¾åƒçš„åŸå§‹çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²å€¼ï¼Œç›´æ–¹å›¾ä¸­é¡¹ç›®çš„è®¡æ•°ï¼Œæˆ–è€…å¯¹è±¡çš„å±æ€§å¦‚é•¿åº¦ã€å®½åº¦å’Œé«˜åº¦ã€‚å¦ä¸€æ–¹é¢ï¼Œæ½œåœ¨ç‰¹å¾ä¸ä»£è¡¨ä»»ä½•ç‰¹å®šçš„å®å€¼ç‰¹å¾ï¼Œè€Œæ˜¯éšæœºåˆå§‹åŒ–ï¼Œç„¶åæ ¹æ®ä»»åŠ¡è¿›è¡Œå­¦ä¹ ã€‚æˆ‘ä»¬åœ¨ç¬¬å…«ç« ä¸­è®¨è®ºçš„ GloVe åµŒå…¥å°±æ˜¯ä¸€ä¸ªå­¦ä¹ è¡¨ç¤ºå•è¯å¯¹æ•°è®¡æ•°çš„æ½œåœ¨å‘é‡çš„ä¾‹å­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä»‹ç»ç”Ÿæˆè¿™äº›æ½œåœ¨ç‰¹å¾æˆ–åµŒå…¥çš„æ›´å¤šæ–¹å¼ã€‚

# ä¸“æ³¨äºæ‚¨çš„â€œä¼˜åŠ¿â€

æœ¬ç« éå¸¸ä¾èµ–äºçº¿æ€§ä»£æ•°ï¼Œå› æ­¤åœ¨ç»§ç»­ä¹‹å‰ï¼Œç†Ÿæ‚‰å‘é‡ã€ç‚¹ç§¯å’Œå‘é‡èŒƒæ•°æ˜¯å¾ˆå¥½çš„ã€‚äº†è§£çŸ©é˜µåŠå…¶ç§©ä¹Ÿå°†éå¸¸æœ‰ç”¨ã€‚è€ƒè™‘é˜…è¯»ã€Šçº¿æ€§ä»£æ•°åŠå…¶åº”ç”¨ã€‹ï¼ˆ[*Linear Algebra and Its Applications*](https://oreil.ly/8MBN8)ï¼‰ï¼Œä½œè€… Gilbert Strangã€‚

æ½œåœ¨ç©ºé—´å¦‚æ­¤å—æ¬¢è¿çš„åŸå› ä¹‹ä¸€æ˜¯å®ƒä»¬é€šå¸¸æ¯”å®ƒä»¬æ‰€ä»£è¡¨çš„ç‰¹å¾ä½ç»´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·-ç‰©å“è¯„åˆ†çŸ©é˜µæˆ–äº¤äº’çŸ©é˜µï¼ˆå…¶ä¸­çŸ©é˜µæ¡ç›®ä¸º 1ï¼Œå¦‚æœç”¨æˆ·ä¸ç‰©å“æœ‰äº¤äº’ï¼‰æ˜¯ *N* Ã— *M* ç»´åº¦çš„ï¼Œé‚£ä¹ˆå°†çŸ©é˜µåˆ†è§£ä¸º *N* Ã— *K* å’Œ *K* Ã— *M* çš„æ½œåœ¨å› å­ï¼Œå…¶ä¸­ *K* è¿œå°äº *N* æˆ– *M*ï¼Œæ˜¯å¯¹ç¼ºå¤±æ¡ç›®çš„ä¸€ç§è¿‘ä¼¼ï¼Œå› ä¸ºæˆ‘ä»¬æ”¾å®½äº†å› å­åˆ†è§£ã€‚ *K* æ¯” *N* æˆ– *M* å°é€šå¸¸è¢«ç§°ä¸º*ä¿¡æ¯ç“¶é¢ˆ*â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ­£åœ¨å¼ºåˆ¶çŸ©é˜µç”±ä¸€ä¸ªå°å¾—å¤šçš„çŸ©é˜µç»„æˆã€‚è¿™æ„å‘³ç€ ML æ¨¡å‹å¿…é¡»å¡«è¡¥ç¼ºå¤±çš„æ¡ç›®ï¼Œè¿™å¯¹äºæ¨èç³»ç»Ÿå¯èƒ½æ˜¯æœ‰åˆ©çš„ã€‚åªè¦ç”¨æˆ·ä¸è¶³å¤Ÿç›¸ä¼¼çš„ç‰©å“æœ‰äº¤äº’ï¼Œé€šè¿‡å¼ºåˆ¶ç³»ç»Ÿåœ¨è‡ªç”±åº¦æ–¹é¢å®¹é‡å¤§å¤§å‡å°‘ï¼Œç„¶åå› å­åˆ†è§£å¯ä»¥å®Œå…¨é‡æ„çŸ©é˜µï¼Œå¹¶ä¸”ç¼ºå¤±çš„æ¡ç›®å¾€å¾€ä¼šè¢«ç›¸ä¼¼çš„ç‰©å“å¡«è¡¥ã€‚

ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬å°†ä¸€ä¸ª 4 Ã— 4 çš„ç”¨æˆ·-ç‰©å“çŸ©é˜µåˆ†è§£ä¸ºä¸€ä¸ª 4 Ã— 2 å’Œä¸€ä¸ª 2 Ã— 4 çš„å‘é‡æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚

æˆ‘ä»¬æä¾›çš„çŸ©é˜µçš„è¡Œæ˜¯ç”¨æˆ·ï¼Œåˆ—æ˜¯ç‰©å“ã€‚ä¾‹å¦‚ï¼Œç¬¬ 0 è¡Œæ˜¯ `[1, 0, 0, 1]`ï¼Œè¿™æ„å‘³ç€ç”¨æˆ· 0 é€‰æ‹©äº†ç‰©å“ 0 å’Œç‰©å“ 3ã€‚è¿™äº›å¯ä»¥æ˜¯è¯„åˆ†æˆ–è´­ä¹°ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€äº›ä»£ç ï¼š

```py
import numpy as np

a = np.array([
    [1, 0, 0 ,1],
    [1, 0, 0 ,0],
    [0, 1, 1, 0],
    [0, 1, 0, 0]]
)

u, s, v = np.linalg.svd(a, full_matrices=False)

# Set the last two eigenvalues to 0.
s[2:4] = 0
print(s)
b = np.dot(u * s, v)
print(b)

# These are the eigenvalues with the smallest two set to 0.
s = [1.61803399 1.61803399 0.         0.        ]

# This is the newly reconstructed matrix.
b = [[1.17082039 0.         0.         0.7236068 ]
 [0.7236068  0.         0.         0.4472136 ]
 [0.         1.17082039 0.7236068  0.        ]
 [0.         0.7236068  0.4472136  0.        ]]
```

è¯·æ³¨æ„ï¼Œç°åœ¨ç¬¬ 1 è¡Œçš„ç”¨æˆ·åœ¨ç¬¬ 3 åˆ—æœ‰ä¸€ä¸ªç‰©å“çš„åˆ†æ•°ï¼Œå¹¶ä¸”ç¬¬ 3 è¡Œçš„ç”¨æˆ·å¯¹ç¬¬ 2 åˆ—çš„ç‰©å“æœ‰æ­£åˆ†æ•°ã€‚è¿™ç§ç°è±¡é€šå¸¸è¢«ç§°ä¸º*çŸ©é˜µè¡¥å…¨*ï¼Œå¯¹äºæ¨èç³»ç»Ÿæ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬å¯ä»¥å‘ç”¨æˆ·æ¨èæ–°çš„ç‰©å“ã€‚é€šè¿‡å¼ºåˆ¶è®© ML é€šè¿‡æ¯”å…¶å°è¯•é‡å»ºçš„çŸ©é˜µå¤§å°æ›´å°çš„ç“¶é¢ˆçš„ä¸€èˆ¬æ–¹æ³•è¢«ç§°ä¸º*ä½ç§©è¿‘ä¼¼*ï¼Œå› ä¸ºè¿‘ä¼¼çš„ç§©ä¸º 2ï¼Œä½†åŸå§‹ç”¨æˆ·-ç‰©å“çŸ©é˜µçš„ç§©ä¸º 4ã€‚

# çŸ©é˜µçš„ç§©æ˜¯ä»€ä¹ˆï¼Ÿ

*N* Ã— *M* çŸ©é˜µå¯ä»¥è¢«è§†ä¸º *N* è¡Œå‘é‡ï¼ˆå¯¹åº”ç”¨æˆ·ï¼‰å’Œ *M* åˆ—å‘é‡ï¼ˆå¯¹åº”ç‰©å“ï¼‰ã€‚å½“ä½ è€ƒè™‘ *M* ç»´åº¦ä¸­ *N* å‘é‡æ—¶ï¼Œ*çŸ©é˜µçš„ç§©* æ˜¯ç”± *N* ä¸ªå‘é‡åœ¨ *M* ç»´åº¦ä¸­å®šä¹‰çš„å¤šé¢ä½“çš„ä½“ç§¯ã€‚ç„¶è€Œï¼Œè¿™ä¸æˆ‘ä»¬è®¨è®ºçŸ©é˜µç§©çš„æ–¹å¼é€šå¸¸ä¸åŒã€‚è™½ç„¶è¿™æ˜¯æœ€è‡ªç„¶å’Œç²¾ç¡®çš„å®šä¹‰ï¼Œä½†æˆ‘ä»¬å´è¯´å®ƒæ˜¯â€œè¡¨ç¤ºçŸ©é˜µå‘é‡æ‰€éœ€çš„æœ€å°ç»´æ•°ã€‚â€

æˆ‘ä»¬å°†åœ¨æœ¬ç« åé¢æ›´è¯¦ç»†åœ°ä»‹ç» SVDã€‚è¿™åªæ˜¯ä¸ºäº†æ¿€å‘ä½ å¯¹ç†è§£æ½œåœ¨ç©ºé—´å¦‚ä½•ä¸æ¨èç³»ç»Ÿç›¸å…³çš„å…´è¶£ã€‚

# ç‚¹ç§¯ç›¸ä¼¼åº¦

åœ¨ç¬¬ä¸‰ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ç›¸ä¼¼åº¦æµ‹é‡ï¼Œä½†ç°åœ¨æˆ‘ä»¬å›åˆ°ç‚¹ç§¯çš„æ¦‚å¿µï¼Œå› ä¸ºåœ¨æ½œåœ¨ç©ºé—´ä¸­å®ƒä»¬å˜å¾—æ›´åŠ é‡è¦ã€‚æ¯•ç«Ÿï¼Œæ½œåœ¨ç©ºé—´å»ºç«‹åœ¨è·ç¦»å³ç›¸ä¼¼æ€§çš„å‡è®¾ä¸Šã€‚

åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œç‚¹ç§¯ç›¸ä¼¼åº¦æœ‰æ„ä¹‰ï¼Œå› ä¸ºå®ƒæä¾›äº†åœ¨æ½œåœ¨ç©ºé—´ä¸­ç”¨æˆ·ä¸ç‰©å“ä¹‹é—´å…³ç³»çš„å‡ ä½•è§£é‡Šï¼ˆæˆ–è€…å¯èƒ½æ˜¯ç‰©å“ä¸ç‰©å“ã€ç”¨æˆ·ä¸ç”¨æˆ·ç­‰ï¼‰ã€‚åœ¨æ¨èç³»ç»Ÿçš„èƒŒæ™¯ä¸‹ï¼Œç‚¹ç§¯å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå‘é‡åœ¨å¦ä¸€ä¸ªå‘é‡ä¸Šçš„æŠ•å½±ï¼ŒæŒ‡ç¤ºç”¨æˆ·åå¥½ä¸ç‰©å“ç‰¹æ€§ä¹‹é—´çš„ç›¸ä¼¼åº¦æˆ–å¯¹é½ç¨‹åº¦ã€‚

è¦ç†è§£ç‚¹ç§¯çš„å‡ ä½•æ„ä¹‰ï¼Œè€ƒè™‘ä¸¤ä¸ªå‘é‡ *u* å’Œ *p*ï¼Œåˆ†åˆ«è¡¨ç¤ºæ½œåœ¨ç©ºé—´ä¸­çš„ç”¨æˆ·å’Œäº§å“ã€‚è¿™ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯å¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼š

<math alttext="u times p equals StartAbsoluteValue EndAbsoluteValue u StartAbsoluteValue EndAbsoluteValue StartAbsoluteValue EndAbsoluteValue p StartAbsoluteValue EndAbsoluteValue c o s left-parenthesis theta right-parenthesis" display="block"><mrow><mi>u</mi> <mo>Ã—</mo> <mi>p</mi> <mo>=</mo> <mo>|</mo> <mo>|</mo> <mi>u</mi> <mo>|</mo> <mo>|</mo> <mo>|</mo> <mo>|</mo> <mi>p</mi> <mo>|</mo> <mo>|</mo> <mi>c</mi> <mi>o</mi> <mi>s</mi> <mo>(</mo> <mi>Î¸</mi> <mo>)</mo></mrow></math>

è¿™é‡Œï¼Œ||u|| å’Œ ||p|| è¡¨ç¤ºç”¨æˆ·å‘é‡å’Œäº§å“å‘é‡çš„å¤§å°ï¼ŒÎ¸ è¡¨ç¤ºå®ƒä»¬ä¹‹é—´çš„è§’åº¦ã€‚å› æ­¤ï¼Œç‚¹ç§¯æ˜¯ä¸€ä¸ªè¡¡é‡ä¸€ä¸ªå‘é‡åœ¨å¦ä¸€ä¸ªå‘é‡ä¸ŠæŠ•å½±çš„åº¦é‡ï¼Œå…¶å€¼å—åˆ°ä¸¤ä¸ªå‘é‡å¤§å°çš„å½±å“ã€‚

ä½™å¼¦ç›¸ä¼¼åº¦æ˜¯æ¨èç³»ç»Ÿä¸­å¦ä¸€ä¸ªæµè¡Œçš„ç›¸ä¼¼åº¦åº¦é‡ï¼Œç›´æ¥æºäºç‚¹ç§¯ï¼š

<math alttext="c o s i n e s i m i l a r i t y left-parenthesis u comma p right-parenthesis equals StartFraction left-parenthesis u times p right-parenthesis Over left-parenthesis StartAbsoluteValue EndAbsoluteValue u StartAbsoluteValue EndAbsoluteValue StartAbsoluteValue EndAbsoluteValue p StartAbsoluteValue EndAbsoluteValue right-parenthesis EndFraction" display="block"><mrow><mi>c</mi> <mi>o</mi> <mi>s</mi> <mi>i</mi> <mi>n</mi> <mi>e</mi> <mi>s</mi> <mi>i</mi> <mi>m</mi> <mi>i</mi> <mi>l</mi> <mi>a</mi> <mi>r</mi> <mi>i</mi> <mi>t</mi> <mi>y</mi> <mrow><mo>(</mo> <mi>u</mi> <mo>,</mo> <mi>p</mi> <mo>)</mo></mrow> <mo>=</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>(</mo><mi>u</mi><mo>Ã—</mo><mi>p</mi><mo>)</mo></mrow> <mrow><mo>(</mo><mo>|</mo><mo>|</mo><mi>u</mi><mo>|</mo><mo>|</mo><mo>|</mo><mo>|</mo><mi>p</mi><mo>|</mo><mo>|</mo><mo>)</mo></mrow></mfrac></mstyle></mrow></math>

ä½™å¼¦ç›¸ä¼¼åº¦çš„èŒƒå›´ä» -1 åˆ° 1ï¼Œå…¶ä¸­ -1 è¡¨ç¤ºå®Œå…¨ä¸ç›¸ä¼¼çš„åå¥½å’Œç‰¹æ€§ã€‚0 è¡¨ç¤ºæ²¡æœ‰ç›¸ä¼¼åº¦ï¼Œ1 è¡¨ç¤ºç”¨æˆ·åå¥½ä¸äº§å“ç‰¹æ€§å®Œå…¨å¯¹é½ã€‚åœ¨æ¨èç³»ç»Ÿçš„èƒŒæ™¯ä¸‹ï¼Œä½™å¼¦ç›¸ä¼¼åº¦æä¾›äº†ä¸€ä¸ªå½’ä¸€åŒ–çš„ç›¸ä¼¼åº¦åº¦é‡ï¼Œä¸å—ç”¨æˆ·å’Œäº§å“å‘é‡å¤§å°çš„å½±å“ã€‚éœ€è¦æ³¨æ„ï¼Œé€‰æ‹©ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦è¿˜æ˜¯ L2 è·ç¦»å–å†³äºæ‚¨ä½¿ç”¨çš„åµŒå…¥ç±»å‹ä»¥åŠä¼˜åŒ–è®¡ç®—çš„æ–¹å¼ã€‚åœ¨å®è·µä¸­ï¼Œé€šå¸¸æœ€é‡è¦çš„ç‰¹å¾æ˜¯ç›¸å¯¹å€¼ã€‚

åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œç‚¹ç§¯ï¼ˆä»¥åŠä½™å¼¦ç›¸ä¼¼åº¦ï¼‰çš„å‡ ä½•è§£é‡Šæ˜¯æ•æ‰ç”¨æˆ·åå¥½ä¸äº§å“ç‰¹æ€§ä¹‹é—´çš„å¯¹é½ç¨‹åº¦ã€‚å¦‚æœç”¨æˆ·å‘é‡å’Œäº§å“å‘é‡ä¹‹é—´çš„è§’åº¦å¾ˆå°ï¼Œåˆ™ç”¨æˆ·åå¥½ä¸äº§å“ç‰¹æ€§å¾ˆå¥½åœ°å¯¹é½ï¼Œä»è€Œå¯¼è‡´æ›´é«˜çš„ç›¸ä¼¼åº¦åˆ†æ•°ã€‚ç›¸åï¼Œå¦‚æœè§’åº¦å¾ˆå¤§ï¼Œåˆ™ç”¨æˆ·åå¥½ä¸äº§å“ç‰¹æ€§ä¸ç›¸ä¼¼ï¼Œå¯¼è‡´è¾ƒä½çš„ç›¸ä¼¼åº¦åˆ†æ•°ã€‚é€šè¿‡å°†ç”¨æˆ·å’Œç‰©å“å‘é‡æŠ•å½±åˆ°å½¼æ­¤ä¸Šï¼Œç‚¹ç§¯ç›¸ä¼¼åº¦å¯ä»¥æ•æ‰ç”¨æˆ·åå¥½ä¸ç‰©å“ç‰¹æ€§ä¹‹é—´çš„å¯¹é½ç¨‹åº¦ï¼Œä»è€Œä½¿æ¨èç³»ç»Ÿèƒ½å¤Ÿè¯†åˆ«æœ€æœ‰å¯èƒ½ä¸ç”¨æˆ·ç›¸å…³å’Œå¸å¼•çš„ç‰©å“ã€‚

ä¼ é—»ä¸­ï¼Œç‚¹ç§¯ä¼¼ä¹æ•æ‰åˆ°äº†æµè¡Œåº¦ï¼Œå› ä¸ºéå¸¸é•¿çš„å‘é‡å€¾å‘äºå®¹æ˜“æŠ•å½±åˆ°ä»»ä½•ä¸å®Œå…¨å‚ç›´æˆ–æŒ‡å‘è¿œç¦»çš„ç‰©ä½“ä¸Šã€‚å› æ­¤ï¼Œå­˜åœ¨ä¸€ç§æƒè¡¡ï¼Œå³é¢‘ç¹æ¨èå…·æœ‰è¾ƒå¤§å‘é‡é•¿åº¦çš„çƒ­é—¨ç‰©å“ä¸å…·æœ‰è¾ƒå°ä½™å¼¦è·ç¦»è§’åº¦å·®çš„é•¿å°¾ç‰©å“ä¹‹é—´çš„æƒè¡¡ã€‚

å›¾Â 10-1 è€ƒè™‘äº†ä¸¤ä¸ªå‘é‡ï¼Œ*a* å’Œ *b*ã€‚ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æ—¶ï¼Œå‘é‡æ˜¯å•ä½é•¿åº¦çš„ï¼Œæ‰€ä»¥è§’åº¦å°±æ˜¯ç›¸ä¼¼åº¦çš„åº¦é‡ã€‚ç„¶è€Œï¼Œä½¿ç”¨ç‚¹ç§¯æ—¶ï¼Œä¸€ä¸ªéå¸¸é•¿çš„å‘é‡åƒ *c* å¯èƒ½ä¼šè¢«è®¤ä¸ºæ¯” *b* æ›´ç›¸ä¼¼ *a*ï¼Œå°½ç®¡ *a* å’Œ *b* ä¹‹é—´çš„è§’åº¦æ›´å°ï¼Œå› ä¸º *c* çš„é•¿åº¦æ›´é•¿ã€‚è¿™äº›é•¿å‘é‡å¾€å¾€æ˜¯ä¸è®¸å¤šå…¶ä»–é¡¹ç›®å…±åŒå‡ºç°çš„éå¸¸æµè¡Œçš„é¡¹ç›®ã€‚

![ä½™å¼¦ vs ç‚¹ç§¯ç›¸ä¼¼åº¦](img/brpj_1001.png)

###### å›¾ 10-1\. ä½™å¼¦ç›¸ä¼¼åº¦ä¸ç‚¹ç§¯ç›¸ä¼¼åº¦

# å…±ç°æ¨¡å‹

åœ¨æˆ‘ä»¬çš„ç»´åŸºç™¾ç§‘å…±ç°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç¡®å®šäº†ä¸¤ä¸ªé¡¹ç›®ä¹‹é—´çš„å…±ç°ç»“æ„å¯ä»¥ç”¨æ¥ç”Ÿæˆç›¸ä¼¼åº¦æµ‹é‡ã€‚æˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨ PMI å¯ä»¥è·å–å…±ç°è®¡æ•°å¹¶åŸºäºè´­ç‰©è½¦ä¸­çš„é¡¹ä¸å…¶ä»–é¡¹ä¹‹é—´éå¸¸é«˜çš„äº’ä¿¡æ¯åšå‡ºæ¨èã€‚

æ­£å¦‚æˆ‘ä»¬æ‰€è®¨è®ºçš„ï¼ŒPMI ä¸æ˜¯ä¸€ä¸ªè·ç¦»åº¦é‡ï¼Œä½†åŸºäºå…±ç°ä»å…·æœ‰é‡è¦çš„ç›¸ä¼¼åº¦åº¦é‡ã€‚è®©æˆ‘ä»¬å›åˆ°è¿™ä¸ªè¯é¢˜ã€‚

ä¹‹å‰æåˆ°è¿‡ï¼ŒPMI çš„å®šä¹‰å¦‚ä¸‹ï¼š

<math alttext="StartFraction p left-parenthesis x Subscript i Baseline comma x Subscript j Baseline right-parenthesis Over p left-parenthesis x Subscript i Baseline right-parenthesis asterisk p left-parenthesis x Subscript j Baseline right-parenthesis EndFraction equals StartFraction left-parenthesis upper C Subscript script upper I Baseline right-parenthesis Subscript x Sub Subscript i Subscript comma x Sub Subscript j Subscript Baseline asterisk number-sign left-parenthesis total interactions right-parenthesis Over number-sign left-parenthesis x Subscript i Baseline right-parenthesis asterisk number-sign left-parenthesis x Subscript j Baseline right-parenthesis EndFraction" display="block"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>p</mi><mo>(</mo><msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>x</mi> <mi>j</mi></msub> <mo>)</mo></mrow> <mrow><mi>p</mi><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi></msub> <mo>)</mo></mrow><mo>*</mo><mi>p</mi><mrow><mo>(</mo><msub><mi>x</mi> <mi>j</mi></msub> <mo>)</mo></mrow></mrow></mfrac></mstyle> <mo>=</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mfenced close=")" open="(" separators=""><msub><mi>C</mi> <mi>â„</mi></msub></mfenced> <mrow><msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>x</mi> <mi>j</mi></msub></mrow></msub> <mo>*</mo><mo>#</mo><mfenced close=")" open="(" separators=""><mtext>total</mtext><mtext>interactions</mtext></mfenced></mrow> <mrow><mo>#</mo><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi></msub> <mo>)</mo></mrow><mo>*</mo><mo>#</mo><mrow><mo>(</mo><msub><mi>x</mi> <mi>j</mi></msub> <mo>)</mo></mrow></mrow></mfrac></mstyle></mrow></math>

ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ *ç¦»æ•£å…±ç°åˆ†å¸ƒ*ï¼Œ<math alttext="upper C upper D Subscript x Sub Subscript i"><mrow><mi>C</mi> <msub><mi>D</mi> <msub><mi>x</mi> <mi>i</mi></msub></msub></mrow></math> ï¼Œå®šä¹‰ä¸ºæ‰€æœ‰å…¶ä»– <math alttext="x Subscript j"><msub><mi>x</mi> <mi>j</mi></msub></math> çš„å…±ç°çš„é›†åˆï¼š

<math alttext="upper C upper D Subscript x Sub Subscript i Baseline equals left-parenthesis upper C Subscript script upper I Baseline right-parenthesis Subscript x Sub Subscript i Subscript comma x 1 Baseline comma ellipsis comma left-parenthesis upper C Subscript script upper I Baseline right-parenthesis Subscript x Sub Subscript i Subscript comma x Sub Subscript i Subscript Baseline comma ellipsis comma left-parenthesis upper C Subscript script upper I Baseline right-parenthesis Subscript x Sub Subscript i Subscript comma x Sub Subscript upper N Subscript Baseline" display="block"><mrow><mi>C</mi> <msub><mi>D</mi> <msub><mi>x</mi> <mi>i</mi></msub></msub> <mo>=</mo> <mrow><msub><mfenced close=")" open="(" separators=""><msub><mi>C</mi> <mi>â„</mi></msub></mfenced> <mrow><msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>x</mi> <mn>1</mn></msub></mrow></msub> <mo>,</mo> <mo>...</mo> <mo>,</mo> <msub><mfenced close=")" open="(" separators=""><msub><mi>C</mi> <mi>â„</mi></msub></mfenced> <mrow><msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>x</mi> <mi>i</mi></msub></mrow></msub> <mo>,</mo> <mo>...</mo> <mo>,</mo> <msub><mfenced close=")" open="(" separators=""><msub><mi>C</mi> <mi>â„</mi></msub></mfenced> <mrow><msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>x</mi> <mi>N</mi></msub></mrow></msub></mrow></mrow></math>

åœ¨è¿™é‡Œï¼Œ<math alttext="j element-of 1 ellipsis upper N"><mrow><mi>j</mi> <mo>âˆˆ</mo> <mn>1</mn> <mo>...</mo> <mi>N</mi></mrow></math> ï¼Œè€Œ <math alttext="upper N"><mi>N</mi></math> æ˜¯æ‰€æœ‰é¡¹ç›®çš„æ€»æ•°ã€‚è¿™è¡¨ç¤º <math alttext="x Subscript i"><msub><mi>x</mi> <mi>i</mi></msub></math> ä¸æ‰€æœ‰å…¶ä»–é¡¹ç›®ä¹‹é—´çš„å…±ç°ç›´æ–¹å›¾ã€‚é€šè¿‡å¼•å…¥è¿™ç§ç¦»æ•£åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¦ä¸€ä¸ªå·¥å…·ï¼šHellinger è·ç¦»ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨å‡ ç§æ–¹æ³•æ¥è¡¡é‡åˆ†å¸ƒè·ç¦»ï¼Œæ¯ç§æ–¹æ³•éƒ½æœ‰ä¸åŒçš„ä¼˜åŠ¿ã€‚åœ¨æˆ‘ä»¬çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šæ·±å…¥æ¢è®¨è¿™äº›å·®å¼‚ï¼Œè€Œæ˜¯åšæŒä½¿ç”¨æœ€ç®€å•ä½†æœ€åˆé€‚çš„æ–¹æ³•ã€‚Hellinger è·ç¦»çš„å®šä¹‰å¦‚ä¸‹ï¼š

<math alttext="upper H left-parenthesis upper P comma upper Q right-parenthesis equals NestedStartRoot 1 minus sigma-summation Underscript i Overscript n Endscripts StartRoot p Subscript i Baseline q Subscript i Baseline EndRoot NestedEndRoot equals StartFraction 1 Over StartRoot 2 EndRoot EndFraction double-vertical-bar StartRoot upper P EndRoot minus StartRoot upper Q EndRoot double-vertical-bar Subscript 2" display="block"><mrow><mi>H</mi> <mrow><mo>(</mo> <mi>P</mi> <mo>,</mo> <mi>Q</mi> <mo>)</mo></mrow> <mo>=</mo> <msqrt><mrow><mn>1</mn> <mo>-</mo> <msubsup><mo>âˆ‘</mo> <mi>i</mi> <mi>n</mi></msubsup> <msqrt><mrow><msub><mi>p</mi> <mi>i</mi></msub> <msub><mi>q</mi> <mi>i</mi></msub></mrow></msqrt></mrow></msqrt> <mo>=</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn> <msqrt><mn>2</mn></msqrt></mfrac></mstyle> <msub><mfenced close="âˆ¥" open="âˆ¥" separators=""><msqrt><mi>P</mi></msqrt><mo>-</mo><msqrt><mi>Q</mi></msqrt></mfenced> <mn>2</mn></msub></mrow></math>

<math alttext="upper P equals mathematical left-angle p Subscript i Baseline mathematical right-angle"><mrow><mi>P</mi> <mo>=</mo> <mfenced close="âŒª" open="âŒ©" separators=""><msub><mi>p</mi> <mi>i</mi></msub></mfenced></mrow></math> å’Œ <math alttext="upper Q equals mathematical left-angle q Subscript i Baseline mathematical right-angle"><mrow><mi>Q</mi> <mo>=</mo> <mfenced close="âŒª" open="âŒ©" separators=""><msub><mi>q</mi> <mi>i</mi></msub></mfenced></mrow></math> æ˜¯ä¸¤ä¸ªæ¦‚ç‡å¯†åº¦å‘é‡ã€‚åœ¨æˆ‘ä»¬çš„è®¾å®šä¸­ï¼Œ<math alttext="upper P"><mi>P</mi></math> å’Œ <math alttext="upper Q"><mi>Q</mi></math> å¯ä»¥æ˜¯ <math alttext="upper C upper D Subscript x Sub Subscript i"><mrow><mi>C</mi> <msub><mi>D</mi> <msub><mi>x</mi> <mi>i</mi></msub></msub></mrow></math> å’Œ <math alttext="upper C upper D Subscript x Sub Subscript j"><mrow><mi>C</mi> <msub><mi>D</mi> <msub><mi>x</mi> <mi>j</mi></msub></msub></mrow></math> ã€‚

è¿™ä¸ªè¿‡ç¨‹èƒŒåçš„åŠ¨æœºæ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†åŸºäºå…±ç°çš„ç‰©å“ä¹‹é—´çš„é€‚å½“è·ç¦»ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ç§å‡ ä½•ä¸Šä½¿ç”¨ä»»ä½•ç»´åº¦è½¬æ¢æˆ–å‡å°‘ã€‚ç¨åæˆ‘ä»¬å°†å±•ç¤ºå¯ä»¥ä½¿ç”¨ä»»æ„è·ç¦»çŸ©é˜µå¹¶å°†ç©ºé—´å‡å°‘åˆ°é€¼è¿‘å®ƒçš„ä½ç»´åµŒå…¥çš„ç»´åº¦å‡å°‘æŠ€æœ¯ã€‚

# æµ‹åº¦ç©ºé—´å’Œä¿¡æ¯ç†è®ºå‘¢ï¼Ÿ

å½“æˆ‘ä»¬è®¨è®ºåˆ†å¸ƒæ—¶ï¼Œä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ï¼Œâ€œæ˜¯å¦å­˜åœ¨ä¸€ç§è·ç¦»ä½¿å¾—åˆ†å¸ƒåœ¨æ½œåœ¨ç©ºé—´ä¸­æ˜¯ç‚¹ï¼Ÿâ€å“¦ï¼Œä½ æ²¡æœ‰æƒ³åˆ°ï¼Ÿå¥½å§ï¼Œæˆ‘ä»¬æ— è®ºå¦‚ä½•ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚

ç®€çŸ­çš„ç­”æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è¡¡é‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚æœ€æµè¡Œçš„æ˜¯åº“å°”å·´å…‹-è±å¸ƒå‹’ï¼ˆKLï¼‰æ•£åº¦ï¼Œé€šå¸¸åœ¨è´å¶æ–¯æ„ä¹‰ä¸‹æè¿°ä¸ºé¢„æœŸåˆ†å¸ƒ Q æ—¶çœ‹åˆ°åˆ†å¸ƒ P çš„æƒŠè®¶ç¨‹åº¦ã€‚ç„¶è€Œï¼ŒKL ä¸æ˜¯ä¸€ä¸ªé€‚å½“çš„è·ç¦»åº¦é‡ï¼Œå› ä¸ºå®ƒæ˜¯éå¯¹ç§°çš„ã€‚

å¦ä¸€ä¸ªå…·æœ‰è‰¯å¥½æ€§è´¨çš„å¯¹ç§°è·ç¦»åº¦é‡æ˜¯æµ·æ—æ ¼è·ç¦»ã€‚æµ·æ—æ ¼è·ç¦»å®é™…ä¸Šæ˜¯äºŒèŒƒæ•°çš„æµ‹åº¦è®ºè·ç¦»ã€‚æ­¤å¤–ï¼Œæµ·æ—æ ¼è·ç¦»è‡ªç„¶åœ°æ¨å¹¿åˆ°ç¦»æ•£åˆ†å¸ƒã€‚

å¦‚æœè¿™ä»ç„¶æ²¡æœ‰è§£å†³ä½ å¯¹æŠ½è±¡çš„æ¸´æœ›ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘æ€»å˜åˆ†è·ç¦»ï¼Œè¿™æ˜¯åœ¨è´¹èˆå°”ç²¾ç¡®è·ç¦»æµ‹åº¦ç©ºé—´ä¸­çš„æé™ï¼Œè¿™å®é™…ä¸Šæ„å‘³ç€å®ƒå…·æœ‰ä¸¤ä¸ªåˆ†å¸ƒè·ç¦»çš„æ‰€æœ‰è‰¯å¥½æ€§è´¨ï¼Œå¹¶ä¸”æ²¡æœ‰æµ‹é‡ä¼šè®¤ä¸ºå®ƒä»¬æ›´ä¸åŒã€‚å—¯ï¼Œæ‰€æœ‰çš„è‰¯å¥½æ€§è´¨é™¤äº†ä¸€ä¸ªï¼šå®ƒä¸å¹³æ»‘ã€‚å¦‚æœä½ è¿˜å¸Œæœ›å…·æœ‰å¹³æ»‘æ€§å’Œå¯å¾®æ€§ï¼Œä½ éœ€è¦é€šè¿‡åç§»æ¥è¿‘ä¼¼å®ƒã€‚

å¦‚æœä½ éœ€è¦è®¡ç®—åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¯ä»¥ä½¿ç”¨æµ·æ—æ ¼è·ç¦»ã€‚

# å‡å°‘æ¨èé—®é¢˜çš„æ’å

æˆ‘ä»¬å·²ç»è¡¨æ˜ï¼Œéšç€ç‰©å“å’Œç”¨æˆ·æ•°é‡çš„å¢åŠ ï¼Œæˆ‘ä»¬æ¨èé—®é¢˜çš„ç»´åº¦è¿…é€Ÿå¢åŠ ã€‚å› ä¸ºæˆ‘ä»¬å°†æ¯ä¸ªé¡¹ç›®å’Œç”¨æˆ·è¡¨ç¤ºä¸ºä¸€åˆ—æˆ–å‘é‡ï¼Œè¿™ç±»ä¼¼äº<math alttext="n squared"><msup><mi>n</mi> <mn>2</mn></msup></math>çš„è§„æ¨¡ã€‚æ¨è¿Ÿè¿™ä¸€å›°éš¾çš„ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡é™ç§©ï¼›å›æƒ³æˆ‘ä»¬ä¹‹å‰å…³äºé€šè¿‡å› å­åˆ†è§£è¿›è¡Œé™ç§©çš„è®¨è®ºã€‚

åƒè®¸å¤šæ•´æ•°ä¸€æ ·ï¼Œè®¸å¤šçŸ©é˜µå¯ä»¥è¢«*åˆ†è§£*æˆæ›´å°çš„çŸ©é˜µï¼›å¯¹äºæ•´æ•°æ¥è¯´ï¼Œ*æ›´å°*æ„å‘³ç€æ›´å°çš„å€¼ï¼Œå¯¹äºçŸ©é˜µæ¥è¯´ï¼Œ*æ›´å°*æ„å‘³ç€æ›´å°çš„ç»´åº¦ã€‚å½“æˆ‘ä»¬åˆ†è§£ä¸€ä¸ª<math alttext="upper N times upper M"><mrow><mi>N</mi> <mo>Ã—</mo> <mi>M</mi></mrow></math>çŸ©é˜µæ—¶ï¼Œæˆ‘ä»¬ä¼šå¯»æ‰¾ä¸¤ä¸ªçŸ©é˜µ<math alttext="upper U Subscript upper N times d"><msub><mi>U</mi> <mrow><mi>N</mi><mo>Ã—</mo><mi>d</mi></mrow></msub></math>å’Œ<math alttext="upper V Subscript d times upper M"><msub><mi>V</mi> <mrow><mi>d</mi><mo>Ã—</mo><mi>M</mi></mrow></msub></math>ï¼›è¯·æ³¨æ„ï¼Œå½“æ‚¨å°†çŸ©é˜µç›¸ä¹˜æ—¶ï¼Œå®ƒä»¬å¿…é¡»å…±äº«ä¸€ä¸ªç»´åº¦ï¼Œå¹¶ä¸”è¯¥ç»´åº¦è¢«æ¶ˆé™¤ï¼Œç•™ä¸‹å¦å¤–ä¸¤ä¸ªç»´åº¦ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†è€ƒè™‘å½“<math alttext="d less-than-or-equal-to upper N"><mrow><mi>d</mi> <mo>â‰¤</mo> <mi>N</mi></mrow></math>å’Œ<math alttext="d less-than-or-equal-to upper M"><mrow><mi>d</mi> <mo>â‰¤</mo> <mi>M</mi></mrow></math>æ—¶çš„ MFã€‚é€šè¿‡åˆ†è§£çŸ©é˜µï¼Œæˆ‘ä»¬è¦æ±‚ä¸¤ä¸ªçŸ©é˜µï¼Œå®ƒä»¬å¯ä»¥ç­‰äºæˆ–è¿‘ä¼¼äºåŸå§‹çŸ©é˜µï¼š

<math alttext="upper A Subscript i comma j Baseline asymptotically-equals mathematical left-angle upper U Subscript i Baseline comma upper V Subscript j Baseline mathematical right-angle" display="block"><mrow><msub><mi>A</mi> <mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub> <mo>â‰ƒ</mo> <mfenced close="âŒª" open="âŒ©" separators=""><msub><mi>U</mi> <mi>i</mi></msub> <mo>,</mo> <msub><mi>V</mi> <mi>j</mi></msub></mfenced></mrow></math>

æˆ‘ä»¬å¯»æ±‚ä¸€ä¸ªå°çš„å€¼<math alttext="d"><mi>d</mi></math>æ¥å‡å°‘æ½œåœ¨ç»´åº¦çš„æ•°é‡ã€‚æ­£å¦‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°çš„é‚£æ ·ï¼Œæ¯ä¸ªçŸ©é˜µ<math alttext="upper U Subscript upper N times d"><msub><mi>U</mi> <mrow><mi>N</mi><mo>Ã—</mo><mi>d</mi></mrow></msub></math>å’Œ<math alttext="upper V Subscript d times upper M"><msub><mi>V</mi> <mrow><mi>d</mi><mo>Ã—</mo><mi>M</mi></mrow></msub></math>å°†å¯¹åº”äºåŸå§‹è¯„åˆ†çŸ©é˜µçš„è¡Œæˆ–åˆ—ã€‚ç„¶è€Œï¼Œå®ƒä»¬ä»¥æ›´å°‘çš„ç»´åº¦è¡¨ç¤ºã€‚è¿™åˆ©ç”¨äº†*ä½ç»´æ½œåœ¨ç©ºé—´*çš„æ¦‚å¿µã€‚ç›´è§‚åœ°è¯´ï¼Œæ½œåœ¨ç©ºé—´æ—¨åœ¨ä»¥ä¸¤ç»„å…³ç³»è¡¨ç¤ºä¸å®Œæ•´<math alttext="upper N times upper M"><mrow><mi>N</mi> <mo>Ã—</mo> <mi>M</mi></mrow></math>ç»´å…³ç³»ç›¸åŒçš„å…³ç³»ï¼šé¡¹ç›®ä¸æ½œåœ¨ç‰¹å¾ä¹‹é—´çš„å…³ç³»ï¼Œä»¥åŠç”¨æˆ·ä¸æ½œåœ¨ç‰¹å¾ä¹‹é—´çš„å…³ç³»ã€‚

è¿™äº›æ–¹æ³•åœ¨å…¶ä»–ç±»å‹çš„æœºå™¨å­¦ä¹ ä¸­ä¹Ÿå¾ˆå—æ¬¢è¿ï¼Œä½†å¯¹äºæˆ‘ä»¬çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬ä¸»è¦å°†ç ”ç©¶å¯¹è¯„åˆ†æˆ–äº¤äº’çŸ©é˜µè¿›è¡Œå› å­åˆ†è§£çš„é—®é¢˜ã€‚

è€ƒè™‘ MF æ—¶ï¼Œæ‚¨ç»å¸¸å¿…é¡»å…‹æœä¸€äº›æŒ‘æˆ˜ï¼š

+   æ‚¨å¸Œæœ›åˆ†è§£çš„çŸ©é˜µæ˜¯ç¨€ç–çš„ï¼Œå¹¶ä¸”é€šå¸¸æ˜¯éè´Ÿçš„å’Œ/æˆ–äºŒè¿›åˆ¶çš„ã€‚

+   æ¯ä¸ªé¡¹ç›®å‘é‡ä¸­çš„éé›¶å…ƒç´ æ•°é‡å¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨é©¬å¤ªæ•ˆåº”ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚

+   çŸ©é˜µåˆ†è§£çš„å¤æ‚åº¦æ˜¯ç«‹æ–¹çš„ã€‚

+   SVD å’Œå…¶ä»–å…¨ç§©æ–¹æ³•åœ¨æ²¡æœ‰å¡«è¡¥çš„æƒ…å†µä¸‹æ— æ³•å·¥ä½œï¼Œå¡«è¡¥æœ¬èº«ä¹Ÿå¾ˆå¤æ‚ã€‚

æˆ‘ä»¬å°†é€šè¿‡ä¸€äº›æ›¿ä»£ä¼˜åŒ–æ–¹æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚

## ä¼˜åŒ– MF ä¸ ALS

æˆ‘ä»¬å¸Œæœ›æ‰§è¡Œçš„åŸºæœ¬ä¼˜åŒ–å¦‚ä¸‹ï¼š

<math alttext="upper A Subscript i comma j Baseline asymptotically-equals mathematical left-angle upper U Subscript i Baseline comma upper V Subscript j Baseline mathematical right-angle" display="block"><mrow><msub><mi>A</mi> <mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub> <mo>â‰ƒ</mo> <mfenced close="âŒª" open="âŒ©" separators=""><msub><mi>U</mi> <mi>i</mi></msub> <mo>,</mo> <msub><mi>V</mi> <mi>j</mi></msub></mfenced></mrow></math>

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ‚¨å¸Œæœ›ç›´æ¥ä¼˜åŒ–çŸ©é˜µæ¡ç›®ï¼Œåˆ™éœ€è¦åŒæ—¶ä¼˜åŒ–<math alttext="d squared asterisk upper N asterisk upper M"><mrow><msup><mi>d</mi> <mn>2</mn></msup> <mo>*</mo> <mi>N</mi> <mo>*</mo> <mi>M</mi></mrow></math>ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ å¯¹åº”äºè¿™äº›å› å­åŒ–ä¸­çš„å‚æ•°æ•°é‡ã€‚ç„¶è€Œï¼Œé€šè¿‡äº¤æ›¿è°ƒæ•´ä¸€ä¸ªæˆ–å¦ä¸€ä¸ªçŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°æ˜¾è‘—çš„åŠ é€Ÿã€‚è¿™ç§°ä¸º*äº¤æ›¿æœ€å°äºŒä¹˜*ï¼Œé€šå¸¸ç®€ç§°ä¸º*ALS*ï¼Œè¿™æ˜¯è§£å†³æ­¤é—®é¢˜çš„ä¸€ç§å¸¸è§æ–¹æ³•ã€‚ä¸åœ¨æ¯æ¬¡ä¼ é€’ä¸­å‘ä¸¤ä¸ªçŸ©é˜µçš„æ‰€æœ‰é¡¹åå‘ä¼ æ’­æ›´æ–°ä¸åŒï¼Œæ‚¨å¯ä»¥ä»…æ›´æ–°ä¸¤ä¸ªçŸ©é˜µä¸­çš„ä¸€ä¸ªï¼Œä»è€Œå¤§å¤§å‡å°‘éœ€è¦è¿›è¡Œçš„è®¡ç®—æ•°é‡ã€‚

ALS è¯•å›¾åœ¨<math alttext="upper U"><mi>U</mi></math>å’Œ<math alttext="upper V"><mi>V</mi></math>ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œè¯„ä¼°ç›¸åŒçš„æŸå¤±å‡½æ•°ï¼Œä½†æ¯æ¬¡ä»…æ›´æ–°ä¸€ä¸ªçŸ©é˜µçš„æƒé‡ï¼š

<math alttext="StartLayout 1st Row 1st Column Blank 2nd Column upper U left-arrow upper U minus eta asterisk upper U asterisk nabla upper U asterisk script upper D left-parenthesis upper A comma upper U upper V right-parenthesis 2nd Row 1st Column Blank 2nd Column upper V left-arrow upper V minus eta asterisk upper V asterisk nabla upper V asterisk script upper D left-parenthesis upper A comma upper U upper V right-parenthesis EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd columnalign="left"><mrow><mi>U</mi> <mo>â†</mo> <mi>U</mi> <mo>-</mo> <mi>Î·</mi> <mo>*</mo> <mi>U</mi> <mo>*</mo> <mi>âˆ‡</mi> <mi>U</mi> <mo>*</mo> <mi>ğ’Ÿ</mi> <mfenced close=")" open="(" separators=""><mi>A</mi> <mo>,</mo> <mi>U</mi> <mi>V</mi></mfenced></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mi>V</mi> <mo>â†</mo> <mi>V</mi> <mo>-</mo> <mi>Î·</mi> <mo>*</mo> <mi>V</mi> <mo>*</mo> <mi>âˆ‡</mi> <mi>V</mi> <mo>*</mo> <mi>ğ’Ÿ</mi> <mfenced close=")" open="(" separators=""><mi>A</mi> <mo>,</mo> <mi>U</mi> <mi>V</mi></mfenced></mrow></mtd></mtr></mtable></math>

åœ¨è¿™é‡Œï¼Œ<math alttext="eta"><mi>Î·</mi></math>æ˜¯å­¦ä¹ ç‡ï¼Œ<math alttext="script upper D"><mi>ğ’Ÿ</mi></math>æ˜¯æˆ‘ä»¬é€‰æ‹©çš„è·ç¦»å‡½æ•°ã€‚æˆ‘ä»¬ç¨åä¼šè¯¦ç»†ä»‹ç»è¿™ä¸ªè·ç¦»å‡½æ•°ã€‚åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬è€ƒè™‘è¿™é‡Œçš„ä¸€äº›å¤æ‚æ€§ï¼š

+   æ¯ä¸ªæ›´æ–°è§„åˆ™éƒ½éœ€è¦ç›¸å¯¹äºç›¸å…³å› å­çŸ©é˜µçš„æ¢¯åº¦ã€‚

+   æˆ‘ä»¬ä¸€æ¬¡æ›´æ–°ä¸€ä¸ªå®Œæ•´çš„å› å­çŸ©é˜µï¼Œä½†åœ¨å› å­çŸ©é˜µçš„ä¹˜ç§¯ä¸åŸå§‹çŸ©é˜µä¹‹é—´è¯„ä¼°æŸå¤±ã€‚

+   æˆ‘ä»¬æœ‰ä¸€ä¸ªç¥ç§˜çš„è·ç¦»å‡½æ•°ã€‚

+   é€šè¿‡æˆ‘ä»¬æ„å»ºè¿™ç§ä¼˜åŒ–çš„æ–¹å¼ï¼Œæˆ‘ä»¬éšå«åœ°å‡è®¾æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªè¿‡ç¨‹æ¥ä½¿ä¸¤ä¸ªè¿‘ä¼¼çš„çŸ©é˜µæ”¶æ•›ï¼ˆé€šå¸¸è¿˜ä¼šå¯¹è¿­ä»£æ¬¡æ•°æ–½åŠ é™åˆ¶ï¼‰ã€‚

åœ¨ JAX ä¸­ï¼Œè¿™äº›ä¼˜åŒ–å°†å¾ˆå®¹æ˜“å®ç°ï¼Œå¹¶ä¸”æˆ‘ä»¬å°†çœ‹åˆ°ç­‰å¼å½¢å¼å’Œ JAX ä»£ç çœ‹èµ·æ¥æœ‰å¤šä¹ˆç›¸ä¼¼ã€‚

# çŸ©é˜µä¹‹é—´çš„è·ç¦»

æˆ‘ä»¬å¯ä»¥ä»¥å¤šç§æ–¹å¼ç¡®å®šä¸¤ä¸ªçŸ©é˜µä¹‹é—´çš„è·ç¦»ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è§ï¼Œå¯¹äºå‘é‡çš„ä¸åŒè·ç¦»æµ‹é‡ä»åº•å±‚ç©ºé—´æä¾›äº†ä¸åŒçš„è§£é‡Šã€‚å¯¹äºè¿™äº›è®¡ç®—ï¼Œæˆ‘ä»¬ä¸ä¼šæœ‰å¤ªå¤šå¤æ‚æ€§ï¼Œä½†è¿™å€¼å¾—ä¸€å°æ®µè§‚å¯Ÿã€‚æœ€æ˜æ˜¾çš„æ–¹æ³•æ˜¯ä½ å·²ç»çœ‹åˆ°çš„*è§‚å¯Ÿåˆ°çš„å‡æ–¹è¯¯å·®*ï¼š

<math alttext="StartFraction sigma-summation Underscript normal upper Omega Endscripts left-parenthesis upper A Subscript i comma j Baseline minus mathematical left-angle upper U Subscript i Baseline comma upper V Subscript j Baseline mathematical right-angle right-parenthesis squared Over 1 normal upper Omega vertical-bar EndFraction"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mo>âˆ‘</mo> <mi>Î©</mi></msub> <msup><mfenced close=")" open="(" separators=""><msub><mi>A</mi> <mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub> <mo>-</mo><mfenced close="âŒª" open="âŒ©" separators=""><msub><mi>U</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>V</mi> <mi>j</mi></msub></mfenced></mfenced> <mn>2</mn></msup></mrow> <mrow><mn>1</mn><mi>Î©</mi><mo>|</mo></mrow></mfrac></mstyle></math>

å½“ç”¨æˆ·å‘é‡åªæœ‰ä¸€ä¸ªéé›¶æ¡ç›®ï¼ˆæˆ–è€…è¯´æœ€å¤§è¯„åˆ†ï¼‰æ—¶ï¼Œè§‚å¯Ÿåˆ°çš„å‡æ–¹è¯¯å·®çš„ä¸€ä¸ªæœ‰ç”¨æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨äº¤å‰ç†µæŸå¤±ï¼Œè¿™æ ·å¯ä»¥æä¾›ä¸€ä¸ª*é€»è¾‘ MF*ï¼Œä»è€Œå¾—åˆ°æ¦‚ç‡ä¼°è®¡ã€‚æœ‰å…³å¦‚ä½•å®ç°æ­¤æ“ä½œçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Kyle Chung çš„[â€œæ¨èç³»ç»Ÿçš„çŸ©é˜µåˆ†è§£â€æ•™ç¨‹](https://oreil.ly/7qWy6)ã€‚

åœ¨æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„è¯„åˆ†ä¸­ï¼Œæˆ‘ä»¬é¢„æœŸï¼ˆå¹¶çœ‹åˆ°ï¼ï¼‰æœ‰å¤§é‡ç¼ºå¤±å€¼å’Œä¸€äº›å…·æœ‰è¿‡å¤šè¯„åˆ†çš„é¡¹ç›®å‘é‡ã€‚è¿™è¡¨æ˜æˆ‘ä»¬åº”è¯¥è€ƒè™‘éå‡åŒ€åŠ æƒçš„çŸ©é˜µã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•é€šè¿‡æ­£åˆ™åŒ–æ¥è€ƒè™‘è¿™äº›å’Œå…¶ä»–å˜ä½“ã€‚

## MF çš„æ­£åˆ™åŒ–

*åŠ æƒäº¤æ›¿æœ€å°äºŒä¹˜*ï¼ˆWALSï¼‰ä¸ ALS ç±»ä¼¼ï¼Œä½†è¯•å›¾æ›´ä¼˜é›…åœ°è§£å†³è¿™ä¸¤ä¸ªæ•°æ®é—®é¢˜ã€‚åœ¨ WALS ä¸­ï¼Œåˆ†é…ç»™æ¯ä¸ªè§‚å¯Ÿåˆ°çš„è¯„åˆ†çš„æƒé‡ä¸ç”¨æˆ·æˆ–é¡¹ç›®çš„è§‚å¯Ÿåˆ°çš„è¯„åˆ†æ•°æˆåæ¯”ã€‚å› æ­¤ï¼Œå¯¹äºè¯„åˆ†è¾ƒå°‘çš„ç”¨æˆ·æˆ–é¡¹ç›®çš„è§‚å¯Ÿåˆ°çš„è¯„åˆ†åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­è¢«èµ‹äºˆæ›´å¤§çš„æƒé‡ã€‚

æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æƒé‡ä½œä¸ºæˆ‘ä»¬æœ€ç»ˆæŸå¤±å‡½æ•°ä¸­çš„æ­£åˆ™åŒ–å‚æ•°åº”ç”¨ï¼š

<math alttext="StartFraction sigma-summation Underscript normal upper Omega Endscripts left-parenthesis upper A Subscript i comma j Baseline minus less-than upper U Subscript i Baseline comma upper V Subscript j Baseline greater-than right-parenthesis squared Over StartAbsoluteValue normal upper Omega EndAbsoluteValue EndFraction plus StartFraction 1 Over upper N EndFraction sigma-summation StartAbsoluteValue upper U EndAbsoluteValue" display="block"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mo>âˆ‘</mo> <mi>Î©</mi></msub> <msup><mfenced close=")" open="(" separators=""><msub><mi>A</mi> <mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub> <mo>-</mo><mo><</mo><msub><mi>U</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>V</mi> <mi>j</mi></msub> <mo>></mo></mfenced> <mn>2</mn></msup></mrow> <mrow><mo>|</mo><mi>Î©</mi><mo>|</mo></mrow></mfrac></mstyle> <mo>+</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn> <mi>N</mi></mfrac></mstyle> <mo>âˆ‘</mo> <mrow><mo>|</mo> <mi>U</mi> <mo>|</mo></mrow></mrow></math>

å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•å¯¹äº MF ä¹Ÿå¾ˆé‡è¦ï¼Œå¹¶ä¸”å¾ˆå—æ¬¢è¿ã€‚æˆ‘ä»¬å°†è®¨è®ºè¿™ä¸¤ç§å¼ºå¤§çš„æ­£åˆ™åŒ–æŠ€æœ¯ï¼š

+   æƒé‡è¡°å‡

+   Gramian æ­£åˆ™åŒ–

åƒå¾€å¸¸ä¸€æ ·ï¼Œ*æƒé‡è¡°å‡* æ˜¯æˆ‘ä»¬çš„ <math alttext="l squared"><msup><mi>l</mi> <mn>2</mn></msup></math> æ­£åˆ™åŒ–ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯ Frobenius èŒƒæ•°çš„æ°´å¹³ï¼Œå³æƒé‡çŸ©é˜µçš„å¤§å°ã€‚ä¸€ä¸ªä¼˜é›…çš„è§‚ç‚¹æ˜¯ï¼Œè¿™ç§æƒé‡è¡°å‡æ˜¯åœ¨æœ€å°åŒ–*å¥‡å¼‚å€¼*çš„å¤§å°ã€‚

ç±»ä¼¼åœ°ï¼ŒMF è¿˜æœ‰å¦ä¸€ç§çœ‹èµ·æ¥éå¸¸æ ‡å‡†ä½†è®¡ç®—æ–¹å¼å®Œå…¨ä¸åŒçš„æ­£åˆ™åŒ–æŠ€æœ¯ã€‚è¿™æ˜¯é€šè¿‡ Gramiansâ€”â€”æœ¬è´¨ä¸Šæ˜¯æ­£åˆ™åŒ–å•ä¸ªçŸ©é˜µæ¡ç›®çš„å¤§å°ï¼Œä½†åœ¨ä¼˜åŒ–ä¸­æœ‰ä¸€ä¸ªä¼˜é›…çš„æŠ€å·§ã€‚ç‰¹åˆ«åœ°ï¼ŒçŸ©é˜µ <math alttext="upper U"><mi>U</mi></math> çš„ Gramian æ˜¯ä¹˜ç§¯ <math alttext="upper U Superscript upper T Baseline upper U"><mrow><msup><mi>U</mi> <mi>T</mi></msup> <mi>U</mi></mrow></math> ã€‚æ•é”çš„è¯»è€…å¯èƒ½ä¼šè®¤å‡ºè¿™ä¸ªæœ¯è¯­ï¼Œå› ä¸ºå®ƒä¸æˆ‘ä»¬å…ˆå‰ç”¨äºè®¡ç®—äºŒè¿›åˆ¶çŸ©é˜µçš„å…±ç°çš„æœ¯è¯­ç›¸åŒã€‚è”ç³»åœ¨äºä¸¤è€…éƒ½åªæ˜¯è¯•å›¾æ‰¾åˆ°çŸ©é˜µè¡Œå’Œåˆ—ä¹‹é—´ç‚¹ç§¯çš„æœ‰æ•ˆè¡¨ç¤ºæ–¹å¼ã€‚

è¿™äº›æ­£åˆ™åŒ–æ˜¯ Frobenius é¡¹ï¼š

<math alttext="upper R left-parenthesis upper U comma upper V right-parenthesis equals StartFraction 1 Over upper N EndFraction sigma-summation Underscript i Overscript upper N Endscripts StartAbsoluteValue upper U Subscript i Baseline EndAbsoluteValue Subscript 2 Superscript 2 Baseline plus StartFraction 1 Over upper M EndFraction sigma-summation Underscript j Overscript upper M Endscripts StartAbsoluteValue upper V Subscript j Baseline EndAbsoluteValue Subscript 2 Superscript 2" display="block"><mstyle displaystyle="true" scriptlevel="0"><mrow><mi>R</mi> <mrow><mo>(</mo> <mi>U</mi> <mo>,</mo> <mi>V</mi> <mo>)</mo></mrow> <mo>=</mo> <mfrac><mn>1</mn> <mi>N</mi></mfrac> <munderover><mo>âˆ‘</mo> <mi>i</mi> <mi>N</mi></munderover> <mrow><mo>|</mo></mrow> <msub><mi>U</mi> <mi>i</mi></msub> <msubsup><mrow><mo>|</mo></mrow> <mn>2</mn> <mn>2</mn></msubsup> <mo>+</mo> <mfrac><mn>1</mn> <mi>M</mi></mfrac> <munderover><mo>âˆ‘</mo> <mi>j</mi> <mi>M</mi></munderover> <msubsup><mrow><mo>|</mo><msub><mi>V</mi> <mi>j</mi></msub> <mo>|</mo></mrow> <mn>2</mn> <mn>2</mn></msubsup></mrow></mstyle></math>

æˆ–è€…ï¼Œå±•å¼€æ¥è¯´ï¼Œæ–¹ç¨‹çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

<math alttext="upper R left-parenthesis upper U comma upper V right-parenthesis equals StartFraction 1 Over upper N EndFraction sigma-summation Underscript i Overscript upper N Endscripts sigma-summation Underscript k Overscript d Endscripts upper U Subscript i comma k Superscript 2 Baseline plus StartFraction 1 Over upper M EndFraction sigma-summation Underscript j Overscript upper M Endscripts sigma-summation Underscript l Overscript d Endscripts upper V Subscript j comma l Superscript 2" display="block"><mstyle displaystyle="true" scriptlevel="0"><mrow><mi>R</mi> <mrow><mo>(</mo> <mi>U</mi> <mo>,</mo> <mi>V</mi> <mo>)</mo></mrow> <mo>=</mo> <mfrac><mn>1</mn> <mi>N</mi></mfrac> <munderover><mo>âˆ‘</mo> <mi>i</mi> <mi>N</mi></munderover> <munderover><mo>âˆ‘</mo> <mi>k</mi> <mi>d</mi></munderover> <msubsup><mi>U</mi> <mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow> <mn>2</mn></msubsup> <mo>+</mo> <mfrac><mn>1</mn> <mi>M</mi></mfrac> <munderover><mo>âˆ‘</mo> <mi>j</mi> <mi>M</mi></munderover> <munderover><mo>âˆ‘</mo> <mi>l</mi> <mi>d</mi></munderover> <msubsup><mi>V</mi> <mrow><mi>j</mi><mo>,</mo><mi>l</mi></mrow> <mn>2</mn></msubsup></mrow></mstyle></math>

è¿™äº›æ˜¯ Gramian é¡¹ï¼š

<math alttext="StartLayout 1st Row 1st Column upper G left-parenthesis upper U comma upper V right-parenthesis 2nd Column colon equals StartFraction 1 Over upper N dot upper M EndFraction sigma-summation Underscript i Overscript upper N Endscripts sigma-summation Underscript j Overscript upper M Endscripts mathematical left-angle upper U Subscript i Baseline comma upper V Subscript j Baseline mathematical right-angle squared 2nd Row 1st Column Blank 3rd Row 1st Column Blank 2nd Column equals StartFraction 1 Over upper N dot upper M EndFraction asterisk sigma-summation Underscript k comma l Overscript d Endscripts left-parenthesis upper U Superscript upper T Baseline upper U asterisk upper V Superscript upper T Baseline upper V right-parenthesis Subscript k comma l Baseline EndLayout period" display="block"><mrow><mtable><mtr><mtd columnalign="left"><mrow><mi>G</mi> <mo>(</mo> <mi>U</mi> <mo>,</mo> <mi>V</mi> <mo>)</mo></mrow></mtd> <mtd columnalign="left"><mstyle displaystyle="true" scriptlevel="0"><mrow><mo>:</mo> <mo>=</mo> <mfrac><mn>1</mn> <mrow><mi>N</mi><mo>Â·</mo><mi>M</mi></mrow></mfrac> <munderover><mo>âˆ‘</mo> <mi>i</mi> <mi>N</mi></munderover> <munderover><mo>âˆ‘</mo> <mi>j</mi> <mi>M</mi></munderover> <msup><mfenced close="âŒª" open="âŒ©" separators=""><msub><mi>U</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>V</mi> <mi>j</mi></msub></mfenced> <mn>2</mn></msup></mrow></mstyle></mtd></mtr> <mtr><mtd columnalign="left"><mstyle displaystyle="true" scriptlevel="0"><mrow><mo>=</mo> <mfrac><mn>1</mn> <mrow><mi>N</mi><mo>Â·</mo><mi>M</mi></mrow></mfrac> <mo>*</mo> <munderover><mo>âˆ‘</mo> <mrow><mi>k</mi><mo>,</mo><mi>l</mi></mrow> <mi>d</mi></munderover> <msub><mfenced close=")" open="(" separators=""><msup><mi>U</mi> <mi>T</mi></msup> <mi>U</mi><mo>*</mo><msup><mi>V</mi> <mi>T</mi></msup> <mi>V</mi></mfenced> <mrow><mi>k</mi><mo>,</mo><mi>l</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable> <mo>.</mo></mrow></math>

æœ€åï¼Œæˆ‘ä»¬æœ‰æˆ‘ä»¬çš„æŸå¤±å‡½æ•°ï¼š

<math alttext="StartFraction 1 Over StartAbsoluteValue normal upper Omega EndAbsoluteValue EndFraction sigma-summation Underscript left-parenthesis i comma j right-parenthesis element-of normal upper Omega Endscripts left-parenthesis upper A Subscript i j Baseline minus mathematical left-angle upper U Subscript i Baseline comma upper V Subscript j Baseline mathematical right-angle right-parenthesis squared plus lamda Subscript upper R Baseline left-parenthesis StartFraction 1 Over upper N EndFraction sigma-summation Underscript i Overscript upper N Endscripts sigma-summation Underscript k Overscript d Endscripts upper U Subscript i comma k Superscript 2 Baseline plus StartFraction 1 Over upper M EndFraction sigma-summation Underscript j Overscript upper M Endscripts sigma-summation Underscript l Overscript d Endscripts upper V Subscript j comma l Superscript 2 Baseline right-parenthesis plus lamda Subscript upper G Baseline left-parenthesis StartFraction 1 Over upper N dot upper M EndFraction asterisk sigma-summation Underscript k comma l Overscript d Endscripts left-parenthesis upper U Superscript upper T Baseline upper U asterisk upper V Superscript upper T Baseline upper V right-parenthesis Subscript k comma l Baseline right-parenthesis" display="block"><mstyle displaystyle="true" scriptlevel="0"><mrow><mfrac><mn>1</mn> <mrow><mo>|</mo><mi>Î©</mi><mo>|</mo></mrow></mfrac> <munder><mo>âˆ‘</mo> <mrow><mo>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>)</mo><mo>âˆˆ</mo><mi>Î©</mi></mrow></munder> <msup><mrow><mo>(</mo><msub><mi>A</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub> <mo>-</mo><mrow><mo>âŒ©</mo><msub><mi>U</mi> <mi>i</mi></msub> <mo>,</mo><msub><mi>V</mi> <mi>j</mi></msub> <mo>âŒª</mo></mrow><mo>)</mo></mrow> <mn>2</mn></msup> <mo>+</mo> <msub><mi>Î»</mi> <mi>R</mi></msub> <mfenced close=")" open="(" separators=""><mfrac><mn>1</mn> <mi>N</mi></mfrac> <munderover><mo>âˆ‘</mo> <mi>i</mi> <mi>N</mi></munderover> <munderover><mo>âˆ‘</mo> <mi>k</mi> <mi>d</mi></munderover> <msubsup><mi>U</mi> <mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow> <mn>2</mn></msubsup> <mo>+</mo> <mfrac><mn>1</mn> <mi>M</mi></mfrac> <munderover><mo>âˆ‘</mo> <mi>j</mi> <mi>M</mi></munderover> <munderover><mo>âˆ‘</mo> <mi>l</mi> <mi>d</mi></munderover> <msubsup><mi>V</mi> <mrow><mi>j</mi><mo>,</mo><mi>l</mi></mrow> <mn>2</mn></msubsup></mfenced> <mo>+</mo> <msub><mi>Î»</mi> <mi>G</mi></msub> <mfenced close=")" open="(" separators=""><mfrac><mn>1</mn> <mrow><mi>N</mi><mo>Â·</mo><mi>M</mi></mrow></mfrac> <mo>*</mo> <munderover><mo>âˆ‘</mo> <mrow><mi>k</mi><mo>,</mo><mi>l</mi></mrow> <mi>d</mi></munderover> <msub><mfenced close=")" open="(" separators=""><msup><mi>U</mi> <mi>T</mi></msup> <mi>U</mi><mo>*</mo><msup><mi>V</mi> <mi>T</mi></msup> <mi>V</mi></mfenced> <mrow><mi>k</mi><mo>,</mo><mi>l</mi></mrow></msub></mfenced></mrow></mstyle></math>

## æ­£åˆ™åŒ–çš„ MF å®ç°

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å†™äº†*å¾ˆå¤š*æ•°å­¦ç¬¦å·ï¼Œä½†æ‰€æœ‰è¿™äº›ç¬¦å·éƒ½ä½¿æˆ‘ä»¬èƒ½å¤Ÿå¾—å‡ºä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡å‹ã€‚*æ­£åˆ™åŒ–çŸ©é˜µå› å­åˆ†è§£*æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä¸­ç­‰è§„æ¨¡æ¨èé—®é¢˜æ¨¡å‹ã€‚è¿™ç§æ¨¡å‹ç±»å‹åœ¨è®¸å¤šä¸¥è‚ƒçš„ä¼ä¸šä¸­ä»ç„¶åœ¨ä½¿ç”¨ã€‚MF å®ç°çš„ä¸€ä¸ªç»å…¸é—®é¢˜æ˜¯æ€§èƒ½ï¼Œä½†å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ JAXï¼Œåœ¨è¿™é‡Œæœ‰æå¥½çš„æœ¬åœ° GPU æ”¯æŒï¼Œæˆ‘ä»¬çš„å®ç°å®é™…ä¸Šå¯ä»¥æ¯”åƒ[PyTorch ç¤ºä¾‹](https://oreil.ly/U-K-V)ä¸­æ‰¾åˆ°çš„æ›´ç´§å‡‘ã€‚

è®©æˆ‘ä»¬é€šè¿‡ Gramians çš„åŒé‡æ­£åˆ™åŒ–æ¨¡å‹æ¥é¢„æµ‹ç”¨æˆ·-é¡¹ç›®çŸ©é˜µä¸­çš„è¯„åˆ†ä¼šæ˜¯æ€æ ·çš„æ¨¡å‹ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†è¿›è¡Œç®€å•çš„è®¾ç½®ã€‚è¿™å°†å‡è®¾æ‚¨çš„è¯„åˆ†çŸ©é˜µå·²ç»åœ¨ wandb ä¸Šäº†ï¼š

```py
import jax
import jax.numpy as jnp
import numpy as np
import pandas as pd
import os, json, wandb, math

from jax import grad, jit
from jax import random
from jax.experimental import sparse

key = random.PRNGKey(0)

wandb.login()
run = wandb.init(
    # Set entity to specify your username or team name
    entity="wandb-un",
    # Set the project where this run will be logged
    project="jax-mf",
    # associate the runs to the right dataset
    config={
      "dataset": "MF-Dataset",
    }
)

# note that we assume the dataset is a ratings table stored in wandb
artifact = run.use_artifact('stored-dataset:latest')
ratings_artifact = artifact.download()
ratings_artifact_blob = json.load(
    open(
        os.path.join(
            ratings_artifact,
            'ratings.table.json'
        )
    )
)

ratings_artifact_blob.keys()
# ['_type', 'column_types', 'columns', 'data', 'ncols', 'nrows']

ratings = pd.DataFrame( # user_id, item_id, rating, unix_timestamp
    data=ratings_artifact_blob['data'],
    columns=ratings_artifact_blob['columns']
)

def start_pipeline(df):
    return df.copy()

def column_as_type(df, column: str, cast_type):
    df[column] = df[column].astype(cast_type)
    return df

def rename_column_value(df, target_column, prior_val, post_val):
    df[target_column] = df[target_column].replace({prior_val: post_val})
    return df

def split_dataframe(df, holdout_fraction=0.1):
    """Splits a DataFrame into training and test sets.
 Args:
 df: a dataframe.
 holdout_fraction: fraction of dataframe rows to use in the test set.
 Returns:
 train: dataframe for training
 test: dataframe for testing
 """
    test = df.sample(frac=holdout_fraction, replace=False)
    train = df[~df.index.isin(test.index)]
    return train, test

all_rat = (ratings
    .pipe(start_pipeline)
    .pipe(column_as_type, column='user_id', cast_type=int)
    .pipe(column_as_type, column='item_id', cast_type=int)
)

def ratings_to_sparse_array(ratings_df, user_dim, item_dim):
    indices = (np.array(ratings_df['user_id']), np.array(ratings_df['item_id']))
    values = jnp.array(ratings_df['rating'])

    return {
        'indices': indices,
        'values': values,
        'shape': [user_dim, item_dim]
    }

def random_normal(pr_key, shape, mu=0, sigma=1, ):
    return (mu + sigma * random.normal(pr_key, shape=shape))

x = random_normal(
    pr_key = random.PRNGKey(1701),
    shape=(10000,),
    mu = 1.0,
    sigma = 3.0,
) # these hyperparameters are pretty meaningless

def sp_mse_loss(A, params):
    U, V = params['users'], params['items']
    rows, columns = A['indices']
    estimator = -(U @ V.T)[(rows, columns)]
    square_err = jax.tree_map(
        lambda x: x**2,
        A['values']+estimator
    )
    return jnp.mean(square_err)

omse_loss = jit(sp_mse_loss)
```

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨è¿™é‡Œå®ç°æˆ‘ä»¬è‡ªå·±çš„æŸå¤±å‡½æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰æŸå¤±ï¼Œä½†å®ƒåˆ©ç”¨äº†æˆ‘ä»¬çŸ©é˜µçš„ç¨€ç–æ€§è´¨ã€‚ä½ å¯èƒ½ä¼šåœ¨ä»£ç ä¸­æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬å·²ç»å°†çŸ©é˜µè½¬æ¢ä¸ºç¨€ç–è¡¨ç¤ºï¼Œå› æ­¤æˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸ä»…å¯ä»¥åˆ©ç”¨è¯¥è¡¨ç¤ºï¼Œè¿˜å¯ä»¥ç¼–å†™ä¸ºåˆ©ç”¨ JAX è®¾å¤‡æ•°ç»„å’Œæ˜ å°„/ç¼–è¯‘çš„å½¢å¼ã€‚

# è¿™ä¸ªæŸå¤±å‡½æ•°çœŸçš„æ­£ç¡®å—ï¼Ÿ

å¦‚æœä½ å¯¹è¿™ç§åƒé­”æœ¯èˆ¬å‡ºç°çš„æŸå¤±å‡½æ•°æ„Ÿåˆ°å¥½å¥‡ï¼Œæˆ‘ä»¬ç†è§£ã€‚åœ¨å†™è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹åˆ©ç”¨ JAX çš„è¿™ç§æŸå¤±å‡½æ•°çš„æœ€ä½³å®ç°éå¸¸ä¸ç¡®å®šã€‚å®é™…ä¸Šï¼Œæœ‰å¾ˆå¤šåˆç†çš„æ–¹æ³•å¯ä»¥è¿›è¡Œè¿™ç§ä¼˜åŒ–ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªå…¬å…±å®éªŒæ¥å¯¹å‡ ç§æ–¹æ³•è¿›è¡ŒåŸºå‡†æµ‹è¯•[åœ¨ Colab ä¸Š](https://oreil.ly/6zwEX)ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºæ¨¡å‹å¯¹è±¡æ¥å¤„ç†æˆ‘ä»¬è®­ç»ƒæ—¶çš„ MF çŠ¶æ€ã€‚å°½ç®¡è¿™æ®µä»£ç åŸºæœ¬ä¸Šå¤§å¤šæ˜¯æ¨¡æ¿ä»£ç ï¼Œä½†å®ƒä¼šä»¥ç›¸å¯¹å†…å­˜é«˜æ•ˆçš„æ–¹å¼ä¸ºæˆ‘ä»¬è®¾ç½®å¥½ï¼Œä»¥ä¾¿å°†æ¨¡å‹é¦ˆé€åˆ°è®­ç»ƒå¾ªç¯ä¸­ã€‚è¿™ä¸ªæ¨¡å‹æ˜¯åœ¨ä¸€å° MacBook Pro ä¸Šï¼Œåœ¨ä¸åˆ°ä¸€å¤©çš„æ—¶é—´é‡Œï¼Œå¯¹ 100 ä¸‡æ¡è®°å½•è¿›è¡Œäº†å‡ åƒæ¬¡è¿­ä»£çš„è®­ç»ƒï¼š

```py
class CFModel(object):
    """Simple class that represents a collaborative filtering model"""
    def __init__(
          self,
          metrics: dict,
          embeddings: dict,
          ground_truth: dict,
          embeddings_parameters: dict,
          prng_key=None
    ):
        """Initializes a CFModel.
 Args:
 """
        self._metrics = metrics
        self._embeddings = embeddings
        self._ground_truth = ground_truth
        self._embeddings_parameters = embeddings_parameters

        if prng_key is None:
            prng_key = random.PRNGKey(0)
        self._prng_key = prng_key

    @property
    def embeddings(self):
        """The embeddings dictionary."""
        return self._embeddings

    @embeddings.setter
    def embeddings(self, value):
        self._embeddings = value

    @property
    def metrics(self):
        """The metrics dictionary."""
        return self._metrics

    @property
    def ground_truth(self):
        """The train/test dictionary."""
        return self._ground_truth

    def reset_embeddings(self):
        """Clear out embeddings state."""

        prng_key1, prng_key2 = random.split(self._prng_key, 2)

        self._embeddings['users'] = random_normal(
            prng_key1,
            [
              self._embeddings_parameters['user_dim'],
              self._embeddings_parameters['embedding_dim']
            ],
            mu=0,
            sigma=self._embeddings_parameters['init_stddev'],
        )
        self._embeddings['items'] = random_normal(
            prng_key2,
            [
              self._embeddings_parameters['item_dim'],
              self._embeddings_parameters['embedding_dim']],
            mu=0,
            sigma=self._embeddings_parameters['init_stddev'],
        )

def model_constructor(
    ratings_df,
    user_dim,
    item_dim,
    embedding_dim=3,
    init_stddev=1.,
    holdout_fraction=0.2,
    prng_key=None,
    train_set=None,
    test_set=None,
):
    if prng_key is None:
      prng_key = random.PRNGKey(0)

    prng_key1, prng_key2 = random.split(prng_key, 2)

    if (train_set is None) and (test_set is None):
        train, test = (ratings_df
            .pipe(start_pipeline)
            .pipe(split_dataframe, holdout_fraction=holdout_fraction)
        )

        A_train = (train
            .pipe(start_pipeline)
            .pipe(ratings_to_sparse_array, user_dim=user_dim, item_dim=item_dim)
        )
        A_test = (test
            .pipe(start_pipeline)
            .pipe(ratings_to_sparse_array, user_dim=user_dim, item_dim=item_dim)
        )
    elif (train_set is None) ^ (test_set is None):
        raise('Must send train and test if sending one')
    else:
        A_train, A_test = train_set, test_set

    U = random_normal(
        prng_key1,
        [user_dim, embedding_dim],
        mu=0,
        sigma=init_stddev,
    )
    V = random_normal(
        prng_key2,
        [item_dim, embedding_dim],
        mu=0,
        sigma=init_stddev,
    )

    train_loss = omse_loss(A_train, {'users': U, 'items': V})
    test_loss = omse_loss(A_test, {'users': U, 'items': V})

    metrics = {
        'train_error': train_loss,
        'test_error': test_loss
    }
    embeddings = {'users': U, 'items': V}
    ground_truth = {
        "A_train": A_train,
        "A_test": A_test
    }
    return CFModel(
        metrics=metrics,
        embeddings=embeddings,
        ground_truth=ground_truth,
        embeddings_parameters={
            'user_dim': user_dim,
            'item_dim': item_dim,
            'embedding_dim': embedding_dim,
            'init_stddev': init_stddev,
        },
        prng_key=prng_key,
    )

mf_model = model_constructor(all_rat, user_count, item_count)
```

æˆ‘ä»¬è¿˜åº”è¯¥è®¾ç½®å¥½ï¼Œä»¥ä¾¿åœ¨ wandb ä¸Šè¿›è¡Œè‰¯å¥½çš„è®°å½•ï¼Œè¿™æ ·åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å°±å¾ˆå®¹æ˜“ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼š

```py
def train():
  run_config = { # These will be hyperparameters we will tune via wandb
      'emb_dim': 10, # Latent dimension
      'prior_std': 0.1, # Std dev around 0 for weights initialization
      'alpha': 1.0, # Learning rate
      'steps': 1500, # Number of training steps
  }

  with wandb.init() as run:
    run_config.update(run.config)
    model_object = model_constructor(
        ratings_df=all_rat,
        user_dim=user_count,
        item_dim=item_count,
        embedding_dim=run_config['emb_dim'],
        init_stddev=run_config['prior_std'],
        prng_key=random.PRNGKey(0),
        train_set=mf_model.ground_truth['A_train'],
        test_set=mf_model.ground_truth['A_test']
    )
    model_object.reset_embeddings() # Ensure we are starting from priors
    alpha, steps = run_config['alpha'], run_config['steps']
    print(run_config)
    grad_fn = jax.value_and_grad(omse_loss, 1)
    for i in range(steps):
      # We perform one gradient update
      loss_val, grads = grad_fn(
          model_object.ground_truth['A_train'],
          model_object.embeddings
      )
      model_object.embeddings = jax.tree_multimap(
          lambda p, g: p - alpha * g,
          # Basic update rule; JAX handles broadcasting for us
          model_object.embeddings,
          grads
      )
      if i % 1000 == 0: # Most output in wandb; little bit of logging
        print(f'Loss step {i}: ', loss_val)
        print(f"""Test loss: {
            omse_loss(
                model_object.ground_truth['A_train'],
                model_object.embeddings
            )}""")

      wandb.log({
          "Train omse": loss_val,
          "Test omse": omse_loss(
              model_object.ground_truth['A_test'],
              model_object.embeddings
           )
      })
```

è¯·æ³¨æ„ï¼Œæ­¤ä»£ç æ­£åœ¨ä½¿ç”¨`tree_multimap`æ¥å¤„ç†å¹¿æ’­æˆ‘ä»¬çš„æ›´æ–°è§„åˆ™ï¼Œå¹¶ä¸”æˆ‘ä»¬æ­£åœ¨è°ƒç”¨ä»¥å‰çš„`omse_loss`è°ƒç”¨ä¸­çš„è¢« jit çš„æŸå¤±ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ­£åœ¨è°ƒç”¨`value_and_grad`ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨è¿›è¡Œæ—¶å°†æŸå¤±è®°å½•åˆ° wandb ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„æŠ€å·§ï¼Œä½ ä¼šçœ‹åˆ°è¿™æ ·çš„æŠ€å·§æ—¢å¯ä»¥é«˜æ•ˆåœ°åšåˆ°è¿™ä¸¤ç‚¹ï¼Œåˆå¯ä»¥ä¸ä½¿ç”¨å›è°ƒã€‚

æ‚¨å¯ä»¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œå¹¶å¼€å§‹è¿›è¡Œæ‰«æï¼š

```py
sweep_config = {
    "name" : "mf-test-sweep",
    "method" : "random",
    "parameters" : {
        "steps" : {
            "min": 1000,
            "max": 3000,
        },
        "alpha" :{
            "min": 0.6,
            "max": 1.75
        },
        "emb_dim" :{
            "min": 3,
            "max": 10
        },
        "prior_std" :{
            "min": .5,
            "max": 2.0
        },
    },
    "metric" : {
        'name': 'Test omse',
        'goal': 'minimize'
    }
}

sweep_id = wandb.sweep(sweep_config, project="jax-mf", entity="wandb-un")

wandb.init()
train()

count = 50
wandb.agent(sweep_id, function=train, count=count)
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¶…å‚æ•°ä¼˜åŒ–ï¼ˆHPOï¼‰æ˜¯å…³äºæˆ‘ä»¬çš„è¶…å‚æ•°ï¼Œå¦‚åµŒå…¥ç»´åº¦å’Œå…ˆéªŒï¼ˆéšæœºçŸ©é˜µï¼‰çš„ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åœ¨æˆ‘ä»¬çš„è¯„åˆ†çŸ©é˜µä¸Šè®­ç»ƒäº†ä¸€äº› MF æ¨¡å‹ã€‚ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ æ­£åˆ™åŒ–å’Œäº¤å‰éªŒè¯ã€‚

è®©æˆ‘ä»¬ç›´æ¥å°†å‰è¿°æ•°å­¦æ–¹ç¨‹ç¿»è¯‘æˆä»£ç ï¼š

```py
def ell_two_regularization_term(params, dimensions):
    U, V = params['users'], params['items']
    N, M = dimensions['users'], dimensions['items']
    user_sq = jnp.multiply(U, U)
    item_sq = jnp.multiply(V, V)
    return (jnp.sum(user_sq)/N + jnp.sum(item_sq)/M)

l2_loss = jit(ell_two_regularization_term)

def gramian_regularization_term(params, dimensions):
    U, V = params['users'], params['items']
    N, M = dimensions['users'], dimensions['items']
    gr_user = U.T @ U
    gr_item = V.T @ V
    gr_square = jnp.multiply(gr_user, gr_item)
    return (jnp.sum(gr_square)/(N*M))

gr_loss = jit(gramian_regularization_term)

def regularized_omse(A, params, dimensions, hyperparams):
  lr, lg = hyperparams['ell_2'], hyperparams['gram']
  losses = {
      'omse': sp_mse_loss(A, params),
      'l2_loss': l2_loss(params, dimensions),
      'gr_loss': gr_loss(params, dimensions),
  }
  losses.update({
      'total_loss': losses['omse'] + lr*losses['l2_loss'] + lg*losses['gr_loss']
  })
  return losses['total_loss'], losses

reg_loss_observed = jit(regularized_omse)
```

æˆ‘ä»¬ä¸ä¼šæ·±å…¥ç ”ç©¶å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼Œä½†æˆ‘ä»¬ä¼šåšä¸€ä¸ªç®€å•çš„è¡°å‡ï¼š

```py
def lr_decay(
    step_num,
    base_learning_rate,
    decay_pct = 0.5,
    period_length = 100.0
):
    return base_learning_rate * math.pow(
        decay_pct,
        math.floor((1+step_num)/period_length)
    )
```

æˆ‘ä»¬æ›´æ–°çš„è®­ç»ƒå‡½æ•°å°†æ•´åˆæˆ‘ä»¬çš„æ–°æ­£åˆ™åŒ– - è¿™äº›æ­£åˆ™åŒ–å¸¦æœ‰ä¸€äº›è¶…å‚æ•° - ä»¥åŠä¸€äº›é¢å¤–çš„æ—¥å¿—è®¾ç½®ã€‚è¿™æ®µä»£ç ä½¿å¾—åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è®°å½•æˆ‘ä»¬çš„å®éªŒå¹¶é…ç½®è¶…å‚æ•°ä»¥ä¸æ­£åˆ™åŒ–ä¸€èµ·å·¥ä½œå˜å¾—å®¹æ˜“ï¼š

```py
def train_with_reg_loss():
    run_config = { # These will be hyperparameters we will tune via wandb
        'emb_dim': None,
        'prior_std': None,
        'alpha': None, # Learning rate
        'steps': None,
        'ell_2': 1, #l2 regularization penalization weight
        'gram': 1, #gramian regularization penalization weight
        'decay_pct': 0.5,
        'period_length': 100.0
    }

    with wandb.init() as run:
        run_config.update(run.config)
        model_object = model_constructor(
            ratings_df=all_rat,
            user_dim=942,
            item_dim=1681,
            embedding_dim=run_config['emb_dim'],
            init_stddev=run_config['prior_std'],
            prng_key=random.PRNGKey(0),
            train_set=mf_model.ground_truth['A_train'],
            test_set=mf_model.ground_truth['A_test']
        )
        model_object.reset_embeddings() # Ensure we start from priors

        alpha, steps = run_config['alpha'], run_config['steps']
        print(run_config)

        grad_fn = jax.value_and_grad(
            reg_loss_observed,
            1,
            has_aux=True
        ) # Tell JAX to expect an aux dict as output

        for i in range(steps):
            (total_loss_val, loss_dict), grads = grad_fn(
                model_object.ground_truth['A_train'],
                model_object.embeddings,
                dimensions={'users': user_count, 'items': item_count},
                hyperparams={
                    'ell_2': run_config['ell_2'],
                    'gram': run_config['gram']
                } # JAX carries our loss dict along for logging
            )

            model_object.embeddings = jax.tree_multimap(
                lambda p, g: p - lr_decay(
                    i,
                    alpha,
                    run_config['decay_pct'],
                    run_config['period_length']
                ) * g, # update with decay
                model_object.embeddings,
                grads
            )
            if i % 1000 == 0:
                print(f'Loss step {i}:')
                print(loss_dict)
                print(f"""Test loss: {
                    omse_loss(model_object.ground_truth['A_test'],
                    model_object.embeddings)}""")

            loss_dict.update( # wandb takes the entire loss dictionary
                {
                    "Test omse": omse_loss(
                        model_object.ground_truth['A_test'],
                        model_object.embeddings
                    ),
                    "learning_rate": lr_decay(i, alpha),
                }
            )
            wandb.log(loss_dict)

 sweep_config = {
    "name" : "mf-HPO-with-reg",
    "method" : "random",
    "parameters" : {
      "steps": {
        "value": 2000
      },
      "alpha" :{
        "min": 0.6,
        "max": 2.25
      },
      "emb_dim" :{
        "min": 15,
        "max": 80
      },
      "prior_std" :{
        "min": .5,
        "max": 2.0
      },
      "ell_2" :{
        "min": .05,
        "max": 0.5
      },
      "gram" :{
        "min": .1,
        "max": .75
      },
      "decay_pct" :{
        "min": .2,
        "max": .8
      },
      "period_length" :{
        "min": 50,
        "max": 500
      }
    },
    "metric" : {
      'name': 'Test omse',
      'goal': 'minimize'
    }
  }

  sweep_id = wandb.sweep(
      sweep_config,
      project="jax-mf",
      entity="wandb-un"
  )

run_config = { # These will be hyperparameters we will tune via wandb
      'emb_dim': 10, # Latent dimension
      'prior_std': 0.1,
      'alpha': 1.0, # Learning rate
      'steps': 1000, # Number of training steps
      'ell_2': 1, #l2 regularization penalization weight
      'gram': 1, #gramian regularization penalization weight
      'decay_pct': 0.5,
      'period_length': 100.0
  }

train_with_reg_loss()
```

æœ€åä¸€æ­¥æ˜¯ä»¥ä¸€ç§è®©æˆ‘ä»¬å¯¹æ‰€è§åˆ°çš„æ¨¡å‹æ„Ÿåˆ°è‡ªä¿¡çš„æ–¹å¼æ¥è¿›è¡Œã€‚ä¸å¹¸çš„æ˜¯ï¼Œä¸º MF é—®é¢˜è®¾ç½®äº¤å‰éªŒè¯å¯èƒ½ä¼šå¾ˆæ£˜æ‰‹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æˆ‘ä»¬çš„æ•°æ®ç»“æ„è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼š

```py
def sparse_array_concatenate(sparse_array_iterable):
    return {
        'indices': tuple(
            map(
                jnp.concatenate,
                zip(*(x['indices'] for x in sparse_array_iterable)))
            ),
        'values': jnp.concatenate(
            [x['values'] for x in sparse_array_iterable]
        ),
    }

class jax_df_Kfold(object):
    """Simple class that handles Kfold
 splitting of a matrix as a dataframe and stores as sparse jarrays"""
    def __init__(
        self,
        df: pd.DataFrame,
        user_dim: int,
        item_dim: int,
        k: int = 5,
        prng_key=random.PRNGKey(0)
    ):
        self._df = df
        self._num_folds = k
        self._split_idxes = jnp.array_split(
            random.permutation(
                prng_key,
                df.index.to_numpy(),
                axis=0,
                independent=True
            ),
            self._num_folds
        )

        self._fold_arrays = dict()

        for fold_index in range(self._num_folds):
        # let's create sparse jax arrays for each fold piece
            self._fold_arrays[fold_index] = (
                self._df[
                    self._df.index.isin(self._split_idxes[fold_index])
                ].pipe(start_pipeline)
                .pipe(
                    ratings_to_sparse_array,
                    user_dim=user_dim,
                    item_dim=item_dim
                )
            )

    def get_fold(self, fold_index: int):
        assert(self._num_folds > fold_index)
        test = self._fold_arrays[fold_index]
        train = sparse_array_concatenate(
            [v for k,v in self._fold_arrays.items() if k != fold_index]
        )
        return train, test
```

æ¯ä¸ªè¶…å‚æ•°è®¾ç½®åº”è¯¥ä¸ºæ¯ä¸ª fold äº§ç”ŸæŸå¤±ï¼Œå› æ­¤åœ¨*wandb.init*ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ª fold æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼š

```py
for j in num_folds:
  train, test = folder.get_fold(j)
  model_object_dict[j] = model_constructor(
          ratings_df=all_rat,
          user_dim=user_count,
          item_dim=item_count,
          embedding_dim=run_config['emb_dim'],
          init_stddev=run_config['prior_std'],
          prng_key=random.PRNGKey(0),
          train_set=train,
          test_set=test
      )
```

åœ¨æ¯ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¸ä»…æƒ³è®¡ç®—è®­ç»ƒçš„æ¢¯åº¦å¹¶åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°ï¼Œè¿˜æƒ³ä¸ºæ‰€æœ‰æŠ˜å è®¡ç®—æ¢¯åº¦ï¼Œè¯„ä¼°æ‰€æœ‰æµ‹è¯•ï¼Œå¹¶ç”Ÿæˆç›¸å…³çš„é”™è¯¯ï¼š

```py
for i in range(steps):
    loss_dict = {"learning_rate": step_decay(i)}
    for j, M in model_object_dict.items():
        (total_loss_val, fold_loss_dict), grads = grad_fn(
          M.ground_truth['A_train'],
          M.embeddings,
          dimensions={'users': 942, 'items': 1681},
          hyperparams={'ell_2': run_config['ell_2'], 'gram': run_config['gram']}
        )

        M.embeddings = jax.tree_multimap(
            lambda p, g: p - step_decay(i) * g,
            M.embeddings,
            grads
        )
```

æ—¥å¿—åº”ä¸ºæ¯ä¸ªæŠ˜å çš„æŸå¤±ï¼Œå¹¶ä¸”èšåˆæŸå¤±åº”ä¸ºç›®æ ‡æŒ‡æ ‡ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ªæŠ˜å éƒ½æ˜¯æ¨¡å‹å‚æ•°çš„ç‹¬ç«‹ä¼˜åŒ–ï¼›ä½†æ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°è·¨æŠ˜å çš„èšåˆè¡Œä¸ºï¼š

```py
        fold_loss_dict = {f'{k}_fold-{j}': v for k, v in fold_loss_dict.items()}
        fold_loss_dict.update(
                  {
                      f"Test omse_fold-{j}": omse_loss(
                        M.ground_truth['A_test'],
                        M.embeddings
                      ),
                  }
              )

        loss_dict.update(fold_loss_dict)

    loss_dict.update({
      "Test omse_mean": jnp.mean(
        [v for k,v in loss_dict.items() if k.startswith('Test omse_fold-')]
      )
    })
    wandb.log(loss_dict)
```

æˆ‘ä»¬å°†æ‰€æœ‰å†…å®¹æ•´åˆæˆä¸€ä¸ªå¤§çš„è®­ç»ƒæ–¹æ³•ï¼š

```py
def train_with_reg_loss_CV():
    run_config = { # These will be hyperparameters we will tune via wandb
        'emb_dim': None, # Latent dimension
        'prior_std': None,
        # Standard deviation around 0 that our weights are initialized to
        'alpha': None, # Learning rate
        'steps': None, # Number of training steps
        'num_folds': None, # Number of CV Folds
        'ell_2': 1, #hyperparameter for l2 regularization penalization weight
        'gram': 1, #hyperparameter for gramian regularization penalization weight
    }

    with wandb.init() as run:
        run_config.update(run.config) # This is how the wandb agent passes params
        model_object_dict = dict()

        for j in range(run_config['num_folds']):
            train, test = folder.get_fold(j)
            model_object_dict[j] = model_constructor(
                ratings_df=all_rat,
                user_dim=942,
                item_dim=1681,
                embedding_dim=run_config['emb_dim'],
                init_stddev=run_config['prior_std'],
                prng_key=random.PRNGKey(0),
                train_set=train,
                test_set=test
            )
            model_object_dict[j].reset_embeddings()
            # Ensure we are starting from priors

        alpha, steps = run_config['alpha'], run_config['steps']
        print(run_config)

        grad_fn = jax.value_and_grad(reg_loss_observed, 1, has_aux=True)
        # Tell JAX to expect an aux dict as output

        for i in range(steps):
            loss_dict = {
              "learning_rate": lr_decay(
                i,
                alpha,
                decay_pct=.75,
                period_length=250
              )
            }
            for j, M in model_object_dict.items():
            # Iterate through folds

                (total_loss_val, fold_loss_dict), grads = grad_fn(
                # compute gradients for one fold
                    M.ground_truth['A_train'],
                    M.embeddings,
                    dimensions={'users': 942, 'items': 1681},
                    hyperparams={
                      'ell_2': run_config['ell_2'],
                      'gram': run_config['gram']
                    }
                )

                M.embeddings = jax.tree_multimap(
                # update weights for one fold
                    lambda p, g: p - lr_decay(
                      i,
                      alpha,
                      decay_pct=.75,
                      period_length=250
                    ) * g,
                    M.embeddings,
                    grads
                )

                fold_loss_dict = {
                  f'{k}_fold-{j}':
                  v for k, v in fold_loss_dict.items()
                }
                fold_loss_dict.update( # loss calculation within fold
                    {
                        f"Test omse_fold-{j}": omse_loss(
                          M.ground_truth['A_test'],
                          M.embeddings
                        ),
                    }
                )

                loss_dict.update(fold_loss_dict)

            loss_dict.update({ # average loss over all folds
                "Test omse_mean": np.mean(
                    [v for k,v in loss_dict.items()
                    if k.startswith('Test omse_fold-')]
                ),
                "test omse_max": np.max(
                    [v for k,v in loss_dict.items()
                    if k.startswith('Test omse_fold-')]
                ),
                "test omse_min": np.min(
                    [v for k,v in loss_dict.items()
                    if k.startswith('Test omse_fold-')]
                )
            })
            wandb.log(loss_dict)

            if i % 1000 == 0:
                print(f'Loss step {i}:')
                print(loss_dict)
```

è¿™æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆæ‰«æé…ç½®ï¼š

```py
sweep_config = {
    "name" : "mf-HPO-CV",
    "method" : "random",
    "parameters" : {
      "steps": {
        "value": 2000
      },
      "num_folds": {
        "value": 5
      },
      "alpha" :{
        "min": 2.0,
        "max": 3.0
      },
      "emb_dim" :{
        "min": 15,
        "max": 70
      },
      "prior_std" :{
        "min": .75,
        "max": 1.0
      },
      "ell_2" :{
        "min": .05,
        "max": 0.5
      },
      "gram" :{
        "min": .1,
        "max": .6
      },
    },
    "metric" : {
      'name': 'Test omse_mean',
      'goal': 'minimize'
    }
  }

  sweep_id = wandb.sweep(sweep_config, project="jax-mf", entity="wandb-un")

wandb.agent(sweep_id, function=train_with_reg_loss_CV, count=count)
```

è¿™ä¼¼ä¹æ˜¯å¾ˆå¤šè®¾ç½®å·¥ä½œï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œç¡®å®å–å¾—äº†å¾ˆå¤šæˆå°±ã€‚æˆ‘ä»¬å·²ç»åˆå§‹åŒ–äº†æ¨¡å‹ä»¥ä¼˜åŒ–ä¸¤ä¸ªçŸ©é˜µå› å­ï¼ŒåŒæ—¶ä¿æŒçŸ©é˜µå…ƒç´ å’Œ Gramians è¾ƒå°ã€‚

è¿™å¸¦æˆ‘ä»¬æ¥åˆ°æˆ‘ä»¬å¯çˆ±çš„å›¾ç‰‡ã€‚

### HPO MF çš„è¾“å‡º

è®©æˆ‘ä»¬å¿«é€Ÿçœ‹çœ‹å…ˆå‰çš„å·¥ä½œäº§ç”Ÿäº†ä»€ä¹ˆã€‚é¦–å…ˆï¼Œå›¾Â 10-3 æ˜¾ç¤ºæˆ‘ä»¬çš„ä¸»è¦æŸå¤±å‡½æ•°ï¼Œè§‚å¯Ÿåˆ°çš„å‡æ–¹è¯¯å·®ï¼ˆOMSEï¼‰ï¼Œæ­£åœ¨è¿…é€Ÿå‡å°‘ã€‚è¿™å¾ˆå¥½ï¼Œä½†æˆ‘ä»¬åº”è¯¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚

![è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±](img/brpj_1003.png)

###### å›¾ 10-3\. è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±

è®©æˆ‘ä»¬å¿«é€ŸæŸ¥çœ‹ä»¥ç¡®ä¿æˆ‘ä»¬çš„æ­£åˆ™åŒ–å‚æ•°ï¼ˆå›¾Â 10-4ï¼‰æ­£åœ¨æ”¶æ•›ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬ç»§ç»­æ›´å¤šçš„ epochsï¼Œæˆ‘ä»¬çš„ L2 æ­£åˆ™åŒ–å¯èƒ½ä»ç„¶å¯ä»¥è¿›ä¸€æ­¥å‡å°‘ã€‚

![æ­£åˆ™åŒ–å‚æ•°](img/brpj_1004.png)

###### å›¾ 10-4\. æ­£åˆ™åŒ–å‚æ•°

æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æˆ‘ä»¬çš„äº¤å‰éªŒè¯æŒ‰æŠ˜å å±•å¼€ï¼Œå¹¶ä¼´éšç€ç›¸åº”çš„æŸå¤±ï¼ˆå›¾Â 10-5ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ª*å¹³è¡Œåæ ‡å›¾*ï¼›å…¶çº¿æ¡å¯¹åº”ä¸åŒè¿è¡Œï¼Œå¯¹åº”äºä¸åŒå‚æ•°é€‰æ‹©ï¼Œå¹¶ä¸”å…¶å‚ç›´è½´æ˜¯ä¸åŒçš„æŒ‡æ ‡ã€‚æœ€å³ä¾§çš„çƒ­å›¾è½´å¯¹åº”æˆ‘ä»¬è¯•å›¾æœ€å°åŒ–çš„æ€»ä½“æ€»æŸå¤±ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬äº¤æ›¿åœ¨ä¸€ä¸ªæŠ˜å ä¸Šæµ‹è¯•æŸå¤±å’Œè¯¥æŠ˜å ä¸Šçš„æ€»æŸå¤±ã€‚è¾ƒä½çš„æ•°å­—æ›´å¥½ï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°å„è¡Œåœ¨å…¶æŠ˜å çš„æŸå¤±ä¸Šä¿æŒä¸€è‡´ï¼ˆå¦åˆ™ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªåæ–œçš„æ•°æ®é›†ï¼‰ã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œè¶…å‚æ•°çš„é€‰æ‹©å¯ä»¥ä¸æŠ˜å è¡Œä¸ºäº’åŠ¨ï¼Œä½†åœ¨æ‰€æœ‰ä½æŸå¤±æƒ…æ™¯ï¼ˆåœ¨åº•éƒ¨ï¼‰ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸åŒæŠ˜å æ€§èƒ½ä¹‹é—´çš„é«˜ç›¸å…³æ€§ã€‚

![è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±](img/brpj_1005.png)

###### å›¾ 10-5\. è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±

æ¥ä¸‹æ¥ï¼Œå“ªäº›è¶…å‚æ•°é€‰æ‹©å¯¹æ€§èƒ½æœ‰è¾ƒå¼ºçš„å½±å“ï¼Ÿå›¾Â 10-6 æ˜¯å¦ä¸€ä¸ªå¹³è¡Œåæ ‡å›¾ï¼Œå…¶å‚ç›´è½´å¯¹åº”ä¸åŒçš„è¶…å‚æ•°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å‚ç›´è½´ä¸Šçš„å“ªäº›é¢†åŸŸå¯¹åº”æœ€å³ä¾§çƒ­å›¾ä¸Šçš„ä½æŸå¤±ã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„ä¸€äº›è¶…å‚æ•°ï¼Œæ¯”å¦‚å…ˆéªŒåˆ†å¸ƒå’Œæœ‰äº›ä»¤äººæƒŠè®¶çš„`ell_2`ï¼Œå‡ ä¹æ²¡æœ‰å½±å“ã€‚ç„¶è€Œï¼Œè¾ƒå°çš„åµŒå…¥ç»´åº¦å’Œè¾ƒå°çš„ Gram æƒé‡ç¡®å®æœ‰å½±å“ã€‚è¾ƒå¤§çš„ alpha å€¼ä¼¼ä¹ä¹Ÿä¸è‰¯å¥½çš„æ€§èƒ½ç›¸å…³ã€‚

![è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±](img/brpj_1006.png)

###### å›¾ 10-6\. è¶…å‚æ•°çš„æŸå¤±

æœ€åï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œéšç€æˆ‘ä»¬è¿›è¡Œè´å¶æ–¯è¶…å‚æ•°æœç´¢ï¼Œæˆ‘ä»¬çš„æ€§èƒ½ç¡®å®éšæ—¶é—´æ”¹å–„ã€‚å›¾Â 10-7 æ˜¯ä¸€ä¸ªå¸•ç´¯æ‰˜å›¾ï¼Œæ•£ç‚¹å›¾ä¸­çš„æ¯ä¸ªç‚¹è¡¨ç¤ºä¸€æ¬¡è¿è¡Œï¼Œä»å·¦åˆ°å³æ˜¯æ—¶é—´è½´ã€‚å‚ç›´è½´æ˜¯æ€»ä½“æŸå¤±ï¼Œå€¼è¶Šä½è¶Šå¥½ï¼Œè¿™æ„å‘³ç€é€šå¸¸æˆ‘ä»¬æ­£åœ¨æœç€æ›´å¥½çš„æ€§èƒ½æ”¶æ•›ã€‚æ²¿ç€æ•£ç‚¹å‡¸åŒ…åº•éƒ¨å†…åˆ»çš„çº¿æ˜¯*å¸•ç´¯æ‰˜å‰æ²¿*ï¼Œæˆ–è¯¥ x å€¼ä¸‹çš„æœ€ä½³æ€§èƒ½ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ—¶é—´åºåˆ—å¸•ç´¯æ‰˜å›¾ï¼Œå®ƒä»…è·Ÿè¸ªæ—¶é—´å†…çš„æœ€ä½³æ€§èƒ½ã€‚

ä¹Ÿè®¸ä½ ä¼šæƒ³çŸ¥é“æˆ‘ä»¬æ˜¯å¦‚ä½•åœ¨æ—¶é—´å†…æ”¶æ•›åˆ°æ›´å¥½çš„æŸå¤±å€¼çš„ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿›è¡Œäº†è´å¶æ–¯è¶…å‚æ•°æœç´¢ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä»ç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒä¸­é€‰æ‹©äº†æˆ‘ä»¬çš„è¶…å‚æ•°ï¼Œå¹¶ä¸”åŸºäºå…ˆå‰è¿è¡Œçš„è¡¨ç°æ›´æ–°äº†æ¯ä¸ªå‚æ•°çš„å…ˆéªŒä¿¡æ¯ã€‚å…³äºè¿™ç§æ–¹æ³•çš„ä»‹ç»ï¼Œè¯·å‚é˜… Robert Mitson çš„[ã€Šè´å¶æ–¯è¶…å‚æ•°ä¼˜åŒ–å…¥é—¨ã€‹](https://oreil.ly/4nd3D)ã€‚åœ¨å®é™…ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸ªå›¾ä¸­çœ‹åˆ°è¾ƒå°‘çš„å•è°ƒè¡Œä¸ºï¼Œä½†æˆ‘ä»¬å§‹ç»ˆå¸Œæœ›æœ‰æ‰€æ”¹å–„ã€‚

![è®­ç»ƒæœŸé—´çš„æŸå¤±](img/brpj_1007.png)

###### å›¾ 10-7\. æŸå¤±å€¼çš„å¸•ç´¯æ‰˜å‰æ²¿

### å…ˆéªŒéªŒè¯

å¦‚æœæˆ‘ä»¬å°†å‰è¿°æ–¹æ³•ä»˜è¯¸å®è·µï¼Œæˆ‘ä»¬éœ€è¦å°†è®­ç»ƒè¿‡çš„æ¨¡å‹å­˜å‚¨åœ¨æ¨¡å‹æ³¨å†Œè¡¨ä¸­ï¼Œä»¥ä¾¿åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ã€‚æœ€ä½³åšæ³•æ˜¯å»ºç«‹ä¸€ç»„æ˜ç¡®çš„è¯„ä¼°æ ‡å‡†ï¼Œä»¥æµ‹è¯•é€‰æ‹©çš„æ¨¡å‹ã€‚åœ¨ä½ çš„åŸºæœ¬æœºå™¨å­¦ä¹ åŸ¹è®­ä¸­ï¼Œä½ å¯èƒ½å·²ç»è¢«é¼“åŠ±è€ƒè™‘éªŒè¯æ•°æ®é›†ï¼›è¿™äº›å¯ä»¥é‡‡ç”¨å¤šç§å½¢å¼ï¼Œæµ‹è¯•ç‰¹å®šå­é›†çš„å®ä¾‹æˆ–ç‰¹å¾ï¼Œç”šè‡³åˆ†å¸ƒåœ¨å·²çŸ¥æ–¹å¼ä¸‹çš„åå˜é‡ä¸­ã€‚

æ¨èç³»ç»Ÿçš„ä¸€ä¸ªæœ‰ç”¨çš„æ¡†æ¶æ˜¯è®°ä½å®ƒä»¬æ˜¯ä¸€ä¸ªåŸºæœ¬ä¸Šæ˜¯é¡ºåºæ•°æ®é›†ã€‚æœ‰äº†è¿™ä¸ªæƒ³æ³•ï¼Œè®©æˆ‘ä»¬å†çœ‹çœ‹æˆ‘ä»¬çš„è¯„åˆ†æ•°æ®ã€‚ç¨åæˆ‘ä»¬å°†æ›´å¤šåœ°è®¨è®ºé¡ºåºæ¨èç³»ç»Ÿï¼Œä½†åœ¨è°ˆè®ºéªŒè¯æ—¶ï¼Œæåˆ°å¦‚ä½•é€‚å½“åœ°å¤„ç†æ˜¯æœ‰ç”¨çš„ã€‚

æ³¨æ„ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„è¯„åˆ†éƒ½æœ‰ç›¸å…³çš„æ—¶é—´æˆ³ã€‚ä¸ºäº†æ„å»ºä¸€ä¸ªåˆé€‚çš„éªŒè¯é›†ï¼Œä»æˆ‘ä»¬æ•°æ®çš„æœ«å°¾è·å–æ—¶é—´æˆ³æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚

ä¸è¿‡ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼Œâ€œä¸åŒç”¨æˆ·ä½•æ—¶æ´»è·ƒï¼Ÿâ€ä»¥åŠâ€œåæœŸæ—¶é—´æˆ³æ˜¯å¦å¯èƒ½æ˜¯å¯¹è¯„åˆ†çš„æœ‰åé€‰æ‹©ï¼Ÿâ€è¿™äº›éƒ½æ˜¯é‡è¦çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥æŒ‰ç”¨æˆ·è¿›è¡Œç•™å‡ºéªŒè¯ã€‚

è¦åˆ›å»ºè¿™ä¸ª*å…ˆéªŒæ•°æ®é›†*ï¼Œå…¶ä¸­æµ‹è¯•é›†ç›´æ¥è·Ÿåœ¨è®­ç»ƒé›†åé¢ï¼ŒæŒ‰ç…§æ—¶é—´é¡ºåºï¼Œé¦–å…ˆå†³å®šéªŒè¯çš„æœŸæœ›å¤§å°ï¼Œä¾‹å¦‚ 10%ã€‚æ¥ä¸‹æ¥ï¼ŒæŒ‰ç”¨æˆ·åˆ†ç»„æ•°æ®ã€‚æœ€åï¼Œä½¿ç”¨æ‹’ç»æŠ½æ ·ï¼Œç¡®ä¿ä¸ä½¿ç”¨æœ€è¿‘çš„æ—¶é—´æˆ³ä½œä¸ºæ‹’ç»æ¡ä»¶ã€‚

è¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨æ‹’ç»æŠ½æ ·åœ¨ pandas ä¸­çš„ç®€å•å®ç°ã€‚è¿™ä¸æ˜¯æœ€é«˜æ•ˆçš„å®ç°æ–¹å¼ï¼Œä½†å¯ä»¥å®Œæˆä»»åŠ¡ï¼š

```py
def prequential_validation_set(df, holdout_perc=0.1):
    '''
 We utilize rejection sampling.

 Assign a probability to all observations, if they lie below the
 sample percentage AND they're the most recent still in the set, include.

 Otherwise return them and repeat.
 Each time, take no more than the remaining necessary to fill the count.
 '''
    count = int(len(df)*holdout_perc)
    sample = []
    while count >0:
      df['p'] = np.random.rand(len(df),1) #generate probabilities
      x = list(
          df.loc[~df.index.isin(sample)] # exclude already selected
          .sort_values(['unix_timestamp'], ascending=False)
          .groupby('user_id').head(1) # only allow the first in each group
          .query("p < @holdout_perc").index # grab the indices
      )
      rnd.shuffle(x) # ensure our previous sorting doesn't bias the users subset
      sample += x[:count] # add observations up to the remaining needed
      count -= len(x[:count]) # decrement the remaining needed

    df.drop(columns=['p'], inplace=True)

    test = df.iloc[sample]
    train = df[~df.index.isin(test.index)]
    return train, test
```

è¿™æ˜¯ä¸€ç§å¯¹å›ºæœ‰é¡ºåºæ•°æ®é›†çš„æœ‰æ•ˆå’Œé‡è¦çš„éªŒè¯æ–¹æ¡ˆã€‚

## WSABIE

è®©æˆ‘ä»¬å†æ¬¡å…³æ³¨ä¼˜åŒ–å’Œä¿®æ”¹ã€‚å¦ä¸€ç§ä¼˜åŒ–æ˜¯å°† MF é—®é¢˜è§†ä¸ºå•ä¸€ä¼˜åŒ–é—®é¢˜ã€‚

æ–‡ç« [â€œWSABIE: Scaling Up to Large Vocabulary Image Annotationâ€](https://oreil.ly/1GB3x)ç”± Jason Weston ç­‰äººæå‡ºçš„æ–¹æ³•ä¹ŸåŒ…å«äº†ä»…å¯¹ç‰©å“çŸ©é˜µè¿›è¡Œå› å¼åˆ†è§£çš„æ–¹æ³•ã€‚åœ¨è¿™ç§æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬ç”¨ç”¨æˆ·å–œæ¬¢çš„ç‰©å“çš„åŠ æƒå’Œæ›¿æ¢ç”¨æˆ·çŸ©é˜µã€‚æˆ‘ä»¬è¦†ç›–äº† Web è§„æ¨¡çš„å›¾åƒåµŒå…¥ï¼ˆWSABIEï¼‰å’Œåœ¨â€œWARPâ€ä¸­çš„ Warp æŸå¤±ã€‚å°†ç”¨æˆ·è¡¨ç¤ºä¸ºä»–ä»¬å–œæ¬¢çš„ç‰©å“çš„å¹³å‡å€¼æ˜¯ä¸€ç§èŠ‚çœç©ºé—´çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰å¤§é‡ç”¨æˆ·åˆ™ä¸éœ€è¦å•ç‹¬çš„ç”¨æˆ·çŸ©é˜µã€‚

# æ½œåœ¨ç©ºé—´ HPO

å¦ä¸€ç§å®Œå…¨ä¸åŒçš„ä¸º RecSys è¿›è¡Œ HPO çš„æ–¹æ³•æ˜¯é€šè¿‡æ½œåœ¨ç©ºé—´æœ¬èº«ï¼[â€œDynamic Recommender Systems ä¸­çš„æ½œåœ¨ç©ºé—´è¶…å‚æ•°ä¼˜åŒ–â€](https://oreil.ly/RLeEC)ç”± Bruno Veloso ç­‰äººå°è¯•åœ¨æ¯ä¸ªæ­¥éª¤ä¸­ä¿®æ”¹ç›¸å¯¹åµŒå…¥ä»¥ä¼˜åŒ–åµŒå…¥æ¨¡å‹ã€‚

# é™ç»´

æ¨èç³»ç»Ÿç»å¸¸ä½¿ç”¨é™ç»´æŠ€æœ¯æ¥å‡å°‘è®¡ç®—å¤æ‚æ€§å¹¶å¢å¼ºæ¨èç®—æ³•çš„å‡†ç¡®æ€§ã€‚åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œæ¨èç³»ç»Ÿçš„é™ç»´ä¸»è¦æ¦‚å¿µåŒ…æ‹¬ MF å’Œ SVDã€‚

*çŸ©é˜µåˆ†è§£æ–¹æ³•*å°†ç”¨æˆ·-ç‰©å“äº¤äº’çŸ©é˜µ <math alttext="left-parenthesis upper A element-of double-struck upper R Superscript left-parenthesis m times n right-parenthesis Baseline right-parenthesis"><mrow><mo>(</mo> <mi>A</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>m</mi><mo>Ã—</mo><mi>n</mi><mo>)</mo></mrow></msup> <mo>)</mo></mrow></math> åˆ†è§£æˆä¸¤ä¸ªè¡¨ç¤ºç”¨æˆ· <math alttext="left-parenthesis upper U element-of double-struck upper R Superscript left-parenthesis m times r right-parenthesis Baseline right-parenthesis"><mrow><mo>(</mo> <mi>U</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>m</mi><mo>Ã—</mo><mi>r</mi><mo>)</mo></mrow></msup> <mo>)</mo></mrow></math> å’Œç‰©å“ <math alttext="left-parenthesis upper V element-of double-struck upper R Superscript left-parenthesis n times r right-parenthesis Baseline right-parenthesis"><mrow><mo>(</mo> <mi>V</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>n</mi><mo>Ã—</mo><mi>r</mi><mo>)</mo></mrow></msup> <mo>)</mo></mrow></math> æ½œåœ¨å› å­çš„è¾ƒä½ç»´åº¦çŸ©é˜µã€‚è¿™ç§æŠ€æœ¯å¯ä»¥æ­ç¤ºæ½œåœ¨çš„æ•°æ®ç»“æ„ï¼Œå¹¶æ ¹æ®ç”¨æˆ·çš„å…ˆå‰äº¤äº’æä¾›æ¨èã€‚åœ¨æ•°å­¦ä¸Šï¼ŒMF å¯ä»¥è¡¨ç¤ºå¦‚ä¸‹ï¼š

<math alttext="upper A tilde upper U times upper V Superscript left-parenthesis upper T right-parenthesis" display="block"><mrow><mi>A</mi> <mo>âˆ¼</mo> <mi>U</mi> <mo>Ã—</mo> <msup><mi>V</mi> <mrow><mo>(</mo><mi>T</mi><mo>)</mo></mrow></msup></mrow></math>

*SVD*æ˜¯ä¸€ç§çº¿æ€§ä»£æ•°æŠ€æœ¯ï¼Œå®ƒå°†çŸ©é˜µ(*A*)åˆ†è§£ä¸ºä¸‰ä¸ªçŸ©é˜µâ€”å·¦å¥‡å¼‚å‘é‡(*U*)ï¼Œå¥‡å¼‚å€¼(*Î£*)å’Œå³å¥‡å¼‚å‘é‡(*V*)ã€‚åœ¨æ¨èç³»ç»Ÿä¸­ï¼ŒSVD å¯ç”¨äº MFï¼Œå…¶ä¸­ç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µè¢«åˆ†è§£ä¸ºæ›´å°‘æ•°é‡çš„æ½œåœ¨å› å­ã€‚SVD çš„æ•°å­¦è¡¨ç¤ºå¦‚ä¸‹ï¼š

<math alttext="upper A equals upper U times normal upper Sigma times upper V Superscript left-parenthesis upper T right-parenthesis" display="block"><mrow><mi>A</mi> <mo>=</mo> <mi>U</mi> <mo>Ã—</mo> <mi>Î£</mi> <mo>Ã—</mo> <msup><mi>V</mi> <mrow><mo>(</mo><mi>T</mi><mo>)</mo></mrow></msup></mrow></math>

åœ¨å®é™…æ“ä½œä¸­ï¼Œäººä»¬é€šå¸¸ä¸ä¼šä½¿ç”¨æ•°å­¦åº“æ¥æ‰¾åˆ°ç‰¹å¾å‘é‡ï¼Œè€Œæ˜¯å¯èƒ½ä½¿ç”¨[å¹‚è¿­ä»£æ³•](https://oreil.ly/DCsRs)æ¥è¿‘ä¼¼åœ°å‘ç°ç‰¹å¾å‘é‡ã€‚è¿™ç§æ–¹æ³•æ¯”ä¸ºæ­£ç¡®æ€§å’Œå¯†é›†å‘é‡ä¼˜åŒ–çš„å®Œæ•´ç¨ å¯† SVD è§£å†³æ–¹æ¡ˆè¦å¯æ‰©å±•å¾—å¤šï¼š

```py
import jax
import jax.numpy as jnp

def power_iteration(a: jnp.ndarray) -> jnp.ndarray:
  """Returns an eigenvector of the matrix a.
 Args:
 a: a n x m matrix
 """
  key = jax.random.PRNGKey(0)
  x = jax.random.normal(key, shape=(a.shape[1], 1))
  for i in range(100):
    x = a @ x
    x = x / jnp.linalg.norm(x)
  return x.T

key = jax.random.PRNGKey(123)
A = jax.random.normal(key, shape=[4, 4])
print(A)
[[ 0.52830553  0.3722206  -1.2219944  -0.10314374]
 [ 1.4722222   0.47889313 -1.2940298   1.0449569 ]
 [ 0.23724185  0.3545859  -0.172465   -1.8011322 ]
 [ 0.4864215   0.08039388 -1.2540827   0.72071517]]
S, _, _ = jnp.linalg.svd(A)
print(S)
[[-0.375782    0.40269807  0.44086716 -0.70870167]
 [-0.753597    0.0482972  -0.65527284  0.01940039]
 [ 0.2040088   0.91405433 -0.15798494  0.31293103]
 [-0.49925917 -0.00250015  0.5927009   0.6320123 ]]
x1 = power_iteration(A)
print(x1.T)
[[-0.35423845]
 [-0.8332922 ]
 [ 0.16189891]
 [-0.39233655]]
```

æ³¨æ„ï¼Œå¹‚è¿­ä»£è¿”å›çš„ç‰¹å¾å‘é‡æ¥è¿‘äº<math alttext="upper S"><mi>S</mi></math>çš„ç¬¬ä¸€åˆ—ï¼Œä½†ä¸å®Œå…¨ç›¸åŒã€‚è¿™æ˜¯å› ä¸ºè¿™ç§æ–¹æ³•æ˜¯è¿‘ä¼¼çš„ã€‚å®ƒä¾èµ–äºç‰¹å¾å‘é‡åœ¨ä¹˜ä»¥çŸ©é˜µæ—¶ä¸æ”¹å˜æ–¹å‘çš„äº‹å®ã€‚å› æ­¤ï¼Œé€šè¿‡é‡å¤ä¹˜ä»¥çŸ©é˜µï¼Œæˆ‘ä»¬æœ€ç»ˆè¿­ä»£åˆ°ä¸€ä¸ªç‰¹å¾å‘é‡ã€‚è¿˜è¦æ³¨æ„ï¼Œæˆ‘ä»¬è§£å†³çš„æ˜¯åˆ—ç‰¹å¾å‘é‡ï¼Œè€Œä¸æ˜¯è¡Œç‰¹å¾å‘é‡ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ—æ˜¯ç”¨æˆ·ï¼Œè¡Œæ˜¯é¡¹ç›®ã€‚é‡è¦çš„æ˜¯è¦ç©è½¬è½¬ç½®çŸ©é˜µï¼Œå› ä¸ºå¾ˆå¤šæœºå™¨å­¦ä¹ æ¶‰åŠåˆ°é‡å¡‘å’Œè½¬ç½®çŸ©é˜µï¼Œæ‰€ä»¥æ—©æœŸç†Ÿæ‚‰å®ƒä»¬æ˜¯ä¸€é¡¹é‡è¦æŠ€èƒ½ã€‚

# ç‰¹å¾å‘é‡ç¤ºä¾‹

è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç»ƒä¹ ç»™ä½ ï¼šç¬¬äºŒä¸ªç‰¹å¾å‘é‡æ˜¯é€šè¿‡åœ¨çŸ©é˜µä¹˜æ³•åå‡å»ç¬¬ä¸€ä¸ªç‰¹å¾å‘é‡æ¥è®¡ç®—çš„ã€‚è¿™å‘Šè¯‰ç®—æ³•å¿½ç•¥ç¬¬ä¸€ä¸ªç‰¹å¾å‘é‡ä¸Šçš„ä»»ä½•æˆåˆ†ï¼Œä»¥è®¡ç®—ç¬¬äºŒä¸ªç‰¹å¾å‘é‡ã€‚ä½œä¸ºä¸€ä¸ªæœ‰è¶£çš„ç»ƒä¹ ï¼Œè·³åˆ°[Colab](https://oreil.ly/0zmWq)ä¸Šå°è¯•è®¡ç®—ç¬¬äºŒä¸ªç‰¹å¾å‘é‡ã€‚å°†è¿™ç§æ–¹æ³•æ‰©å±•åˆ°ç¨€ç–å‘é‡è¡¨ç¤ºæ˜¯å¦ä¸€ä¸ªæœ‰è¶£çš„ç»ƒä¹ ï¼Œå› ä¸ºå®ƒå…è®¸æ‚¨å¼€å§‹è®¡ç®—ç¨€ç–çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œè¿™é€šå¸¸æ˜¯æ¨èç³»ç»Ÿä½¿ç”¨çš„çŸ©é˜µå½¢å¼ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡åˆ›å»ºä¸€ä¸ªåˆ—å¹¶å°†å…¶ä¸æ‰€æœ‰ç‰¹å¾å‘é‡ç‚¹ç§¯ï¼Œæ‰¾åˆ°æœ€æ¥è¿‘çš„ç‰¹å¾å‘é‡ã€‚ç„¶åæ‰¾åˆ°ç”¨æˆ·å°šæœªçœ‹åˆ°çš„ç‰¹å¾å‘é‡ä¸­æ‰€æœ‰æœ€é«˜è¯„åˆ†çš„æ¡ç›®ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºæ¨èè¿”å›ã€‚å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœç‰¹å¾å‘é‡<math alttext="x 1"><msub><mi>x</mi> <mn>1</mn></msub></math>æœ€æ¥è¿‘ç”¨æˆ·åˆ—ï¼Œé‚£ä¹ˆæ¨èçš„æœ€ä½³é¡¹ç›®å°†æ˜¯é¡¹ç›® 3ï¼Œå› ä¸ºå®ƒæ˜¯ç‰¹å¾å‘é‡ä¸­æœ€å¤§çš„æˆåˆ†ï¼Œå› æ­¤å¦‚æœç”¨æˆ·æœ€æ¥è¿‘ç‰¹å¾å‘é‡<math alttext="x 1"><msub><mi>x</mi> <mn>1</mn></msub></math>ï¼Œåˆ™è¯„åˆ†æœ€é«˜ã€‚è¿™æ®µä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

```py
import jax
import jax.numpy as jnp

def recommend_items(eigenvectors: jnp.ndarray, user:jnp.ndarray) -> jnp.ndarray:
  """Returns an ordered list of recommend items for the user.
 Args:
 eigenvectors: a nxm eigenvector matrix
 user: a user vector of size m.
 """
  score_eigenvectors = jnp.matmul(eigenvectors.T, user)
  which_eigenvector = jnp.argmax(score_eigenvectors)
  closest_eigenvector = eigenvectors.T[which_eigenvector]
  scores, items = jax.lax.top_k(closest_eigenvector, 3)
  return scores, items

S = jnp.array(
[[-0.375782,    0.40269807],
 [-0.753597,    0.0482972],
 [ 0.2040088,   0.91405433],
 [-0.49925917, -0.00250015]])
u = jnp.array([-1, -1, 0, 0]).reshape(4, 1)
scores, items = recommend_items(S, u)
print(scores)
[ 0.2040088  -0.375782   -0.49925917]
print(items)
[2 0 3]
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”¨æˆ·å¯¹é¡¹ç›® 0 å’Œé¡¹ç›® 1 è¿›è¡Œäº†è´Ÿé¢è¯„ä»·ã€‚æœ€æ¥è¿‘çš„åˆ—ç‰¹å¾å‘é‡å› æ­¤æ˜¯åˆ— 0ã€‚ç„¶åæˆ‘ä»¬é€‰æ‹©è·ç¦»ç”¨æˆ·æœ€è¿‘çš„ç‰¹å¾å‘é‡ï¼Œå¯¹æ¡ç›®è¿›è¡Œæ’åºï¼Œå¹¶å‘ç”¨æˆ·æ¨èé¡¹ç›® 2ï¼Œè¿™æ˜¯ç”¨æˆ·å°šæœªçœ‹åˆ°çš„æœ€é«˜è¯„åˆ†æ¡ç›®ã€‚

ä¸¤ç§æŠ€æœ¯æ—¨åœ¨ä»ç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µä¸­æå–æœ€ç›¸å…³çš„ç‰¹å¾å¹¶å‡å°‘å…¶ç»´åº¦ï¼Œä»è€Œæ”¹å–„æ€§èƒ½ï¼š

ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰

è¿™ç§ç»Ÿè®¡æŠ€æœ¯å°†åŸå§‹é«˜ç»´æ•°æ®è½¬æ¢ä¸ºè¾ƒä½ç»´åº¦çš„è¡¨ç¤ºï¼ŒåŒæ—¶ä¿ç•™æœ€é‡è¦çš„ä¿¡æ¯ã€‚ PCA å¯ä»¥åº”ç”¨äºç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µï¼Œä»¥å‡å°‘ç»´åº¦æ•°é‡å¹¶æé«˜æ¨èç®—æ³•çš„è®¡ç®—æ•ˆç‡ã€‚

éè´ŸçŸ©é˜µåˆ†è§£ï¼ˆNMFï¼‰

æ­¤æŠ€æœ¯å°†éè´Ÿç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µ <math alttext="left-parenthesis upper A element-of double-struck upper R Superscript left-parenthesis m times n right-parenthesis asterisk plus Baseline right-parenthesis"><mrow><mo>(</mo> <mi>A</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>m</mi><mo>Ã—</mo><mi>n</mi><mo>)</mo><mo>*</mo><mo>+</mo></mrow></msup> <mo>)</mo></mrow></math> åˆ†è§£ä¸ºä¸¤ä¸ªéè´ŸçŸ©é˜µ <math alttext="left-parenthesis upper W element-of double-struck upper R Superscript left-parenthesis m times r right-parenthesis asterisk plus"><mrow><mo>(</mo> <mi>W</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>m</mi><mo>Ã—</mo><mi>r</mi><mo>)</mo><mo>*</mo><mo>+</mo></mrow></msup></mrow></math> å’Œ <math alttext="upper H element-of double-struck upper R Superscript left-parenthesis r times n right-parenthesis Super Subscript plus Superscript Baseline right-parenthesis"><mrow><mi>H</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <msub><mrow><mo>(</mo><mi>r</mi><mo>Ã—</mo><mi>n</mi><mo>)</mo></mrow> <mo>+</mo></msub></msup> <mrow><mo>)</mo></mrow></mrow></math> ã€‚ NMF å¯ä»¥ç”¨äºæ¨èç³»ç»Ÿä¸­çš„ç»´åº¦ç¼©å‡ï¼Œå…¶ä¸­æ½œåœ¨å› å­æ˜¯éè´Ÿä¸”å¯è§£é‡Šçš„ã€‚ NMF çš„æ•°å­¦è¡¨ç¤ºä¸º <math alttext="upper A asymptotically-equals upper W times upper H"><mrow><mi>A</mi> <mo>â‰ƒ</mo> <mi>W</mi> <mo>Ã—</mo> <mi>H</mi></mrow></math> ã€‚

MF æŠ€æœ¯å¯ä»¥é€šè¿‡ä½¿ç”¨é™„åŠ ä¿¡æ¯ï¼ˆå¦‚é¡¹ç›®å†…å®¹æˆ–ç”¨æˆ·äººå£ç»Ÿè®¡æ•°æ®ï¼‰è¿›ä¸€æ­¥æ‰©å±•ï¼Œé€šè¿‡ä½¿ç”¨è¾…åŠ©ä¿¡æ¯ã€‚ è¾…åŠ©ä¿¡æ¯å¯ä»¥ç”¨æ¥å¢å¼ºç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µï¼Œä»è€Œå®ç°æ›´å‡†ç¡®å’Œä¸ªæ€§åŒ–çš„æ¨èã€‚

æ­¤å¤–ï¼ŒMF æ¨¡å‹å¯ä»¥æ‰©å±•åˆ°å¤„ç†éšå¼åé¦ˆæ•°æ®ï¼Œå…¶ä¸­ç¼ºå°‘äº¤äº’æ•°æ®å¹¶ä¸ç­‰åŒäºç¼ºä¹å…´è¶£ã€‚ é€šè¿‡å°†é¢å¤–çš„æ­£åˆ™åŒ–é¡¹å¹¶å…¥ç›®æ ‡å‡½æ•°ï¼ŒMF æ¨¡å‹å¯ä»¥å­¦ä¹ ç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µçš„æ›´å¼ºå¥è¡¨ç¤ºï¼Œä»è€Œä¸ºéšå¼åé¦ˆåœºæ™¯æä¾›æ›´å¥½çš„æ¨èã€‚

è€ƒè™‘ä¸€ä¸ªåˆ©ç”¨ MF æ¨¡å‹ç”¨æˆ·-ç‰©å“äº¤äº’çŸ©é˜µçš„æ¨èç³»ç»Ÿã€‚ å¦‚æœç³»ç»ŸåŒ…å«è®¸å¤šç”¨æˆ·å’Œç‰©å“ï¼Œç”Ÿæˆçš„å› å­çŸ©é˜µå¯èƒ½æ˜¯é«˜ç»´çš„ï¼Œä¸”å¤„ç†èµ·æ¥è®¡ç®—æˆæœ¬é«˜æ˜‚ã€‚ ç„¶è€Œï¼Œé€šè¿‡ä½¿ç”¨å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰æˆ–ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ç­‰é™ç»´æŠ€æœ¯ï¼Œç®—æ³•å¯ä»¥å‡å°‘å› å­çŸ©é˜µçš„ç»´åº¦ï¼ŒåŒæ—¶ä¿ç•™å…³äºç”¨æˆ·-ç‰©å“äº¤äº’çš„æœ€é‡è¦ä¿¡æ¯ã€‚ è¿™ä½¿å¾—ç®—æ³•èƒ½å¤Ÿä¸ºæ–°ç”¨æˆ·æˆ–å…·æœ‰æœ‰é™äº¤äº’æ•°æ®çš„ç‰©å“ç”Ÿæˆæ›´æœ‰æ•ˆå’Œå‡†ç¡®çš„æ¨èã€‚

## ç­‰è·åµŒå…¥

*ç­‰è·åµŒå…¥* æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„åµŒå…¥ï¼Œå½“å°†ç‚¹æ˜ å°„åˆ°ä½ç»´ç©ºé—´æ—¶ï¼Œä¿æŒé«˜ç»´ç©ºé—´ä¸­ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚ æœ¯è¯­*ç­‰è·* è¡¨ç¤ºé«˜ç»´ç©ºé—´ä¸­çš„ç‚¹ä¹‹é—´çš„è·ç¦»åœ¨ä½ç»´ç©ºé—´ä¸­è¢«ç²¾ç¡®åœ°ä¿ç•™ï¼Œåªæœ‰ä¸€ä¸ªç¼©æ”¾å› å­ã€‚

ä¸å…¶ä»–ç±»å‹çš„åµŒå…¥ï¼ˆå¦‚çº¿æ€§æˆ–éçº¿æ€§åµŒå…¥ï¼‰ç›¸æ¯”ï¼Œè¿™ç§ç­‰è·åµŒå…¥åœ¨è®¸å¤šéœ€è¦ä¿æŒè·ç¦»çš„åº”ç”¨ä¸­æ›´ä¸ºç†æƒ³ã€‚ ä¾‹å¦‚ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç­‰è·åµŒå…¥å¯ç”¨äºåœ¨äºŒç»´æˆ–ä¸‰ç»´ä¸­å¯è§†åŒ–é«˜ç»´æ•°æ®ï¼ŒåŒæ—¶ä¿æŒæ•°æ®ç‚¹ä¹‹é—´çš„ç›¸å¯¹è·ç¦»ã€‚ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œç­‰è·åµŒå…¥å¯ç”¨äºè¡¨ç¤ºå•è¯æˆ–æ–‡æ¡£ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§ï¼ŒåŒæ—¶åœ¨åµŒå…¥ç©ºé—´ä¸­ä¿æŒå®ƒä»¬çš„ç›¸å¯¹è·ç¦»ã€‚

ç”Ÿæˆç­‰è·åµŒå…¥çš„ä¸€ç§æµè¡ŒæŠ€æœ¯æ˜¯*å¤šç»´æ ‡åº¦*ï¼ˆ*MDS*ï¼‰ã€‚ MDS é€šè¿‡è®¡ç®—é«˜ç»´ç©ºé—´ä¸­æ•°æ®ç‚¹ä¹‹é—´çš„æˆå¯¹è·ç¦»ï¼Œç„¶åç¡®å®šä¸€ä¸ªä¿æŒè¿™äº›è·ç¦»çš„ä½ç»´åµŒå…¥æ¥è¿ä½œã€‚ ä¼˜åŒ–é—®é¢˜é€šå¸¸è¢«åˆ¶å®šä¸ºçº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œå…¶ç›®æ ‡æ˜¯æœ€å°åŒ–é«˜ç»´ç©ºé—´ä¸­æˆå¯¹è·ç¦»ä¸ä½ç»´åµŒå…¥ä¸­ç›¸åº”è·ç¦»ä¹‹é—´çš„å·®å¼‚ã€‚ åœ¨æ•°å­¦ä¸Šï¼Œæˆ‘ä»¬å†™æˆï¼š<math alttext="m i n Subscript left-parenthesis upper X right-parenthesis Baseline sigma-summation Underscript left-parenthesis i comma j right-parenthesis Endscripts left-parenthesis d Subscript i j Baseline minus StartAbsoluteValue EndAbsoluteValue x Subscript i Baseline minus x Subscript j Baseline StartAbsoluteValue EndAbsoluteValue right-parenthesis squared"><mrow><mi>æœ€å°åŒ–</mi> <mi>ä¸Šæ ‡</mi> <msub><mtext>å·¦æ‹¬å·</mtext> <mrow><mi>X</mi> <mtext>å³æ‹¬å·</mtext></mrow></msub> <msub><mo>Î£</mo> <mrow><mtext>å·¦æ‹¬å·</mtext><mi>i</mi><mo>,</mo><mi>j</mi><mtext>å³æ‹¬å·</mtext></mrow></msub> <mrow><mtext>å·¦æ‹¬å·</mtext></mrow> <msub><mi>d</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub> <mo>-</mo> <mrow><mtext>ç»å¯¹å€¼</mtext><mtext>ç»å¯¹å€¼</mtext></mrow> <msub><mi>x</mi> <mi>i</mi></msub> <mo>-</mo> <msub><mi>x</mi> <mi>j</mi></msub> <msup><mrow><mtext>ç»å¯¹å€¼</mtext><mtext>ç»å¯¹å€¼</mtext></mrow> <mn>2</mn></msup></mrow></math>ã€‚

è¿™é‡Œï¼Œ<math alttext="d Subscript i j"><msub><mi>d</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub></math> è¡¨ç¤ºé«˜ç»´ç©ºé—´ä¸­çš„æˆå¯¹è·ç¦»ï¼Œè€Œ <math alttext="x Subscript i"><msub><mi>x</mi> <mi>i</mi></msub></math> å’Œ <math alttext="x Subscript j"><msub><mi>x</mi> <mi>j</mi></msub></math> è¡¨ç¤ºä½ç»´åµŒå…¥ä¸­çš„ç‚¹ã€‚

ç”Ÿæˆç­‰è·åµŒå…¥çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ ¸æ–¹æ³•ï¼Œå¦‚æ ¸ PCA æˆ–æ ¸ MDSã€‚æ ¸æ–¹æ³•é€šè¿‡éšå¼åœ°å°†æ•°æ®ç‚¹æ˜ å°„åˆ°æ›´é«˜ç»´çš„ç‰¹å¾ç©ºé—´ï¼Œåœ¨è¿™ä¸ªç©ºé—´ä¸­ï¼Œç‚¹ä¹‹é—´çš„è·ç¦»æ›´å®¹æ˜“è®¡ç®—ã€‚ç„¶ååœ¨ç‰¹å¾ç©ºé—´ä¸­è®¡ç®—ç­‰è·åµŒå…¥ï¼Œå¹¶å°†ç»“æœåµŒå›åŸå§‹ç©ºé—´ã€‚

ç­‰è·åµŒå…¥å·²è¢«åº”ç”¨äºæ¨èç³»ç»Ÿä¸­ï¼Œç”¨äºå°†ç”¨æˆ·-ç‰©å“äº¤äº’çŸ©é˜µè¡¨ç¤ºä¸ºä¸€ä¸ªä½ç»´ç©ºé—´ï¼Œå…¶ä¸­ä¿ç•™äº†ç‰©å“ä¹‹é—´çš„è·ç¦»ã€‚é€šè¿‡åœ¨åµŒå…¥ç©ºé—´ä¸­ä¿æŒç‰©å“ä¹‹é—´çš„è·ç¦»ï¼Œæ¨èç®—æ³•å¯ä»¥æ›´å¥½åœ°æ•æ‰æ•°æ®çš„åŸºæœ¬ç»“æ„ï¼Œå¹¶æä¾›æ›´å‡†ç¡®å’Œå¤šæ ·åŒ–çš„æ¨èã€‚

ç­‰è·åµŒå…¥è¿˜å¯ä»¥ç”¨äºæ•´åˆé¢å¤–ä¿¡æ¯åˆ°æ¨èç®—æ³•ä¸­ï¼Œä¾‹å¦‚ç‰©å“å†…å®¹æˆ–ç”¨æˆ·äººå£ç»Ÿè®¡æ•°æ®ã€‚é€šè¿‡ä½¿ç”¨ç­‰è·åµŒå…¥æ¥è¡¨ç¤ºç‰©å“å’Œé¢å¤–ä¿¡æ¯ï¼Œç®—æ³•å¯ä»¥åŸºäºç”¨æˆ·-ç‰©å“äº¤äº’æ•°æ®ä»¥åŠç‰©å“å†…å®¹æˆ–ç”¨æˆ·äººå£ç»Ÿè®¡ä¿¡æ¯æ•æ‰ç‰©å“ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œä»è€Œæä¾›æ›´å‡†ç¡®å’Œå¤šæ ·åŒ–çš„æ¨èã€‚

æ­¤å¤–ï¼Œç­‰è·åµŒå…¥è¿˜å¯ä»¥ç”¨äºè§£å†³æ¨èç³»ç»Ÿä¸­çš„å†·å¯åŠ¨é—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨ç­‰è·åµŒå…¥æ¥è¡¨ç¤ºç‰©å“ï¼Œç®—æ³•å¯ä»¥æ ¹æ®å®ƒä»¬åœ¨åµŒå…¥ç©ºé—´ä¸­ä¸ç°æœ‰ç‰©å“çš„ç›¸ä¼¼æ€§ï¼Œå³ä½¿åœ¨æ²¡æœ‰ç”¨æˆ·äº¤äº’çš„æƒ…å†µä¸‹ï¼Œä¸ºæ–°ç‰©å“æä¾›å»ºè®®ã€‚

æ€»ä¹‹ï¼Œç­‰è·åµŒå…¥æ˜¯æ¨èç³»ç»Ÿä¸­ä¸€ç§å®è´µçš„æŠ€æœ¯ï¼Œç”¨äºå°†ç”¨æˆ·-ç‰©å“äº¤äº’çŸ©é˜µè¡¨ç¤ºä¸ºä¸€ä¸ªä½ç»´ç©ºé—´ï¼Œå…¶ä¸­ä¿ç•™äº†ç‰©å“ä¹‹é—´çš„è·ç¦»ã€‚ç­‰è·åµŒå…¥å¯ä»¥ä½¿ç”¨ MF æŠ€æœ¯ç”Ÿæˆï¼Œå¹¶å¯ä»¥ç”¨äºæ•´åˆé¢å¤–ä¿¡æ¯ï¼Œè§£å†³å†·å¯åŠ¨é—®é¢˜ï¼Œæé«˜æ¨èçš„å‡†ç¡®æ€§å’Œå¤šæ ·æ€§ã€‚

## éçº¿æ€§å±€éƒ¨åº¦é‡åµŒå…¥

*éçº¿æ€§å±€éƒ¨åº¦é‡åµŒå…¥* æ˜¯å¦ä¸€ç§æ–¹æ³•ï¼Œç”¨äºå°†ç”¨æˆ·-ç‰©å“äº¤äº’çŸ©é˜µè¡¨ç¤ºä¸ºä¸€ä¸ªä½ç»´ç©ºé—´ï¼Œå…¶ä¸­ä¿ç•™äº†é™„è¿‘ç‰©å“ä¹‹é—´çš„å±€éƒ¨è·ç¦»ã€‚é€šè¿‡åœ¨åµŒå…¥ç©ºé—´ä¸­ä¿æŒç‰©å“ä¹‹é—´çš„å±€éƒ¨è·ç¦»ï¼Œæ¨èç®—æ³•å¯ä»¥æ›´å¥½åœ°æ•æ‰æ•°æ®çš„å±€éƒ¨ç»“æ„ï¼Œå¹¶æä¾›æ›´å‡†ç¡®å’Œå¤šæ ·åŒ–çš„æ¨èã€‚

æ•°å­¦ä¸Šï¼Œè®¾ <math alttext="upper X equals x 1 comma x 2 comma period period period comma x Subscript n Baseline"><mrow><mi>X</mi> <mo>=</mo> <mrow><msub><mi>x</mi> <mn>1</mn></msub> <mo>,</mo> <msub><mi>x</mi> <mn>2</mn></msub> <mo>,</mo> <mo>.</mo> <mo>.</mo> <mo>.</mo> <mo>,</mo> <msub><mi>x</mi> <mi>n</mi></msub></mrow></mrow></math> è¡¨ç¤ºé«˜ç»´ç©ºé—´ä¸­çš„é¡¹ç›®é›†åˆï¼Œè€Œ <math alttext="upper Y equals y 1 comma y 2 comma period period period comma y Subscript n Baseline"><mrow><mi>Y</mi> <mo>=</mo> <mrow><msub><mi>y</mi> <mn>1</mn></msub> <mo>,</mo> <msub><mi>y</mi> <mn>2</mn></msub> <mo>,</mo> <mo>.</mo> <mo>.</mo> <mo>.</mo> <mo>,</mo> <msub><mi>y</mi> <mi>n</mi></msub></mrow></mrow></math> è¡¨ç¤ºä½ç»´ç©ºé—´ä¸­çš„é¡¹ç›®é›†åˆã€‚éçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ˜ å°„ <math alttext="f colon upper X right-arrow upper Y"><mrow><mi>f</mi> <mo>:</mo> <mi>X</mi> <mo>â†’</mo> <mi>Y</mi></mrow></math> ï¼Œä»¥ä¿æŒå±€éƒ¨è·ç¦»ï¼Œå³å¯¹äºä»»æ„ <math alttext="x Subscript i Baseline comma x Subscript j Baseline element-of upper X"><mrow><msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo> <msub><mi>x</mi> <mi>j</mi></msub> <mo>âˆˆ</mo> <mi>X</mi></mrow></math> ï¼Œæˆ‘ä»¬æœ‰ï¼š

<math alttext="d Subscript upper Y Baseline left-parenthesis f left-parenthesis x Subscript i Baseline right-parenthesis comma f left-parenthesis x Subscript j Baseline right-parenthesis right-parenthesis asymptotically-equals d Subscript upper X Baseline left-parenthesis x Subscript i Baseline comma x Subscript j Baseline right-parenthesis" display="block"><mrow><msub><mi>d</mi> <mi>Y</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mrow><mo>(</mo> <msub><mi>x</mi> <mi>i</mi></msub> <mo>)</mo></mrow> <mo>,</mo> <mi>f</mi> <mrow><mo>(</mo> <msub><mi>x</mi> <mi>j</mi></msub> <mo>)</mo></mrow> <mo>)</mo></mrow> <mo>â‰ƒ</mo> <msub><mi>d</mi> <mi>X</mi></msub> <mrow><mo>(</mo> <msub><mi>x</mi> <mi>i</mi></msub> <mo>,</mo> <msub><mi>x</mi> <mi>j</mi></msub> <mo>)</mo></mrow></mrow></math>

åœ¨æ¨èç³»ç»Ÿä¸­ç”Ÿæˆéçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥çš„ä¸€ä¸ªæµè¡Œæ–¹æ³•æ˜¯é€šè¿‡è‡ªç¼–ç å™¨ç¥ç»ç½‘ç»œã€‚è‡ªç¼–ç å™¨é€šè¿‡ç¼–ç å™¨ç½‘ç»œå°†é«˜ç»´ç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µæ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼Œç„¶åé€šè¿‡è§£ç å™¨ç½‘ç»œå°†çŸ©é˜µé‡æ–°æ„å»ºå›é«˜ç»´ç©ºé—´ã€‚ç¼–ç å™¨å’Œè§£ç å™¨ç½‘ç»œè¢«è”åˆè®­ç»ƒï¼Œä»¥æœ€å°åŒ–è¾“å…¥æ•°æ®å’Œé‡æ„æ•°æ®ä¹‹é—´çš„å·®å¼‚ï¼Œç›®çš„æ˜¯æ•æ‰åµŒå…¥ç©ºé—´ä¸­çš„æ•°æ®æ½œåœ¨ç»“æ„ï¼š

<math alttext="m i n Subscript left-parenthesis theta comma phi right-parenthesis Baseline sigma-summation Underscript left-parenthesis i equals 1 right-parenthesis Overscript n Endscripts StartAbsoluteValue EndAbsoluteValue x Subscript i minus g Subscript phi Baseline left-parenthesis f Subscript theta Baseline left-parenthesis x Subscript i Baseline right-parenthesis right-parenthesis StartAbsoluteValue EndAbsoluteValue squared" display="block"><mrow><mi>m</mi> <mi>i</mi> <msub><mi>n</mi> <mrow><mo>(</mo><mi>Î¸</mi><mo>,</mo><mi>Ï†</mi><mo>)</mo></mrow></msub> <munderover><mo>âˆ‘</mo> <mrow><mo>(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>)</mo></mrow> <mi>n</mi></munderover> <mrow><mo>|</mo> <mo>|</mo></mrow> <msub><mi>x</mi> <mi>i</mi></msub> <mo>-</mo> <msub><mi>g</mi> <mi>Ï†</mi></msub> <mrow><mo>(</mo> <msub><mi>f</mi> <mi>Î¸</mi></msub> <mrow><mo>(</mo> <msub><mi>x</mi> <mi>i</mi></msub> <mo>)</mo></mrow> <mo>)</mo></mrow> <msup><mrow><mo>|</mo><mo>|</mo></mrow> <mn>2</mn></msup></mrow></math>

è¿™é‡Œï¼Œ<math alttext="f Subscript theta"><msub><mi>f</mi> <mi>Î¸</mi></msub></math> è¡¨ç¤ºå¸¦æœ‰å‚æ•° <math alttext="theta comma g Subscript theta Baseline"><mrow><mi>Î¸</mi> <mo>,</mo> <msub><mi>g</mi> <mi>Î¸</mi></msub></mrow></math> çš„ç¼–ç å™¨ç½‘ç»œï¼Œ<math alttext="theta"><mi>Î¸</mi></math> è¡¨ç¤ºå…·æœ‰å‚æ•° <math alttext="theta"><mi>Î¸</mi></math> çš„è§£ç å™¨ç½‘ç»œï¼Œå¹¶ä¸” <math alttext="StartAbsoluteValue EndAbsoluteValue dot StartAbsoluteValue EndAbsoluteValue"><mrow><mo>|</mo> <mo>|</mo> <mo>Â·</mo> <mo>|</mo> <mo>|</mo></mrow></math> è¡¨ç¤ºæ¬§å‡ é‡Œå¾—èŒƒæ•°ã€‚

åœ¨æ¨èç³»ç»Ÿä¸­ç”Ÿæˆéçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ t-åˆ†å¸ƒéšæœºé‚»åŸŸåµŒå…¥ï¼ˆt-SNEï¼‰ã€‚t-SNE çš„å·¥ä½œåŸç†æ˜¯å¯¹é«˜ç»´ç©ºé—´ä¸­é¡¹ç›®ä¹‹é—´çš„æˆå¯¹ç›¸ä¼¼æ€§è¿›è¡Œå»ºæ¨¡ï¼Œç„¶åæ‰¾åˆ°ä¸€ä¸ªä¿æŒè¿™äº›ç›¸ä¼¼æ€§çš„ä½ç»´åµŒå…¥ã€‚

åœ¨ç°ä»£ï¼Œæ›´æµè¡Œçš„æ–¹æ³•æ˜¯ UMAPï¼Œå®ƒè¯•å›¾åœ¨å±€éƒ¨é‚»åŸŸä¸­ä¿æŒå¯†åº¦çš„æœ€å°æµå½¢ã€‚ UMAP æ˜¯åœ¨å¤æ‚å’Œé«˜ç»´æ½œåœ¨ç©ºé—´ä¸­å¯»æ‰¾ä½ç»´è¡¨ç¤ºçš„é‡è¦æŠ€æœ¯ï¼›æŸ¥é˜…å…¶æ–‡æ¡£ [*https://oreil.ly/NLqDg*](https://oreil.ly/NLqDg)ã€‚ä¼˜åŒ–é—®é¢˜é€šå¸¸è¢«åˆ¶å®šä¸ºä¸€ä¸ªæˆæœ¬å‡½æ•° *C*ï¼Œç”¨äºè¡¡é‡é«˜ç»´ç©ºé—´ä¸­æˆå¯¹ç›¸ä¼¼æ€§ä¸è¾ƒä½ç»´åº¦åµŒå…¥ä¸­ç›¸åº”ç›¸ä¼¼æ€§ä¹‹é—´çš„å·®å¼‚ï¼š

<math alttext="dollar-sign upper C left-parenthesis upper Y right-parenthesis equals sigma-summation Underscript left-parenthesis i comma j right-parenthesis Endscripts p Subscript i j Baseline asterisk l o g left-parenthesis StartFraction p Subscript i j Baseline Over q Subscript i j Baseline EndFraction right-parenthesis dollar-sign"><mrow><mi>C</mi> <mrow><mo>(</mo> <mi>Y</mi> <mo>)</mo></mrow> <mo>=</mo> <msub><mo>âˆ‘</mo> <mrow><mo>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>)</mo></mrow></msub> <msub><mi>p</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub> <mo>*</mo> <mi>l</mi> <mi>o</mi> <mi>g</mi> <mrow><mo>(</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>p</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub> <msub><mi>q</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub></mfrac></mstyle> <mo>)</mo></mrow></mrow></math>

è¿™é‡Œï¼Œ<math alttext="p Subscript i j"><msub><mi>p</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub></math> è¡¨ç¤ºé«˜ç»´ç©ºé—´ä¸­çš„æˆå¯¹ç›¸ä¼¼æ€§ï¼Œ<math alttext="q Subscript i j"><msub><mi>q</mi> <mrow><mi>i</mi><mi>j</mi></mrow></msub></math> è¡¨ç¤ºä½ç»´ç©ºé—´ä¸­çš„æˆå¯¹ç›¸ä¼¼æ€§ï¼Œæ±‚å’Œéå†æ‰€æœ‰é¡¹ç›®å¯¹<math alttext="left-parenthesis i comma j right-parenthesis"><mrow><mo>(</mo> <mi>i</mi> <mo>,</mo> <mi>j</mi> <mo>)</mo></mrow></math> ã€‚

éçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥è¿˜å¯ç”¨äºå°†é¢å¤–ä¿¡æ¯æ•´åˆåˆ°æ¨èç®—æ³•ä¸­ï¼Œä¾‹å¦‚é¡¹ç›®å†…å®¹æˆ–ç”¨æˆ·äººå£ç»Ÿè®¡æ•°æ®ã€‚é€šè¿‡ä½¿ç”¨éçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥æ¥è¡¨ç¤ºé¡¹ç›®å’Œé¢å¤–ä¿¡æ¯ï¼Œç®—æ³•å¯ä»¥åŸºäºç”¨æˆ·-é¡¹ç›®äº¤äº’æ•°æ®ä»¥åŠé¡¹ç›®å†…å®¹æˆ–ç”¨æˆ·äººå£ç»Ÿè®¡æ•°æ®æ•æ‰é¡¹ç›®ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œä»è€Œå®ç°æ›´å‡†ç¡®å’Œå¤šæ ·åŒ–çš„æ¨èã€‚

æ­¤å¤–ï¼Œéçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥è¿˜å¯ç”¨äºè§£å†³æ¨èç³»ç»Ÿä¸­çš„å†·å¯åŠ¨é—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨éçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥æ¥è¡¨ç¤ºé¡¹ç›®ï¼Œç®—æ³•å¯ä»¥åŸºäºå®ƒä»¬åœ¨åµŒå…¥ç©ºé—´ä¸­ä¸ç°æœ‰é¡¹ç›®çš„ç›¸ä¼¼æ€§ä¸ºæ–°é¡¹ç›®æä¾›å»ºè®®ï¼Œå³ä½¿åœ¨ç¼ºä¹ç”¨æˆ·äº¤äº’çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å®ç°ã€‚

æ€»ä¹‹ï¼Œéçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥æ˜¯æ¨èç³»ç»Ÿä¸­çš„ä¸€ç§æœ‰ç”¨æŠ€æœ¯ï¼Œç”¨äºåœ¨ä½ç»´ç©ºé—´ä¸­è¡¨ç¤ºç”¨æˆ·-é¡¹ç›®äº¤äº’çŸ©é˜µï¼Œä¿æŒé™„è¿‘é¡¹ç›®ä¹‹é—´çš„å±€éƒ¨è·ç¦»ã€‚éçº¿æ€§å±€éƒ¨å¯åº¦é‡åµŒå…¥å¯ä»¥ä½¿ç”¨è‡ªç¼–ç å™¨ç¥ç»ç½‘ç»œæˆ– t-SNE ç­‰æŠ€æœ¯ç”Ÿæˆï¼Œå¹¶å¯ç”¨äºæ•´åˆé¢å¤–ä¿¡æ¯ï¼Œè§£å†³å†·å¯åŠ¨é—®é¢˜ï¼Œå¹¶æé«˜æ¨èçš„å‡†ç¡®æ€§å’Œå¤šæ ·æ€§ã€‚

## å±…ä¸­æ ¸å¯¹é½

åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œé¢„æœŸæ¯ä¸€å±‚çš„æ½œåœ¨ç©ºé—´è¡¨ç¤ºèƒ½å¤Ÿè¡¨è¾¾ä¼ å…¥ä¿¡å·ä¹‹é—´çš„ç›¸å…³ç»“æ„ã€‚é€šå¸¸ï¼Œè¿™äº›å±‚é—´è¡¨ç¤ºç”±ä¸€ç³»åˆ—ä»åˆå§‹å±‚åˆ°æœ€ç»ˆå±‚çš„çŠ¶æ€è½¬æ¢ç»„æˆã€‚ä½ å¯èƒ½ä¼šè‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°ï¼šâ€œè¿™äº›è¡¨ç¤ºå¦‚ä½•éšç½‘ç»œå±‚æ¬¡å˜åŒ–è€Œå˜åŒ–ï¼Ÿâ€ä»¥åŠâ€œè¿™äº›å±‚æœ‰å¤šç›¸ä¼¼ï¼Ÿâ€æœ‰è¶£çš„æ˜¯ï¼Œå¯¹äºæŸäº›æ¶æ„ï¼Œè¿™ä¸ªé—®é¢˜å¯èƒ½æ­ç¤ºå‡ºç½‘ç»œè¡Œä¸ºçš„æ·±åˆ»è§è§£ã€‚

æ¯”è¾ƒå±‚è¡¨ç¤ºçš„è¿™ä¸€è¿‡ç¨‹ç§°ä¸º*ç›¸å…³åˆ†æ*ã€‚å¯¹äºå…·æœ‰å±‚ <math alttext="1 comma ellipsis comma upper N"><mrow><mn>1</mn> <mo>,</mo> <mo>...</mo> <mo>,</mo> <mi>N</mi></mrow></math> çš„ MLPï¼Œè¿™äº›ç›¸å…³æ€§å¯ä»¥é€šè¿‡ä¸€ä¸ª <math alttext="upper N times upper N"><mrow><mi>N</mi> <mo>Ã—</mo> <mi>N</mi></mrow></math> çš„çŸ©é˜µæ¥è¡¨ç¤ºæˆå¯¹å…³ç³»ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œæ¯ä¸€å±‚éƒ½åŒ…å«ä¸€ç³»åˆ—æ½œåœ¨å› ç´ ï¼Œç±»ä¼¼äºæ•°æ®é›†å…¶ä»–ç‰¹å¾çš„ç›¸å…³åˆ†æï¼Œè¿™äº›æ½œåœ¨ç‰¹å¾çš„å…³ç³»å¯ä»¥ç®€å•åœ°é€šè¿‡å®ƒä»¬çš„åæ–¹å·®è¿›è¡Œæ€»ç»“ã€‚

# äº²å’ŒåŠ›å’Œ p-sale

æ­£å¦‚ä½ æ‰€è§ï¼ŒMF æ˜¯ä¸€ç§å¼ºå¤§çš„é™ç»´æŠ€æœ¯ï¼Œå¯ä»¥ç”Ÿæˆé”€å”®æ¦‚ç‡çš„ä¼°ç®—å™¨ï¼ˆé€šå¸¸ç¼©å†™ä¸º*p-sale*ï¼‰ã€‚åœ¨ MF ä¸­ï¼Œç›®æ ‡æ˜¯å°†ç”¨æˆ·è¡Œä¸ºå’Œäº§å“é”€å”®çŸ©é˜µçš„å†å²æ•°æ®åˆ†è§£ä¸ºä¸¤ä¸ªä½ç»´çŸ©é˜µï¼šä¸€ä¸ªä»£è¡¨ç”¨æˆ·åå¥½ï¼Œå¦ä¸€ä¸ªä»£è¡¨äº§å“ç‰¹å¾ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†è¿™ä¸ª MF æ¨¡å‹è½¬æ¢ä¸ºé”€å”®ä¼°ç®—å™¨ã€‚

è®© <math alttext="upper R element-of double-struck upper R Superscript left-parenthesis upper M times upper N right-parenthesis"><mrow><mi>R</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>M</mi><mo>Ã—</mo><mi>N</mi><mo>)</mo></mrow></msup></mrow></math> æ˜¯å†å²æ•°æ®çŸ©é˜µï¼Œå…¶ä¸­ *M* æ˜¯ç”¨æˆ·æ•°ï¼Œ*N* æ˜¯äº§å“æ•°ã€‚MF çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸¤ä¸ªçŸ©é˜µ <math alttext="upper U element-of double-struck upper R Superscript left-parenthesis upper M times d right-parenthesis"><mrow><mi>U</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>M</mi><mo>Ã—</mo><mi>d</mi><mo>)</mo></mrow></msup></mrow></math> å’Œ <math alttext="upper V element-of double-struck upper R Superscript left-parenthesis upper N times d right-parenthesis"><mrow><mi>V</mi> <mo>âˆˆ</mo> <msup><mi>â„</mi> <mrow><mo>(</mo><mi>N</mi><mo>Ã—</mo><mi>d</mi><mo>)</mo></mrow></msup></mrow></math> ï¼Œå…¶ä¸­ <math alttext="d"><mi>d</mi></math> æ˜¯æ½œåœ¨ç©ºé—´çš„ç»´æ•°ï¼Œä½¿å¾—ï¼š

<math alttext="upper R asymptotically-equals upper U asterisk upper V Superscript upper T" display="block"><mrow><mi>R</mi> <mo>â‰ƒ</mo> <mi>U</mi> <mo>*</mo> <msup><mi>V</mi> <mi>T</mi></msup></mrow></math>

*é”€å”®çš„æ¦‚ç‡*ï¼Œæˆ–ç­‰æ•ˆåœ°è¯´ï¼Œé˜…è¯»ã€è§‚çœ‹ã€åƒæˆ–ç‚¹å‡»ï¼Œå¯ä»¥é€šè¿‡ MF é¢„æµ‹ï¼Œé¦–å…ˆå°†å†å²æ•°æ®çŸ©é˜µåˆ†è§£ä¸ºç”¨æˆ·å’Œäº§å“çŸ©é˜µï¼Œç„¶åè®¡ç®—ä¸€ä¸ªè¡¨ç¤ºç”¨æˆ·è´­ä¹°ç‰¹å®šäº§å“å¯èƒ½æ€§çš„åˆ†æ•°ã€‚è¿™ä¸ªåˆ†æ•°å¯ä»¥é€šè¿‡ç”¨æˆ·çŸ©é˜µä¸­å¯¹åº”è¡Œå’Œäº§å“çŸ©é˜µä¸­çš„åˆ—çš„ç‚¹ç§¯è®¡ç®—ï¼Œç„¶åé€šè¿‡é€»è¾‘å‡½æ•°å°†ç‚¹ç§¯è½¬æ¢ä¸ºæ¦‚ç‡åˆ†æ•°ã€‚

ä»æ•°å­¦ä¸Šè®²ï¼Œç”¨æˆ·*u*å’Œäº§å“*p*çš„é”€å”®æ¦‚ç‡å¯ä»¥è¡¨ç¤ºå¦‚ä¸‹ï¼š

<math alttext="upper P left-parenthesis u comma p right-parenthesis equals normal s normal i normal g normal m normal o normal i normal d left-parenthesis u asterisk p Superscript upper T Baseline right-parenthesis" display="block"><mrow><mi>P</mi> <mrow><mo>(</mo> <mi>u</mi> <mo>,</mo> <mi>p</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>sigmoid</mi> <mrow><mo>(</mo> <mi>u</mi> <mo>*</mo> <msup><mi>p</mi> <mi>T</mi></msup> <mo>)</mo></mrow></mrow></math>

è¿™é‡Œï¼Œsigmoid æ˜¯å°†ç”¨æˆ·å’Œäº§å“å‘é‡çš„ç‚¹ç§¯æ˜ å°„åˆ°ä»‹äº 0 å’Œ 1 ä¹‹é—´çš„æ¦‚ç‡åˆ†æ•°çš„é€»è¾‘å‡½æ•°ï¼š

<math alttext="s i g m o i d left-parenthesis x right-parenthesis equals 1 slash left-parenthesis 1 plus e x p left-parenthesis negative x right-parenthesis right-parenthesis" display="block"><mrow><mi>s</mi> <mi>i</mi> <mi>g</mi> <mi>m</mi> <mi>o</mi> <mi>i</mi> <mi>d</mi> <mo>(</mo> <mi>x</mi> <mo>)</mo> <mo>=</mo> <mn>1</mn> <mo>/</mo> <mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>e</mi> <mi>x</mi> <mi>p</mi> <mo>(</mo> <mo>-</mo> <mi>x</mi> <mo>)</mo> <mo>)</mo></mrow></math>

<math alttext="p Superscript upper T"><msup><mi>p</mi> <mi>T</mi></msup></math>è¡¨ç¤ºäº§å“å‘é‡çš„è½¬ç½®ã€‚ç”¨æˆ·å’Œäº§å“å‘é‡çš„ç‚¹ç§¯æ˜¯ç”¨æˆ·åå¥½ä¸äº§å“ç‰¹æ€§ä¹‹é—´ç›¸ä¼¼æ€§çš„åº¦é‡ï¼Œé€»è¾‘å‡½æ•°å°†æ­¤ç›¸ä¼¼æ€§åˆ†æ•°æ˜ å°„åˆ°æ¦‚ç‡åˆ†æ•°ã€‚

ç”¨æˆ·å’Œäº§å“çŸ©é˜µå¯ä»¥é€šè¿‡ä½¿ç”¨å„ç§ MF ç®—æ³•ï¼ˆå¦‚ SVDã€NMF æˆ– ALSï¼‰åœ¨å†å²æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒã€‚ä¸€æ—¦çŸ©é˜µè®­ç»ƒå¥½äº†ï¼Œå¯ä»¥å°†ç‚¹ç§¯å’Œé€»è¾‘å‡½æ•°åº”ç”¨äºæ–°çš„ç”¨æˆ·-äº§å“å¯¹ï¼Œä»¥é¢„æµ‹é”€å”®çš„æ¦‚ç‡ã€‚é¢„æµ‹çš„æ¦‚ç‡å¯ä»¥ç”¨æ¥å¯¹ç”¨æˆ·è¿›è¡Œäº§å“æ’åå’Œæ¨èã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äº ALS çš„æŸå¤±å‡½æ•°æ˜¯å‡¸çš„ï¼ˆæ„å‘³ç€å­˜åœ¨å”¯ä¸€çš„å…¨å±€æœ€å°å€¼ï¼‰ï¼Œå½“æˆ‘ä»¬å›ºå®šç”¨æˆ·æˆ–ç‰©å“çŸ©é˜µæ—¶ï¼Œæ”¶æ•›é€Ÿåº¦å¯èƒ½ä¼šå¾ˆå¿«ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œå›ºå®šç”¨æˆ·çŸ©é˜µï¼Œè§£å†³ç‰©å“çŸ©é˜µã€‚ç„¶åå›ºå®šç‰©å“çŸ©é˜µï¼Œè§£å†³ç”¨æˆ·çŸ©é˜µã€‚è¯¥æ–¹æ³•åœ¨ä¸¤ç§è§£ä¹‹é—´äº¤æ›¿ï¼Œå¹¶ä¸”å› ä¸ºåœ¨è¿™ä¸ªèŒƒå›´å†…æŸå¤±æ˜¯å‡¸çš„ï¼Œæ‰€ä»¥æ–¹æ³•ä¼šè¿…é€Ÿæ”¶æ•›ã€‚

ç”¨æˆ·çŸ©é˜µä¸­å¯¹åº”è¡Œå’Œäº§å“çŸ©é˜µä¸­åˆ—çš„ç‚¹ç§¯è¡¨ç¤ºç”¨æˆ·å’Œäº§å“ä¹‹é—´çš„äº²å’Œåˆ†æ•°ï¼Œæˆ–è€…è¯´ç”¨æˆ·åå¥½ä¸äº§å“ç‰¹æ€§åŒ¹é…çš„ç¨‹åº¦ã€‚ç„¶è€Œï¼Œä»…å‡­è¿™ä¸ªåˆ†æ•°å¯èƒ½ä¸è¶³ä»¥é¢„æµ‹ç”¨æˆ·æ˜¯å¦ä¼šå®é™…è´­ä¹°äº§å“ã€‚

åœ¨ MF æ¨¡å‹ä¸­ï¼Œåº”ç”¨äºç‚¹ç§¯çš„é€»è¾‘å‡½æ•°å°†äº²å’Œåˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡åˆ†æ•°ï¼Œè¯¥åˆ†æ•°è¡¨ç¤ºé”€å”®çš„å¯èƒ½æ€§ã€‚æ­¤è½¬æ¢è€ƒè™‘äº†é™¤ç”¨æˆ·åå¥½å’Œäº§å“ç‰¹æ€§å¤–çš„é¢å¤–å› ç´ ï¼Œä¾‹å¦‚äº§å“çš„æ•´ä½“æµè¡Œåº¦ã€ç”¨æˆ·çš„è´­ä¹°è¡Œä¸ºä»¥åŠå…¶ä»–ç›¸å…³çš„å¤–éƒ¨å› ç´ ã€‚é€šè¿‡æ•´åˆè¿™äº›é¢å¤–å› ç´ ï¼ŒMF èƒ½å¤Ÿæ›´å¥½åœ°é¢„æµ‹é”€å”®çš„æ¦‚ç‡ï¼Œè€Œä¸ä»…ä»…æ˜¯äº²å’Œåˆ†æ•°ã€‚

ä¸€ä¸ªæ¯”è¾ƒåº“ï¼ˆä¸è¿‡ä¸åœ¨ JAX ä¸­ï¼‰ç”¨äºçº¿æ€§è®¡ç®—æ½œåœ¨åµŒå…¥æ˜¯ [libFM](http://libfm.org)ã€‚å› å­æœºçš„å…¬å¼ç±»ä¼¼äº GloVe åµŒå…¥ï¼Œå®ƒä¹Ÿæ¨¡æ‹Ÿä¸¤ä¸ªå‘é‡ä¹‹é—´çš„äº¤äº’ï¼Œä½†ç‚¹ç§¯å¯ä»¥ç”¨äºå›å½’æˆ–äºŒå…ƒåˆ†ç±»ä»»åŠ¡ã€‚è¯¥æ–¹æ³•è¿˜å¯ä»¥æ‰©å±•åˆ°æ¨èè¶…è¿‡ç”¨æˆ·å’Œé¡¹ç›®ä¸¤ç§ç±»å‹çš„ç‰©å“ã€‚

æ€»ä¹‹ï¼ŒçŸ©é˜µå› å­åŒ–ï¼ˆMFï¼‰ä¸ä»…é€šè¿‡å°†ç”¨æˆ·åå¥½å’Œäº§å“ç‰¹æ€§ä¹‹å¤–çš„å› ç´ æ•´åˆï¼Œäº§ç”Ÿé”€å”®æ¦‚ç‡è€Œéä»…ä»…äº²å’ŒåŠ›è¯„åˆ†ï¼Œè¿˜é€šè¿‡ä½¿ç”¨ logistic å‡½æ•°å°†äº²å’ŒåŠ›åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡åˆ†æ•°ã€‚

# æ¨èç³»ç»Ÿè¯„ä¼°çš„å€¾å‘åˆ†é…åŠ æƒ

å¦‚æ‚¨æ‰€è§ï¼Œæ¨èç³»ç»Ÿæ˜¯æ ¹æ®ç”¨æˆ·åé¦ˆè¿›è¡Œè¯„ä¼°çš„ï¼Œè¿™äº›åé¦ˆæ¥è‡ªéƒ¨ç½²çš„æ¨èç³»ç»Ÿã€‚ç„¶è€Œï¼Œè¿™äº›æ•°æ®å—åˆ°éƒ¨ç½²ç³»ç»Ÿçš„å› æœå½±å“ï¼Œå½¢æˆäº†ä¸€ä¸ªåé¦ˆå¾ªç¯ï¼Œå¯èƒ½ä¼šåå‘è¯„ä¼°æ–°æ¨¡å‹ã€‚è¿™ç§åé¦ˆå¾ªç¯å¯èƒ½å¯¼è‡´æ··æ‚å˜é‡ï¼Œä½¿å¾—å¾ˆéš¾åŒºåˆ†ç”¨æˆ·åå¥½å’Œéƒ¨ç½²ç³»ç»Ÿå½±å“ä¹‹é—´çš„å…³ç³»ã€‚

å¦‚æœè¿™è®©æ‚¨æ„Ÿåˆ°æƒŠè®¶ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹ï¼Œæ¨èç³»ç»Ÿ*ä¸*å¯¹ç”¨æˆ·é‡‡å–çš„è¡ŒåŠ¨å’Œ/æˆ–è¿™äº›è¡ŒåŠ¨å¯¼è‡´çš„ç»“æœäº§ç”Ÿå› æœå½±å“ï¼Œè¿™éœ€è¦å‡è®¾åƒâ€œç”¨æˆ·å®Œå…¨å¿½è§†æ¨èâ€å’Œâ€œç³»ç»Ÿéšæœºæ¨èâ€ã€‚å€¾å‘åˆ†é…å¯ä»¥å‡è½»è¿™ä¸ªé—®é¢˜çš„ä¸€äº›æœ€åå½±å“ã€‚

æ¨èç³»ç»Ÿçš„æ€§èƒ½å–å†³äºè®¸å¤šå› ç´ ï¼ŒåŒ…æ‹¬ç”¨æˆ·-é¡¹ç›®ç‰¹å¾ã€ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œè¶‹åŠ¿ï¼Œè¿™äº›å› ç´ å¯ä»¥å½±å“æ¨èçš„è´¨é‡å’Œç”¨æˆ·å‚ä¸åº¦ã€‚ç„¶è€Œï¼Œå½±å“å¯èƒ½æ˜¯ç›¸äº’çš„ï¼šç”¨æˆ·äº’åŠ¨å½±å“æ¨èç³»ç»Ÿï¼Œåä¹‹äº¦ç„¶ã€‚å› æ­¤ï¼Œè¯„ä¼°æ¨èç³»ç»Ÿå¯¹ç”¨æˆ·è¡Œä¸ºå’Œæ»¡æ„åº¦çš„å› æœæ•ˆåº”æ˜¯ä¸€é¡¹å…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ï¼Œå› ä¸ºå®ƒéœ€è¦æ§åˆ¶æ½œåœ¨çš„æ··æ‚å› ç´ â€”â€”è¿™äº›å› ç´ å¯èƒ½å½±å“æ²»ç–—åˆ†é…ï¼ˆæ¨èç­–ç•¥ï¼‰å’Œæ„Ÿå…´è¶£çš„ç»“æœï¼ˆç”¨æˆ·å¯¹æ¨èçš„å“åº”ï¼‰ã€‚

å› æœæ¨æ–­ä¸ºè§£å†³è¿™äº›æŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªæ¡†æ¶ã€‚åœ¨æ¨èç³»ç»Ÿçš„èƒŒæ™¯ä¸‹ï¼Œå› æœæ¨æ–­å¯ä»¥å¸®åŠ©å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š

+   æ¨èç­–ç•¥çš„é€‰æ‹©å¦‚ä½•å½±å“ç”¨æˆ·å‚ä¸åº¦ï¼Œå¦‚ç‚¹å‡»ç‡ã€è´­ä¹°ç‡å’Œæ»¡æ„åº¦è¯„åˆ†ï¼Ÿ

+   å¯¹äºç»™å®šç”¨æˆ·æ®µã€é¡¹ç›®ç±»åˆ«æˆ–ä¸Šä¸‹æ–‡ï¼Œä»€ä¹ˆæ˜¯æœ€ä½³æ¨èç­–ç•¥ï¼Ÿ

+   æ¨èç­–ç•¥å¯¹ç”¨æˆ·ä¿ç•™ã€å¿ è¯šåº¦å’Œç”Ÿå‘½å‘¨æœŸä»·å€¼çš„é•¿æœŸå½±å“æ˜¯ä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬å°†é€šè¿‡ä»‹ç»å› æœæ¨æ–­ä¸­ä¸€ä¸ªå¯¹æ¨èç³»ç»Ÿè‡³å…³é‡è¦çš„æ–¹é¢æ¥ç»“æŸæœ¬ç« ï¼ŒåŸºäºå€¾å‘å¾—åˆ†çš„æ¦‚å¿µã€‚æˆ‘ä»¬å°†ä»‹ç»å€¾å‘æ€§ï¼Œä»¥é‡åŒ–å‘ç”¨æˆ·å±•ç¤ºæŸäº›é¡¹çš„è°ƒæ•´åå¯èƒ½æ€§ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†çœ‹åˆ°è¿™å¦‚ä½•ä¸è‘—åçš„è¾›æ™®æ£®æ‚–è®ºäº’åŠ¨ã€‚

## å€¾å‘æ€§

åœ¨è®¸å¤šæ•°æ®ç§‘å­¦é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å¤„ç†æ··æ‚å› ç´ ï¼Œç‰¹åˆ«æ˜¯æ··æ‚å› ç´ ä¸ç›®æ ‡ç»“æœä¹‹é—´çš„ç›¸å…³æ€§ã€‚æ ¹æ®è®¾ç½®çš„ä¸åŒï¼Œæ··æ‚å› ç´ å¯èƒ½å…·æœ‰å„ç§å½¢å¼ã€‚æœ‰è¶£çš„æ˜¯ï¼Œåœ¨æ¨èç³»ç»Ÿä¸­ï¼Œè¿™ç§æ··æ‚å› ç´ å¯èƒ½æ˜¯ç³»ç»Ÿæœ¬èº«ï¼æ¨èç³»ç»Ÿçš„ç¦»çº¿è¯„ä¼°å—ç”¨æˆ·çš„é¡¹ç›®é€‰æ‹©è¡Œä¸ºå’Œéƒ¨ç½²çš„æ¨èç³»ç»Ÿäº§ç”Ÿçš„æ··æ‚å› ç´ çš„å½±å“ã€‚

å¦‚æœè¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥æœ‰ç‚¹å¾ªç¯ï¼Œå®ƒç¡®å®æœ‰ç‚¹ã€‚è¿™æœ‰æ—¶è¢«ç§°ä¸º*é—­ç¯åé¦ˆ*ã€‚ç¼“è§£çš„ä¸€ç§æ–¹æ³•æ˜¯å€¾å‘åŠ æƒï¼Œé€šè¿‡è€ƒè™‘æ¯ä¸ªåé¦ˆåœ¨ç›¸åº”å±‚æ¬¡ä¸Šçš„ä¼°è®¡å€¾å‘æ€§æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½ å¯èƒ½è¿˜è®°å¾—*å€¾å‘æ€§*æŒ‡çš„æ˜¯ç”¨æˆ·çœ‹åˆ°æŸä¸ªé¡¹çš„å¯èƒ½æ€§ï¼›é€šè¿‡å…¶å€’æ•°åŠ æƒï¼Œæˆ‘ä»¬å¯ä»¥æŠµæ¶ˆé€‰æ‹©åå·®ã€‚ä¸æ ‡å‡†çš„ç¦»çº¿ç•™ç½®è¯„ä¼°ç›¸æ¯”ï¼Œè¿™ç§æ–¹æ³•è¯•å›¾ä»£è¡¨æ‰€è€ƒè™‘çš„æ¨èæ¨¡å‹çš„å®é™…æ•ˆç”¨ã€‚

# åˆ©ç”¨åäº‹å®æ¨æ–­

ç¼“è§£é€‰æ‹©åå·®çš„å¦ä¸€ç§æ–¹æ³•æ˜¯*åäº‹å®è¯„ä¼°*ï¼Œå®ƒä½¿ç”¨ç±»ä¼¼äºå¼ºåŒ–å­¦ä¹ ä¸­çš„ç¦»çº¿ç­–ç•¥è¯„ä¼°æ–¹æ³•çš„å€¾å‘åŠ æƒæŠ€æœ¯æ¥ä¼°è®¡æ¨èæ¨¡å‹çš„å®é™…æ•ˆç”¨ã€‚ç„¶è€Œï¼Œåäº‹å®è¯„ä¼°é€šå¸¸ä¾èµ–äºåœ¨å¼€ç¯è®¾ç½®ä¸­å‡†ç¡®è®°å½•å€¾å‘æ€§ï¼Œå…¶ä¸­ä¸€äº›éšæœºé¡¹ç›®ä¼šæš´éœ²ç»™ç”¨æˆ·ï¼Œè¿™å¯¹å¤§å¤šæ•°æ¨èé—®é¢˜æ¥è¯´æ˜¯ä¸å®é™…çš„ã€‚å¦‚æœæ‚¨å¯ä»¥é€‰æ‹©å‘ç”¨æˆ·æä¾›éšæœºæ¨èä»¥è¿›è¡Œè¯„åˆ†ï¼Œè¿™ä¹Ÿå¯ä»¥å¸®åŠ©å»åå·®ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä¸åŸºäº RL çš„æ¨èç³»ç»Ÿç»“åˆä½¿ç”¨ï¼Œåè€…ä½¿ç”¨æ¢ç´¢-åˆ©ç”¨æ–¹æ³•ï¼Œå¦‚å¤šè‡‚è€è™æœºæˆ–å…¶ä»–ç»“æ„åŒ–éšæœºåŒ–ã€‚

*åå‘å€¾å‘è¯„åˆ†*ï¼ˆ*IPS*ï¼‰æ˜¯ä¸€ç§åŸºäºå€¾å‘æ€§çš„è¯„ä¼°æ–¹æ³•ï¼Œåˆ©ç”¨é‡è¦æ€§æŠ½æ ·æ¥è€ƒè™‘éƒ¨ç½²çš„æ¨èç³»ç»Ÿæ”¶é›†çš„åé¦ˆä¸æ˜¯å‡åŒ€éšæœºçš„äº‹å®ã€‚å€¾å‘æ€§è¯„åˆ†æ˜¯ä¸€ä¸ªå¹³è¡¡å› å­ï¼Œå®ƒè°ƒæ•´äº†åŸºäºå€¾å‘æ€§è¯„åˆ†çš„è§‚å¯Ÿåˆ°çš„åé¦ˆåˆ†å¸ƒã€‚å¦‚æœå¼€ç¯åé¦ˆå¯ä»¥ä»æ‰€æœ‰å¯èƒ½çš„é¡¹ç›®ä¸­å‡åŒ€éšæœºæŠ½æ ·ï¼Œé‚£ä¹ˆ IPS è¯„ä¼°æ–¹æ³•åœ¨ç†è®ºä¸Šæ˜¯æ— åçš„ã€‚åœ¨ç¬¬ä¸‰ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†é©¬å¤ªæ•ˆåº”ï¼Œæˆ–è€…æ¨èç³»ç»Ÿçš„â€œå¯Œè€…æ„ˆå¯Œâ€ç°è±¡ï¼›IPS æ˜¯å¯¹æŠ—è¿™ç§æ•ˆåº”çš„ä¸€ç§æ–¹å¼ã€‚æ³¨æ„è¿™é‡Œé©¬å¤ªæ•ˆåº”å’Œè¾›æ™®æ£®æ‚–è®ºä¹‹é—´çš„å…³ç³»ï¼Œå½“åœ¨ä¸åŒçš„åˆ†å±‚ä¸­ï¼Œé€‰æ‹©æ•ˆåº”äº§ç”Ÿäº†æ˜¾è‘—çš„åå€šæ—¶ï¼Œè¿™ç§å…³ç³»æ˜¯å­˜åœ¨çš„ã€‚

å€¾å‘æ€§åŠ æƒåŸºäºè¿™æ ·ä¸€ä¸ªæ€æƒ³ï¼šéƒ¨ç½²çš„æ¨èç³»ç»Ÿä½¿ä¸€ä¸ªé¡¹ç›®æš´éœ²ç»™ç”¨æˆ·çš„æ¦‚ç‡ï¼ˆå€¾å‘æ€§è¯„åˆ†ï¼‰ä¼šå½±å“åˆ°ä»è¯¥ç”¨æˆ·æ”¶é›†åˆ°çš„åé¦ˆã€‚é€šè¿‡æ ¹æ®å€¾å‘æ€§è¯„åˆ†é‡æ–°åŠ æƒåé¦ˆï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ç”±éƒ¨ç½²ç³»ç»Ÿå¼•å…¥çš„åå€šï¼Œå¹¶è·å¾—å¯¹æ–°æ¨èæ¨¡å‹æ›´å‡†ç¡®çš„è¯„ä¼°ã€‚

è¦åº”ç”¨ IPSï¼Œæˆ‘ä»¬éœ€è¦ä¼°è®¡æ”¶é›†åˆ°çš„åé¦ˆæ•°æ®é›†ä¸­æ¯ä¸ªé¡¹ç›®-ç”¨æˆ·äº¤äº’çš„å€¾å‘æ€§è¯„åˆ†ã€‚è¿™å¯ä»¥é€šè¿‡å»ºæ¨¡éƒ¨ç½²ç³»ç»Ÿåœ¨äº¤äº’æ—¶ä¼šæš´éœ²é¡¹ç›®ç»™ç”¨æˆ·çš„æ¦‚ç‡æ¥å®ç°ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨é¡¹ç›®çš„æµè¡Œåº¦ä½œä¸ºå…¶å€¾å‘æ€§è¯„åˆ†çš„ä»£ç†ã€‚ç„¶è€Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„æ–¹æ³•æ¥åŸºäºç”¨æˆ·å’Œé¡¹ç›®ç‰¹å¾ä»¥åŠäº¤äº’çš„ä¸Šä¸‹æ–‡æ¥å»ºæ¨¡å€¾å‘æ€§è¯„åˆ†ã€‚

ä¸€æ—¦ä¼°è®¡å‡ºå€¾å‘æ€§è¯„åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡è¦æ€§æŠ½æ ·é‡æ–°åŠ æƒåé¦ˆã€‚å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªåé¦ˆéƒ½è¢«å…¶å€¾å‘æ€§è¯„åˆ†çš„å€’æ•°åŠ æƒï¼Œä»¥ä¾¿æ›´å¯èƒ½ç”±éƒ¨ç½²ç³»ç»Ÿæš´éœ²çš„é¡¹ç›®è¢«é™æƒï¼Œè€Œæ›´ä¸å¯èƒ½è¢«æš´éœ²çš„é¡¹ç›®åˆ™è¢«å‡æƒã€‚è¿™ç§é‡æ–°åŠ æƒè¿‡ç¨‹è¿‘ä¼¼äºä»äººæ°”å‡åŒ€åˆ†å¸ƒçš„æ¨èä¸­è·å¾—çš„åé¦ˆçš„åäº‹å®åˆ†å¸ƒã€‚

æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é‡æ–°åŠ æƒçš„åé¦ˆé€šè¿‡æ ‡å‡†çš„è¯„ä¼°æŒ‡æ ‡æ¥è¯„ä¼°æ–°æ¨èæ¨¡å‹ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨æœ¬ç« ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚ç„¶åï¼Œé€šè¿‡ä½¿ç”¨é‡æ–°åŠ æƒçš„åé¦ˆï¼Œå°†æ–°æ¨¡å‹çš„æ•ˆæœä¸éƒ¨ç½²ç³»ç»Ÿçš„æ•ˆæœè¿›è¡Œæ¯”è¾ƒï¼Œæä¾›å¯¹æ–°æ¨¡å‹æ€§èƒ½æ›´å…¬å¹³ã€æ›´å‡†ç¡®çš„è¯„ä¼°ã€‚

## è¾›æ™®æ£®æ°å’Œç¼“è§£æ··æ‚å˜é‡

*è¾›æ™®æ£®æ‚–è®º*æ˜¯åŸºäºä¸€ä¸ªæ··æ‚å˜é‡çš„æ¦‚å¿µï¼Œè¯¥æ··æ‚å˜é‡å»ºç«‹äº†æˆ‘ä»¬çœ‹åˆ°ï¼ˆå¯èƒ½è¯¯å¯¼æ€§çš„ï¼‰åå˜é‡çš„åˆ†å±‚ã€‚å½“è°ƒæŸ¥ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å…³è”æ€§æ—¶ï¼Œä½†è¿™äº›å˜é‡å—åˆ°æ··æ‚å˜é‡çš„å¼ºçƒˆå½±å“æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§æ‚–è®ºã€‚

å¯¹äºæ¨èç³»ç»Ÿï¼Œè¿™ä¸ªæ··æ·†å˜é‡æ˜¯éƒ¨ç½²æ¨¡å‹çš„ç‰¹å¾å’Œé€‰æ‹©è¶‹åŠ¿ã€‚å€¾å‘åˆ†æ•°è¢«å¼•å…¥ä¸ºç³»ç»Ÿä»æ— åå¼€ç¯æš´éœ²åœºæ™¯åç¦»çš„åº¦é‡ã€‚æ­¤åˆ†æ•°å…è®¸åŸºäºè§‚å¯Ÿåˆ°çš„é—­ç¯åé¦ˆè®¾è®¡å’Œåˆ†ææ¨èæ¨¡å‹çš„ç¦»çº¿è¯„ä¼°ï¼Œæ¨¡æ‹Ÿå¼€ç¯åœºæ™¯çš„æŸäº›ç‰¹å®šç‰¹å¾ã€‚

ä¼ ç»Ÿçš„è¾›æ™®æ£®æ‚–è®ºæè¿°é€šå¸¸å»ºè®®åˆ†å±‚ï¼Œè¿™æ˜¯ä¸€ç§é€šè¿‡é¦–å…ˆè¯†åˆ«åº•å±‚åˆ†å±‚æ¥è¯†åˆ«å’Œä¼°è®¡å› æœæ•ˆåº”çš„ä¼—æ‰€å‘¨çŸ¥æ–¹æ³•ã€‚å¯¹äºæ¨èç³»ç»Ÿï¼Œè¿™æ¶‰åŠæ ¹æ®éƒ¨ç½²æ¨¡å‹ç‰¹å¾çš„å¯èƒ½å€¼åˆ†å±‚è§‚å¯Ÿç»“æœï¼Œè¯¥ç‰¹å¾æ˜¯æ··æ·†å˜é‡ã€‚

ç”¨æˆ·ç‹¬ç«‹å€¾å‘åˆ†æ•°é€šè¿‡ä½¿ç”¨å…ˆéªŒæ¦‚ç‡æ¥ä¼°è®¡ï¼Œå³éƒ¨ç½²æ¨¡å‹æ¨èé¡¹ç›®çš„å…ˆéªŒæ¦‚ç‡ï¼Œä»¥åŠåœ¨æ¨èæ—¶ç”¨æˆ·ä¸é¡¹ç›®äº¤äº’çš„æ¡ä»¶æ¦‚ç‡è¿›è¡Œä¸¤æ­¥ç”Ÿæˆè¿‡ç¨‹ä¼°è®¡ã€‚åŸºäºä¸€ç³»åˆ—æ¸©å’Œå‡è®¾ï¼ˆä½†åœ¨è¿™é‡Œæ•°å­¦ä¸Šå¤ªæŠ€æœ¯åŒ–ï¼Œä¸äºˆè¯¦ç»†è®¨è®ºï¼‰ï¼Œå¯ä»¥ä½¿ç”¨æ¯ä¸ªæ•°æ®é›†çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç”¨æˆ·ç‹¬ç«‹å€¾å‘åˆ†æ•°ã€‚

æˆ‘ä»¬éœ€è¦å®šä¹‰ç”¨æˆ·å€¾å‘åˆ†æ•° <math alttext="p Subscript u comma i"><msub><mi>p</mi> <mrow><mi>u</mi><mo>,</mo><mi>i</mi></mrow></msub></math> ï¼Œè¿™è¡¨ç¤ºéƒ¨ç½²æ¨¡å‹æš´éœ²é¡¹ç›® <math alttext="i element-of upper I"><mrow><mi>i</mi> <mo>âˆˆ</mo> <mi>I</mi></mrow></math> ç»™ç”¨æˆ· <math alttext="u element-of upper U"><mrow><mi>u</mi> <mo>âˆˆ</mo> <mi>U</mi></mrow></math> çš„å€¾å‘æˆ–é¢‘ç‡ã€‚åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å¯¹ç”¨æˆ·è¿›è¡Œè¾¹é™…åŒ–ï¼Œå¾—åˆ°ç”¨æˆ·ç‹¬ç«‹å€¾å‘åˆ†æ•° <math alttext="p Subscript asterisk comma i"><msub><mi>p</mi> <mrow><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub></math> ã€‚æ­£å¦‚ Longqi Yang ç­‰äººåœ¨ [â€œä¸åç¦»çº¿æ¨èç³»ç»Ÿè¯„ä¼°çš„éšå¼åé¦ˆâ€](https://oreil.ly/mpM87) ä¸­æ‰€è¿°ï¼Œæ–¹ç¨‹å¦‚ä¸‹ï¼š

<math alttext="p Subscript asterisk comma i Baseline alpha left-parenthesis n Subscript i Superscript asterisk Baseline right-parenthesis Superscript StartFraction gamma plus 1 Over 2 EndFraction" display="block"><mrow><msub><mi>p</mi> <mrow><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub> <mi>Î±</mi> <msup><mfenced close=")" open="(" separators=""><msubsup><mi>n</mi> <mi>i</mi> <mo>*</mo></msubsup></mfenced> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>Î³</mi><mo>+</mo><mn>1</mn></mrow> <mn>2</mn></mfrac></mstyle></msup></mrow></math>

åœ¨è¿™é‡Œï¼Œ<math alttext="n Subscript i Superscript asterisk"><msubsup><mi>n</mi> <mi>i</mi> <mo>*</mo></msubsup></math> æ˜¯é¡¹ç›® <math alttext="i"><mi>i</mi></math> ä¸ä¹‹äº¤äº’çš„æ€»æ¬¡æ•°ï¼Œ<math alttext="gamma"><mi>Î³</mi></math> æ˜¯å½±å“ä¸åŒè§‚å¯Ÿæµè¡Œåº¦çš„å€¾å‘åˆ†å¸ƒçš„å‚æ•°ã€‚å¹‚å¾‹å‚æ•° <math alttext="gamma"><mi>Î³</mi></math> å½±å“é¡¹ç›®çš„å€¾å‘åˆ†å¸ƒï¼Œå¹¶ä¸”ä¾èµ–äºç ”ç©¶çš„æ•°æ®é›†ï¼›æˆ‘ä»¬ä½¿ç”¨æ¯ä¸ªæ•°æ®é›†çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ <math alttext="gamma"><mi>Î³</mi></math> å‚æ•°ã€‚

ä½¿ç”¨è¿™äº›å€¾å‘ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è®¡ç®—åé¦ˆæ•ˆæœæ—¶åº”ç”¨ç®€å•çš„åæƒé‡<math alttext="w Subscript i Baseline equals StartFraction 1 Over p Subscript i Baseline EndFraction"><mrow><msub><mi>w</mi> <mi>i</mi></msub> <mo>=</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn> <msub><mi>p</mi> <mi>i</mi></msub></mfrac></mstyle></mrow></math>ã€‚æœ€åï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›æƒé‡ä¸å€¾å‘åŒ¹é…ç»“åˆèµ·æ¥ï¼Œç”Ÿæˆåäº‹å®æ¨èï¼›é€šè¿‡æ”¶é›†å¤§è‡´ç›¸ç­‰çš„å€¾å‘é¡¹ç›®åˆ°åˆ†å±‚ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›åˆ†å±‚ç”¨ä½œæ··æ‚å˜é‡ã€‚

# åŒé‡ç¨³å¥ä¼°è®¡

åŒé‡ç¨³å¥ä¼°è®¡ï¼ˆDREï¼‰æ˜¯ä¸€ç§ç»“åˆä¸¤ä¸ªæ¨¡å‹çš„æ–¹æ³•ï¼šä¸€ä¸ªæ¨¡å‹å»ºæ¨¡æ¥å—æ²»ç–—ï¼ˆé€šè¿‡å·²éƒ¨ç½²æ¨¡å‹æ¨èé¡¹ç›®ï¼‰çš„æ¦‚ç‡ï¼Œå¦ä¸€ä¸ªæ¨¡å‹å»ºæ¨¡æ„Ÿå…´è¶£çš„ç»“æœï¼ˆç”¨æˆ·å¯¹é¡¹ç›®çš„åé¦ˆï¼‰ã€‚åœ¨ DRE ä¸­ä½¿ç”¨çš„æƒé‡å–å†³äºè¿™ä¸¤ä¸ªæ¨¡å‹çš„é¢„æµ‹æ¦‚ç‡ã€‚è¯¥æ–¹æ³•çš„ä¼˜ç‚¹åœ¨äºï¼Œå³ä½¿å…¶ä¸­ä¸€ä¸ªæ¨¡å‹è¢«é”™è¯¯è§„å®šï¼Œå®ƒä»ç„¶å¯ä»¥æä¾›æ— åä¼°è®¡ã€‚

å…·æœ‰å€¾å‘åˆ†æ•°åŠ æƒå’Œç»“æœæ¨¡å‹çš„åŒé‡ç¨³å¥ä¼°è®¡å™¨çš„ç»“æ„æ–¹ç¨‹å¦‚ä¸‹ï¼š

<math alttext="normal upper Theta equals StartFraction sigma-summation w Subscript i Baseline left-parenthesis upper Y Subscript i Baseline minus f left-parenthesis upper X Subscript i Baseline right-parenthesis right-parenthesis Over sigma-summation w Subscript i Baseline left-parenthesis upper T Subscript i Baseline minus p Subscript i Baseline right-parenthesis plus sigma-summation w Subscript i Baseline left-parenthesis p Subscript i Baseline left-parenthesis 1 minus p Subscript i Baseline right-parenthesis squared left-parenthesis f left-parenthesis upper X Subscript i Baseline right-parenthesis minus f Superscript asterisk Baseline left-parenthesis upper X Subscript i Baseline right-parenthesis right-parenthesis right-parenthesis EndFraction" display="block"><mrow><mi>Î˜</mi> <mo>=</mo> <mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>âˆ‘</mo><msub><mi>w</mi> <mi>i</mi></msub> <mfenced close=")" open="(" separators=""><msub><mi>Y</mi> <mi>i</mi></msub> <mo>-</mo><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi> <mi>i</mi></msub> <mo>)</mo></mrow></mfenced></mrow> <mrow><mo>âˆ‘</mo><msub><mi>w</mi> <mi>i</mi></msub> <mfenced close=")" open="(" separators=""><msub><mi>T</mi> <mi>i</mi></msub> <mo>-</mo><msub><mi>p</mi> <mi>i</mi></msub></mfenced> <mo>+</mo><mo>âˆ‘</mo><msub><mi>w</mi> <mi>i</mi></msub> <mfenced close=")" open="(" separators=""><msub><mi>p</mi> <mi>i</mi></msub> <msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi> <mi>i</mi></msub> <mo>)</mo></mrow> <mn>2</mn></msup> <mfenced close=")" open="(" separators=""><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi> <mi>i</mi></msub> <mo>)</mo></mrow><mo>-</mo><msup><mi>f</mi> <mo>*</mo></msup> <mrow><mo>(</mo><msub><mi>X</mi> <mi>i</mi></msub> <mo>)</mo></mrow></mfenced></mfenced></mrow></mfrac></mstyle></mrow></math>

è¿™é‡Œï¼Œ<math alttext="upper Y Subscript i"><msub><mi>Y</mi> <mi>i</mi></msub></math> æ˜¯ç»“æœï¼Œ<math alttext="upper X Subscript i"><msub><mi>X</mi> <mi>i</mi></msub></math> æ˜¯åå˜é‡ï¼Œ<math alttext="upper T Subscript i"><msub><mi>T</mi> <mi>i</mi></msub></math> æ˜¯æ²»ç–—ï¼Œ<math alttext="p Subscript i"><msub><mi>p</mi> <mi>i</mi></msub></math> æ˜¯å€¾å‘åˆ†æ•°ï¼Œ<math alttext="w Subscript i"><msub><mi>w</mi> <mi>i</mi></msub></math> æ˜¯æƒé‡ï¼Œ<math alttext="f left-parenthesis upper X Subscript i Baseline right-parenthesis"><mrow><mi>f</mi> <mo>(</mo> <msub><mi>X</mi> <mi>i</mi></msub> <mo>)</mo></mrow></math> æ˜¯ç»“æœæ¨¡å‹ï¼Œ<math alttext="f Superscript asterisk Baseline left-parenthesis upper X Subscript i Baseline right-parenthesis"><mrow><msup><mi>f</mi> <mo>*</mo></msup> <mrow><mo>(</mo> <msub><mi>X</mi> <mi>i</mi></msub> <mo>)</mo></mrow></mrow></math> æ˜¯ä¼°è®¡çš„ç»“æœæ¨¡å‹ã€‚

å¯¹äºè¿™äº›è€ƒè™‘çš„å¾ˆå¥½ä»‹ç»ï¼Œè¯·æŸ¥çœ‹[â€œç»™æˆ‘ä¸€ä¸ªç¨³å¥çš„ä¼°è®¡å™¨ - å¹¶ä¸”è¦åŒé‡ï¼â€](https://oreil.ly/sNhvF)ã€‚

# æ‘˜è¦

çœŸæ˜¯ä¸€ä¸ªæ—‹é£ï¼æ½œåœ¨ç©ºé—´æ˜¯æ¨èç³»ç»Ÿä¸­*æœ€*é‡è¦çš„æ–¹é¢ä¹‹ä¸€ã€‚å®ƒä»¬æ˜¯æˆ‘ä»¬ç”¨æ¥ç¼–ç ç”¨æˆ·å’Œé¡¹ç›®çš„è¡¨ç¤ºã€‚æœ€ç»ˆï¼Œæ½œåœ¨ç©ºé—´ä¸ä»…ä»…æ˜¯ç»´åº¦å‡å°‘ï¼Œå®ƒä»¬å…³ä¹ç†è§£ä¸€ç§å‡ ä½•ï¼Œå…¶ä¸­è·ç¦»çš„æµ‹é‡ç¼–ç ä¸æ‚¨çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ç›¸å…³çš„å«ä¹‰ã€‚

åµŒå…¥å’Œç¼–ç å™¨çš„ä¸–ç•Œæ·±ä¸å¯æµ‹ã€‚æˆ‘ä»¬è¿˜æ²¡æœ‰æ—¶é—´è®¨è®º CLIP åµŒå…¥ï¼ˆå›¾åƒ+æ–‡æœ¬ï¼‰æˆ– PoincarÃ©ç›˜ï¼ˆè‡ªç„¶å±‚æ¬¡è·ç¦»æµ‹é‡ï¼‰ã€‚æˆ‘ä»¬æ²¡æœ‰æ·±å…¥è®¨è®º UMAPï¼ˆä¸€ç§éçº¿æ€§å¯†åº¦æ„ŸçŸ¥çš„é™ç»´æŠ€æœ¯ï¼‰æˆ– HNSWï¼ˆä¸€ç§åœ¨æ½œåœ¨ç©ºé—´ä¸­æ£€ç´¢çš„æ–¹æ³•ï¼Œå¾ˆå¥½åœ°å°Šé‡å±€éƒ¨å‡ ä½•å…³ç³»ï¼‰ã€‚è€Œæ˜¯æŒ‡å‘äº† Vicki Boykis çš„ï¼ˆåŒæ—¶å‘å¸ƒçš„ï¼‰[æ–‡ç« ](https://oreil.ly/Rpu23)å…³äºåµŒå…¥ï¼ŒKarel MinaÅ™Ã­k çš„[æ–‡ç« å’Œæ„å»ºåµŒå…¥çš„æŒ‡å—](https://oreil.ly/UDZ1_)ï¼Œæˆ–è€… Cohere çš„ Meor Amer çš„[æ–‡æœ¬åµŒå…¥ç¾ä¸½çš„è§†è§‰æŒ‡å—](https://oreil.ly/t1N48)ã€‚

æˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†è¡¨ç¤ºæ–¹æ³•ï¼Œä½†æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä¼˜åŒ–ã€‚æˆ‘ä»¬æ­£åœ¨æ„å»º*ä¸ªæ€§åŒ–*æ¨èç³»ç»Ÿï¼Œå› æ­¤è®©æˆ‘ä»¬å®šä¹‰ä¸€äº›åº¦é‡æ ‡å‡†æ¥è¡¡é‡æˆ‘ä»¬åœ¨ä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚
