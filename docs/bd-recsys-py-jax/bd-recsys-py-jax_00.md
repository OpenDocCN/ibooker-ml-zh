# 前言

你是如何找到这本书的？是在网站上看到广告吗？也许是朋友或导师建议的；或者你在社交媒体上看到了提到它的帖子。也许你是在书店的书架上发现它的——一家你信任的地图应用带你去的书店？不管你是怎么找到它的，你几乎肯定是通过推荐系统来到这本书的。

实现和设计能够为用户提供建议的系统是任何业务中应用机器学习（ML）最流行和最重要的应用之一。无论您想帮助用户找到与他们口味相配的最佳服装、从在线商店购买的最吸引人的物品、丰富和娱乐他们的视频，最大程度地吸引来自他们网络的内容，还是那一天他们需要了解的新闻要点，推荐系统都提供了解决方案。

现代推荐系统的设计与其服务的领域一样多样化。这些系统包括用于实现和执行产品目标的计算机软件架构，以及排名的算法组件。用于排名推荐的方法可以来自传统的统计学习算法、线性代数的灵感、几何考虑，当然还有基于梯度的方法。正如算法方法多样化一样，推荐的建模和评估考虑也是如此：个性化排名、搜索推荐、序列建模以及所有这些的评分，现在对于与推荐系统工作的 ML 工程师来说都是必须知道的。

###### 注意

从业者经常使用缩写 RecSys 来描述推荐系统领域。因此，在本书中，我们在提到该领域时使用 RecSys，而在提到我们构建的推荐系统时使用 recommendation system。

如果你是一个 ML 从业者，你可能已经意识到推荐系统，并且可能了解一两种最简单的建模方法，并能够对相关的数据结构和模型架构进行明智的讨论；然而，推荐系统经常超出数据科学和 ML 核心课程的范围。许多在行业中有多年经验的高级数据科学家对实际构建推荐系统知之甚少，并且在谈论这个话题时可能感到害怕。尽管借鉴了与其他 ML 问题类似的基础和技能，但 RecSys 拥有一个快速发展的充满活力的社区，这使得把建立推荐系统交给已经投入时间或愿意紧跟最新信息的*其他*数据科学家变得很容易。

本书存在的原因是打破这些感知障碍。在实际水平上理解推荐系统不仅对需要向用户提供内容的业务案例有用，而且 RecSys 的基本思想通常弥合了非常多其他类型的机器学习之间的鸿沟。例如，文章推荐系统可能利用自然语言处理（NLP）来找到文章的表达，利用序列建模来促进更长时间的参与，以及利用上下文组件允许用户查询来引导结果。如果您从纯学术兴趣的角度接近这一领域，无论您对数学的哪些方面感兴趣， sooner or later，都会出现与 RecSys 有关的链接或应用！

最后，如果与其他领域的联系、几乎所有数学的应用或明显的商业效用*都不足以*引起您对推荐系统的兴趣，那么令人惊叹的尖端技术可能会：RecSys 始终处于并超越机器学习的前沿。显而易见的收入影响的一个好处是，公司和从业者需要始终推动可能性的边界以及如何实现它。最先进的深度学习架构和最佳的代码基础设施被应用于这一领域。当你考虑到在 FAANG 的五个字母中，四个字母的核心——这个缩写代表着 Meta（以前称为 Facebook）、Apple、Amazon、Netflix 和 Google——至少有一个或多个推荐系统时，这并不奇怪。¹

作为一名从业者，您需要理解如何执行以下操作：

+   将您的数据和业务问题视为 RecSys 问题

+   识别关键数据以开始构建 RecSys

+   确定适合您的 RecSys 问题的模型，以及您应该如何评估它们。

+   实现、训练、测试和部署上述模型

+   跟踪指标以确保您的系统按计划运行

+   在学习有关用户、产品和业务案例的更多信息后逐步改进您的系统

本书阐明了完成这些步骤所需的核心概念和示例，无论是哪个行业或规模。我们将指导您完成建立推荐系统的数学、思想和实现细节——无论是您的第一个还是第五十个。我们将向您展示如何使用 Python 和 JAX 构建这些系统。

如果您还不熟悉，JAX 是来自 Google 的 Python 框架，旨在将自动微分和函数式编程范式作为一流对象。此外，它使用了一种特别适合来自各种背景的机器学习从业者的 NumPy API 风格。

我们将展示捕捉必要概念的代码示例和体系结构模型，并提供扩展这些系统到生产应用程序的方式。

# 本书使用的惯例

本书使用以下印刷惯例：

*斜体*

表示新术语、网址、电子邮件地址、文件名和文件扩展名。

`固定宽度`

用于程序列表，以及段落内引用程序元素如变量或函数名、数据库、数据类型、环境变量、语句和关键字。

**`固定宽度粗体`**

显示用户应按字面输入的命令或其他文本。

*`固定宽度斜体`*

显示应由用户提供值或由上下文确定值的文本。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般说明。

###### 警告

此元素指示警告或注意事项。

# 使用代码示例

包含的代码片段引用的笔记本将在中等大小和大多数情况下免费资源上运行。为了便于进行实验和探索，我们通过 Google Colab 笔记本提供代码。

可下载补充材料（代码示例、练习等）位于[ESRecsys on GitHub](https://github.com/BBischof/ESRecsys/)。

如果您有技术问题或使用代码示例时遇到问题，请发送电子邮件至*bookquestions@oreilly.com*。

本书旨在帮助您完成工作。一般而言，如果本书提供示例代码，您可以在您的程序和文档中使用它。除非您复制了大量代码，否则无需联系我们以获得许可。例如，编写使用本书多个代码块的程序不需要许可。销售或分发 O’Reilly 图书中的示例代码需要许可。引用本书并引用示例代码回答问题不需要许可。将本书大量示例代码整合到产品文档中需要许可。

我们感谢，但通常不要求归属。归属通常包括标题、作者、出版商和 ISBN。例如：“*Python 和 JAX 中的建议系统* 作者 Bryan Bischof 和 Hector Yee，2024 年版权 Bryan Bischof 和 Resonant Intelligence LLC，978-1-492-09799-0。”

如果您觉得您使用的代码示例超出了公平使用范围或上述许可，请随时通过*permissions@oreilly.com*与我们联系。
# 致谢

Hector 想要感谢他的丈夫，Donald，在写作过程中给予他的爱与支持，以及他的姐姐 Serena 经常寄来的零食。他还想将这本书献给已故的亲人。特别感谢 Google 的审阅者 Ed Chi、Courtney Hohne、Sally Goldman、Richa Nigam、Mingliang Jiang 和 Anselm Levskaya。感谢 Bryan Hughes 审阅维基百科代码。

Bryan 要感谢他在 Stitch Fix 的同事们，在那里他学习到了本书中许多关键的思想——特别是 Ian Horn 在迁移学习方面的耐心指导，Molly Davies 博士在实验和效果估计方面的指导，Mark Weiss 在理解可用性与推荐之间关系方面的深入合作，Reza Sohrabi 博士对变换器的介绍，Xi Chen 博士在推荐系统中使用图神经网络的鼓励，以及 Leland McInnes 博士在维度减少和近似最近邻方面的细致建议。Bryan 还从与 Natalia Gardiol 博士、Daniel Fleischman 博士、Andrew Ho 博士、Jason Liu、Dan Marthaler 博士、Chris Moody 博士、Oz Raza、Anna Schneider 博士、Ujjwal Sarin、Agnieszka Szefer 博士、Daniel Tasse 博士、Diyang Tang、Zach Winston 等人的交流中受益匪浅。除了他不可思议的 Stitch Fix 同事们，他特别感谢 Eric Bunch 博士、Lee Goerl 博士、Will Chernoff 博士、Leo Rosenberg 和 Janu Verma 多年来的合作。Brian Amadio 博士作为一位出色的同事最初建议他写这本书。Even Oldridge 博士鼓励他实际去尝试。Eugene Yan 和 Karl Higley——虽然他们都未曾见面，但对他有极大的启发。他要感谢对他职业生涯产生重要影响的 Zhongzhu Lin 博士和 Alexander Rosenberg 博士。Cianna Salvatora 协助进行早期文献综述，Valentina Besprozvannykh 在阅读早期草稿笔记和提供指导方面提供了极大帮助。

两位作者感谢 Tobias Zwingmann、Ted Dunning、Vicki Boykis、Eric Schles、Shaked Zychlinski 和 Will Kurt，在书稿上给予了大量细致的技术反馈——没有这些反馈，这本书将会难以理解。Rebecca Novack 力劝我们加入这个项目。Jill Leonard 从书稿中删除了近 100 处错误的*利用*一词，并在书稿文本上提供了大量耐心的合作。

¹ 有人可能会争论说苹果公司的核心推荐系统也是其公司的核心。虽然苹果应用商店确实是公司的重要战略产品，但我们仍然保守地给出四分之五的评估，并表示推荐系统不是苹果的主要盈利能力。
