# 前言

## 前言

自第一版《TensorFlow 机器学习》出版以来已有两年。在人工智能领域，两年是一段很长的时间。

现在，我们对一个拥有超过 800 亿个人工神经元、学习超过 1700 亿个参数的人类语言模型感到着迷。训练这样一个模型的成本以百万美元计。麻省理工学院的 Lex Fridman 预测，随着计算和算法设计的改进，我们很快就能以不到几千美元的成本训练出与人类大脑大小相当的模型。想想看——在我们不久的将来，我们将以不到一辆 Peloton 固定自行车的成本来训练一个具有人类大脑原始容量的 AI 模型。

撰写一本捕捉这个快速发展的技术的书充满了风险。当克里斯写了几章时，研究人员可能已经产生了更新、更优雅的解决同样问题的方法。然而，今天可能只有大约 1 万人真正深刻理解人工智能。你想跳进来，学习，并开始在工作中使用人工智能。该怎么办呢？

购买这本书——即使你有第一版。特别关注以下七个新章节，它们将引导你了解人工智能的基本技术：

+   第六章，“情感分类：大型电影评论数据集”

+   第八章，“从 Android 加速度计数据推断用户活动”

+   第十章，“词性标注和词义消歧”

+   第十二章，“应用自编码器：CIFAR-10 图像数据集”

+   第十五章，“构建真实世界的 CNN：VGG-Face 和 VGG-Face Lite”

+   第十七章，“LSTMs 和自动语音识别”

+   第十八章，“用于聊天机器人的序列到序列模型”

克里斯帮助你学习机器在我们的世界中如何看、听、说、写和感受。他展示了机器如何像人眼一样，利用自编码器瞬间发现挡风玻璃上的灰尘。

克里斯用令人沮丧的、实用的细节描述建模技术，这些技术将随着时间的推移而持续存在。它们对于将问题作为张量输入、张量输出、通过图流动是基本的。正确地构建问题比描述解决问题的个别细节更为重要。预期这些细节会迅速变化和改进。

带着对 AI 建模的欣赏，你将准备好享受人工智能快速、指数级的前进旅程。欢迎来到我们的世界！跳进来，享受乐趣，开启那些 GPU，并尽你所能帮助人类解决智能问题。用智能机器重新构想我们的世界——然后用 TensorFlow 实现它。

克里斯，感谢你抽出时间做我们的向导，穿插着那种我非常喜欢的糟糕的父亲幽默。

Scott Penberthy，谷歌应用 AI 总监

旧金山

加利福尼亚州，2020 年 8 月

## 前言

大约 15 个月前，就在今天，我坐下来，手拿这本书的第一版全新副本，打开它，一头扎了进去。我现在在位于美丽加利福尼亚州帕萨迪纳的 NASA 喷气推进实验室管理人工智能、分析和创新发展部门。然而，当时我是 IT 部门的副首席技术官（CTO），在数据科学、信息检索和软件方面有深厚的背景，但对热门话题机器学习只有表面的了解。我尝试过它，但从未深入钻研，就像人们说的那样。鉴于 Manning 对实用性、深入示例以及最重要的是幽默（我在一切事物中都迫切寻求它；幽默使事物变得更好）的覆盖，我对这本书抱有好感。当时，自从我有时间阅读技术书籍以来，几乎已经过去了一年，更不用说坐下来尝试代码和练习了。

我决定，有了这本书，我必须运行代码，拿出铅笔和纸，绘制矩阵，并写下东西——你知道的，学习我正在阅读的内容，而不是阅读但不学习。哇，这本书真是个大挑战。它很有趣——可能是我读过的最简单的机器学习入门书籍——而且我确实理解了它。我记得有一天晚上对妻子说，“这就是为什么所有亿万富翁 CEO，比如[埃隆]马斯克，都害怕 AI 的原因。”我可以看到它在各种格式中的应用，如文本、声音、视觉和语音。它使用了一个我听说很多的令人惊叹的框架，叫做 TensorFlow。

然而，有一个问题。这本书的第一版有一个习惯，那就是在每章的结尾抛出一个项目符号——大致意思是“好吧，你刚刚覆盖了 AI 或 ML 主题 X；你可以尝试构建一个像这个最先进的 X 模型一样为 X 构建模型并测试它。”我很好奇，愿意投入时间。大约九周后，我训练并重建了视觉几何组（VGG）的标志性面部模型，并发现了一大堆改进和重建了不再存在的数据集。我编写了代码，从 Android 手机数据中推断用户的活动，如跑步或行走。我构建了一个强大的情感分类器，在 Kaggle 的爆米花电影挑战赛（现已关闭）中可能会获得前 100 名结果。

最终，我为这本书的第二版积累了足够的代码、笔记和材料。我收集了数据，编写了 Jupyter 笔记本并对其进行了文档记录，修复了代码中的错误；甚至在 Nishant Shukla 这本书的第一版和这一版之间两年时间里，TensorFlow 在 1.x 分支上发布了大约 20 个版本，2.x 版本也即将推出（在我写这本书的时候已经推出了）。

所有代码、示例、错误修复、数据下载、辅助软件库安装和 Docker 化都是这本书中你得到的内容。不要把它想成又一本*TensorFlow 书；我本可以轻易地称之为《使用 TensorFlow 和朋友的机器学习，第 2 版：NumPy、SciPy、Matplotlib、Jupyter、Pandas、Tika、SKLearn、TQDM 以及更多》。你需要所有这些元素来做数据科学和机器学习。为了清楚起见，这本书不仅仅关于 TensorFlow；这是一本关于机器学习以及如何做的书：如何清理数据、构建模型并训练它，以及（最重要的是）如何评估它。

我希望你现在和将来都像我一样喜欢机器学习。这段旅程并不容易，包括在写作时被全球大流行病所困扰，但我从未如此乐观，因为我看到了人工智能和机器学习的光明和力量。我希望在阅读这本书后，你也会这样。

## 致谢

如果没有感谢尼尚特·舒克拉，我将感到失职，他写了这本书的第一版。他聪明、风趣的讨论激发了我踏上这段旅程，最终使我创作了这本书。

我衷心感谢我的收购编辑迈克尔·斯蒂普斯，他相信我的书稿，并坚持我的坚持、热情和愿景。这本书因你的强烈反馈和批评而变得更好。感谢 Manning 出版社的出版商 Marjan Bace，他批准了这本书的想法，并在他第一本书 10 年后给了这位作者另一次机会。

我的开发编辑托尼·阿里托拉一直是我最大的支持者和确保这本书成功的最坚定的倡导者。她对我的信任、对愿景和过程的信念，以及我们之间的信任，使这本书变得非常出色。托尼对我的 AI 和数据科学术语的挑战以及她将我的 50000 英尺概念编辑和重新构思为实用解决方案和解决问题的能力，使无论你对编码、AI 还是 ML 的了解如何，使用 TensorFlow 进行机器学习都成为一种可口的享受。感谢她的冷静、智慧和心。

感谢我的技术发展编辑阿尔·克林克，他的技术编辑和建议无疑提高了这本书的质量。

向所有审稿人致谢：Alain Couniot、Alain Lompo、Ariel Gamino、Bhagvan Kommadi、David Jacobs、Dinesh Ghanta、Edward Hartley、Eriks Zelenka、Francisco José Lacueva、Hilde Van Gysel、Jeon Kang、Johnny L. Hopkins、Ken W. Alger、Lawrence Nderu、Marius Kreis、Michael Bright、Teresa Fontanella de Santis、Vishwesh Ravi Shrimali 和 Vittal Damaraju——你们的建议帮助使这本书变得更好。此外，我还要感谢那些提供了宝贵反馈和建议的匿名审稿人，他们鼓励我努力追求更好的安装，这导致了仓库中的全面 Docker 安装和分支，以及代码的整体更好组织。

我要感谢 Candace Gillhoolley 组织了数十次播客、推广和联系活动，以推广这本书并传播信息。

感谢我的行业同事和队友抽出他们自己的时间阅读这本书的早期草稿章节，并提供了宝贵的反馈。我特别想感谢 Philip Southam 对我的信任，以及他在 Docker 安装方面的早期工作，还有 Rob Royce 在 TensorFlow2 分支上的工作和对代码的兴趣。我还深深地感谢赵张在 CNN 章节想法上的帮助，以及 Thamme Gowda 提供的指导和讨论。

最后，我要感谢我惊人的妻子，Lisa Mattmann，在将近十年后，她让我再次做我承诺过不会再做的事情（在我上一本书和我的博士论文之前）。我在远离写作方面有着糟糕的记录，但这一次不同，在将近 20 年的相处中，她了解我，知道写作是我的激情。谢谢你，亲爱的。

我将这本书献给我的孩子们。我的大儿子，Christian John (CJ) Mattmann，对情感分析章节和文本处理表现出兴趣。他真是继承了家族的基因。我希望有一天，他会有勇气运行代码，并执行他自己的甚至更好的情感分析和机器学习。我怀疑他会这样做。感谢 Heath 和 Hailey Mattmann 理解当爸爸深夜熬夜完成这本书和编写章节以及编码时的情况。这本书献给你们！

## 关于这本书

为了从这本书中获得最大益处，您应该将其视为两部分：一部分是数学和理论的基础，随后是使用 Python、TensorFlow 及其相关工具的实际应用。当我特别提到在特定领域使用机器学习技术，如回归或分类，并引用示例数据集或问题时，请思考您如何利用这些数据和/或问题领域来测试您正在使用的新的机器学习技术。这正是我在第一版读者时的做法，仔细研读章节，然后应用“如果...会怎样”的想法和指向数据集的指针，基于我制作的笔记本和我所做的工作，为这一版创建了新的章节。

整个过程需要花费每个章节数周或数月的时间来完成。我在第二版中记录了所有更新。随着您阅读这本书的前几部分，您会发现章节的顺序与第一版相似。然而，在回归之后，现在有一个章节专门介绍将回归应用于第一版建议的 311 个服务练习。同样，第二版还有一个完整的章节介绍如何使用分类对 Netflix 电影评论数据执行情感分析。

在本书的其余部分，你将探索包括无监督聚类、隐藏马尔可夫模型（HMMs）、自动编码器、深度强化学习、卷积神经网络（CNNs）和 CNN 分类器等主题。我还增加了一章，介绍如何从 Android 手机中提取位置数据，并推断用户正在进行的活动类型，以及一章关于重新创建 VGG-Face 面部识别 CNN 模型的内容。为了执行一些后续练习，你可能需要访问 GPU，无论是本地在您的笔记本电脑上，还是通过 Google、Amazon 或其他大型提供商的云访问。我会在这个过程中帮助你。

请确保在 liveBook 讨论论坛（[`livebook.manning.com/book/machine-learning-with-tensorflow-second-edition/discussion`](https://livebook.manning.com/book/machine-learning-with-tensorflow-second-edition/discussion)）中发布你关于本书的任何问题、评论或建议。你的反馈对于保持本书的时效性和确保它是最好的书籍至关重要。我期待着在您的机器学习之旅中帮助你！

## 本书是如何组织的：一个路线图

本书分为三个部分。

第一部分，“你的机器学习配置”，解释了机器学习的一般理论，并给出了一些关于其在当今世界大规模增长和使用的动机，讨论基于最广泛使用的机器学习实现框架之一：TensorFlow。

+   第一章介绍了机器学习，并解释了它是如何教授计算机根据输入图像、文本、声音和其他格式进行分类、预测、聚合和识别的。

+   第二章涵盖了 TensorFlow 基础知识，并向读者介绍了 TensorFlow 框架；张量的概念；基于图的执行；以及创建、训练和保存模型的过程。

第二部分，“核心学习算法”，为你提供了机器学习工具箱：回归用于学习连续值预测或分类用于离散分类预测和推理。本部分中的章节是配对的；一章专注于工具和一般理论，下一章则提供了一个涉及数据清洗、准备、训练、推理和评估的详细示例问题。教授的技术包括回归、分类、无监督聚类和 HMMs。所有这些技术都是可解释的，即你可以解释机器学习过程的步骤，并直接使用数学和统计学来评估它们的值。

+   第三章涵盖了回归，这是一个涉及连续输入和可能离散或连续输出的建模问题。

+   第四章将回归应用于来自纽约市 311 服务机构的真实世界呼叫中心数据，该机构为市民提供帮助。你将收集每周呼叫量的数据集，并使用回归来预测每周预期的呼叫数量。

+   第五章涵盖了分类，这是一个建模问题，它接受离散或连续数据作为输入，并输出单个或多个分类类别标签。

+   第六章使用 Netflix 和 IMDb 电影评论数据对电影进行分类，构建了一个基于评论识别电影为正面或负面的电影情感分类器。

+   第七章演示了无监督聚类，展示了在没有标签的情况下自动将输入数据分组到离散类别中。

+   第八章将自动聚类应用于输入的 Android 手机位置数据，向你展示如何根据手机加速度计的位置数据推断用户活动。

+   第九章使你轻松进入隐马尔可夫模型（HMMs）的主题，并展示了间接证据如何导致可解释的决策。

+   第十章将隐马尔可夫模型（HMMs）应用于文本输入，以在难以判断 engineer 是名词还是动词时，对文本中的词性进行区分。（什么时候不是这样呢，对吧？）

书的最后一部分涵盖了正在席卷社区的神经网络范式：帮助汽车自动驾驶、医生诊断癌症以及手机使用生物识别技术（如你的面部）来决定你是否可以登录。神经网络是一种受人类大脑及其结构启发的特定机器学习模型，其结构是一个基于输入、发出预测、置信度、信念、结构和形状的神经元图。神经元很好地映射到张量的概念，张量是图中允许标量值、矩阵和向量等信息通过它们流动、被操作、转换等的节点——因此，谷歌框架的名称为 TensorFlow。本书的这一部分涵盖了用于压缩和表示输入的自动编码器、用于自动分类图像中对象和面孔的卷积神经网络（CNNs）以及用于时间序列数据或转换为文本的语音数据的循环神经网络（RNNs）。第三部分还涵盖了 seq2seq RNN 架构，它可以用来将输入文本和语句与智能数字助手（如聊天机器人）的响应关联起来。本书的最后一章将神经网络应用于根据输入视频和图像评估机器人折叠布料的效用。

+   第十一章涵盖了自动编码器，它们通过使用神经网络中的隐藏层将输入数据压缩成更小的表示。

+   第十二章探讨了多种类型的自动编码器，包括堆叠和去噪自动编码器，并演示了网络如何从 CIFAR-10 数据集中学习图像的紧凑表示。

+   第十三章向读者介绍了一种不同类型的网络：深度强化学习网络，它学习投资股票组合的最佳策略。

+   第十四章全部关于卷积神经网络（CNN），这是一种受视觉皮层启发的神经网络架构。CNN 使用多个卷积滤波器来开发输入图像及其更高和更低阶特征的紧凑表示。

+   第十五章教你如何构建两个真实世界的 CNN：一个用于 CIFAR-10 数据集的对象识别，另一个用于名为 VGG-Face 的面部识别系统。

+   第十六章涵盖了时间序列数据的 RNN 范式，并代表了神经网络随时间做出的决策，而不仅仅是特定实例中的决策。

+   第十七章向你展示了如何构建一个名为长短期记忆（LSTM）的真实世界 RNN 模型类型，用于自动语音到文本识别，重建了百度使其闻名的深度语音模型架构。

+   第十八章重用 RNN 并演示了 seq2seq 架构，它可以用来构建一个智能聊天机器人，该机器人可以针对用户聊天进行现实反应，这些反应是在之前的问题和答案上训练的。

+   第十九章通过探索效用景观来结束本书，使用神经网络架构从布折叠的视频中创建图像嵌入，然后使用这些嵌入来推断任务每个步骤随时间的效用。

## 关于代码

本书包含许多源代码示例，无论是编号列表还是与普通文本内联。在这两种情况下，源代码都使用`固定宽度字体`如这样来格式化，以将其与普通文本区分开来。有时代码也会`加粗`以突出显示与章节中先前步骤相比有所改变的代码，例如当新功能添加到现有代码行时。

在许多情况下，原始源代码已经被重新格式化；我们添加了换行并重新调整了缩进，以适应书籍中可用的页面空间。在极少数情况下，即使这样也不够，列表中还包括了行续接标记（➥）。此外，当代码在文本中描述时，源代码中的注释通常也会从列表中移除。许多列表旁边都有代码注释，突出显示重要概念。

本书中的许多图形都包含颜色，可以在电子书版本中查看。要获取免费的电子书（PDF、ePub 或 Kindle 格式），请访问[`mng.bz/JxPo`](http://mng.bz/JxPo)注册您的印刷版书籍。

书中的代码按章节组织，作为一系列 Jupyter 笔记本。你可以从 Docker Hub 拉取或自己构建相关的 Docker 容器，它会自动安装 Python 3 和 Python 2.7 以及 TensorFlow 1.15 和 1.14，这样你就可以运行书中的所有示例。书中的列表清晰划分并编号；它们对应于 GitHub 仓库中[`mng.bz/MoJn`](http://mng.bz/MoJn)的章节和列表编号.ipynb 文件，以及 Manning 网站[`www.manning.com/books/machine-learning-with-tensorflow-second-edition`](https://www.manning.com/books/machine-learning-with-tensorflow-second-edition)。

Docker 文件会自动从远程 Dropbox 链接下载并安装第三方库（TensorFlow 及其相关库的部分，如书中所述）和必要的数据集，以便您运行所有代码。如果您在自己的 Python 环境中本地安装了库和数据，也可以在 Docker 容器外运行库和数据的下载脚本。

作者将乐意接收在 GitHub 上报告的代码问题，甚至更乐意接收您发现的任何问题的拉取请求。还有一项积极的工作正在将本书中的列表迁移到 TensorFlow2。您可以在 tensorflow2 分支中找到当前的工作 [`github.com/chrismattmann/MLwithTensorFlow2ed/tree/tensorflow2`](https://github.com/chrismattmann/MLwithTensorFlow2ed/tree/tensorflow2)。

## liveBook 讨论论坛

购买《TensorFlow 机器学习》包括免费访问由 Manning Publications 运营的私人网络论坛，您可以在论坛中就本书发表评论、提出技术问题，并从作者和其他用户那里获得帮助。要访问论坛，请访问 [`livebook.manning.com/book/machine-learning-with-tensorflow-second-edition/discussion`](https://livebook.manning.com/book/machine-learning-with-tensorflow-second-edition/discussion)。您还可以在 [`livebook.manning.com/#!/discussion`](https://livebook.manning.com/#!/discussion) 了解更多关于 Manning 论坛和行为准则的信息。

Manning 对读者的承诺是提供一个场所，让读者之间以及读者与作者之间可以进行有意义的对话。这并不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未支付报酬）。我们建议您尝试向作者提出一些挑战性的问题，以免他的兴趣转移！只要本书仍在印刷中，论坛和以前讨论的存档将可通过出版社的网站访问。

## 关于作者

Chris Mattmann 是美国宇航局喷气推进实验室人工智能、分析和创新发展组织部门的部门经理，在那里他被认定为 JPL 数据科学领域的首位首席科学家。Chris 将 TensorFlow 应用于他在 NASA 面临的挑战，包括使用 TensorFlow 构建谷歌 Show & Tell 算法的图像标题实现。作为 Apache 软件基金会的前任总监，Chris 为开源项目做出了贡献，并在南加州大学教授内容检测和分析、搜索引擎和信息检索的硕士研究生课程。

## 关于封面插图

《TensorFlow 机器学习》的封面上的插图被标注为“来自克罗地亚达尔马提亚的帕格岛的人”。这幅插图取自 2006 年出版的 19 世纪服装和民族志描述的复制品，名为《达尔马提亚》，由考古学家和历史学家弗拉内·卡拉拉教授（1812-1854）所著，他是克罗地亚斯普利特古物博物馆的第一任馆长。插图是从斯普利特中世纪中心的罗马核心，即公元 304 年左右皇帝戴克里先退休宫殿的废墟中，位于民族志博物馆（原古物博物馆）的一位 helpful librarian 那里获得的。书中包含了来自达尔马提亚不同地区的精美彩色插图，并附有服装和日常生活的描述。自 19 世纪以来，着装规范已经改变，当时丰富的地区多样性已经消失。现在很难区分不同大陆的居民，更不用说不同的城镇或地区了。也许我们用更丰富多彩的个人生活——当然，是更丰富多彩、节奏更快的技术生活——来换取了文化多样性。

在难以区分一本计算机书籍与另一本的时候，曼宁通过书籍封面上的设计，庆祝了计算机行业的创新精神和主动性。这些设计基于两百年前丰富多样的地区生活，通过此类收藏中的插图被重新呈现出来。
