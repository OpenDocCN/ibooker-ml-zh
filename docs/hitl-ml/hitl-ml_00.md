# 前置材料

## 前言

随着机器学习在许多行业领域的广泛应用，人工智能系统现在正与人类系统和人类进行日常接触。大多数人已经注意到了一些面向用户的影响。机器学习可以改善人们的生活，例如通过有用的语音助手的语音识别和自然语言理解，或者它可能会打扰甚至主动伤害人类，例子从令人烦恼的产品推荐到系统性地歧视女性或代表性不足的少数族裔的简历审查系统。与其考虑人工智能在孤立状态下运行，本世纪迫切需要探索以人为本的人工智能——即构建能够有效与人类合作和协作、增强人类能力的 AI 技术。

这本书的重点不是放在最终用户身上，而是关注人和机器学习如何在机器学习系统的生产和运行中结合在一起。在工业界，机器学习从业者都知道，获取正确标注的数据比采用更先进的机器学习算法要宝贵得多。数据的生成、选择和标注是一项非常人性化的工作。手动标注数据可能既昂贵又不可靠，这本书花了很多篇幅来探讨这个问题。一个方向是减少需要标注的数据量，同时通过主动学习的方法仍然允许训练高质量的系统。另一个方向是利用机器学习和人机交互技术来提高人工标注的速度和准确性。事情并不止于此：大多数大型部署系统还涉及各种各样的人类审查和更新。再次，机器学习既可以设计为利用人的工作，也可以是人们需要与之抗争的东西。

罗伯特·莫纳克是这个旅程中一位高度合格的向导。在他攻读博士学位之前和期间的工作中，罗伯特的关注点是实用且关注人的。他基于自己在几个危机场景中提供帮助的努力，开创了将自然语言处理（NLP）应用于灾害响应相关信息的先河。他从处理关键数据的人类方法开始，然后寻找利用 NLP 自动化部分流程的最佳方式。我很高兴，现在许多这些方法正在被灾害响应组织使用，并且可以在本书中与更广泛的受众分享。

尽管机器学习的数据方面通常被认为主要是管理工作，但本书表明这一方面也非常技术性。数据采样算法和注释质量控制的算法通常接近下游模型消耗训练数据的复杂性，在某些情况下，在注释过程中实现了机器学习和迁移学习技术。对注释过程更多资源的真正需求，这本书在写作过程中就已经产生了影响。随着各个章节的出版，它们被农业、娱乐和旅游等领域的大型组织中的数据科学家所阅读。这突出了机器学习的现在广泛使用和对数据聚焦书籍的渴望。本书规范了许多当前的最佳实践和算法，但由于数据方面长期以来被忽视，我预计还有更多关于数据聚焦机器学习的科学发现有待发现，并且我希望这本入门指南能够鼓励进一步的进步。

—克里斯托弗·D·曼宁

*克里斯托弗·D·曼宁是斯坦福大学计算机科学和语言学教授，斯坦福人工智能实验室主任，以及斯坦福以人为本的人工智能研究所联合主任。*

## 前言

我将本书的所有作者收入捐赠给改善数据集的倡议，特别是针对低资源语言和健康及灾害响应。当我开始写这本书时，关于灾害响应的示例数据集并不常见，且与我作为机器学习科学家和灾害响应者的双重背景相关。随着 COVID-19 的出现，全球格局发生了变化，现在许多人理解为什么灾害响应用例如此重要。大流行暴露了我们机器学习能力的许多差距，特别是在获取相关医疗保健信息和对抗虚假信息运动方面。当搜索引擎未能呈现最新的公共卫生信息，而社交媒体平台未能识别广泛传播的虚假信息时，我们都体验了无法快速适应数据变化的应用的负面影响。

这本书并不仅限于灾难响应。我在这里分享的观察和方法的来源也来自于我为自动驾驶汽车、音乐推荐、在线商业、语音设备、翻译以及广泛的其它实际应用构建数据集的经验。在撰写这本书的过程中，了解到许多新的应用让我感到非常高兴。从阅读草稿章节的数据科学家那里，我了解到一些组织在历史上与机器学习并不相关：一家农业公司在其拖拉机上安装智能摄像头，一家娱乐公司将人脸识别技术应用于卡通角色，一家环保公司预测碳足迹，以及一家服装公司个性化时尚推荐。当我在这家数据科学实验室关于这本书的邀请演讲时，我确信我学到的东西比我教给他们的还要多！

所有这些用例有两个共同点：数据科学家需要为他们机器学习模型创建更好的训练和评估数据，而且关于如何创建这些数据的出版物几乎为零。我很高兴分享策略和技术，以帮助结合人类和机器智能的系统，几乎适用于机器学习的任何应用。

## 致谢

我最感激的是我的妻子，维多利亚·莫纳克，她支持我最初决定写这本书。我希望这本书能帮助让我们的世界因为我在写书时出生的小小人类而变得更好。

大多数撰写技术书籍的人告诉我，他们在写作结束时都停止了享受这个过程。这并没有发生在我身上。由于自 2019 年以来提供反馈的所有人，我享受了写这本书直到最后的修订。我非常感激早期反馈对 Manning 出版社流程的内在重要性，在 Manning 出版社，我最感激的是我的编辑，苏珊·埃奇里斯。我期待着我们的每周通话，我特别幸运地有一位编辑之前曾在电子发现领域担任“人工审核员”。并不是每个作家都有幸拥有具有领域经验的编辑！我也感谢弗朗西斯·布昂特莫普对章节的详细审查；阿尔·克林的克对技术的审查；项目编辑迪尔德丽·希姆；校对员基尔·辛普森；校对员凯里·黑尔斯；审查编辑伊万·马丁诺维奇；以及 Manning 出版社内为本书的内容、图像和代码提供反馈的每一个人。

感谢所有审稿人：Alain Couniot、Alessandro Puzielli、Arnaldo Gabriel Ayala Meyer、Clemens Baader、Dana Robinson、Danny Scott、Des Horsley、Diego Poggioli、Emily Ricotta、Ewelina Sowka、Imaculate Mosha、Michal Rutka、Michiel Trimpe、Rajesh Kumar R S、Ruslan Shevchenko、Sayak Paul、Sebastián Palma Mardones、Tobias Bürger、Torje Lucian、V. V. Phansalkar、Vidhya Vinay。你们的建议帮助使这本书更加完善。

感谢我的网络中所有在早期草稿中给予我直接反馈的人：Abhay Agarwa、Abraham Starosta、Aditya Arun、Brad Klingerberg、David Evans、Debajyoti Datta、Divya Kulkarni、Drazen Prelec、Elijah Rippeth、Emma Bassein、Frankie Li、Jim Ostrowski、Katerina Margatina、Miquel Àngel Farré、Rob Morris、Scott Cambo、Tivadar Danka、Yada Pruksachatkun 以及通过 Manning 在线论坛评论的每个人。Adrian Calma 特别勤奋，我很幸运一位最近获得主动学习博士学位的人如此仔细地阅读了草稿章节！

我对我的职业生涯中合作过的许多人表示感谢。除了今天在苹果公司的同事外，我还特别感激在 Idibon、Figure Eight、AWS 和斯坦福大学的过去同事。我很高兴我的斯坦福大学博士导师 Christopher Manning 为这本书提供了序言。

最后，我特别感谢在本书中分享轶事的 11 位专家：Ayanna Howard、Daniela Braga、Elena Grewal、Ines Montani、Jennifer Prendki、Jia Li、Kieran Snyder、Lisa Braden-Harder、Matthew Honnibal、Peter Skomoroch 和 Radha Basu。他们所有人都创立了成功的机器学习公司，并在他们职业生涯的某个阶段直接参与了机器学习的数据处理方面。如果你像本书的大多数预期读者一样——一个职业生涯早期、努力创造良好训练数据的人——请将他们视为你未来自己的榜样！

## 关于本书

这是我希望在我接触机器学习时存在的书，因为它解决了人工智能中最重要的问题：人类和机器应该如何合作解决问题？大多数机器学习模型都是基于人类示例的，但大多数机器学习文本和课程只关注算法。你通常可以用好的数据和简单的算法获得最先进的结果，但你很少用基于糟糕数据的最先进算法获得最先进的结果。所以如果你需要首先深入研究机器学习的某个领域，你可能会认为数据方面更重要。

### 适合阅读本书的人群

本书主要面向数据科学家、软件开发人员和最近才开始使用机器学习（或最近才开始在数据方面工作）的学生。你应该对监督学习和无监督学习等概念有一些经验，以及训练和测试机器学习模型、PyTorch 和 TensorFlow 等库。但你不需要在这些领域的任何一个是专家就可以开始阅读这本书。

当你变得更加有经验时，这本书应该仍然是不同技术的一个有用的快速参考。这本书是第一本包含注释、主动学习和相邻任务（如注释的界面设计）等最常见策略的书籍。

### 本书如何组织：路线图

本书分为四个部分：介绍；对主动学习的深入探讨；对标注的深入探讨；以及最后一部分，它通过人机界面设计策略和三个实现示例将所有内容整合在一起。

本书的第一部分介绍了创建训练和评估数据的基本模块：标注、主动学习和帮助人类和机器最有效地结合其智能的人机交互概念。到第二章结束时，您将构建一个人类在循环的机器学习应用，用于标注新闻标题，从而完成从标注新数据到重新训练模型，然后使用新模型来帮助决定哪些数据应该被标注的循环。

第二部分涵盖了主动学习——用于采样人类审查的最重要数据的技术集合。第三章介绍了理解模型不确定性的最广泛使用的技术，第四章探讨了由于采样不足或数据不具有代表性而导致模型可能自信但错误的复杂问题。第五章介绍了将不同策略组合成一个全面的主动学习系统的方法，第六章介绍了主动学习技术如何应用于不同类型的机器学习任务。

第三部分涵盖了标注——获取训练和评估数据准确且具有代表性的标签的常见问题。第七章介绍了如何寻找和管理合适的人员进行数据标注。第八章介绍了标注质量控制的基礎，介绍了计算准确性和一致性的最常见方法。第九章涵盖了标注质量控制的高级策略，包括主观任务的标注以及使用基于规则的系统、基于搜索的系统、迁移学习、半监督学习、自监督学习和合成数据创建等多种方法来半自动化标注。第十章介绍了如何管理不同类型的机器学习任务的标注。

第四部分通过第十一章对有效注释界面的深入探讨和第十二章中三个人类在循环的机器学习应用示例，完成了“循环”。

在整本书中，我们不断回到不同类型的机器学习任务中的例子：图像和文档级别的标注、连续数据、目标检测、语义分割、序列标注、语言生成和信息检索。内封面包含快速参考，展示了您可以在书中找到这些任务的位置。

### 关于代码

本书使用的所有代码都是开源的，并可以从我的 GitHub 账户获取。本书前六章使用的代码位于[`github.com/rmunro/pytorch_active_learning`](https://github.com/rmunro/pytorch_active_learning)。

一些章节也使用电子表格进行分析，最后三章中的三个例子分别存放在各自的存储库中。有关更多详细信息，请参阅相应的章节。

### liveBook 讨论论坛

购买《人机协同机器学习》（*Human-in-the-Loop Machine Learning*）包括免费访问由 Manning Publications 运营的私人网络论坛，您可以在论坛上发表关于本书的评论，提出技术问题，并从作者和其他用户那里获得帮助。要访问论坛，请访问 [`livebook.manning.com/book/human-in-the-loop-machine-learning/welcome/v-11`](https://livebook.manning.com/book/human-in-the-loop-machine-learning/welcome/v-11)。您可以在 [`livebook.manning.com/#!/discussion`](https://livebook.manning.com/#!/discussion) 了解更多关于 Manning 的论坛和行为准则。

Manning 对读者的承诺是提供一个场所，让读者之间以及读者与作者之间可以进行有意义的对话。这不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您尝试向作者提出一些挑战性的问题，以免他的兴趣转移！只要本书有售，论坛和先前讨论的存档将可通过出版社的网站访问。

### 其他在线资源

每章都有一个“进一步阅读”部分，并且除了少数例外，列出的所有资源都是免费的，并且可在网上获取。正如我在几个地方所说的，寻找那些引用我所引用论文的高引用工作。包含一些有影响力的论文没有意义，而且在此书之后还将发表许多其他相关论文。

## 关于作者

Robert Monarch 博士（原名 Robert Munro），是结合人类和机器智能的专家，目前居住在旧金山，并在苹果公司工作。Robert 在塞拉利昂、海地、亚马逊、伦敦和悉尼等地工作过，在从初创公司到联合国的各种组织中工作过。他是 Idibon 的首席执行官和创始人，Figure Eight 的首席技术官，并领导了亚马逊网络服务（Amazon Web Services）的第一个自然语言处理和机器翻译服务。
