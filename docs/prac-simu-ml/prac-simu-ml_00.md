# 序言

欢迎来到*机器学习实用模拟*！这本书结合了我们最喜欢的两件事情：*视频游戏引擎*和*人工智能*。我们希望您在阅读时能像我们写作时那样享受它。

具体来说，本书探讨了 Unity 的使用，这是一个曾被称为*游戏引擎*但现在更喜欢称为*用于创建和操作交互式、实时 3D 内容的平台*的产品。这是很多词汇，但基本上可以归结为这样：Unity 是一个用于在 3D 中构建事物的平台，虽然传统上它被用于视频游戏开发，但也可以通过结合 3D 图形、物理模拟和某种输入来构建任何可以用 3D 表示的东西。

结合一个*用于创建和操作交互式、实时 3D 内容的平台*与机器学习工具，您可以使用您创建的 3D 世界来训练机器学习模型，有点像真实世界。事实上并不完全像真实世界，但想象起来很有趣，与真实世界有一些真正有用的联系（例如能够生成用于真实世界机器学习应用的数据，以及可以转换为物理真实世界对象的模型，比如机器人）。

###### 提示

当我们说真实世界时，实际上是指物理世界。

将 Unity 与机器学习结合使用是创建*模拟*和*合成数据*的绝佳方式，这是本书涵盖的两个不同主题。

# 本书中使用的资源

我们建议您随着书中的进展逐章自己编写代码跟随学习。

如果您遇到困难，或者只想存档我们版本的代码副本，您可以通过我们的[网站](http://www.secretlab.com.au/books/practical-simulations)找到您需要的内容。

对于我们在书中涉及的某些活动，您将需要资源的副本以获取某些资产，因此我们建议您下载它。

# 受众和方法

我们为那些对机器学习感兴趣但不一定是机器学习工程师的程序员和软件工程师写了这本书。如果您对机器学习有一些兴趣，或者开始在机器学习领域工作，那么这本书适合您。如果您是一名游戏开发者，对 Unity 或其他游戏引擎有所了解，并希望学习机器学习（无论是为游戏还是其他应用），那么这本书也适合您。

如果你已经是一个机器学习专家，这本书也适合你，但方式有所不同：我们不会深入探讨机器学习的原理和方法。因此，如果你已经深入了解 PyTorch 和类似框架，那么在这里你也会感觉很舒适。如果你对机器学习世界的深层原理不是很了解，也不用担心，这里的内容非常易于理解。使用 Unity 进行仿真和合成的关键在于，你不需要详细了解其中的细节，它们都会“自动”运行（这是我们的最后一句名言，我们知道）。

无论如何，如果你来自软件、机器学习或游戏领域，本书都适合你。这里有适合每个人的内容。我们会教你足够使用 Unity 和机器学习的内容，同时也为你提供了进一步学习感兴趣领域的起点。

# 本书的组织结构

本书分为三部分。

第 I 部分，“仿真与合成基础”，介绍了仿真与合成的主题，并通过简单的活动逐步引导你进入。

第 II 部分，“为了乐趣与利益仿真世界”，致力于仿真。这是本书的最大部分，因为仿真比合成要复杂得多。在这一部分中，我们几乎一步一步地介绍了一系列仿真活动，随着我们的学习，逐渐建立了更多的概念和方法。到了本部分的结尾，你将接触到许多通过仿真可以走的不同道路。

第 III 部分，“合成数据，真实成果”，致力于合成。虽然比仿真要小得多，但仍然至关重要。你将学习使用 Unity 创建合成数据的基础知识，到最后你将能够制作几乎任何你可能需要的合成。

# 使用本书

我们将本书围绕活动进行了结构化。我们希望你能与我们一起完成这些活动，并在你感兴趣的地方添加自己的想法（但不要觉得你必须这么做）。

我们采取了基于活动的方法，因为我们认为这是学习 Unity 游戏引擎和机器学习方面所需知识的最佳方式。我们不希望把所有关于 Unity 的知识都教给你，也没有足够的空间来详细解释机器学习的所有细节。

通过活动之间的转换，我们可以根据需要引入或排除内容。我们真心希望你能喜欢我们选择的这些活动！

## 我们的任务

对于仿真，我们将构建：

+   一个可以将球自行滚动到目标的活动，在第二章中（我们知道，这听起来太不可思议了，但确实是真的！）

+   一个可以将方块推到目标区域的立方体，在第四章中。

+   一辆简单的自动驾驶汽车，驶入一条赛道，在第五章中。

+   通过模仿人类示范训练的追求硬币的球，在第六章

+   一个弹道发射器代理，可以使用课程学习将球发射到目标，第八章

+   一组一起工作以将块推向目标的立方体，在第九章

+   一个能够使用视觉输入（即摄像头）而不是精确测量来平衡球的代理，在第十章

+   一种连接并从 Python 操纵模拟的方式，在第十一章

并进行综合，我们将：

+   生成随机抛掷和放置的骰子图像，在第三章

+   改进骰子图像生成器，改变骰子的地板和颜色，在第十三章

+   生成超市产品图像，以便在复杂背景和随意位置上对 Unity 外图像进行训练，在第十四章

# 本书中使用的约定

本书使用以下排版约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名和文件扩展名。

`常宽度`

用于程序清单，以及在段落中引用程序元素，如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。也用于命令和命令行输出。

**`常粗体`**

显示用户应直接输入的命令或其他文本。

*`常斜体`*

显示应由用户提供值或由上下文确定的值替换的文本。

###### 提示

这个元素表示一个提示或建议。

###### 注意

这个元素表示一般性说明。

###### 注意

这个元素表示警告或注意事项。

# 使用代码示例

补充资料（代码示例、练习、勘误等）可从[*http://secretlab.com.au/books/practical-simulations*](http://secretlab.com.au/books/practical-simulations)*下载。

本书的目的是帮助您完成工作。一般来说，如果本书提供示例代码，则可以在您的程序和文档中使用它。除非您复制了大量代码，否则无需联系我们以获得许可。例如，编写使用本书多个代码片段的程序不需要许可。出售或分发 O’Reilly 图书示例需要许可。回答问题并引用本书示例代码不需要许可。将本书示例代码的大量内容整合到产品文档中需要许可。

我们感谢您的使用，但不需要署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*Machine Learning 实用模拟*，作者 Paris 和 Mars Buttfield-Addison、Tim Nugent 和 Jon Manning。版权 2022 Secret Lab，978-1-492-08992-6。”

如果您认为您使用的代码示例超出了合理使用范围或上述授权，请随时通过*permissions@oreilly.com*与我们联系。

# O'Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](http://oreilly.com)提供技术和商业培训、知识和洞察力，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章、会议以及我们的在线学习平台分享他们的知识和专长。O'Reilly 的在线学习平台提供即时访问现场培训课程、深度学习路径、交互式编码环境以及来自 O'Reilly 和其他 200 多家出版商的大量文本和视频内容。更多信息，请访问[*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

请向出版商发送关于本书的评论和问题：

+   O'Reilly Media, Inc.

+   Gravenstein Highway North 1005

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或当地）

+   707-829-0104（传真）

我们为本书设有网页，列出勘误、示例和任何其他信息。您可以访问此页面[*https://oreil.ly/practical-sims-for-ML*](https://oreil.ly/practical-sims-for-ML)。

发送电子邮件至*bookquestions@oreilly.com*以评论或询问有关本书的技术问题。

关于我们的书籍、课程、会议和新闻的更多信息，请访问我们的网站[*http://www.oreilly.com*](http://www.oreilly.com)。

在 Facebook 上找到我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)

在 YouTube 上观看我们：[*http://youtube.com/oreillymedia*](http://youtube.com/oreillymedia)

# 致谢

Mars 要感谢她的家人和合作者们的支持，以及塔斯马尼亚大学 ICT 学院的人们和澳大利亚更广泛的科技社区为她提供的所有机会。

Jon 感谢他的母亲、父亲以及其他疯狂的大家庭成员们对他的巨大支持。

Paris 感谢他的母亲，没有她，他不可能做任何一件像写书这样有趣的事情，还有他的妻子（也是共同作者）Mars，以及所有和他一起幸运地撰写这本书的朋友们！

Tim 感谢他的父母和家人包容他那相对平淡的生活方式。

我们都想要感谢米歇尔·克罗宁，她真是太了不起了，她的技能和建议对完成这本书至关重要。帕里斯很抱歉我们会在会议中经常岔开话题，但这太有趣了，我们真的很期待未来与您合作更多项目！

特别感谢我们在 O’Reilly Media 的朋友和前编辑雷切尔·鲁梅利奥蒂斯。我们怀念我们一起参加会议喝咖啡的时光。

真的，我们要感谢在编写这本书的过程中与我们互动过的所有 O’Reilly Media 员工。特别要感谢克里斯·福歇尔，他不仅在工作中表现出色，而且对我们非常耐心。还要感谢我们出色的副本编辑伊丽莎白·奥利弗。你们都如此专业、有趣和才华横溢。这真是令人敬畏。

特别感谢托尼·格雷和[苹果大学联盟](http://www.auc.edu.au)，因为他们为我们和其他在这页上列出的人们提供了巨大的支持。如果不是他们，我们不会写这本书。现在轮到你写书了，托尼——对此我们感到抱歉！

还要感谢尼尔·戈德斯坦，他完全应该为把我们卷入写书这一行业中承担全部责任和/或指责。

我们感谢麦克拉伯的支持（他们知道他们是谁，并继续守望着海豚将军的不可避免的晋升），以及克里斯托弗·卢格教授、莱昂妮·埃利斯博士以及塔斯马尼亚大学的现任和前任工作人员对我们的包容。

还要特别感谢戴夫·J.、杰森·I.、亚当·B.、乔什·D.、安德鲁·B.、杰斯·L.以及所有激励我们并帮助我们的人。非常特别感谢在苹果工作的那群辛勤工作的工程师、作家、艺术家和其他工作人员，没有他们，这本书（以及许多类似的书）将没有存在的理由。

还要感谢我们的技术审阅者们！没有他们的彻底和专业精神以及对我们工作的热情，我们无法写出这本书。还有极高程度的吹毛求疵。我们真的很感激。真心的！

最后，非常感谢您购买我们的书籍——我们非常感激！如果您有任何反馈，请告诉我们。
