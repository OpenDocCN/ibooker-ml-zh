# 前言

# 这本书适合谁？

初级机器学习书籍通常关注机器学习（ML）的“什么”和“如何”，然后解释来自 AI 研究实验室的新方法的数学方面，并教授如何使用 AI 框架来实现这些方法。而这本书则围绕着支持经验汇集而来的“为什么”，这些经验是经验丰富的 ML 从业者在将机器学习应用于现实世界问题时所采用的技巧和窍门。

我们假设你已经具备机器学习和数据处理的基础知识。这不是一本基础教材，而是为那些寻找第二本实用机器学习书籍的数据科学家、数据工程师或机器学习工程师而写的。如果你已经掌握了基础知识，这本书将向你介绍一系列想法，并为那些你（作为机器学习从业者）可能认识的想法命名，让你能够自信地掌握它们。

如果你是计算机科学专业的学生，准备进入工业界工作，这本书将丰富你的知识，并为你进入专业世界做好准备。它将帮助你学习如何构建高质量的机器学习系统。

# 书中不包括的内容

这本书主要是为企业中的机器学习工程师而写，而不是学术界或工业研究实验室的机器学习科学家。

我们有意不讨论正在研究中的领域 —— 例如机器学习模型架构（如双向编码器或注意力机制或短路层），因为我们假设您将使用预构建的模型架构（例如 ResNet-50 或 GRUCell），而不是编写自己的图像分类或递归神经网络。

这里有一些具体的例子，我们有意避开，因为我们认为这些主题更适合大学课程和机器学习研究人员：

机器学习算法

例如，我们不讨论随机森林和神经网络之间的区别。这在初级机器学习教材中有所涵盖。

构建模块

我们不涵盖不同类型的梯度下降优化器或激活函数。我们建议使用 Adam 和 ReLU —— 根据我们的经验，通过在这些方面做出不同选择来改进性能的潜力往往是较小的。

ML 模型架构

如果您正在进行图像分类，我们建议您使用像 ResNet 或您阅读本书时的最新热门模型。将设计新的图像分类或文本分类模型留给专门研究此问题的研究人员。

模型层

本书不涉及卷积神经网络或递归神经网络。它们因为是构建模块而被双重淘汰，也因为可以即插即用而被淘汰。

自定义训练循环

在 Keras 中仅仅调用`model.fit()`就可以满足从业者的需求。

在本书中，我们尝试仅包含企业机器学习工程师在日常工作中将会使用的常见模式。

作为类比，请考虑数据结构。尽管数据结构课程将深入研究不同数据结构的实现，而研究数据结构的研究人员必须学习如何正式表示它们的数学属性，但实际从业者可以更加实用。企业软件开发人员只需知道如何有效地使用数组、链表、映射、集合和树。这本书是为了实用的机器学习实践者而写的。

# 代码示例

我们提供机器学习的代码（有时使用 Keras/TensorFlow，有时使用 scikit-learn 或 BigQuery ML）和数据处理的代码（使用 SQL），以展示我们讨论的技术如何实际实现。本书中引用的所有代码都是我们的 GitHub 存储库的一部分，您可以在那里找到完全可工作的 ML 模型。我们强烈建议您尝试这些代码示例。

代码在涵盖的概念和技术中次要。我们的目标是，无论 TensorFlow 或 Keras 如何变化，话题和原则都应保持相关性，我们可以轻松想象更新 GitHub 存储库以包含其他 ML 框架的实现，例如 PyTorch，同时保持书籍文本不变。因此，如果您的主要 ML 框架是 PyTorch，甚至是像 H20.ai 或 R 这样的非 Python 框架，本书应同样具有信息量。确实，我们欢迎您在 GitHub 存储库中为这些模式的一个或多个实现做出贡献。

如果您有技术问题或者在使用代码示例时遇到问题，请发送电子邮件至*bookquestions@oreilly.com*。

本书旨在帮助您完成工作。一般情况下，如果本书提供了示例代码，您可以在自己的程序和文档中使用它。除非您复制了大量代码，否则无需征得我们的许可。例如，编写一个程序并使用了本书中的多个代码片段并不需要许可。销售或分发 O’Reilly 书籍中的示例则需要许可。引用本书并引用示例代码来回答问题也无需许可。将本书中大量示例代码整合到产品文档中则需要许可。

我们感谢您，但通常不需要署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*Machine Learning Design Patterns* by Valliappa Lakshmanan, Sara Robinson, and Michael Munn (O’Reilly). Copyright 2021 Valliappa Lakshmanan, Sara Robinson, and Michael Munn, 978-1-098-11578-4。” 如果您认为您使用的代码示例不适合公平使用或上述权限，请随时通过*permissions@oreilly.com* 联系我们。

# 本书中使用的约定

本书中使用的排版约定如下：

*Italic*

表示新术语、网址、电子邮件地址、文件名和文件扩展名。

`Constant width`

用于程序清单以及在段落内引用程序元素，例如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

**`Constant width bold`**

显示用户应直接输入的命令或其他文本。

*`Constant width italic`*

显示应由用户提供的值或根据上下文确定的值替换的文本。

###### Tip

此元素表示提示或建议。

###### 注意

此元素表示一般注释。

###### 警告

此元素表示警告或注意事项。

# O’Reilly 在线学习

###### 注意

超过 40 年来，[*O’Reilly Media*](http://oreilly.com) 为企业的成功提供技术和商业培训、知识和洞察。

我们独特的专家和创新者网络通过书籍、文章以及我们的在线学习平台分享他们的知识和专长。O’Reilly 的在线学习平台为您提供按需访问的实时培训课程、深入学习路径、交互式编码环境以及来自 O’Reilly 和 200 多家其他出版商的广泛文本和视频集合。有关更多信息，请访问[*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题寄给出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大境内）

+   707-829-0515（国际或本地）

+   707-829-0104（传真）

我们为本书创建了一个网页，列出勘误、示例和任何其他信息。您可以访问[*https://oreil.ly/MLDP*](https://oreil.ly/MLDP)。

发送电子邮件至*bookquestions@oreilly.com* 以就本书提出评论或技术问题。

有关我们的图书和课程的新闻和信息，请访问[*http://oreilly.com*](http://oreilly.com)。

在 Facebook 上找到我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)

在 YouTube 上观看我们：[*http://youtube.com/oreillymedia*](http://youtube.com/oreillymedia)

# 致谢

没有众多 Google 员工的慷慨，像这样的书是不可能的，特别是我们云 AI，解决方案工程，专业服务和开发者关系团队的同事。我们感激他们让我们观察，分析和质疑他们在训练，改进和使 ML 模型运行时遇到的具有挑战性的问题的解决方案。感谢我们的经理 Karl Weinmeister，Steve Cellini，Hamidou Dia，Abdul Razack，Chris Hallenbeck，Patrick Cole，Louise Byrne 和 Rochana Golani，在 Google 内部营造了开放精神，让我们有自由收录这些模式并出版这本书。

Salem Haykal，Benoit Dherin 和 Khalid Salama 审阅了每一个模式和每一章。Sal 指出了我们遗漏的细微之处，Benoit 缩小了我们的论点，而 Khalid 指引我们找到了相关的研究。没有你们的意见，这本书不可能如此出色。谢谢你们！Amy Unruh，Rajesh Thallam，Robbie Haertel，Zhitao Li，Anusha Ramesh，Ming Fang，Parker Barnes，Andrew Zaldivar，James Wexler，Andrew Sellergren 和 David Kanter 审阅了与他们专业领域相关的部分，对近期路线图会如何影响我们的建议提出了许多建议。Nitin Aggarwal 和 Matthew Yeager 以读者的角度审阅了手稿并提高了其清晰度。特别感谢 Rajesh Thallam 为第八章设计了最后一个图。当然，任何错误都是我们的。

O’Reilly 是技术书籍的首选出版商，而我们团队的专业素养正是其所在。Rebecca Novak 在整理有吸引力的大纲时引领我们，Kristen Brown 出色地管理了整个内容的开发，Corbin Collins 在每个阶段给予我们有益的指导，Elizabeth Kelly 在制作过程中非常愉快，Charles Roumeliotis 对审校工作给予了锐利的眼光。感谢你们的帮助！

Michael：感谢我的父母一直相信我，并鼓励我对学术和其他方面的兴趣。你一定和我一样能欣赏这个神秘的封面。Phil，感谢你在我写这本书的时候耐心忍受我的令人讨厌的日程安排。现在，我要睡觉了。

Sara：Jon，你是这本书存在的重要原因。感谢你鼓励我写这本书，总是知道如何让我开心，欣赏我的古怪，尤其是在我不信任自己的时候相信我。感谢我的父母，从一开始就是我的最忠实的粉丝，鼓励我爱技术和写作，让我继续这样做。Ally，Katie，Randi 和 Sophie，谢谢你们在这个不确定的时期一直给我光明和欢笑。

Lak：我接下这本书，本以为能在机场等待时候完成它。COVID-19 让我大部分工作都在家完成。感谢 Abirami、Sidharth 和 Sarada 在我专心撰写时的包容。现在周末更多时间去远足了！

我们三个会把这本书的所有版税捐赠给[编程女孩（Girls Who Code）](https://girlswhocode.com)，这个组织的使命是培养未来的女工程师队伍。在机器学习领域，多样性、公平性和包容性尤为重要，以确保 AI 模型不会延续人类社会中已有的偏见。
