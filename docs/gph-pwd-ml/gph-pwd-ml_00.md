# 前置内容

## 前言

技术世界对机器学习充满热议。每天我们都被其应用和进步的文章所轰炸。但在从业者中，一场安静的革命正在酝酿，这场革命将图置于机器学习的核心。

亚历山德罗在近十年的实践之后撰写了这本书，正值图论与机器学习的交汇点。如果亚历山德罗为网络巨头之一工作，提炼一支由博士组成的军队的知识，这将是一本有趣的书，但对于我们大多数人来说，它只能满足我们的好奇心，而不是作为一本实用的指南。幸运的是，尽管亚历山德罗拥有博士学位，但他从事企业领域的工作，对企业构建的系统有着深刻的同理心和了解。这本书反映了这一点：亚历山德罗能够有效地解决软件工程师和数据专业人士在构建非超大规模网络巨头之外的当代系统时必须克服的实践设计和实施挑战。

*图增强机器学习*展示了图对于机器学习未来的重要性。它不仅表明图提供了为当代机器学习管道提供动力的优越手段，而且还表明图是组织、分析和处理数据以进行机器学习的自然方式。本书提供了一次丰富的、精心策划的图机器学习之旅，每个主题都基于亚历山德罗的深厚经验和长期实践者的轻松、精致的自信。

本书循序渐进，提供了一个整体框架来推理机器学习并将其集成到我们的数据系统中。紧接着，它提供了一种实用的方法来处理推荐，涵盖了各种方法，如协同过滤、基于内容和会话的推荐以及混合风格。亚历山德罗指出了在最先进的技术中缺乏可解释性的问题，并表明这不是图方法的问题。然后，他继续处理欺诈检测，涉及邻近性和社交网络分析等概念，我们在犯罪网络背景下重新学习了“物以类聚”的格言。最后，本书处理了知识图谱：图技术消费文档并从中提取关联知识的能力，消除术语歧义，处理模糊查询术语。主题范围广泛，但信息质量始终优秀。

在整本书中，亚历山德罗温和地引导读者，从基础知识到高级概念逐步构建。通过示例和配套代码，注重实践的读者能够快速运行示例，并据此为自己的需求进行适配。你将带着各种实用的工具完成这本书，如果你愿意，甚至可能有一些指甲下的污垢。你将准备好提取图特征，让你的现有模型在今天表现更好，你也将准备好明天原生地与图数据库一起工作。我保证这将是一次美妙的旅程。

——吉姆·韦伯博士，Neo4j 首席科学家

## 前言

2012 年的夏天是我能记得的意大利南部最热的一个夏天。我和我的妻子正在等待我们第一个儿子的出生，他很快就要出生了，所以我们几乎没有机会外出或在阿普利亚那令人惊叹的新鲜、干净的水中享受任何清凉。在这种条件下，你可以因为 DIY（在我这个情况下不是）而变得疯狂，或者你可以用一些具有挑战性的东西来保持你的大脑忙碌。因为我不是 Sudoku 的超级粉丝，所以我开始了一个夜间和周末的项目：尝试构建一个通用的推荐引擎，它可以服务于多个范围和场景，从小型简单的到复杂和结构化的用户-项目交互数据集，最终包括相关的上下文信息。

这是我生活中图数据库强力进入的时刻。这种灵活的数据模型不仅允许我以相同的方式存储用户的购买信息，还包括所有相关的信息（后来正式定义为上下文信息）以及生成的推荐模型。当时，Neo4j 1.x 版本刚刚发布。尽管它没有现在拥有的 Cypher 或其他高级查询机制，但它足够稳定，让我选择它作为我项目的主要图数据库。采用图数据库帮助我解开了项目的难题，四个月后，我发布了 reco4j 的 alpha 版本：历史上第一个图驱动推荐引擎！

这是一场真正的、充满激情的爱情故事的开始。在接下来的三年里，我一直在自己尝试，试图在这里和那里推销 reco4j 的想法（说实话，并不那么成功），直到我和 GraphAware 的首席执行官 Michal Bachman 通了一次电话。几天后，我飞往伦敦，签署了我的合同，成为这家小型咨询公司的第六位员工，该公司帮助公司在他们的图项目中取得成功。最终，图数据库成为了我的存在理由（当然，在我两个孩子之后）。

之后，图生态系统发生了很大的变化。更多的公司开始采用图作为它们的核心技术，为客户提供先进的服务或解决内部问题。在 GraphAware，我在那里成长为首席科学家，公司规模显著增长，我有机会帮助公司利用图来构建新的服务和改进现有的服务。图不仅能够解决经典问题——从基本的搜索功能到推荐引擎，从欺诈检测到信息检索——而且也成为了改进和增强机器学习项目的突出技术。网络科学和图算法为对自然连接数据和无连接数据进行不同类型的分析提供了新的工具。

在多年的咨询生涯中，我与数据科学家和数据工程师交谈，发现了很多可以通过使用图模型或图算法解决的问题。这种向人们展示一种不同方式来处理机器学习项目的经历，使我写下了你手中的这本书。图模型并不声称能解决所有问题，但它们可以成为你武器库中的另一件利器。这本书是你自己的爱情故事开始的地方。

## 致谢

这本书的发布历时超过三年。它需要大量的工作——肯定比我最初脑海中这个疯狂想法出现时想象的要多得多。与此同时，这已经成为我迄今为止职业生涯中最激动人心的经历。（是的，我正在计划写第二本书。）我喜欢制作这本书，但这是一段漫长的旅程。这就是为什么我想感谢很多人在过程中帮助我的原因。

首先，我要感谢我的家人。我的妻子奥罗拉在我所有漫长的夜晚和早起的早晨里不得不独自入睡，我的孩子们很少看到我的脸，除了在无数周末的笔记本电脑屏幕上。感谢你的理解和无条件的爱。

接下来，我想感谢我在 Manning 出版社的开发编辑 Dustin Archibald。感谢你与我合作，并教会我所有关于写作的知识。我特别感谢你在每个月都晚交的情况下仍然如此耐心。你对这本书质量的承诺使得它对每一位读者来说都变得更好。还有许多其他在 Manning 出版社的同事在出版的每个阶段都与我合作，我要向他们表示衷心的感谢。你们的团队是一个伟大且运转良好的机器，我很享受与每一位同事的合作。

向所有审稿人致谢：Alex Ott、Alex Lucas、Amlan Chatterjee、Angelo Simone Scotto、Arnaud Castelltort、Arno Bastenhof、Dave Bechberger、Erik Sapper、Helen Mary Labao Barrameda、Joel Neely、Jose San Leandro Armendáriz、Kalyan Reddy、Kelvin Rawls、Koushik Vikram、Lawrence Nderu、Manish Jain、Odysseas Pentakalos、Richard Vaughan、Robert Diana、Rohit Mishra、Tom Heiman、Tomaz Bratanic、Venkata Marrapu 和 Vishwesh Ravi Shrimali；你们的建议帮助使这本书变得更好。

最后但同样重要的是，如果没有 GraphAware，尤其是没有 Michal，这本书将不会存在——这不仅因为他雇佣了我，并允许我在这样一个令人惊叹的公司中成长，而且还因为当我在喝啤酒时告诉他我在考虑写一本书时，他说：“我认为你应该这么做！”这本书也离不开 Chris 和 Luanne，他们从第一天起就是我最忠实的粉丝；离不开 KK，他总是在关键时刻用正确的话来鼓励我并激励我；离不开 Claudia，她帮助我审阅图像；以及离不开我那些了不起的同事，我们进行了最有意思和最具挑战性的讨论。你们所有人让这本书成为可能！

## 关于这本书

*图增强机器学习*是一本关于在机器学习应用中有效使用图的实用指南，展示了在图中扮演关键角色的完整解决方案的构建所有阶段。它侧重于与图相关的技术、算法和设计模式。基于我在构建复杂机器学习应用的经验，本书提出许多配方，其中图是美味产品的主要成分，供您的客户使用。在整个机器学习项目的生命周期中，这些方法可以在多个方面发挥作用，例如更有效地管理数据源、实现更好的算法、存储预测模型以便更快地访问，以及以更有效的方式可视化结果以进行进一步分析。

### 谁应该阅读这本书？

这本书适合你吗？如果你是一位数据科学家或数据工程师从业者，它可以帮助你完成或开始你的学习路径。如果你是一位需要启动或推动新机器学习项目的经理，它可以帮助你向团队提出不同的视角。如果你是一位对探索图的力量感兴趣的资深开发者，它可以帮助你发现关于图的新视角，不仅作为一种数据库，而且作为一种使 AI 成为可能的使能技术。

这本书不是关于机器学习技术的一般性汇编；它专注于与图相关的技术、算法和设计模式，这是本书的重点主题。具体来说，本书专注于图方法如何帮助您开发和交付更好的机器学习项目。图模型技术被详细地介绍，并描述了多个基于图的算法。最复杂的概念通过具体场景进行说明，并设计了具体的应用。

这本书旨在成为一本实用的指南，帮助你将一个可工作的应用程序安装到生产环境中。因此，它描述了优化技术和启发式方法，以帮助你处理真实数据、真实问题和真实用户。本书不仅讨论了玩具示例，还讨论了来自现实世界用例的端到端应用程序，并提出了一些处理具体问题的建议。

如果这些场景激起了你的兴趣，这本书绝对是适合你的。

### 本书是如何组织的

本书共 12 章，分为四个部分。第一部分介绍了本书的主要主题，从通用的机器学习和图概念开始，然后转向结合这些概念的优势：

+   第一章介绍了机器学习和图，并涵盖了理解以下章节所需的基本概念。

+   第二章列出了与机器学习输入相关的主要挑战，并讨论了如何通过使用图模型和图数据库来处理它们。它还介绍了图数据库的主要特性。

+   第三章详细描述了图在机器学习工作流程中的作用，并描述了一个用于大规模图处理的系统。

第二部分讨论了几个实际案例，在这些案例中，图支持了机器学习项目的发展并改善了最终结果，特别是关注推荐：

+   第四章介绍了最常见的推荐技术，并描述了如何为其中之一设计合适的图模型：基于内容的推荐引擎。它详细说明了如何将现有的（非图）数据集导入图模型，并实现工作的基于内容的推荐引擎。

+   第五章描述了如何为协作过滤方法设计合适的图模型，以及如何实现完全工作的协作过滤推荐引擎。

+   第六章介绍了基于会话的推荐算法并描述了一个能够捕捉用户会话数据的图模型。它说明了如何将样本数据集导入设计的模型，并在其上实现一个真实的推荐引擎。

+   第七章引导读者通过实现一个考虑用户上下文的推荐引擎。它描述了上下文感知推荐引擎的图模型，并展示了如何将现有数据集导入图模型。此外，本章还说明了如何在一个单一引擎中结合多种推荐方法。

第三部分解决欺诈检测问题：

+   第八章介绍了欺诈检测并描述了不同领域中的不同类型欺诈。它还指出了在建模数据以更快、更轻松地揭示欺诈方面图的作用，以及一些用于简单图模型以对抗欺诈的技术和算法。

+   第九章转向基于异常检测的更高级的欺诈对抗算法。它展示了如何使用图来存储和分析交易的 k-NN，并识别异常交易。

+   第十章介绍了如何使用社会网络分析（SNA）来分类欺诈者和欺诈风险。它列出了基于 SNA 的欺诈分析的不同图算法，并展示了如何从数据中推导出合适的图。

第四部分涵盖了自然语言处理（NLP）：

+   第十一章介绍了与基于图的 NLP 相关的概念。特别是，它描述了一种简单的方法，通过提取非结构化数据的隐藏结构，将文本分解并存储在图中。

+   第十二章介绍了知识图谱，详细说明了如何从文本中提取实体和关系，并创建知识图谱。它列出了与知识图谱一起使用的后处理技术，例如语义网络构建和自动主题提取。

虽然从头到尾阅读这本书可以最大化学习效果，但并不需要这样做。它可以作为参考，随时应对新挑战。对于这个领域的初学者，我建议从前三章开始，以清晰地理解关键概念，然后跳转到感兴趣的具体主题章节。如果你对某个特定主题或应用感兴趣，最好从你感兴趣部分的第一章开始：第四章为推荐，第八章为欺诈检测，第十一章为自然语言处理。如果你是图和机器学习的专家，并且只寻找建议，你可以阅读你感兴趣的章节。每个章节都建议阅读其他章节中的材料。

### 关于代码

这本书包含了许多源代码示例，无论是编号列表还是与普通文本内联，源代码都以固定宽度字体格式化，如下所示，以将其与普通文本区分开来。

在许多情况下，原始源代码已被重新格式化；我们添加了换行并重新整理了缩进，以适应书中的可用页面空间。在某些情况下，即使这样也不够，列表中还包括了行续接标记（➥）。此外，当代码在文本中描述时，源代码中的注释通常已从列表中删除。许多列表都有代码注释，突出显示重要概念。

本书中的示例源代码可以从出版商的网站[`www.manning.com/books/graph-powered-machine-learning`](https://www.manning.com/books/graph-powered-machine-learning)下载，或者你可以从我的 Git 仓库[`github.com/alenegro81/gpml`](https://github.com/alenegro81/gpml)克隆它。

### liveBook 讨论论坛

购买 Graph-Powered Machine Learning 包括免费访问由 Manning Publications 运营的私人网络论坛，您可以在那里对本书发表评论、提出技术问题，并从作者和其他用户那里获得帮助。要访问论坛并订阅它，请将您的网络浏览器指向[`livebook.manning.com/book/graph-powered-machine-learning`](https://livebook.manning.com/book/graph-powered-machine-learning)。您还可以在[`livebook.manning.com/discussion`](https://livebook.manning.com/discussion)了解更多关于 Manning 的论坛和行为准则。

Manning 对我们读者的承诺是提供一个场所，在那里个人读者之间，以及读者和作者之间可以进行有意义的对话。这不是对作者参与特定数量承诺的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您向他提出挑战性问题，以免他的兴趣转移！只要本书有售，论坛和先前讨论的存档将从出版社的网站提供访问。

### 在线资源

需要更多想法和支持吗？

GraphAware 网站([`www.graphaware.com`](https://www.graphaware.com/))总是充满了与使用图解决问题相关的最新博客文章、视频、播客和案例研究。

Neo4j 网站([`neo4j.com`](https://neo4j.com))也不断发布关于图的新材料，展示如何在多个环境中正确使用图数据库。

如果您在安装、查询或管理您的 Neo4j 实例或其他图数据库时遇到问题，Stack Overflow([`stackoverflow.com`](https://stackoverflow.com))总是寻找您问题解决方案的最佳资源。

## 关于作者

首先，我对计算机科学和数据研究充满极大的热情。我专长于自然语言处理、推荐引擎、欺诈检测和图辅助搜索。

在学术上追求计算机工程并在该领域担任各种职务后，我继续攻读跨学科科学与技术博士学位。随着我对图数据库的兴趣达到顶峰，我创立了一家名为 Reco4 的公司，旨在支持一个名为 reco4j 的开源项目——第一个基于图数据源的推荐框架。

现在，我是 GraphAware 的首席科学家，我们所有人都在追求成为图技术领域的首选品牌的目标。我们有 LinkedIn、世界经济论坛、欧洲航天局和美国银行等客户，我们专注于帮助客户通过将数据转化为可搜索的、可理解的和可操作的知识来获得竞争优势。在过去的几年里，我致力于领导 Hume（我们的知识图谱平台）的开发，并在世界各地的各种会议上发表演讲。

## 关于封面插图

《图神经网络机器学习》封面上的图像是从《罗马塔兰泰拉舞者，手摇铃鼓和曼陀林演奏者》（1865）中提取的。艺术家是安东·罗马科（1832-1889），一位在旅行中爱上意大利的奥地利 19 世纪画家，1857 年移居罗马，开始绘画意大利的日常生活片段。这幅画展示了一位塔兰泰拉舞者，她在跳舞的同时还在敲击手摇铃鼓（与一位演奏曼陀林的男子一起）。这幅图像被选为对作者自己在意大利南部的起源的致敬，特别是在南阿普利亚，那里这种舞蹈仍然是一种活的传统。塔兰泰拉是一种传统舞蹈，表演者模拟了被当地常见的狼蛛——被称为“塔兰图拉”（不要与今天普遍所知的塔兰图拉混淆）咬后的情况。这种蜘蛛被普遍认为毒性极强，其咬伤会导致一种被称为塔兰图拉病的歇斯底里症状。这种舞蹈的原始形式是无序且流畅的，以模拟这种状态。其他人认为，舞蹈的发明是因为连续的运动，通过引起大量出汗，可以帮助将蜘蛛的毒液从体内排出。

无论这种舞蹈的真正起源是什么，其音乐和节奏都是令人愉悦且无法抗拒的。今天仍然非常常见当地人表演这种舞蹈。
