# 第二部分建议

*表示*是机器学习和计算机科学中最为复杂和引人入胜的任务之一。华盛顿大学的计算机科学教授佩德罗·多明戈斯（Pedro Domingos）发表了一篇名为[Domingos, 2012]的文章，在其中他将机器学习分解为三个主要组成部分：表示、评估和优化。表示具体影响机器学习项目生命周期的三个核心方面：

+   在将其作为输入传递给学习过程之前，表示训练数据集的正式语言（或模式）

+   学习过程的结果——*预测模型*——的存储方式

+   在预测阶段，如何访问训练数据和预测模型以进行预测

所有这些方面都受到用于从训练数据集中的观察示例中推断泛化的学习算法的影响，并影响整体性能，包括预测准确性和训练和预测性能（速度）。

从第二部分开始，本书专注于*数据建模*：用于表示训练数据集和推断模型（学习过程的结果）的正式结构，以便计算机程序（学习代理¹）可以处理和访问它，为最终用户提供预测或分析。因此，考虑了两种不同的模型：

+   *描述模型*是为了服务于特定学习目的而创建的现实的简化表示（训练数据集）。这种简化基于对特定目的相关或不相关的某些假设，有时也基于可用信息的约束。

+   *预测模型*是估计感兴趣未知值的公式：目标。这个公式可以是数学的，是对数据结构（例如数据库或图）的查询，是一个逻辑陈述，如规则，或者这些的组合。它以高效格式表示训练数据集上的学习过程结果，并用于执行实际预测。

本书剩余部分阐述了用于数据建模的基于图的技术，这些技术服务于这两个目的。在某些情况下（当学习算法是图算法时），使用图作为数据模型的决定是必要的。在其他情况下，图方法比使用表格或其他替代方案更优。

第二章和第三章在较高层次上介绍了一些建模示例，例如使用蜂窝塔网络来监控对象、共现图来查找关键词，以及二分图来在推荐引擎中表示用户-物品数据集。这些示例展示了在这些特定场景中，图方法在建模目的上的优势。在本书的第二部分，我们将深入探讨。通过使用三个不同的宏观目标——推荐、欺诈分析和文本挖掘——本部分和下一部分的内容将更详细地介绍一系列建模技术和最佳实践，用于表示训练数据集、预测模型和访问模式。尽管如此，重点仍然在于图建模技术和预测算法。主要目的是为您提供心理工具，将预测技术的输入或输出表示为图，展示图方法固有的价值。将展示一些示例场景，并在可能和适当的情况下，将这些设计技术——包括必要的扩展和考虑——投影到其他相关场景中。

从现在到本书的结尾，章节也将具有实践性。将介绍并详细讨论真实数据集、代码片段和查询。对于每个示例场景，将选择数据集，设计并导入模型，创建并访问预测模型以获取预测。对于查询，我们将使用一种标准的图查询语言，Cypher ([`www.opencypher.org`](https://www.opencypher.org))。这种类似 SQL 的语言最初是专为 Neo4j 数据库设计的专有查询机制，但自 2015 年以来，它已成为一个开放标准。此后，其他公司（如 SAP HANA 和 Databricks）和项目（如 Apache Spark 和 RedisGraph）已将其作为图数据库的查询语言采用。

本部分不需要对 Cypher 语言有任何先前的了解，并且在整个书中，所有查询都进行了详细描述和注释。如果您想了解更多关于它的信息，我建议您查看官方文档以及一些详细描述该主题的书籍[Robinson 等人，2015，以及 Vukotic 等人，2014]。此外，为了更好地理解本部分和下一部分的内容，我建议您安装和配置 Neo4j 并运行查询。这为您提供了学习新查询语言、玩转图和更好地在脑海中固定这里提出的概念的机会。附录 B 提供了对 Neo4j 和 Cypher 的快速介绍，并解释了为什么本书使用 Neo4j 作为参考图数据库。安装指南可在那里以及 Neo4j 开发者网站上找到（[`neo4j.com/docs/operations-manual`](https://neo4j.com/docs/operations-manual)）。查询和代码示例与当时可用的最新版本 4.x 进行了测试。

本部分章节专注于将数据建模应用于推荐引擎。由于这个主题是一个常见的与图相关的机器学习主题，因此介绍了多种技术，并进行了详细的阐述。

术语*推荐系统*（RS）指的是所有通过使用他们可以收集到的关于相关用户和项目的知识，向特定用户推荐可能感兴趣的项目[Ricci 等人，2015]。这些建议可能与各种决策过程相关，例如购买什么产品、听什么音乐或看什么电影。在这种情况下，*项目*是一个通用术语，用于识别系统向用户推荐的内容。推荐系统通常专注于特定类型或类别的项目，例如要购买的书、要阅读的新闻文章或要预订的酒店。整体设计和用于生成推荐的技术都是为了提供对该特定类型项目有用的和相关的建议。有时，可以使用从一类项目中收集到的信息来提供其他类型项目的推荐。例如，购买西装的人可能也对商业书籍或昂贵的手机感兴趣。

虽然推荐系统（RS）的主要目的是帮助公司卖出更多商品，但它们从用户的角度来看也有很多优点。用户不断被选择所淹没：要阅读的新闻、要购买的产品、要看的节目等等。不同提供商提供的项目集合正在迅速增长，用户无法再对所有这些进行筛选。在这种情况下，推荐引擎提供了一个定制的体验，帮助人们更快地找到他们正在寻找的或可能对他们感兴趣的东西。结果是，由于他们在短时间内获得了相关的结果，用户的满意度将会更高。

越来越多的服务提供商正在利用这一套工具和技术 [Ricci 等人，2015]，原因包括以下几点：

+   *增加销售的商品数量*—帮助提供商卖出比不提供任何推荐时更多的商品可能是 RS 最重要的功能。这一目标得以实现，因为推荐的商品很可能会满足用户的需求和愿望。在大多数环境中，由于有大量商品（新闻文章、书籍、手表等）可供选择，用户经常被大量信息淹没，以至于他们找不到他们想要的东西，结果是他们的会话没有以具体行动结束。在这种情况下，RS 在精炼用户需求和期望方面提供了一个有效的帮助。

+   *销售更多样化的商品*—RS 可以完成的另一个重要功能是允许用户选择在没有精确推荐的情况下可能难以找到的商品。例如，在旅游 RS 中，服务提供商可能希望推广可能对特定用户在该地区感兴趣的地方，而不仅仅是最受欢迎的地方。通过提供定制建议，提供商大大降低了广告可能不适合该用户口味的地方的风险。通过向用户推荐或广告不太受欢迎（在不太知名的意义上）的地方，RS 可以提高他们在该地区的整体体验质量，并允许新地方被发现并变得流行。

+   *提高用户满意度*—一个设计得当的 RS 可以改善用户对应用的使用体验。有多少次，在浏览像亚马逊这样的在线书店时，你看到推荐并想，“哇，那本书肯定很有趣”？如果用户发现推荐有趣、相关，并且由设计良好的前端温和地提出，他们就会享受使用系统。有效、准确的推荐和可用界面的杀手级组合将提高用户对系统的主观评价，并且他们很可能会再次回来。因此，这种方法增加了系统的使用率、可用于模型构建的数据、推荐的质量和用户满意度。

+   *提高用户忠诚度*—网站和其他以客户为中心的应用通过识别回头客并将他们视为尊贵的访客来欣赏和鼓励忠诚度。对于 RS（除了一些例外情况）来说，跟踪回头用户是一个常见的要求，因为算法会使用用户在之前互动中获得的信息，例如他们对项目的评分，来在用户下一次访问过程中做出推荐。因此，用户与网站或应用互动的频率越高，用户的模型就越精细；他们偏好的表示就发展起来，推荐系统的输出效果也得到提高。

+   *更好地理解用户的需求*——一个正确实施的 RS 的另一个重要副作用是它为用户的偏好创建了一个模型，这些偏好可以是明确收集的，也可以由系统本身预测。服务提供商可以重新使用由此产生的新知识来实现其他目标，例如改善物品的库存或生产管理。在旅游领域，目的地管理机构可以选择向新客户群体宣传特定地区，或使用通过分析 RS 收集的数据（用户的交易）得出的特定类型的促销信息。

在设计 RS 时必须考虑这些方面，因为它们不仅影响系统收集、存储和处理数据的方式，还影响其用于预测的方式。由于这里列出的某些原因（如果不是全部原因），数据图表示和基于图的分析可以通过简化数据管理、挖掘、通信和交付发挥重要作用。这些方面在本部分中得到强调。

值得注意的是，我们谈论的是个性化推荐。换句话说，每个用户都会根据他们的口味收到不同的推荐列表，这些口味是基于之前的互动或通过不同方法收集的信息推断出来的[Jannach 等人，2010]。提供个性化推荐需要系统了解每个用户和每个物品的一些（或很多）信息。因此，RS 必须开发和维护一个包含用户偏好数据的用户模型（或用户配置文件），以及包含物品特征或其他细节的项目模型（或项目配置文件）。

用户和项目模型的创建是每个推荐系统的核心。然而，这种信息的收集、建模和利用方式取决于特定的推荐技术和相关的学习算法。根据构建模型所使用的信息类型以及预测用户兴趣和提供预测的方法，可以实现不同类型的推荐系统。

本部分探讨了四种主要的推荐技术。这些技术只是可用的解决方案中的一部分样本，但我选择它们是因为它们涵盖了广泛的机会和建模示例。这四种方法包括

+   *基于内容的推荐*（第四章）——推荐引擎使用项目描述（手动创建或自动提取）和用户配置文件，这些配置文件将重要性分配给不同的特征。它学会找到与用户过去喜欢（互动过）的内容相似的项目。一个典型的例子是新闻推荐引擎，它将用户之前阅读的文章与最新的文章进行比较，以找到在内容上相似的项目。

+   *协同过滤*（第五章）——协同推荐背后的基本思想是，如果用户在过去有相同的兴趣——例如购买类似书籍或观看类似电影，那么他们未来也会有相同的行为。这种方法的最著名例子是亚马逊的推荐系统，它使用用户与物品的交互历史来向用户提供推荐。

+   *基于会话的推荐*（第六章）——推荐引擎根据会话数据（如会话点击和点击物品的描述）进行预测。当用户资料和过去活动的细节不可用时，基于会话的方法很有用。它使用有关当前用户交互的信息，并将其与其他用户的先前交互相匹配。一个例子是提供酒店、别墅和公寓详情的旅游网站；用户通常在过程结束时才登录，那时是预订的时候。在这种情况下，没有关于用户的历史信息。

+   *上下文感知推荐*（第七章）——推荐引擎通过适应用户的特定上下文来生成相关的推荐 [Adomavicius et al., 2011]。上下文信息可能包括位置、时间或公司（用户与谁在一起）。许多移动应用程序使用上下文信息（位置、天气、时间等）来细化提供给用户的推荐。

这个列表并不全面，也不是唯一可用的分类。从某些角度来看，基于会话和上下文感知的推荐可能被认为是协同过滤的子类别，这取决于实现它们的算法类型。然而，这个列表反映了本书中描述方法的方式。

每种方法都有其优缺点。混合推荐系统结合方法来克服这些问题，并向用户提供更好的推荐。混合推荐方法在第七章中也有讨论。

## 参考文献

[Domingos, 2012] Domingos, Pedro. “关于机器学习的一些有用知识。” *《ACM 通讯》* 55:10 (2012): 78-87\. doi: [`dx.doi.org/10.1145/ 2347736.2347755`](http://dx.doi.org/10.1145/2347736.2347755)

Cypher 查询语言参考，版本 9\. [`mng.bz/zGza`](https://shortener.manning.com/zGza).

[Robinson et al., 2015]，Robinson, Ian, Jim Webber, 和 Emil Eifrem. *图数据库*. 2nd ed. Sebastopol, CA: O’Reilly, 2015.

[Vukotic et al., 2014] Vukotic, Aleksa, Dominic Fox, Jonas Partner, Nicki Watt, 和 Tareq Abedrabbo. *Neo4j 实战*. Shelter Island, NY: Manning, 2014.

[Ricci et al., 2015] Ricci, Lior Rokach, 和 Bracha Shapira. *推荐系统手册*. 2nd ed. New York: Springer, 2015.

[Jannach 等人，2010] Jannach, Dietmar, Markus Zanker, Alexander Felfernig, 和 Gerhard Friedrich. *推荐系统：导论*. 英国剑桥：剑桥大学出版社，2010\. doi: [`dx.doi.org/10.1017/CBO9780511763113`](http://dx.doi.org/10.1017/CBO9780511763113)

[Adomavicius 等人，2011] Adomavicius, Gediminas, Bamshad Mobasher, Francesco Ricci, 和 Alexander Tuzhilin. “上下文感知推荐系统.” *人工智能杂志* 32:3 (2011): 67-80, 2011\. DOI: [`doi.org/10.1609/aimag.v32i3.2364`](https://doi.org/10.1609/aimag.v32i3.2364)

^（1.）如第一章所述，如果一个代理在观察世界之后能够提高其在未来任务上的表现，则认为该代理正在学习。
